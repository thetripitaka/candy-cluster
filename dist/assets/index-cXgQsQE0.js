const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-CSs2d_9u.js","assets/webworkerAll-B-TNbOR9.js","assets/colorToUniform-BXaCBwVl.js","assets/WebGPURenderer-BB_7q_tj.js","assets/SharedSystems-BPpBSmYg.js","assets/WebGLRenderer-DD-go-of.js"])))=>i.map(i=>d[i]);
var WS=Object.defineProperty;var DS=(s,t,e)=>t in s?WS(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var Ue=(s,t,e)=>DS(s,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();const GS=["en","ar","de","es","fi","fr","hi","id","ja","ko","pl","pt","ru","tr","vi","zh","tl"];let df="en";function HS(s){const t=s.toLowerCase().split("-")[0];df=GS.includes(t)?t:"en"}function Pe(){return df}function Jt(s,t){const e=Bm.en??{},i=(Bm[df]??e)[s]??e[s]??s;return t?i.replace(/\{(\w+)\}/g,(r,o)=>{const c=t[o];return c==null?`{${o}}`:String(c)}):i}const Bm={en:{"ui.popup.boosted":"BOOSTED","ui.popup.infused":"INFUSED","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"BONUS MODE","splash.card1.body":`LAND 3 BONUS SYMBOLS
TO ENTER BONUS MODE`,"splash.card2.title":"+ MULTIPLIER","splash.card2.body":`MULTIPLIER COMPOUNDS
ON EVERY CLUSTER WIN`,"splash.card3.title":"BOUNCING WILD","splash.card3.body":"SECOND CHANCE WILDS","ui.tumbleWin":"TUMBLE WIN","ui.freeSpins":"FREE SPINS","ui.spinsLeft":"SPINS LEFT","ui.info":"INFO","ui.gameInfoTitle":"BLOCKY FARM – GAME INFO","ui.clickToContinue":"CLICK TO CONTINUE","ui.totalWin":"TOTAL WIN","ui.balance":"BALANCE","ui.bet":"BET","ui.win":"WIN","ui.mult":"MULT","ui.loading":"LOADING SPELLS","ui.loadingPct":"LOADING","ui.rotateBackPortrait":`PLEASE ROTATE
BACK TO PORTRAIT`,"ui.btnBuy":"BUY","ui.btnTopUp":"TOP UP","ui.btnConfirm":"CONFIRM","ui.btnAuto":"AUTO","ui.btnSettings":"SETTINGS","ui.btnPlayAuto":"PLAY AUTO","ui.btnStopAuto":"STOP AUTO","ui.buyBonus":"BUY BONUS","ui.insufficientBalance":"OOPS, NOT ENOUGH BALANCE","ui.insufficientBalanceOrChangeBet":"OOPS — NOT ENOUGH BALANCE OR CHANGE BET AMOUNT","ui.autoPlayTitle":"AUTO PLAY","ui.autoPlaySubtitle":"NUMBER OF ROUNDS","ui.buyCard.pickMixTitle":"PICK & MIX","ui.buyCard.pickMixBody":`ENTRY BONUS
STARTS AT 1× MULTIPLIER`,"ui.buyCard.gigaTitle":"GIGA","ui.buyCard.gigaBody":`HIGHER VOLATILITY
STARTS AT 2× MULTIPLIER`,"ui.buyCard.superTitle":"SUPER","ui.buyCard.superBody":`STRONG FEATURE
STARTS AT 3× MULTIPLIER`,"ui.buyCard.ultraTitle":"ULTRA","ui.buyCard.ultraBody":`MAXIMUM INTENSITY
STARTS AT 5× MULTIPLIER`,"ui.bigWin.big":"BIG WIN","ui.bigWin.super":"SUPER WIN","ui.bigWin.mega":"MEGA WIN","ui.bigWin.epic":"EPIC WIN","ui.bigWin.max":"MAX WIN","ui.bigWin.xTimes":"×{x}"},ar:{"ui.popup.boosted":"مُعَزَّز","ui.popup.infused":"مُمْدَد","splash.title.blocky":"بلوكي","splash.title.farm":"فارم","splash.card1.title":"وضع البونص","splash.card1.body":`اهبط 3 رموز بونص
للدخول إلى وضع البونص`,"splash.card2.title":"+ مضاعف","splash.card2.body":`يزداد المضاعف
مع كل فوز بالعنقود`,"splash.card3.title":"وايلد مرتد","splash.card3.body":`وايلد يمنحك
فرصة ثانية`,"ui.tumbleWin":"فوز متتالي","ui.freeSpins":"لفات مجانية","ui.spinsLeft":"اللفات المتبقية","ui.info":"معلومات","ui.gameInfoTitle":"بلوكي فارم – معلومات اللعبة","ui.clickToContinue":"اضغط للمتابعة","ui.totalWin":"إجمالي الربح","ui.balance":"الرصيد","ui.bet":"الرهان","ui.win":"الربح","ui.mult":"المضاعف","ui.loading":"جارٍ تحميل التعويذات","ui.loadingPct":"تحميل","ui.rotateBackPortrait":`يرجى تدوير الجهاز
للعودة للوضع العمودي`,"ui.btnBuy":"شراء","ui.btnTopUp":"شحن","ui.btnConfirm":"تأكيد","ui.btnAuto":"تلقائي","ui.btnSettings":"الإعدادات","ui.btnPlayAuto":"تشغيل تلقائي","ui.btnStopAuto":"إيقاف تلقائي","ui.buyBonus":"شراء البونص","ui.insufficientBalance":"عذرًا، الرصيد غير كافٍ","ui.insufficientBalanceOrChangeBet":"عذرًا — الرصيد غير كافٍ أو غيّر الرهان","ui.autoPlayTitle":"تشغيل تلقائي","ui.autoPlaySubtitle":"عدد الجولات","ui.buyCard.pickMixTitle":"اختر وامزج","ui.buyCard.pickMixBody":`دخول البونص
يبدأ عند ×1`,"ui.buyCard.gigaTitle":"ضخم","ui.buyCard.gigaBody":`تقلب أعلى
يبدأ عند ×2`,"ui.buyCard.superTitle":"قوي","ui.buyCard.superBody":`ميزة قوية
يبدأ عند ×3`,"ui.buyCard.ultraTitle":"أسطوري","ui.buyCard.ultraBody":`أقصى شدة
يبدأ عند ×5`,"ui.bigWin.big":"فوز كبير","ui.bigWin.super":"فوز خارق","ui.bigWin.mega":"فوز ضخم","ui.bigWin.epic":"فوز ملحمي","ui.bigWin.max":"أقصى فوز","ui.bigWin.xTimes":"×{x}"},de:{"ui.popup.boosted":"VERSTÄRKT","ui.popup.infused":"DURCHTRÄNKT","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"BONUSMODUS","splash.card1.body":`ERHALTE 3 BONUSSYMBOLE
FÜR DEN BONUSMODUS`,"splash.card2.title":"+ MULTI","splash.card2.body":`MULTIPLIKATOR STEIGERT
SICH BEI JEDEM
CLUSTER-GEWINN`,"splash.card3.title":`SPRINGENDER
WILD`,"splash.card3.body":`WILDS MIT
ZWEITER CHANCE`,"ui.tumbleWin":"KASKADEN-GEWINN","ui.freeSpins":"FREISPIELE","ui.spinsLeft":"VERBLEIBENDE SPIELE","ui.info":"INFO","ui.gameInfoTitle":"BLOCKY FARM – SPIELINFO","ui.clickToContinue":"KLICKEN ZUM FORTFAHREN","ui.totalWin":"GESAMTGEWINN","ui.balance":"GUTHABEN","ui.bet":"EINSATZ","ui.win":"GEWINN","ui.mult":"MULT","ui.loading":"ZAUBER WERDEN GELADEN","ui.loadingPct":"LÄDT","ui.rotateBackPortrait":`BITTE DREHEN
ZURÜCK INS HOCHFORMAT`,"ui.btnBuy":"KAUFEN","ui.btnTopUp":"AUFLADEN","ui.btnConfirm":"BESTÄTIGEN","ui.btnAuto":"AUTO","ui.btnSettings":"EINSTELLUNGEN","ui.btnPlayAuto":"AUTO STARTEN","ui.btnStopAuto":"AUTO STOPPEN","ui.buyBonus":"BONUS KAUFEN","ui.insufficientBalance":"NICHT GENUG GUTHABEN","ui.insufficientBalanceOrChangeBet":"NICHT GENUG GUTHABEN ODER EINSATZ ÄNDERN","ui.autoPlayTitle":"AUTO-SPIEL","ui.autoPlaySubtitle":"ANZAHL DER RUNDEN","ui.buyCard.pickMixTitle":"MIX & MATCH","ui.buyCard.pickMixBody":`BONUS-EINSTIEG
BEGINNT BEI 1× MULTI`,"ui.buyCard.gigaTitle":"GIGANTISCH","ui.buyCard.gigaBody":`HÖHERE VOLATILITÄT
BEGINNT BEI 2× MULTI`,"ui.buyCard.superTitle":"STARK","ui.buyCard.superBody":`STARKE FUNKTION
BEGINNT BEI 3× MULTI`,"ui.buyCard.ultraTitle":"EXTREM","ui.buyCard.ultraBody":`MAXIMALE INTENSITÄT
BEGINNT BEI 5× MULTI`,"ui.bigWin.big":"GROSSER GEWINN","ui.bigWin.super":"SUPER-GEWINN","ui.bigWin.mega":"MEGA-GEWINN","ui.bigWin.epic":"EPISCHER GEWINN","ui.bigWin.max":"MAXIMALER GEWINN","ui.bigWin.xTimes":"×{x}"},es:{"ui.popup.boosted":"POTENCIADO","ui.popup.infused":"INFUNDIDO","ui.bigWin.big":"GRAN PREMIO","ui.bigWin.super":"SÚPER PREMIO","ui.bigWin.mega":"MEGA PREMIO","ui.bigWin.epic":"PREMIO ÉPICO","ui.bigWin.max":"PREMIO MÁXIMO","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"MODO BONUS","splash.card1.body":`CAEN 3 SÍMBOLOS BONUS
PARA ACTIVAR EL BONUS`,"splash.card2.title":"+ MULTI","splash.card2.body":`EL MULTIPLICADOR
AUMENTA EN CADA
CLUSTER GANADOR`,"splash.card3.title":`WILD
REBOTADOR`,"splash.card3.body":`WILDS CON
SEGUNDA OPORTUNIDAD`,"ui.tumbleWin":"GANANCIA EN CASCADA","ui.freeSpins":"TIRADAS GRATIS","ui.spinsLeft":"TIRADAS RESTANTES","ui.info":"INFO","ui.gameInfoTitle":"BLOCKY FARM – INFORMACIÓN DEL JUEGO","ui.clickToContinue":"HAZ CLIC PARA CONTINUAR","ui.totalWin":"GANANCIA TOTAL","ui.balance":"SALDO","ui.bet":"APUESTA","ui.win":"GANANCIA","ui.mult":"MULT","ui.loading":"CARGANDO HECHIZOS","ui.loadingPct":"CARGANDO","ui.rotateBackPortrait":`POR FAVOR GIRA
A MODO VERTICAL`,"ui.btnBuy":"COMPRAR","ui.btnTopUp":"RECARGAR","ui.btnConfirm":"CONFIRMAR","ui.btnAuto":"AUTO","ui.btnSettings":"AJUSTES","ui.btnPlayAuto":"INICIAR AUTO","ui.btnStopAuto":"DETENER AUTO","ui.buyBonus":"COMPRAR BONUS","ui.insufficientBalance":"SALDO INSUFICIENTE","ui.insufficientBalanceOrChangeBet":"SALDO INSUFICIENTE O CAMBIA LA APUESTA","ui.autoPlayTitle":"JUEGO AUTOMÁTICO","ui.autoPlaySubtitle":"NÚMERO DE RONDAS","ui.buyCard.pickMixTitle":"MEZCLA Y ELIGE","ui.buyCard.pickMixBody":`ENTRADA AL BONUS
COMIENZA EN 1× MULTI`,"ui.buyCard.gigaTitle":"GIGANTE","ui.buyCard.gigaBody":`MAYOR VOLATILIDAD
COMIENZA EN 2× MULTI`,"ui.buyCard.superTitle":"POTENTE","ui.buyCard.superBody":`FUNCIÓN POTENTE
COMIENZA EN 3× MULTI`,"ui.buyCard.ultraTitle":"MÁXIMO","ui.buyCard.ultraBody":`INTENSIDAD MÁXIMA
COMIENZA EN 5× MULTI`},fi:{"ui.popup.boosted":"TEHOSTETTU","ui.popup.infused":"LADATTU","ui.bigWin.big":"ISO VOITTO","ui.bigWin.super":"SUPERVOITTO","ui.bigWin.mega":"MEGAVOITTO","ui.bigWin.epic":"EEPPINEN VOITTO","ui.bigWin.max":"MAKSIMIVOITTO","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"BONUSTILA","splash.card1.body":`SAAVUTA 3 BONUSSYMBOLIA
PÄÄSTÄKSESI BONUKSEEN`,"splash.card2.title":"+ KERROIN","splash.card2.body":`KERROIN KASVAA
CLUSTEREISTA`,"splash.card3.title":"POMPPIVA WILD","splash.card3.body":`WILDIT TOISELLA
MAHDOLLISUUDELLA`,"ui.tumbleWin":"KETJUVOITTO","ui.freeSpins":"ILMAISET KIERROKSET","ui.spinsLeft":"KIERROKSIA JÄLJELLÄ","ui.info":"INFO","ui.gameInfoTitle":"BLOCKY FARM – PELIN TIEDOT","ui.clickToContinue":"NAPAUTA JATKAAKSESI","ui.totalWin":"KOKONAISVOITTO","ui.balance":"SALDO","ui.bet":"PANOS","ui.win":"VOITTO","ui.mult":"KERROIN","ui.loading":"LOITSUJA LADATAAN","ui.loadingPct":"LADATAAN","ui.rotateBackPortrait":`KÄÄNNÄ LAITE
PYSTYTILAAN`,"ui.btnBuy":"OSTA","ui.btnTopUp":"LISÄÄ SALDOA","ui.btnConfirm":"VAHVISTA","ui.btnAuto":"AUTO","ui.btnSettings":"ASETUKSET","ui.btnPlayAuto":"KÄYNNISTÄ AUTO","ui.btnStopAuto":"PYSÄYTÄ AUTO","ui.buyBonus":"OSTA BONUS","ui.insufficientBalance":"EI TARPEEKSI SALDOA","ui.insufficientBalanceOrChangeBet":"EI TARPEEKSI SALDOA TAI MUUTA PANOSTA","ui.autoPlayTitle":"AUTOMAATTINEN PELI","ui.autoPlaySubtitle":"KIERROSTEN MÄÄRÄ","ui.buyCard.pickMixTitle":"VALITSE & SEKOITA","ui.buyCard.pickMixBody":`BONUKSEN SISÄÄNPÄÄSY
ALKAEN 1× KERROIN`,"ui.buyCard.gigaTitle":"VALTAVA","ui.buyCard.gigaBody":`SUUREMPI VOLATILITEETTI
ALKAEN 2× KERROIN`,"ui.buyCard.superTitle":"VAHVA","ui.buyCard.superBody":`VAHVA OMINAISUUS
ALKAEN 3× KERROIN`,"ui.buyCard.ultraTitle":"ÄÄRIMMÄINEN","ui.buyCard.ultraBody":`MAKSIMI-INTENSITEETTI
ALKAEN 5× KERROIN`},fr:{"ui.popup.boosted":"BOOSTÉ","ui.popup.infused":"INFUSÉ","ui.bigWin.big":"GROS GAIN","ui.bigWin.super":"SUPER GAIN","ui.bigWin.mega":"MEGA GAIN","ui.bigWin.epic":"GAIN ÉPIQUE","ui.bigWin.max":"GAIN MAX","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"MODE BONUS","splash.card1.body":`OBTENEZ 3 SYMBOLES
BONUS POUR ENTRER
EN BONUS`,"splash.card2.title":"+ MULTI","splash.card2.body":`LE MULTIPLICATEUR
AUGMENTEÀ CHAQUE
GAIN EN CLUSTER`,"splash.card3.title":`WILD
REBONDISSANT`,"splash.card3.body":`WILDS AVEC
SECONDE CHANCE`,"ui.tumbleWin":"GAIN EN CASCADE","ui.freeSpins":"TOURS GRATUITS","ui.spinsLeft":"TOURS RESTANTS","ui.info":"INFOS","ui.gameInfoTitle":"BLOCKY FARM – INFOS JEU","ui.clickToContinue":"CLIQUEZ POUR CONTINUER","ui.totalWin":"GAIN TOTAL","ui.balance":"SOLDE","ui.bet":"MISE","ui.win":"GAIN","ui.mult":"MULT","ui.loading":"CHARGEMENT DES SORTS","ui.loadingPct":"CHARGEMENT","ui.rotateBackPortrait":`VEUILLEZ TOURNER
EN MODE PORTRAIT`,"ui.btnBuy":"ACHETER","ui.btnTopUp":"RECHARGER","ui.btnConfirm":"CONFIRMER","ui.btnAuto":"AUTO","ui.btnSettings":"RÉGLAGES","ui.btnPlayAuto":"LANCER AUTO","ui.btnStopAuto":"ARRÊTER AUTO","ui.buyBonus":"ACHETER BONUS","ui.insufficientBalance":"SOLDE INSUFFISANT","ui.insufficientBalanceOrChangeBet":"SOLDE INSUFFISANT OU MODIFIER LA MISE","ui.autoPlayTitle":"JEU AUTOMATIQUE","ui.autoPlaySubtitle":"NOMBRE DE TOURS","ui.buyCard.pickMixTitle":"CHOISIR & MÉLANGER","ui.buyCard.pickMixBody":`ENTRÉE BONUS
DÉBUTE À 1× MULTIPLICATEUR`,"ui.buyCard.gigaTitle":"GÉANT","ui.buyCard.gigaBody":`VOLATILITÉ PLUS ÉLEVÉE
DÉBUTE À 2× MULTIPLICATEUR`,"ui.buyCard.superTitle":"PUISSANT","ui.buyCard.superBody":`FONCTIONNALITÉ PUISSANTE
DÉBUTE À 3× MULTIPLICATEUR`,"ui.buyCard.ultraTitle":"ULTIME","ui.buyCard.ultraBody":`INTENSITÉ MAXIMALE
DÉBUTE À 5× MULTIPLICATEUR`},hi:{"ui.popup.boosted":"बूस्टेड","ui.popup.infused":"इन्फ्यूज़्ड","ui.bigWin.big":"बड़ी जीत","ui.bigWin.super":"सुपर जीत","ui.bigWin.mega":"मेगा जीत","ui.bigWin.epic":"एपिक जीत","ui.bigWin.max":"मैक्स जीत","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"ब्लॉकी","splash.title.farm":"फ़ार्म","splash.card1.title":"बोनस मोड","splash.card1.body":`3 बोनस प्रतीक प्राप्त करें
बोनस मोड में प्रवेश के लिए`,"splash.card2.title":"+ गुणक","splash.card2.body":`हर क्लस्टर जीत पर
गुणक बढ़ता है`,"splash.card3.title":"उछलता वाइल्ड","splash.card3.body":`दूसरा मौका देने वाले
वाइल्ड`,"ui.tumbleWin":"कास्केड जीत","ui.freeSpins":"फ्री स्पिन","ui.spinsLeft":"बचे हुए स्पिन","ui.info":"जानकारी","ui.gameInfoTitle":"ब्लॉकी फ़ार्म – गेम जानकारी","ui.clickToContinue":"जारी रखने के लिए क्लिक करें","ui.totalWin":"कुल जीत","ui.balance":"शेष राशि","ui.bet":"दांव","ui.win":"जीत","ui.mult":"गुणक","ui.loading":"मंत्र लोड हो रहे हैं","ui.loadingPct":"लोड हो रहा है","ui.rotateBackPortrait":`कृपया डिवाइस घुमाएँ
पोर्ट्रेट मोड में`,"ui.btnBuy":"खरीदें","ui.btnTopUp":"टॉप अप","ui.btnConfirm":"पुष्टि करें","ui.btnAuto":"ऑटो","ui.btnSettings":"सेटिंग्स","ui.btnPlayAuto":"ऑटो शुरू करें","ui.btnStopAuto":"ऑटो रोकें","ui.buyBonus":"बोनस खरीदें","ui.insufficientBalance":"पर्याप्त शेष राशि नहीं","ui.insufficientBalanceOrChangeBet":"पर्याप्त शेष राशि नहीं या दांव बदलें","ui.autoPlayTitle":"ऑटो प्ले","ui.autoPlaySubtitle":"राउंड की संख्या","ui.buyCard.pickMixTitle":"चुनें और मिलाएँ","ui.buyCard.pickMixBody":`बोनस प्रवेश
1× गुणक से शुरू`,"ui.buyCard.gigaTitle":"विशाल","ui.buyCard.gigaBody":`अधिक अस्थिरता
2× गुणक से शुरू`,"ui.buyCard.superTitle":"शक्तिशाली","ui.buyCard.superBody":`मजबूत फीचर
3× गुणक से शुरू`,"ui.buyCard.ultraTitle":"महान","ui.buyCard.ultraBody":`अधिकतम तीव्रता
5× गुणक से शुरू`},id:{"ui.popup.boosted":"DIPERKUAT","ui.popup.infused":"DIINFUS","ui.bigWin.big":"KEMENANGAN BESAR","ui.bigWin.super":"KEMENANGAN SUPER","ui.bigWin.mega":"KEMENANGAN MEGA","ui.bigWin.epic":"KEMENANGAN EPIK","ui.bigWin.max":"KEMENANGAN MAKS","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"MODE BONUS","splash.card1.body":`DAPATKAN 3 SIMBOL BONUS
UNTUK MASUK MODE BONUS`,"splash.card2.title":"+ PENGALI","splash.card2.body":`PENGALI NAIK
SETIAP CLUSTER`,"splash.card3.title":"WILD MEMANTUL","splash.card3.body":`WILD DENGAN
KESEMPATAN KEDUA`,"ui.tumbleWin":"MENANG BERUNTUN","ui.freeSpins":"PUTARAN GRATIS","ui.spinsLeft":"SISA PUTARAN","ui.info":"INFO","ui.gameInfoTitle":"BLOCKY FARM – INFO GAME","ui.clickToContinue":"KLIK UNTUK LANJUT","ui.totalWin":"TOTAL KEMENANGAN","ui.balance":"SALDO","ui.bet":"TARUHAN","ui.win":"MENANG","ui.mult":"MULT","ui.loading":"MEMUAT MANTRA","ui.loadingPct":"MEMUAT","ui.rotateBackPortrait":`PUTAR PERANGKAT
KE MODE POTRET`,"ui.btnBuy":"BELI","ui.btnTopUp":"ISI SALDO","ui.btnConfirm":"KONFIRMASI","ui.btnAuto":"AUTO","ui.btnSettings":"PENGATURAN","ui.btnPlayAuto":"MULAI AUTO","ui.btnStopAuto":"HENTIKAN AUTO","ui.buyBonus":"BELI BONUS","ui.insufficientBalance":"SALDO TIDAK CUKUP","ui.insufficientBalanceOrChangeBet":"SALDO TIDAK CUKUP ATAU UBAH TARUHAN","ui.autoPlayTitle":"AUTO PLAY","ui.autoPlaySubtitle":"JUMLAH PUTARAN","ui.buyCard.pickMixTitle":"PILIH & CAMPUR","ui.buyCard.pickMixBody":`MASUK BONUS
DIMULAI DARI 1× PENGALI`,"ui.buyCard.gigaTitle":"Raksasa","ui.buyCard.gigaBody":`VOLATILITAS LEBIH TINGGI
DIMULAI DARI 2×`,"ui.buyCard.superTitle":"Kuat","ui.buyCard.superBody":`FITUR KUAT
DIMULAI DARI 3×`,"ui.buyCard.ultraTitle":"Maksimal","ui.buyCard.ultraBody":`INTENSITAS MAKSIMUM
DIMULAI DARI 5×`},ja:{"ui.popup.boosted":"ブースト","ui.popup.infused":"注入","ui.bigWin.big":"ビッグウィン","ui.bigWin.super":"スーパーウィン","ui.bigWin.mega":"メガウィン","ui.bigWin.epic":"エピックウィン","ui.bigWin.max":"マックスウィン","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"ブロッキー","splash.title.farm":"ファーム","splash.card1.title":"ボーナスモード","splash.card1.body":`ボーナスシンボ
ルを3つ獲得で
ボーナスモード突入`,"splash.card2.title":"+ 倍率","splash.card2.body":`クラスター勝利ごとに
倍率が上昇`,"splash.card3.title":`バウンド
ワイルド`,"splash.card3.body":`セカンドチャンスの
ワイルド`,"ui.tumbleWin":"連鎖勝利","ui.freeSpins":"フリースピン","ui.spinsLeft":"残り回数","ui.info":"情報","ui.gameInfoTitle":"BLOCKY FARM – ゲーム情報","ui.clickToContinue":"クリックして続行","ui.totalWin":"合計獲得","ui.balance":"残高","ui.bet":"ベット","ui.win":"獲得","ui.mult":"倍率","ui.loading":"呪文を読み込み中","ui.loadingPct":"読み込み中","ui.rotateBackPortrait":`端末を回転して
縦向きに戻してください`,"ui.btnBuy":"購入","ui.btnTopUp":"チャージ","ui.btnConfirm":"確認","ui.btnAuto":"オート","ui.btnSettings":"設定","ui.btnPlayAuto":"オート開始","ui.btnStopAuto":"オート停止","ui.buyBonus":"ボーナス購入","ui.insufficientBalance":"残高が不足しています","ui.insufficientBalanceOrChangeBet":"残高不足、またはベット額を変更してください","ui.autoPlayTitle":"オートプレイ","ui.autoPlaySubtitle":"ラウンド数","ui.buyCard.pickMixTitle":"ピック＆ミックス","ui.buyCard.pickMixBody":`ボーナス突入
1×倍率から開始`,"ui.buyCard.gigaTitle":"巨大","ui.buyCard.gigaBody":`高いボラティリティ
2×倍率から開始`,"ui.buyCard.superTitle":"強力","ui.buyCard.superBody":`強力な機能
3×倍率から開始`,"ui.buyCard.ultraTitle":"究極","ui.buyCard.ultraBody":`最大強度
5×倍率から開始`},ko:{"ui.popup.boosted":"부스트","ui.popup.infused":"주입","ui.bigWin.big":"빅 윈","ui.bigWin.super":"슈퍼 윈","ui.bigWin.mega":"메가 윈","ui.bigWin.epic":"에픽 윈","ui.bigWin.max":"맥스 윈","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"블로키","splash.title.farm":"팜","splash.card1.title":"보너스 모드","splash.card1.body":`보너스 심볼 3개 획득 시
보너스 모드 진입`,"splash.card2.title":"+ 배수","splash.card2.body":`클러스터 승리마다
배수가 증가`,"splash.card3.title":"바운싱 와일드","splash.card3.body":`두 번째 기회를 주는
와일드`,"ui.tumbleWin":"연쇄 승리","ui.freeSpins":"프리 스핀","ui.spinsLeft":"남은 횟수","ui.info":"정보","ui.gameInfoTitle":"BLOCKY FARM – 게임 정보","ui.clickToContinue":"클릭하여 계속","ui.totalWin":"총 당첨","ui.balance":"잔액","ui.bet":"베팅","ui.win":"당첨","ui.mult":"배수","ui.loading":"주문 불러오는 중","ui.loadingPct":"불러오는 중","ui.rotateBackPortrait":`기기를 돌려
세로 모드로 전환하세요`,"ui.btnBuy":"구매","ui.btnTopUp":"충전","ui.btnConfirm":"확인","ui.btnAuto":"자동","ui.btnSettings":"설정","ui.btnPlayAuto":"자동 시작","ui.btnStopAuto":"자동 중지","ui.buyBonus":"보너스 구매","ui.insufficientBalance":"잔액이 부족합니다","ui.insufficientBalanceOrChangeBet":"잔액이 부족하거나 베팅 금액을 변경하세요","ui.autoPlayTitle":"자동 플레이","ui.autoPlaySubtitle":"라운드 수","ui.buyCard.pickMixTitle":"픽 & 믹스","ui.buyCard.pickMixBody":`보너스 진입
1× 배수부터 시작`,"ui.buyCard.gigaTitle":"거대","ui.buyCard.gigaBody":`더 높은 변동성
2× 배수부터 시작`,"ui.buyCard.superTitle":"강력","ui.buyCard.superBody":`강력한 기능
3× 배수부터 시작`,"ui.buyCard.ultraTitle":"궁극","ui.buyCard.ultraBody":`최대 강도
5× 배수부터 시작`},pl:{"ui.popup.boosted":"WZMOCNIONE","ui.popup.infused":"NASYCONE","ui.bigWin.big":"WIELKA WYGRANA","ui.bigWin.super":"SUPER WYGRANA","ui.bigWin.mega":"MEGA WYGRANA","ui.bigWin.epic":"EPICKA WYGRANA","ui.bigWin.max":"MAKS. WYGRANA","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"TRYB BONUSOWY","splash.card1.body":`ZDOBĄDŹ 3 SYMBOLE
BONUSU ABY WEJŚĆ
 DO BONUSU`,"splash.card2.title":"+ MNOŻNIK","splash.card2.body":`MNOŻNIK ROŚNIE
PRZY KLASTRACH`,"splash.card3.title":"SKACZĄCY WILD","splash.card3.body":`WILDY Z
DRUGĄ SZANSĄ`,"ui.tumbleWin":"WYGRANA KASKADOWA","ui.freeSpins":"DARMOWE SPINY","ui.spinsLeft":"POZOSTAŁO SPINÓW","ui.info":"INFO","ui.gameInfoTitle":"BLOCKY FARM – INFORMACJE O GRZE","ui.clickToContinue":"KLIKNIJ, ABY KONTYNUOWAĆ","ui.totalWin":"SUMA WYGRANYCH","ui.balance":"SALDO","ui.bet":"STAWKA","ui.win":"WYGRANA","ui.mult":"MNOŻNIK","ui.loading":"ŁADOWANIE ZAKLĘĆ","ui.loadingPct":"ŁADOWANIE","ui.rotateBackPortrait":`OBRÓĆ URZĄDZENIE
DO TRYBU PIONOWEGO`,"ui.btnBuy":"KUP","ui.btnTopUp":"DOŁADUJ","ui.btnConfirm":"POTWIERDŹ","ui.btnAuto":"AUTO","ui.btnSettings":"USTAWIENIA","ui.btnPlayAuto":"START AUTO","ui.btnStopAuto":"STOP AUTO","ui.buyBonus":"KUP BONUS","ui.insufficientBalance":"NIEWYSTARCZAJĄCE SALDO","ui.insufficientBalanceOrChangeBet":"BRAK SALDA LUB ZMIEŃ STAWKĘ","ui.autoPlayTitle":"GRA AUTOMATYCZNA","ui.autoPlaySubtitle":"LICZBA RUND","ui.buyCard.pickMixTitle":"WYBIERZ I MIESZAJ","ui.buyCard.pickMixBody":`WEJŚCIE DO BONUSU
START OD 1× MNOŻNIKA`,"ui.buyCard.gigaTitle":"OGROMNY","ui.buyCard.gigaBody":`WYŻSZA ZMIENNOŚĆ
START OD 2× MNOŻNIKA`,"ui.buyCard.superTitle":"MOCNY","ui.buyCard.superBody":`MOCNA FUNKCJA
START OD 3× MNOŻNIKA`,"ui.buyCard.ultraTitle":"MAKSYMALNY","ui.buyCard.ultraBody":`MAKSYMALNA INTENSYWNOŚĆ
START OD 5× MNOŻNIKA`},pt:{"ui.popup.boosted":"TURBINADO","ui.popup.infused":"INFUNDIDO","ui.bigWin.big":"GRANDE GANHO","ui.bigWin.super":"SUPER GANHO","ui.bigWin.mega":"MEGA GANHO","ui.bigWin.epic":"GANHO ÉPICO","ui.bigWin.max":"GANHO MÁXIMO","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"MODO BÔNUS","splash.card1.body":`OBTENHA 3 SÍMBOLOS
BÔNUS PARA ENTRAR
NO BÔNUS`,"splash.card2.title":"+ MULTI","splash.card2.body":`O MULTIPLICADOR AUMENTA
A CADA GANHO EM CLUSTER`,"splash.card3.title":`WILD
SALTITANTE`,"splash.card3.body":`WILDS COM
SEGUNDA CHANCE`,"ui.tumbleWin":"GANHO EM CASCATA","ui.freeSpins":"RODADAS GRÁTIS","ui.spinsLeft":"RODADAS RESTANTES","ui.info":"INFO","ui.gameInfoTitle":"BLOCKY FARM – INFORMAÇÕES DO JOGO","ui.clickToContinue":"CLIQUE PARA CONTINUAR","ui.totalWin":"GANHO TOTAL","ui.balance":"SALDO","ui.bet":"APOSTA","ui.win":"GANHO","ui.mult":"MULT","ui.loading":"CARREGANDO FEITIÇOS","ui.loadingPct":"CARREGANDO","ui.rotateBackPortrait":`GIRE PARA
MODO RETRATO`,"ui.btnBuy":"COMPRAR","ui.btnTopUp":"RECARREGAR","ui.btnConfirm":"CONFIRMAR","ui.btnAuto":"AUTO","ui.btnSettings":"AJUSTES","ui.btnPlayAuto":"INICIAR AUTO","ui.btnStopAuto":"PARAR AUTO","ui.buyBonus":"COMPRAR BÔNUS","ui.insufficientBalance":"SALDO INSUFICIENTE","ui.insufficientBalanceOrChangeBet":"SALDO INSUFICIENTE OU ALTERE A APOSTA","ui.autoPlayTitle":"JOGO AUTOMÁTICO","ui.autoPlaySubtitle":"NÚMERO DE RODADAS","ui.buyCard.pickMixTitle":"PEGAR & MISTURAR","ui.buyCard.pickMixBody":`ENTRADA NO BÔNUS
COMEÇA EM 1× MULTIPLICADOR`,"ui.buyCard.gigaTitle":"GIGANTE","ui.buyCard.gigaBody":`MAIOR VOLATILIDADE
COMEÇA EM 2× MULTIPLICADOR`,"ui.buyCard.superTitle":"PODEROSO","ui.buyCard.superBody":`RECURSO FORTE
COMEÇA EM 3× MULTIPLICADOR`,"ui.buyCard.ultraTitle":"SUPREMO","ui.buyCard.ultraBody":`INTENSIDADE MÁXIMA
COMEÇA EM 5× MULTIPLICADOR`},ru:{"ui.popup.boosted":"УСИЛЕНО","ui.popup.infused":"НАПИТАНО","ui.bigWin.big":"БОЛЬШОЙ ВЫИГРЫШ","ui.bigWin.super":"СУПЕР ВЫИГРЫШ","ui.bigWin.mega":"МЕГА ВЫИГРЫШ","ui.bigWin.epic":"ЭПИЧЕСКИЙ ВЫИГРЫШ","ui.bigWin.max":"МАКС. ВЫИГРЫШ","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"БЛОКИ","splash.title.farm":"ФЕРМА","splash.card1.title":"БОНУСНЫЙ РЕЖИМ","splash.card1.body":`ПОЛУЧИТЕ 3
БОНУС-СИМВОЛА
ДЛЯ ВХОДА В БОНУС`,"splash.card2.title":"+ МНОЖИТЕЛЬ","splash.card2.body":`МНОЖИТЕЛЬ РАСТЁТ
 КАЖДОЙ КОМБИНАЦИЕЙЕ`,"splash.card3.title":"ПРЫГАЮЩИЙ WILD","splash.card3.body":`WILD-СИМВОЛЫ
С ВТОРЫМ ШАНСОМ`,"ui.tumbleWin":"КАСКАДНЫЙ ВЫИГРЫШ","ui.freeSpins":"БЕСПЛАТНЫЕ СПИНЫ","ui.spinsLeft":"ОСТАЛОСЬ СПИНОВ","ui.info":"ИНФО","ui.gameInfoTitle":"BLOCKY FARM — ИНФОРМАЦИЯ ОБ ИГРЕ","ui.clickToContinue":"НАЖМИТЕ ДЛЯ ПРОДОЛЖЕНИЯ","ui.totalWin":`ОБЩИЙ
ВЫИГРЫШ`,"ui.balance":"БАЛАНС","ui.bet":"СТАВКА","ui.win":"ВЫИГРЫШ","ui.mult":"МНОЖ","ui.loading":"ЗАГРУЗКА ЗАКЛИНАНИЙ","ui.loadingPct":"ЗАГРУЗКА","ui.rotateBackPortrait":`ПОВЕРНИТЕ УСТРОЙСТВО
В ПОРТРЕТНЫЙ РЕЖИМ`,"ui.btnBuy":"КУПИТЬ","ui.btnTopUp":"ПОПОЛНИТЬ","ui.btnConfirm":"ПОДТВЕРДИТЬ","ui.btnAuto":"АВТО","ui.btnSettings":"НАСТРОЙКИ","ui.btnPlayAuto":"ЗАПУСТИТЬ АВТО","ui.btnStopAuto":"ОСТАНОВИТЬ АВТО","ui.buyBonus":"КУПИТЬ БОНУС","ui.insufficientBalance":"НЕДОСТАТОЧНО СРЕДСТВ","ui.insufficientBalanceOrChangeBet":"НЕДОСТАТОЧНО СРЕДСТВ ИЛИ ИЗМЕНИТЕ СТАВКУ","ui.autoPlayTitle":"АВТОИГРА","ui.autoPlaySubtitle":"КОЛИЧЕСТВО РАУНДОВ","ui.buyCard.pickMixTitle":"ВЫБОР И МИКС","ui.buyCard.pickMixBody":`ВХОД В БОНУС
СТАРТ С 1× МНОЖИТЕЛЯ`,"ui.buyCard.gigaTitle":"ГИГАНТ","ui.buyCard.gigaBody":`ВЫСОКАЯ ВОЛАТИЛЬНОСТЬ
СТАРТ С 2× МНОЖИТЕЛЯ`,"ui.buyCard.superTitle":"МОЩНЫЙ","ui.buyCard.superBody":`МОЩНАЯ ФУНКЦИЯ
СТАРТ С 3× МНОЖИТЕЛЯ`,"ui.buyCard.ultraTitle":"ЭПИЧЕСКИЙ","ui.buyCard.ultraBody":`МАКСИМАЛЬНАЯ ИНТЕНСИВНОСТЬ
СТАРТ С 5× МНОЖИТЕЛЯ`},tr:{"ui.popup.boosted":"GÜÇLENDİRİLDİ","ui.popup.infused":"AŞILANDI","ui.bigWin.big":"BÜYÜK KAZANÇ","ui.bigWin.super":"SÜPER KAZANÇ","ui.bigWin.mega":"MEGA KAZANÇ","ui.bigWin.epic":"EFSANE KAZANÇ","ui.bigWin.max":"MAKS. KAZANÇ","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"BONUS MODU","splash.card1.body":`BONUS MODUNA GİRMEK İÇİN
3 BONUS SEMBOLÜ KAZAN`,"splash.card2.title":"+ ÇARPAN","splash.card2.body":`HER CLUSTER KAZANCINDA
ÇARPAN ARTAR`,"splash.card3.title":"ZIPLAYAN WILD","splash.card3.body":`İKİNCİ ŞANS SUNAN
WILD’LAR`,"ui.tumbleWin":"KASKAT KAZANCI","ui.freeSpins":"ÜCRETSİZ SPİN","ui.spinsLeft":"KALAN SPİN","ui.info":"BİLGİ","ui.gameInfoTitle":"BLOCKY FARM – OYUN BİLGİSİ","ui.clickToContinue":"DEVAM ETMEK İÇİN TIKLAYIN","ui.totalWin":"TOPLAM KAZANÇ","ui.balance":"BAKİYE","ui.bet":"BAHİS","ui.win":"KAZANÇ","ui.mult":"ÇARPAN","ui.loading":"BÜYÜLER YÜKLENİYOR","ui.loadingPct":"YÜKLENİYOR","ui.rotateBackPortrait":`CİHAZI DÖNDÜRÜN
DİKEY MODA GEÇİN`,"ui.btnBuy":"SATIN AL","ui.btnTopUp":"BAKİYE YÜKLE","ui.btnConfirm":"ONAYLA","ui.btnAuto":"OTO","ui.btnSettings":"AYARLAR","ui.btnPlayAuto":"OTO BAŞLAT","ui.btnStopAuto":"OTO DURDUR","ui.buyBonus":"BONUS SATIN AL","ui.insufficientBalance":"BAKİYE YETERSİZ","ui.insufficientBalanceOrChangeBet":"BAKİYE YETERSİZ YA DA BAHİSİ DEĞİŞTİR","ui.autoPlayTitle":"OTOMATİK OYUN","ui.autoPlaySubtitle":"TUR SAYISI","ui.buyCard.pickMixTitle":"SEÇ & KARIŞTIR","ui.buyCard.pickMixBody":`BONUS GİRİŞİ
1× ÇARPANLA BAŞLAR`,"ui.buyCard.gigaTitle":"DEV","ui.buyCard.gigaBody":`DAHA YÜKSEK VOLATİLİTE
2× ÇARPANLA BAŞLAR`,"ui.buyCard.superTitle":"GÜÇLÜ","ui.buyCard.superBody":`GÜÇLÜ ÖZELLİK
3× ÇARPANLA BAŞLAR`,"ui.buyCard.ultraTitle":"ZİRVE","ui.buyCard.ultraBody":`MAKSİMUM YOĞUNLUK
5× ÇARPANLA BAŞLAR`},vi:{"ui.popup.boosted":"TĂNG CƯỜNG","ui.popup.infused":"TRUYỀN NĂNG LƯỢNG","ui.bigWin.big":"THẮNG LỚN","ui.bigWin.super":"THẮNG SIÊU","ui.bigWin.mega":"THẮNG MEGA","ui.bigWin.epic":"THẮNG HUYỀN THOẠI","ui.bigWin.max":"THẮNG TỐI ĐA","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"Khối","splash.title.farm":"Nông Trại","splash.card1.title":"CHẾ ĐỘ BONUS","splash.card1.body":`NHẬN 3 BIỂU TƯỢNG BONUS
ĐỂ VÀO CHẾ ĐỘ BONUS`,"splash.card2.title":"+ NHÂN","splash.card2.body":`HỆ SỐ NHÂN TĂNG
SAU MỖI CHIẾN THẮNG CLUSTER`,"splash.card3.title":"WILD NẢY","splash.card3.body":`WILD VỚI
CƠ HỘI THỨ HAI`,"ui.tumbleWin":"THẮNG LIÊN TIẾP","ui.freeSpins":"VÒNG QUAY MIỄN PHÍ","ui.spinsLeft":"CÒN LẠI","ui.info":"THÔNG TIN","ui.gameInfoTitle":"BLOCKY FARM – THÔNG TIN TRÒ CHƠI","ui.clickToContinue":"NHẤN ĐỂ TIẾP TỤC","ui.totalWin":"TỔNG THẮNG","ui.balance":"SỐ DƯ","ui.bet":"CƯỢC","ui.win":"THẮNG","ui.mult":"NHÂN","ui.loading":"ĐANG TẢI PHÉP THUẬT","ui.loadingPct":"ĐANG TẢI","ui.rotateBackPortrait":`XOAY THIẾT BỊ
VỀ CHẾ ĐỘ DỌC`,"ui.btnBuy":"MUA","ui.btnTopUp":"NẠP","ui.btnConfirm":"XÁC NHẬN","ui.btnAuto":"AUTO","ui.btnSettings":"CÀI ĐẶT","ui.btnPlayAuto":"CHẠY AUTO","ui.btnStopAuto":"DỪNG AUTO","ui.buyBonus":"MUA BONUS","ui.insufficientBalance":"KHÔNG ĐỦ SỐ DƯ","ui.insufficientBalanceOrChangeBet":"KHÔNG ĐỦ SỐ DƯ HOẶC ĐỔI MỨC CƯỢC","ui.autoPlayTitle":"CHƠI TỰ ĐỘNG","ui.autoPlaySubtitle":"SỐ VÒNG","ui.buyCard.pickMixTitle":"CHỌN & TRỘN","ui.buyCard.pickMixBody":`VÀO BONUS
BẮT ĐẦU TỪ 1×`,"ui.buyCard.gigaTitle":"Khổng Lồ","ui.buyCard.gigaBody":`BIẾN ĐỘNG CAO
BẮT ĐẦU TỪ 2×`,"ui.buyCard.superTitle":"Mạnh Mẽ","ui.buyCard.superBody":`TÍNH NĂNG MẠNH
BẮT ĐẦU TỪ 3×`,"ui.buyCard.ultraTitle":"Tối Thượng","ui.buyCard.ultraBody":`CƯỜNG ĐỘ TỐI ĐA
BẮT ĐẦU TỪ 5×`},zh:{"ui.popup.boosted":"强化","ui.popup.infused":"注入","ui.bigWin.big":"大赢","ui.bigWin.super":"超级大赢","ui.bigWin.mega":"巨型大赢","ui.bigWin.epic":"史诗大赢","ui.bigWin.max":"最强大赢","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"方块","splash.title.farm":"农场","splash.card1.title":"奖励模式","splash.card1.body":`落下 3 个奖励符号
进入奖励模式`,"splash.card2.title":"+ 倍数","splash.card2.body":`每次连消获胜
倍数都会叠加`,"splash.card3.title":"弹跳百搭","splash.card3.body":"获得第二次机会百搭","ui.tumbleWin":"连消赢取","ui.freeSpins":"免费旋转","ui.spinsLeft":"剩余次数","ui.info":"信息","ui.gameInfoTitle":"BLOCKY FARM – 游戏信息","ui.clickToContinue":"点击继续","ui.totalWin":"总赢得","ui.balance":"余额","ui.bet":"投注","ui.win":"赢取","ui.mult":"倍数","ui.loading":"正在加载法术","ui.loadingPct":"加载中","ui.rotateBackPortrait":`请将设备
旋转为竖屏`,"ui.btnBuy":"购买","ui.btnTopUp":"充值","ui.btnConfirm":"确认","ui.btnAuto":"自动","ui.btnSettings":"设置","ui.btnPlayAuto":"开始自动","ui.btnStopAuto":"停止自动","ui.buyBonus":"购买奖励","ui.insufficientBalance":"余额不足","ui.insufficientBalanceOrChangeBet":"余额不足或请更改投注金额","ui.autoPlayTitle":"自动游戏","ui.autoPlaySubtitle":"回合数量","ui.buyCard.pickMixTitle":"挑选混合","ui.buyCard.pickMixBody":`进入奖励
从 1× 倍数开始`,"ui.buyCard.gigaTitle":"巨型","ui.buyCard.gigaBody":`更高波动
从 2× 倍数开始`,"ui.buyCard.superTitle":"强力","ui.buyCard.superBody":`强力功能
从 3× 倍数开始`,"ui.buyCard.ultraTitle":"究极","ui.buyCard.ultraBody":`最高强度
从 5× 倍数开始`},tl:{"ui.popup.boosted":"PINATIBAY","ui.popup.infused":"PINUNO","ui.bigWin.big":"MALAKING PANALO","ui.bigWin.super":"SOBRANG PANALO","ui.bigWin.mega":"MEGA PANALO","ui.bigWin.epic":"EPIC NA PANALO","ui.bigWin.max":"PINAKAMALAKING PANALO","ui.bigWin.xTimes":"×{x}","splash.title.blocky":"BLOCKY","splash.title.farm":"FARM","splash.card1.title":"BONUS MODE","splash.card1.body":`3 BONUS SYMBOL
PARA BONUS MODE`,"splash.card2.title":"+ MULTIPLIER","splash.card2.body":`LUMALAKI ANG
MULTIPLIERSA BAWAT
PANALONG CLUSTER`,"splash.card3.title":"TUMATALONG WILD","splash.card3.body":`MGA WILD NA MAY
IKALAWANG PAGKAKATAON`,"ui.tumbleWin":"SUNOD-SUNOD NA PANALO","ui.freeSpins":"Libreng Ikot","ui.spinsLeft":"Natitirang Ikot","ui.info":"IMPORMASYON","ui.gameInfoTitle":"BLOCKY FARM – IMPORMASYON NG LARO","ui.clickToContinue":"I-CLICK PARA MAGPATULOY","ui.totalWin":"KABUUANG PANALO","ui.balance":"BALANSE","ui.bet":"TAYA","ui.win":"PANALO","ui.mult":"MULT","ui.loading":"NAGLO-LOAD NG MGA MAHIWAGA","ui.loadingPct":"NAGLO-LOAD","ui.rotateBackPortrait":`IBALIK SA
PATAYONG POSISYON`,"ui.btnBuy":"BILI","ui.btnTopUp":"MAGDAGDAG","ui.btnConfirm":"KUMPIRMA","ui.btnAuto":"AUTO","ui.btnSettings":"SETTINGS","ui.btnPlayAuto":"SIMULAN AUTO","ui.btnStopAuto":"ITIGIL AUTO","ui.buyBonus":"BILHIN ANG BONUS","ui.insufficientBalance":"KULANG ANG BALANSE","ui.insufficientBalanceOrChangeBet":"KULANG ANG BALANSE O PALITAN ANG TAYA","ui.autoPlayTitle":"AUTO PLAY","ui.autoPlaySubtitle":"BILANG NG IKOT","ui.buyCard.pickMixTitle":"PUMILI AT IHALO","ui.buyCard.pickMixBody":`PASOK SA BONUS
SIMULA SA 1× MULTIPLIER`,"ui.buyCard.gigaTitle":"Higante","ui.buyCard.gigaBody":`MAS MATAAS NA VOLATILITY
SIMULA SA 2× MULTIPLIER`,"ui.buyCard.superTitle":"Malakas","ui.buyCard.superBody":`MALAKAS NA FEATURE
SIMULA SA 3× MULTIPLIER`,"ui.buyCard.ultraTitle":"Sukdulan","ui.buyCard.ultraBody":`PINAKAMATAAS NA INTENSITY
SIMULA SA 5× MULTIPLIER`}};function ki(s){switch(s){case"ar":return'"Marhey", system-ui, sans-serif';case"hi":return'"PlaypenSansDeva", system-ui, sans-serif';case"zh":return'"ZCOOLKuaiLe", system-ui, sans-serif';case"ja":return'"PottaOne", system-ui, sans-serif';case"ko":return'"DoHyeon", system-ui, sans-serif';case"vi":return'"Neucha", system-ui, sans-serif';case"ru":return'"Neucha", system-ui, sans-serif';case"tr":return'"Bahiana", system-ui, sans-serif';default:return'"Pixeldown","Micro5", system-ui, sans-serif'}}function YS(s){return s.split(",")[0].trim().replaceAll('"',"")}async function Nm(s){var e,n,i;const t=YS(ki(s));await((n=(e=document.fonts)==null?void 0:e.load)==null?void 0:n.call(e,`16px "${t}"`)),await((i=document.fonts)==null?void 0:i.ready)}const XS="modulepreload",VS=function(s){return"/"+s},Um={},Th=function(t,e,n){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(e.map(f=>{if(f=VS(f),f in Um)return;Um[f]=!0;const y=f.endsWith(".css"),x=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${x}`))return;const l=document.createElement("link");if(l.rel=y?"stylesheet":XS,y||(l.as="script"),l.crossOrigin="",l.href=f,c&&l.setAttribute("nonce",c),document.head.appendChild(l),y)return new Promise((p,b)=>{l.addEventListener("load",p),l.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function r(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&r(c.reason);return t().catch(r)})};var Rt=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s.ShapeBuilder="shape-builder",s.Batcher="batcher",s))(Rt||{});const Vd=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},rh=(s,t)=>Vd(s).priority??t,Es={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Vd).forEach(t=>{t.type.forEach(e=>{var n,i;return(i=(n=this._removeHandlers)[e])==null?void 0:i.call(n,t)})}),this},add(...s){return s.map(Vd).forEach(t=>{t.type.forEach(e=>{var r,o;const n=this._addHandlers,i=this._queue;n[e]?(o=n[e])==null||o.call(n,t):(i[e]=i[e]||[],(r=i[e])==null||r.push(t))})}),this},handle(s,t,e){var o;const n=this._addHandlers,i=this._removeHandlers;if(n[s]||i[s])throw new Error(`Extension type ${s} already has a handler`);n[s]=t,i[s]=e;const r=this._queue;return r[s]&&((o=r[s])==null||o.forEach(c=>t(c)),delete r[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,n=>{t.findIndex(r=>r.name===n.name)>=0||(t.push({name:n.name,value:n.ref}),t.sort((r,o)=>rh(o.value,e)-rh(r.value,e)))},n=>{const i=t.findIndex(r=>r.name===n.name);i!==-1&&t.splice(i,1)})},handleByList(s,t,e=-1){return this.handle(s,n=>{t.includes(n.ref)||(t.push(n.ref),t.sort((i,r)=>rh(r,e)-rh(i,e)))},n=>{const i=t.indexOf(n.ref);i!==-1&&t.splice(i,1)})},mixin(s,...t){for(const e of t)Object.defineProperties(s.prototype,Object.getOwnPropertyDescriptors(e))}},zS={extension:{type:Rt.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Th(()=>import("./browserAll-CSs2d_9u.js"),__vite__mapDeps([0,1,2]))}},KS={extension:{type:Rt.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Th(()=>import("./webworkerAll-B-TNbOR9.js"),__vite__mapDeps([1,2]))}};class vs{constructor(t,e,n){this._x=e||0,this._y=n||0,this._observer=t}clone(t){return new vs(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var pl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ig(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var rg={exports:{}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function i(f,y,x){this.fn=f,this.context=y,this.once=x||!1}function r(f,y,x,l,p){if(typeof x!="function")throw new TypeError("The listener must be a function");var b=new i(x,l||f,p),_=e?e+y:y;return f._events[_]?f._events[_].fn?f._events[_]=[f._events[_],b]:f._events[_].push(b):(f._events[_]=b,f._eventsCount++),f}function o(f,y){--f._eventsCount===0?f._events=new n:delete f._events[y]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var y=[],x,l;if(this._eventsCount===0)return y;for(l in x=this._events)t.call(x,l)&&y.push(e?l.slice(1):l);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(x)):y},c.prototype.listeners=function(y){var x=e?e+y:y,l=this._events[x];if(!l)return[];if(l.fn)return[l.fn];for(var p=0,b=l.length,_=new Array(b);p<b;p++)_[p]=l[p].fn;return _},c.prototype.listenerCount=function(y){var x=e?e+y:y,l=this._events[x];return l?l.fn?1:l.length:0},c.prototype.emit=function(y,x,l,p,b,_){var u=e?e+y:y;if(!this._events[u])return!1;var w=this._events[u],M=arguments.length,v,I;if(w.fn){switch(w.once&&this.removeListener(y,w.fn,void 0,!0),M){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,x),!0;case 3:return w.fn.call(w.context,x,l),!0;case 4:return w.fn.call(w.context,x,l,p),!0;case 5:return w.fn.call(w.context,x,l,p,b),!0;case 6:return w.fn.call(w.context,x,l,p,b,_),!0}for(I=1,v=new Array(M-1);I<M;I++)v[I-1]=arguments[I];w.fn.apply(w.context,v)}else{var L=w.length,K;for(I=0;I<L;I++)switch(w[I].once&&this.removeListener(y,w[I].fn,void 0,!0),M){case 1:w[I].fn.call(w[I].context);break;case 2:w[I].fn.call(w[I].context,x);break;case 3:w[I].fn.call(w[I].context,x,l);break;case 4:w[I].fn.call(w[I].context,x,l,p);break;default:if(!v)for(K=1,v=new Array(M-1);K<M;K++)v[K-1]=arguments[K];w[I].fn.apply(w[I].context,v)}}return!0},c.prototype.on=function(y,x,l){return r(this,y,x,l,!1)},c.prototype.once=function(y,x,l){return r(this,y,x,l,!0)},c.prototype.removeListener=function(y,x,l,p){var b=e?e+y:y;if(!this._events[b])return this;if(!x)return o(this,b),this;var _=this._events[b];if(_.fn)_.fn===x&&(!p||_.once)&&(!l||_.context===l)&&o(this,b);else{for(var u=0,w=[],M=_.length;u<M;u++)(_[u].fn!==x||p&&!_[u].once||l&&_[u].context!==l)&&w.push(_[u]);w.length?this._events[b]=w.length===1?w[0]:w:o(this,b)}return this},c.prototype.removeAllListeners=function(y){var x;return y?(x=e?e+y:y,this._events[x]&&o(this,x)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=e,c.EventEmitter=c,s.exports=c})(rg);var $S=rg.exports;const Bi=ig($S),jS=Math.PI*2,qS=180/Math.PI,ZS=Math.PI/180;class Fs{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Fs(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return cd.x=0,cd.y=0,cd}}const cd=new Fs;class Oe{constructor(t=1,e=0,n=0,i=1,r=0,o=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,i,r,o){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new Fs;const n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e}applyInverse(t,e){e=e||new Fs;const n=this.a,i=this.b,r=this.c,o=this.d,c=this.tx,f=this.ty,y=1/(n*o+r*-i),x=t.x,l=t.y;return e.x=o*y*x+-r*y*l+(f*r-c*o)*y,e.y=n*y*l+-i*y*x+(-f*n+c*i)*y,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,o=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this}append(t){const e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this}appendFrom(t,e){const n=t.a,i=t.b,r=t.c,o=t.d,c=t.tx,f=t.ty,y=e.a,x=e.b,l=e.c,p=e.d;return this.a=n*y+i*l,this.b=n*x+i*p,this.c=r*y+o*l,this.d=r*x+o*p,this.tx=c*y+f*l+e.tx,this.ty=c*x+f*p+e.ty,this}setTransform(t,e,n,i,r,o,c,f,y){return this.a=Math.cos(c+y)*r,this.b=Math.sin(c+y)*r,this.c=-Math.sin(c-f)*o,this.d=Math.cos(c-f)*o,this.tx=t-(n*this.a+i*this.c),this.ty=e-(n*this.b+i*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,i=this.c,r=this.d,o=t.pivot,c=-Math.atan2(-i,r),f=Math.atan2(n,e),y=Math.abs(c+f);return y<1e-5||Math.abs(jS-y)<1e-5?(t.rotation=f,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=c,t.skew.y=f),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(i*i+r*r),t.position.x=this.tx+(o.x*e+o.y*i),t.position.y=this.ty+(o.x*n+o.y*r),t}invert(){const t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,o=t*i-e*n;return this.a=i/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-i*r)/o,this.ty=-(t*this.ty-e*r)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Oe;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return JS.identity()}static get shared(){return QS.identity()}}const QS=new Oe,JS=new Oe,Mo=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],To=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vo=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Eo=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],zd=[],og=[],oh=Math.sign;function tw(){for(let s=0;s<16;s++){const t=[];zd.push(t);for(let e=0;e<16;e++){const n=oh(Mo[s]*Mo[e]+vo[s]*To[e]),i=oh(To[s]*Mo[e]+Eo[s]*To[e]),r=oh(Mo[s]*vo[e]+vo[s]*Eo[e]),o=oh(To[s]*vo[e]+Eo[s]*Eo[e]);for(let c=0;c<16;c++)if(Mo[c]===n&&To[c]===i&&vo[c]===r&&Eo[c]===o){t.push(c);break}}}for(let s=0;s<16;s++){const t=new Oe;t.set(Mo[s],To[s],vo[s],Eo[s],0,0),og.push(t)}}tw();const rn={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Mo[s],uY:s=>To[s],vX:s=>vo[s],vY:s=>Eo[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>zd[s][t],sub:(s,t)=>zd[s][rn.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?rn.S:rn.N:Math.abs(t)*2<=Math.abs(s)?s>0?rn.E:rn.W:t>0?s>0?rn.SE:rn.SW:s>0?rn.NE:rn.NW,matrixAppendRotationInv:(s,t,e=0,n=0)=>{const i=og[rn.inv(t)];i.tx=e,i.ty=n,s.append(i)},transformRectCoords:(s,t,e,n)=>{const{x:i,y:r,width:o,height:c}=s,{x:f,y,width:x,height:l}=t;return e===rn.E?(n.set(i+f,r+y,o,c),n):e===rn.S?n.set(x-r-c+f,i+y,c,o):e===rn.W?n.set(x-i-o+f,l-r-c+y,o,c):e===rn.N?n.set(r+f,l-i-o+y,c,o):n.set(i+f,r+y,o,c)}},ah=[new Fs,new Fs,new Fs,new Fs];class oe{constructor(t=0,e=0,n=0,i=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new oe(0,0,0,0)}clone(){return new oe(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,n,i=.5){const{width:r,height:o}=this;if(r<=0||o<=0)return!1;const c=this.x,f=this.y,y=n*(1-i),x=n-y,l=c-y,p=c+r+y,b=f-y,_=f+o+y,u=c+x,w=c+r-x,M=f+x,v=f+o-x;return t>=l&&t<=p&&e>=b&&e<=_&&!(t>u&&t<w&&e>M&&e<v)}intersects(t,e){if(!e){const gt=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=gt)return!1;const at=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>at}const n=this.left,i=this.right,r=this.top,o=this.bottom;if(i<=n||o<=r)return!1;const c=ah[0].set(t.left,t.top),f=ah[1].set(t.left,t.bottom),y=ah[2].set(t.right,t.top),x=ah[3].set(t.right,t.bottom);if(y.x<=c.x||f.y<=c.y)return!1;const l=Math.sign(e.a*e.d-e.b*e.c);if(l===0||(e.apply(c,c),e.apply(f,f),e.apply(y,y),e.apply(x,x),Math.max(c.x,f.x,y.x,x.x)<=n||Math.min(c.x,f.x,y.x,x.x)>=i||Math.max(c.y,f.y,y.y,x.y)<=r||Math.min(c.y,f.y,y.y,x.y)>=o))return!1;const p=l*(f.y-c.y),b=l*(c.x-f.x),_=p*n+b*r,u=p*i+b*r,w=p*n+b*o,M=p*i+b*o;if(Math.max(_,u,w,M)<=p*c.x+b*c.y||Math.min(_,u,w,M)>=p*x.x+b*x.y)return!1;const v=l*(c.y-y.y),I=l*(y.x-c.x),L=v*n+I*r,K=v*i+I*r,W=v*n+I*o,U=v*i+I*o;return!(Math.max(L,K,W,U)<=v*c.x+I*c.y||Math.min(L,K,W,U)>=v*x.x+I*x.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=i,this.height=Math.max(r-i,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=i-this.y,this}scale(t,e=t){return this.x*=t,this.y*=e,this.width*=t,this.height*=e,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=i,this.height=r-i,this}getBounds(t){return t||(t=new oe),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,n=t.y,i=t.x+t.width,r=t.y+t.height;return e>=this.x&&e<this.x+this.width&&n>=this.y&&n<this.y+this.height&&i>=this.x&&i<this.x+this.width&&r>=this.y&&r<this.y+this.height}set(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const hd={default:-1};function Xn(s="default"){return hd[s]===void 0&&(hd[s]=-1),++hd[s]}const Wm=new Set,ze="8.0.0",ew="8.3.4",_a={quiet:!1,noColor:!1},ae=(s,t,e=3)=>{if(_a.quiet||Wm.has(t))return;let n=new Error().stack;const i=`${t}
Deprecated since v${s}`,r=typeof console.groupCollapsed=="function"&&!_a.noColor;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",i):(n=n.split(`
`).splice(e).join(`
`),r?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",i),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",i),console.warn(n))),Wm.add(t)};Object.defineProperties(ae,{quiet:{get:()=>_a.quiet,set:s=>{_a.quiet=s},enumerable:!0,configurable:!1},noColor:{get:()=>_a.noColor,set:s=>{_a.noColor=s},enumerable:!0,configurable:!1}});const ag=()=>{};function xa(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Dm(s){return!(s&s-1)&&!!s}function lg(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const Gm=Object.create(null);function nw(s){const t=Gm[s];return t===void 0&&(Gm[s]=Xn("resource")),t}const cg=class hg extends Bi{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...hg.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){ae(ze,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=nw(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};cg.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let ba=cg;const ug=class dg extends Bi{constructor(t={}){super(),this.options=t,this.uid=Xn("textureSource"),this._resourceType="textureSource",this._resourceId=Xn("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...dg.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new ba(lg(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,n;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(n=this._style)==null||n.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(t){this._style.maxAnisotropy=t}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Xn("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,n){n||(n=this._resolution),t||(t=this.width),e||(e=this.height);const i=Math.round(t*n),r=Math.round(e*n);return this.width=i/n,this.height=r/n,this._resolution=n,this.pixelWidth===i&&this.pixelHeight===r?!1:(this._refreshPOT(),this.pixelWidth=i,this.pixelHeight=r,this.emit("resize",this),this._resourceId=Xn("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Dm(this.pixelWidth)&&Dm(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};ug.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Ni=ug;class ff extends Ni{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let n=t.format;n||(e instanceof Float32Array?n="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?n="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?n="rgba16uint":(e instanceof Int8Array,n="bgra8unorm")),super({...t,resource:e,format:n}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}ff.extension=Rt.TextureSource;const Hm=new Oe;class sw{constructor(t,e){this.mapCoord=new Oe,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const n=this.mapCoord;for(let i=0;i<t.length;i+=2){const r=t[i],o=t[i+1];e[i]=r*n.a+o*n.c+n.tx,e[i+1]=r*n.b+o*n.d+n.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const n=t.orig,i=t.trim;i&&(Hm.set(n.width/i.width,0,0,n.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Hm));const r=t.source,o=this.uClampFrame,c=this.clampMargin/r._resolution,f=this.clampOffset/r._resolution;return o[0]=(t.frame.x+c+f)/r.width,o[1]=(t.frame.y+c+f)/r.height,o[2]=(t.frame.x+t.frame.width-c+f)/r.width,o[3]=(t.frame.y+t.frame.height-c+f)/r.height,this.uClampOffset[0]=this.clampOffset/r.pixelWidth,this.uClampOffset[1]=this.clampOffset/r.pixelHeight,this.isSimple=t.frame.width===r.width&&t.frame.height===r.height&&t.rotate===0,!0}}class te extends Bi{constructor({source:t,label:e,frame:n,orig:i,trim:r,defaultAnchor:o,defaultBorders:c,rotate:f,dynamic:y}={}){if(super(),this.uid=Xn("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new oe,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Ni,this.noFrame=!n,n)this.frame.copyFrom(n);else{const{width:x,height:l}=this._source;this.frame.width=x,this.frame.height=l}this.orig=i||this.frame,this.trim=r,this.rotate=f??0,this.defaultAnchor=o,this.defaultBorders=c,this.destroyed=!1,this.dynamic=y||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new sw(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:n,height:i}=this._source,r=e.x/n,o=e.y/i,c=e.width/n,f=e.height/i;let y=this.rotate;if(y){const x=c/2,l=f/2,p=r+x,b=o+l;y=rn.add(y,rn.NW),t.x0=p+x*rn.uX(y),t.y0=b+l*rn.uY(y),y=rn.add(y,2),t.x1=p+x*rn.uX(y),t.y1=b+l*rn.uY(y),y=rn.add(y,2),t.x2=p+x*rn.uX(y),t.y2=b+l*rn.uY(y),y=rn.add(y,2),t.x3=p+x*rn.uX(y),t.y3=b+l*rn.uY(y)}else t.x0=r,t.y0=o,t.x1=r+c,t.y1=o,t.x2=r+c,t.y2=o+f,t.x3=r,t.y3=o+f}destroy(t=!1){this._source&&(this._source.off("resize",this.update,this),t&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return ae(ze,"Texture.baseTexture is now Texture.source"),this._source}}te.EMPTY=new te({label:"EMPTY",source:new Ni({label:"EMPTY"})});te.EMPTY.destroy=ag;te.WHITE=new te({source:new ff({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});te.WHITE.destroy=ag;function iw(s,t,e){const{width:n,height:i}=e.orig,r=e.trim;if(r){const o=r.width,c=r.height;s.minX=r.x-t._x*n,s.maxX=s.minX+o,s.minY=r.y-t._y*i,s.maxY=s.minY+c}else s.minX=-t._x*n,s.maxX=s.minX+n,s.minY=-t._y*i,s.maxY=s.minY+i}const Ym=new Oe;class Fi{constructor(t=1/0,e=1/0,n=-1/0,i=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Ym,this.minX=t,this.minY=e,this.maxX=n,this.maxY=i}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new oe);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Ym,this}set(t,e,n,i){this.minX=t,this.minY=e,this.maxX=n,this.maxY=i}addFrame(t,e,n,i,r){r||(r=this.matrix);const o=r.a,c=r.b,f=r.c,y=r.d,x=r.tx,l=r.ty;let p=this.minX,b=this.minY,_=this.maxX,u=this.maxY,w=o*t+f*e+x,M=c*t+y*e+l;w<p&&(p=w),M<b&&(b=M),w>_&&(_=w),M>u&&(u=M),w=o*n+f*e+x,M=c*n+y*e+l,w<p&&(p=w),M<b&&(b=M),w>_&&(_=w),M>u&&(u=M),w=o*t+f*i+x,M=c*t+y*i+l,w<p&&(p=w),M<b&&(b=M),w>_&&(_=w),M>u&&(u=M),w=o*n+f*i+x,M=c*n+y*i+l,w<p&&(p=w),M<b&&(b=M),w>_&&(_=w),M>u&&(u=M),this.minX=p,this.minY=b,this.maxX=_,this.maxY=u}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,n=this.minY,i=this.maxX,r=this.maxY,{a:o,b:c,c:f,d:y,tx:x,ty:l}=t;let p=o*e+f*n+x,b=c*e+y*n+l;this.minX=p,this.minY=b,this.maxX=p,this.maxY=b,p=o*i+f*n+x,b=c*i+y*n+l,this.minX=p<this.minX?p:this.minX,this.minY=b<this.minY?b:this.minY,this.maxX=p>this.maxX?p:this.maxX,this.maxY=b>this.maxY?b:this.maxY,p=o*e+f*r+x,b=c*e+y*r+l,this.minX=p<this.minX?p:this.minX,this.minY=b<this.minY?b:this.minY,this.maxX=p>this.maxX?p:this.maxX,this.maxY=b>this.maxY?b:this.maxY,p=o*i+f*r+x,b=c*i+y*r+l,this.minX=p<this.minX?p:this.minX,this.minY=b<this.minY?b:this.minY,this.maxX=p>this.maxX?p:this.maxX,this.maxY=b>this.maxY?b:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,n,i){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<n&&(this.minY=n),this.maxY>i&&(this.maxY=i),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Fi(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,n,i){let r=this.minX,o=this.minY,c=this.maxX,f=this.maxY;i||(i=this.matrix);const y=i.a,x=i.b,l=i.c,p=i.d,b=i.tx,_=i.ty;for(let u=e;u<n;u+=2){const w=t[u],M=t[u+1],v=y*w+l*M+b,I=x*w+p*M+_;r=v<r?v:r,o=I<o?I:o,c=v>c?v:c,f=I>f?I:f}this.minX=r,this.minY=o,this.maxX=c,this.maxY=f}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var rw={grad:.9,turn:360,rad:360/(2*Math.PI)},wr=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},gs=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},vi=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},fg=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},Xm=function(s){return{r:vi(s.r,0,255),g:vi(s.g,0,255),b:vi(s.b,0,255),a:vi(s.a)}},ud=function(s){return{r:gs(s.r),g:gs(s.g),b:gs(s.b),a:gs(s.a,3)}},ow=/^#([0-9a-f]{3,8})$/i,lh=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},pg=function(s){var t=s.r,e=s.g,n=s.b,i=s.a,r=Math.max(t,e,n),o=r-Math.min(t,e,n),c=o?r===t?(e-n)/o:r===e?2+(n-t)/o:4+(t-e)/o:0;return{h:60*(c<0?c+6:c),s:r?o/r*100:0,v:r/255*100,a:i}},mg=function(s){var t=s.h,e=s.s,n=s.v,i=s.a;t=t/360*6,e/=100,n/=100;var r=Math.floor(t),o=n*(1-e),c=n*(1-(t-r)*e),f=n*(1-(1-t+r)*e),y=r%6;return{r:255*[n,c,o,o,f,n][y],g:255*[f,n,n,c,o,o][y],b:255*[o,o,f,n,n,c][y],a:i}},Vm=function(s){return{h:fg(s.h),s:vi(s.s,0,100),l:vi(s.l,0,100),a:vi(s.a)}},zm=function(s){return{h:gs(s.h),s:gs(s.s),l:gs(s.l),a:gs(s.a,3)}},Km=function(s){return mg((e=(t=s).s,{h:t.h,s:(e*=((n=t.l)<50?n:100-n)/100)>0?2*e/(n+e)*100:0,v:n+e,a:t.a}));var t,e,n},Il=function(s){return{h:(t=pg(s)).h,s:(i=(200-(e=t.s))*(n=t.v)/100)>0&&i<200?e*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,e,n,i},aw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,lw=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,cw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,hw=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Kd={string:[[function(s){var t=ow.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?gs(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?gs(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=cw.exec(s)||hw.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:Xm({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=aw.exec(s)||lw.exec(s);if(!t)return null;var e,n,i=Vm({h:(e=t[1],n=t[2],n===void 0&&(n="deg"),Number(e)*(rw[n]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Km(i)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,n=s.b,i=s.a,r=i===void 0?1:i;return wr(t)&&wr(e)&&wr(n)?Xm({r:Number(t),g:Number(e),b:Number(n),a:Number(r)}):null},"rgb"],[function(s){var t=s.h,e=s.s,n=s.l,i=s.a,r=i===void 0?1:i;if(!wr(t)||!wr(e)||!wr(n))return null;var o=Vm({h:Number(t),s:Number(e),l:Number(n),a:Number(r)});return Km(o)},"hsl"],[function(s){var t=s.h,e=s.s,n=s.v,i=s.a,r=i===void 0?1:i;if(!wr(t)||!wr(e)||!wr(n))return null;var o=function(c){return{h:fg(c.h),s:vi(c.s,0,100),v:vi(c.v,0,100),a:vi(c.a)}}({h:Number(t),s:Number(e),v:Number(n),a:Number(r)});return mg(o)},"hsv"]]},$m=function(s,t){for(var e=0;e<t.length;e++){var n=t[e][0](s);if(n)return[n,t[e][1]]}return[null,void 0]},uw=function(s){return typeof s=="string"?$m(s.trim(),Kd.string):typeof s=="object"&&s!==null?$m(s,Kd.object):[null,void 0]},dd=function(s,t){var e=Il(s);return{h:e.h,s:vi(e.s+100*t,0,100),l:e.l,a:e.a}},fd=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},jm=function(s,t){var e=Il(s);return{h:e.h,s:e.s,l:vi(e.l+100*t,0,100),a:e.a}},$d=function(){function s(t){this.parsed=uw(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return gs(fd(this.rgba),2)},s.prototype.isDark=function(){return fd(this.rgba)<.5},s.prototype.isLight=function(){return fd(this.rgba)>=.5},s.prototype.toHex=function(){return t=ud(this.rgba),e=t.r,n=t.g,i=t.b,o=(r=t.a)<1?lh(gs(255*r)):"","#"+lh(e)+lh(n)+lh(i)+o;var t,e,n,i,r,o},s.prototype.toRgb=function(){return ud(this.rgba)},s.prototype.toRgbString=function(){return t=ud(this.rgba),e=t.r,n=t.g,i=t.b,(r=t.a)<1?"rgba("+e+", "+n+", "+i+", "+r+")":"rgb("+e+", "+n+", "+i+")";var t,e,n,i,r},s.prototype.toHsl=function(){return zm(Il(this.rgba))},s.prototype.toHslString=function(){return t=zm(Il(this.rgba)),e=t.h,n=t.s,i=t.l,(r=t.a)<1?"hsla("+e+", "+n+"%, "+i+"%, "+r+")":"hsl("+e+", "+n+"%, "+i+"%)";var t,e,n,i,r},s.prototype.toHsv=function(){return t=pg(this.rgba),{h:gs(t.h),s:gs(t.s),v:gs(t.v),a:gs(t.a,3)};var t},s.prototype.invert=function(){return tr({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),tr(dd(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),tr(dd(this.rgba,-t))},s.prototype.grayscale=function(){return tr(dd(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),tr(jm(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),tr(jm(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?tr({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):gs(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=Il(this.rgba);return typeof t=="number"?tr({h:t,s:e.s,l:e.l,a:e.a}):gs(e.h)},s.prototype.isEqual=function(t){return this.toHex()===tr(t).toHex()},s}(),tr=function(s){return s instanceof $d?s:new $d(s)},qm=[],dw=function(s){s.forEach(function(t){qm.indexOf(t)<0&&(t($d,Kd),qm.push(t))})};function fw(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in e)n[e[i]]=i;var r={};s.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var c,f,y=n[this.toHex()];if(y)return y;if(o!=null&&o.closest){var x=this.toRgb(),l=1/0,p="black";if(!r.length)for(var b in e)r[b]=new s(e[b]).toRgb();for(var _ in e){var u=(c=x,f=r[_],Math.pow(c.r-f.r,2)+Math.pow(c.g-f.g,2)+Math.pow(c.b-f.b,2));u<l&&(l=u,p=_)}return p}},t.string.push([function(o){var c=o.toLowerCase(),f=c==="transparent"?"#0000":e[c];return f?new s(f).toRgb():null},"name"])}dw([fw]);const Aa=class Tl{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Tl)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const n=typeof t;if(n!==typeof e)return!1;if(n==="number"||n==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((r,o)=>r===e[o]);if(t!==null&&e!==null){const r=Object.keys(t),o=Object.keys(e);return r.length!==o.length?!1:r.every(c=>t[c]===e[c])}return t===e}toRgba(){const[t,e,n,i]=this._components;return{r:t,g:e,b:n,a:i}}toRgb(){const[t,e,n]=this._components;return{r:t,g:e,b:n}}toRgbaString(){const[t,e,n]=this.toUint8RgbArray();return`rgba(${t},${e},${n},${this.alpha})`}toUint8RgbArray(t){const[e,n,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(n*255),t[2]=Math.round(i*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,n,i,r]=this._components;return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,n,i]=this._components;return t[0]=e,t[1]=n,t[2]=i,t}toNumber(){return this._int}toBgrNumber(){const[t,e,n]=this.toUint8RgbArray();return(n<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,n,i,r]=Tl._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=n,this._components[2]*=i,this._components[3]*=r,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let n=this._int>>16&255,i=this._int>>8&255,r=this._int&255;return e&&(n=n*t+.5|0,i=i*t+.5|0,r=r*t+.5|0),(t*255<<24)+(n<<16)+(i<<8)+r}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,n,i,r;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,n=(o>>8&255)/255,i=(o&255)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,n,i,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,n,i,r=255]=t,e/=255,n/=255,i/=255,r/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const c=Tl.HEX_PATTERN.exec(t);c&&(t=`#${c[2]}`)}const o=tr(t);o.isValid()&&({r:e,g:n,b:i,a:r}=o.rgba,e/=255,n/=255,i/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=n,this._components[2]=i,this._components[3]=r,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,n]=this._components;this._int=(t*255<<16)+(e*255<<8)+(n*255|0)}_clamp(t,e=0,n=1){return typeof t=="number"?Math.min(Math.max(t,e),n):(t.forEach((i,r)=>{t[r]=Math.min(Math.max(i,e),n)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof Tl||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};Aa.shared=new Aa;Aa._temp=new Aa;Aa.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let ss=Aa;const pw={cullArea:null,cullable:!1,cullableChildren:!0};let pd=0;const Zm=500;function vn(...s){pd!==Zm&&(pd++,pd===Zm?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}const Hl={_registeredResources:new Set,register(s){this._registeredResources.add(s)},unregister(s){this._registeredResources.delete(s)},release(){this._registeredResources.forEach(s=>s.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(s){return this._registeredResources.has(s)},reset(){this._registeredResources.clear()}};class mw{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var n;let e;return this._index>0?e=this._pool[--this._index]:(e=new this._classType,this._count++),(n=e.init)==null||n.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let t=0;t<this._index;t++)this._pool[t].destroy();this._pool.length=0,this._count=0,this._index=0}}class _w{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new mw(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const n=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[n]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}clear(){this._poolsByClass.forEach(t=>t.clear()),this._poolsByClass.clear()}}const Ei=new _w;Hl.register(Ei);const gw={get isCachedAsTexture(){var s;return!!((s=this.renderGroup)!=null&&s.isCachedAsTexture)},cacheAsTexture(s){typeof s=="boolean"&&s===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(s===!0?{}:s))},updateCacheTexture(){var s;(s=this.renderGroup)==null||s.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(s){ae("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(s)}};function yw(s,t,e){const n=s.length;let i;if(t>=n||e===0)return;e=t+e>n?n-t:e;const r=n-e;for(i=t;i<r;++i)s[i]=s[i+e];s.length=r}const xw={allowChildren:!0,removeChildren(s=0,t){var r;const e=t??this.children.length,n=e-s,i=[];if(n>0&&n<=e){for(let c=e-1;c>=s;c--){const f=this.children[c];f&&(i.push(f),f.parent=null)}yw(this.children,s,e);const o=this.renderGroup||this.parentRenderGroup;o&&o.removeChildren(i);for(let c=0;c<i.length;++c){const f=i[c];(r=f.parentRenderLayer)==null||r.detach(f),this.emit("childRemoved",f,this,c),i[c].emit("removed",this)}return i.length>0&&this._didViewChangeTick++,i}else if(n===0&&this.children.length===0)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||ae(ze,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const i=s.parent.children.indexOf(s);if(s.parent===this&&i===t)return s;i!==-1&&s.parent.children.splice(i,1)}t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),n=this.getChildIndex(t);this.children[e]=t,this.children[n]=s;const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)},reparentChild(...s){return s.length===1?this.reparentChildAt(s[0],this.children.length):(s.forEach(t=>this.reparentChildAt(t,this.children.length)),s[0])},reparentChildAt(s,t){if(s.parent===this)return this.setChildIndex(s,t),s;const e=s.worldTransform.clone();s.removeFromParent(),this.addChildAt(s,t);const n=this.worldTransform.clone();return n.invert(),e.prepend(n),s.setFromMatrix(e),s},replaceChild(s,t){s.updateLocalTransform(),this.addChildAt(t,this.getChildIndex(s)),t.setFromMatrix(s.localTransform),t.updateLocalTransform(),this.removeChild(s)}},bw={collectRenderables(s,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(s,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,s):this.collectRenderablesWithEffects(s,t,e))},collectRenderablesSimple(s,t,e){const n=this.children,i=n.length;for(let r=0;r<i;r++)n[r].collectRenderables(s,t,e)},collectRenderablesWithEffects(s,t,e){const{renderPipes:n}=t;for(let i=0;i<this.effects.length;i++){const r=this.effects[i];n[r.pipe].push(r,this,s)}this.collectRenderablesSimple(s,t,e);for(let i=this.effects.length-1;i>=0;i--){const r=this.effects[i];n[r.pipe].pop(r,this,s)}}};class Qm{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Aw{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const n=this._tests[e];if(n.test(t))return Ei.get(n.maskClass,t)}return t}returnMaskEffect(t){Ei.return(t)}}const jd=new Aw;Es.handleByList(Rt.MaskEffect,jd._effectClasses);const Sw={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)},addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,n)=>e.priority-n.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(s){const t=this._maskEffect;(t==null?void 0:t.mask)!==s&&(t&&(this.removeEffect(t),jd.returnMaskEffect(t),this._maskEffect=null),s!=null&&(this._maskEffect=jd.getMaskEffect(s),this.addEffect(this._maskEffect)))},get mask(){var s;return(s=this._maskEffect)==null?void 0:s.mask},setMask(s){this._maskOptions={...this._maskOptions,...s},s.mask&&(this.mask=s.mask),this._markStructureAsChanged()},set filters(s){var r;!Array.isArray(s)&&s&&(s=[s]);const t=this._filterEffect||(this._filterEffect=new Qm);s=s;const e=(s==null?void 0:s.length)>0,n=((r=t.filters)==null?void 0:r.length)>0,i=e!==n;s=Array.isArray(s)?s.slice(0):s,t.filters=Object.freeze(s),i&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=s??null))},get filters(){var s;return(s=this._filterEffect)==null?void 0:s.filters},set filterArea(s){this._filterEffect||(this._filterEffect=new Qm),this._filterEffect.filterArea=s},get filterArea(){var s;return(s=this._filterEffect)==null?void 0:s.filterArea}},ww={label:null,get name(){return ae(ze,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){ae(ze,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let n=0;n<e.length;n++){const i=e[n];if(i.label===s||s instanceof RegExp&&s.test(i.label))return i}if(t)for(let n=0;n<e.length;n++){const r=e[n].getChildByLabel(s,!0);if(r)return r}return null},getChildrenByLabel(s,t=!1,e=[]){const n=this.children;for(let i=0;i<n.length;i++){const r=n[i];(r.label===s||s instanceof RegExp&&s.test(r.label))&&e.push(r)}if(t)for(let i=0;i<n.length;i++)n[i].getChildrenByLabel(s,!0,e);return e}},Ys=Ei.getPool(Oe),vr=Ei.getPool(Fi),Mw=new Oe,Tw={getFastGlobalBounds(s,t){t||(t=new Fi),t.clear(),this._getGlobalBoundsRecursive(!!s,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(s,t,e){let n=t;if(s&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const i=!!this.effects.length;if((this.renderGroup||i)&&(n=vr.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;n.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const r=this.children;for(let o=0;o<r.length;o++)r[o]._getGlobalBoundsRecursive(s,n,e)}if(i){let r=!1;const o=this.renderGroup||this.parentRenderGroup;for(let c=0;c<this.effects.length;c++)this.effects[c].addBounds&&(r||(r=!0,n.applyMatrix(o.worldTransform)),this.effects[c].addBounds(n,!0));r&&n.applyMatrix(o.worldTransform.copyTo(Mw).invert()),t.addBounds(n),vr.return(n)}else this.renderGroup&&(t.addBounds(n,this.relativeGroupTransform),vr.return(n))}};function _g(s,t,e){e.clear();let n,i;return s.parent?t?n=s.parent.worldTransform:(i=Ys.get().identity(),n=pf(s,i)):n=Oe.IDENTITY,gg(s,e,n,t),i&&Ys.return(i),e.isValid||e.set(0,0,0,0),e}function gg(s,t,e,n){var c,f;if(!s.visible||!s.measurable)return;let i;n?i=s.worldTransform:(s.updateLocalTransform(),i=Ys.get(),i.appendFrom(s.localTransform,e));const r=t,o=!!s.effects.length;if(o&&(t=vr.get().clear()),s.boundsArea)t.addRect(s.boundsArea,i);else{const y=s.bounds;y&&!y.isEmpty()&&(t.matrix=i,t.addBounds(y));for(let x=0;x<s.children.length;x++)gg(s.children[x],t,i,n)}if(o){for(let y=0;y<s.effects.length;y++)(f=(c=s.effects[y]).addBounds)==null||f.call(c,t);r.addBounds(t,Oe.IDENTITY),vr.return(t)}n||Ys.return(i)}function pf(s,t){const e=s.parent;return e&&(pf(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function yg(s,t){if(s===16777215||!t)return t;if(t===16777215||!s)return s;const e=s>>16&255,n=s>>8&255,i=s&255,r=t>>16&255,o=t>>8&255,c=t&255,f=e*r/255|0,y=n*o/255|0,x=i*c/255|0;return(f<<16)+(y<<8)+x}const Jm=16777215;function t_(s,t){return s===Jm?t:t===Jm?s:yg(s,t)}function Ah(s){return((s&255)<<16)+(s&65280)+(s>>16&255)}const vw={getGlobalAlpha(s){if(s)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(s=new Oe,t){if(t)return s.copyFrom(this.worldTransform);this.updateLocalTransform();const e=pf(this,Ys.get().identity());return s.appendFrom(this.localTransform,e),Ys.return(e),s},getGlobalTint(s){if(s)return this.renderGroup?Ah(this.renderGroup.worldColor):this.parentRenderGroup?Ah(t_(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=t_(t,e.localColor),e=e.parent;return Ah(t)}};function xg(s,t,e){return t.clear(),e||(e=Oe.IDENTITY),bg(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function bg(s,t,e,n,i){var f,y;let r;if(i)r=Ys.get(),r=e.copyTo(r);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const x=s.localTransform;r=Ys.get(),r.appendFrom(x,e)}const o=t,c=!!s.effects.length;if(c&&(t=vr.get().clear()),s.boundsArea)t.addRect(s.boundsArea,r);else{s.renderPipeId&&(t.matrix=r,t.addBounds(s.bounds));const x=s.children;for(let l=0;l<x.length;l++)bg(x[l],t,r,n,!1)}if(c){for(let x=0;x<s.effects.length;x++)(y=(f=s.effects[x]).addLocalBounds)==null||y.call(f,t,n);o.addBounds(t,Oe.IDENTITY),vr.return(t)}Ys.return(r)}function Ag(s,t){const e=s.children;for(let n=0;n<e.length;n++){const i=e[n],r=i.uid,o=(i._didViewChangeTick&65535)<<16|i._didContainerChangeTick&65535,c=t.index;(t.data[c]!==r||t.data[c+1]!==o)&&(t.data[t.index]=r,t.data[t.index+1]=o,t.didChange=!0),t.index=c+2,i.children.length&&Ag(i,t)}return t.didChange}const Ew=new Oe,Cw={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Fi});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didViewChangeTick&&(s.didChange=!0,s.data[0]=this._didViewChangeTick),Ag(this,s),s.didChange&&xg(this,s.localBounds,Ew),s.localBounds},getBounds(s,t){return _g(this,s,t||new Fi)}},Iw={_onRender:null,set onRender(s){const t=this.renderGroup||this.parentRenderGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},Pw={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Ow))}};function Ow(s,t){return s._zIndex-t._zIndex}const Lw={getGlobalPosition(s=new Fs,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){const n=this.getGlobalTransform(Ys.get(),e);return t=n.apply(s,t),Ys.return(n),t},toLocal(s,t,e,n){t&&(s=t.toGlobal(s,e,n));const i=this.getGlobalTransform(Ys.get(),n);return e=i.applyInverse(s,e),Ys.return(i),e}};class Sg{constructor(){this.uid=Xn("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let kw=0;class Rw{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new ba(this.textureOptions)}createTexture(t,e,n){const i=new Ni({...this.textureOptions,width:t,height:e,resolution:1,antialias:n,autoGarbageCollect:!1});return new te({source:i,label:`texturePool_${kw++}`})}getOptimalTexture(t,e,n=1,i){let r=Math.ceil(t*n-1e-6),o=Math.ceil(e*n-1e-6);r=xa(r),o=xa(o);const c=(r<<17)+(o<<1)+(i?1:0);this._texturePool[c]||(this._texturePool[c]=[]);let f=this._texturePool[c].pop();return f||(f=this.createTexture(r,o,i)),f.source._resolution=n,f.source.width=r/n,f.source.height=o/n,f.source.pixelWidth=r,f.source.pixelHeight=o,f.frame.x=0,f.frame.y=0,f.frame.width=t,f.frame.height=e,f.updateUvs(),this._poolKeyHash[f.uid]=c,f}getSameSizeTexture(t,e=!1){const n=t.source;return this.getOptimalTexture(t.width,t.height,n._resolution,e)}returnTexture(t,e=!1){const n=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[n].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const n=this._texturePool[e];if(n)for(let i=0;i<n.length;i++)n[i].destroy(!0)}this._texturePool={}}}const Sa=new Rw;Hl.register(Sa);class Fw{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new Oe,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Sg,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let n=0;n<e.length;n++){const i=e[n];i._updateFlags=15,this.addChild(i)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Sa.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const t=this._parentCacheAsTextureRenderGroup;t&&!t.textureNeedsUpdate&&t.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let n=0;n<e.length;n++)this.addChild(e[n])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let n=0;n<e.length;n++)this.removeChild(e[n])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let n=0;n<e.length;n++)this._getChildren(e[n],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const n=t.children;for(let i=0;i<n.length;i++)this._getChildren(n[i],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return this._matrixDirty&1?(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new Oe),this._inverseWorldTransform.copyFrom(this.worldTransform).invert()):this._inverseWorldTransform}get textureOffsetInverseTransform(){return this._matrixDirty&2?(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new Oe),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y)):this._textureOffsetInverseTransform}get inverseParentTextureTransform(){if(!(this._matrixDirty&4))return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new Oe),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Bw(s,t,e={}){for(const n in t)!e[n]&&t[n]!==void 0&&(s[n]=t[n])}const md=new vs(null),ch=new vs(null),_d=new vs(null,1,1),hh=new vs(null),e_=1,Nw=2,gd=4;class st extends Bi{constructor(t={}){var e,n;super(),this.uid=Xn("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new Oe,this.relativeGroupTransform=new Oe,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new vs(this,0,0),this._scale=_d,this._pivot=ch,this._origin=hh,this._skew=md,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Bw(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(i=>this.addChild(i)),(n=t.parent)==null||n.addChild(this)}static mixin(t){ae("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Es.mixin(st,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||ae(ze,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let i=0;i<t.length;i++)this.addChild(t[i]);return t[0]}const e=t[0],n=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),n&&(n.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,n&&n.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let i=0;i<t.length;i++)this.removeChild(t[i]);return t[0]}const e=t[0],n=this.children.indexOf(e);return n>-1&&(this._didViewChangeTick++,this.children.splice(n,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,n),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=Ei.get(Fw,this),this.groupTransform=Oe.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),Ei.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new Oe),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*qS}set angle(t){this.rotation=t*ZS}get pivot(){return this._pivot===ch&&(this._pivot=new vs(this,0,0)),this._pivot}set pivot(t){this._pivot===ch&&(this._pivot=new vs(this,0,0),this._origin!==hh&&vn("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===md&&(this._skew=new vs(this,0,0)),this._skew}set skew(t){this._skew===md&&(this._skew=new vs(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===_d&&(this._scale=new vs(this,1,1)),this._scale}set scale(t){this._scale===_d&&(this._scale=new vs(this,0,0)),typeof t=="string"&&(t=parseFloat(t)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get origin(){return this._origin===hh&&(this._origin=new vs(this,0,0)),this._origin}set origin(t){this._origin===hh&&(this._origin=new vs(this,0,0),this._pivot!==ch&&vn("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._origin.set(t):this._origin.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const n=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,n.width),e!==void 0&&this._setHeight(e,n.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this.origin.set(typeof t.originX=="number"?t.originX:this.origin.x,typeof t.originY=="number"?t.originY:this.origin.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,n=this._scale,i=this._pivot,r=this._origin,o=this._position,c=n._x,f=n._y,y=i._x,x=i._y,l=-r._x,p=-r._y;e.a=this._cx*c,e.b=this._sx*c,e.c=this._cy*f,e.d=this._sy*f,e.tx=o._x-(y*e.a+x*e.c)+(l*e.a+p*e.c)-l,e.ty=o._y-(y*e.b+x*e.d)+(l*e.b+p*e.d)-p}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=e_,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const n=ss.shared.setValue(t??16777215).toBgrNumber();n!==this.localColor&&(this.localColor=n,this._updateFlags|=e_,this._onUpdate())}get tint(){return Ah(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Nw,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=gd,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=gd,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=gd,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var i;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let r=0;r<e.length;++r)e[r].destroy(t);(i=this.renderGroup)==null||i.destroy(),this.renderGroup=null}}Es.mixin(st,xw,Tw,Lw,Iw,Cw,Sw,ww,Pw,pw,gw,vw,bw);class mf extends st{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new Fi(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:n,y:i}=t;return n>=e.minX&&n<=e.maxX&&i>=e.minY&&i<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){var e,n;super.destroy(t),this._bounds=null;for(const i in this._gpuData)(n=(e=this._gpuData[i]).destroy)==null||n.call(e);this._gpuData=null}collectRenderablesSimple(t,e,n){const{renderPipes:i}=e;i.blendMode.pushBlendMode(this,this.groupBlendMode,t),i[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const o=this.children,c=o.length;for(let f=0;f<c;f++)o[f].collectRenderables(t,e,n);i.blendMode.popBlendMode(t)}}class Se extends mf{constructor(t=te.EMPTY){t instanceof te&&(t={texture:t});const{texture:e=te.EMPTY,anchor:n,roundPixels:i,width:r,height:o,...c}=t;super({label:"Sprite",...c}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new vs({_onUpdate:()=>{this.onViewUpdate()}}),n?this.anchor=n:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=i??!1,r!==void 0&&(this.width=r),o!==void 0&&(this.height=o)}static from(t,e=!1){return t instanceof te?new Se(t):new Se(te.from(t,e))}set texture(t){t||(t=te.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return iw(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return ae("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,n=this._bounds,{width:i,height:r}=e.orig;n.minX=-t._x*i,n.maxX=n.minX+i,n.minY=-t._y*r,n.maxY=n.minY+r}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(n)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const Uw=new Fi;function wg(s,t,e){const n=Uw;s.measurable=!0,_g(s,e,n),t.addBoundsMask(n),s.measurable=!1}function Mg(s,t,e){const n=vr.get();s.measurable=!0;const i=Ys.get().identity(),r=Tg(s,e,i);xg(s,n,r),s.measurable=!1,t.addBoundsMask(n),Ys.return(i),vr.return(n)}function Tg(s,t,e){return s?(s!==t&&(Tg(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):(vn("Mask bounds, renderable is not inside the root container"),e)}class vg{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Se),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(t,e){this.inverse||wg(this.mask,t,e)}addLocalBounds(t,e){Mg(this.mask,t,e)}containsPoint(t,e){const n=this.mask;return e(n,t)}destroy(){this.reset()}static test(t){return t instanceof Se}}vg.extension=Rt.MaskEffect;class Eg{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}Eg.extension=Rt.MaskEffect;class Cg{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(t,e){wg(this.mask,t,e)}addLocalBounds(t,e){Mg(this.mask,t,e)}containsPoint(t,e){const n=this.mask;return e(n,t)}destroy(){this.reset()}static test(t){return t instanceof st}}Cg.extension=Rt.MaskEffect;const Ww={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let n_=Ww;const pn={get(){return n_},set(s){n_=s}};class Ig extends Ni{constructor(t){t.resource||(t.resource=pn.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,n=this._resolution){const i=super.resize(t,e,n);return i&&this.resizeCanvas(),i}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Ig.extension=Rt.TextureSource;class Po extends Ni{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}Po.extension=Rt.TextureSource;var vh=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(vh||{});class yd{constructor(t,e=null,n=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=n,this._once=i}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Pg=class ui{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new yd(null,null,1/0),this.deltaMS=1/ui.targetFPMS,this.elapsedMS=1/ui.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,n=vh.NORMAL){return this._addListener(new yd(t,e,n))}addOnce(t,e,n=vh.NORMAL){return this._addListener(new yd(t,e,n,!0))}_addListener(t){let e=this._head.next,n=this._head;if(!e)t.connect(n);else{for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}return this._startIfPossible(),this}remove(t,e){let n=this._head.next;for(;n;)n.match(t,e)?n=n.destroy():n=n.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const r=t-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=t-r%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ui.targetFPMS;const n=this._head;let i=n.next;for(;i;)i=i.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,ui.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!ui._shared){const t=ui._shared=new ui;t.autoStart=!0,t._protected=!0}return ui._shared}static get system(){if(!ui._system){const t=ui._system=new ui;t.autoStart=!0,t._protected=!0}return ui._system}};Pg.targetFPMS=.06;let to=Pg,xd;async function Og(){return xd??(xd=(async()=>{var o;const t=pn.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(c=>{const f=document.createElement("video");f.onloadeddata=()=>c(f),f.onerror=()=>c(null),f.autoplay=!1,f.crossOrigin="anonymous",f.preload="auto",f.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",f.load()});if(!e)return"premultiply-alpha-on-upload";const n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const r=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,r),t.deleteFramebuffer(i),t.deleteTexture(n),(o=t.getExtension("WEBGL_lose_context"))==null||o.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),xd}const kh=class Lg extends Ni{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Lg.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=to.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await Og(),this._load=new Promise((n,i)=>{this.isValid?n(this):(this._resolve=n,this._reject=i,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(to.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(to.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(to.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};kh.extension=Rt.TextureSource;kh.defaultOptions={...Ni.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};kh.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Pl=kh;const Ri=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(n=>typeof n=="string"||e?t(n):n):s);class Dw{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||vn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=Ri(t);let i;for(let f=0;f<this.parsers.length;f++){const y=this.parsers[f];if(y.test(e)){i=y.getCacheableAssets(n,e);break}}const r=new Map(Object.entries(i||{}));i||n.forEach(f=>{r.set(f,e)});const o=[...r.keys()],c={cacheKeys:o,keys:n};n.forEach(f=>{this._cacheMap.set(f,c)}),o.forEach(f=>{const y=i?i[f]:e;this._cache.has(f)&&this._cache.get(f)!==y&&vn("[Cache] already has key:",f),this._cache.set(f,r.get(f))})}remove(t){if(!this._cacheMap.has(t)){vn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const Tn=new Dw,qd=[];Es.handleByList(Rt.TextureSource,qd);function kg(s={}){const t=s&&s.resource,e=t?s.resource:s,n=t?s:{resource:s};for(let i=0;i<qd.length;i++){const r=qd[i];if(r.test(e))return new r(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}function Gw(s={},t=!1){const e=s&&s.resource,n=e?s.resource:s,i=e?s:{resource:s};if(!t&&Tn.has(n))return Tn.get(n);const r=new te({source:kg(i)});return r.on("destroy",()=>{Tn.has(n)&&Tn.remove(n)}),t||Tn.set(n,r),r}function Hw(s,t=!1){return typeof s=="string"?Tn.get(s):s instanceof Ni?new te({source:s}):Gw(s,t)}te.from=Hw;Ni.from=kg;Es.add(vg,Eg,Cg,Pl,Po,Ig,ff);var so=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(so||{});function Oi(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function ml(s){return s.split("?")[0].split("#")[0]}function Yw(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Xw(s,t,e){return s.replace(new RegExp(Yw(t),"g"),e)}function Vw(s,t){let e="",n=0,i=-1,r=0,o=-1;for(let c=0;c<=s.length;++c){if(c<s.length)o=s.charCodeAt(c);else{if(o===47)break;o=47}if(o===47){if(!(i===c-1||r===1))if(i!==c-1&&r===2){if(e.length<2||n!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const f=e.lastIndexOf("/");if(f!==e.length-1){f===-1?(e="",n=0):(e=e.slice(0,f),n=e.length-1-e.lastIndexOf("/")),i=c,r=0;continue}}else if(e.length===2||e.length===1){e="",n=0,i=c,r=0;continue}}}else e.length>0?e+=`/${s.slice(i+1,c)}`:e=s.slice(i+1,c),n=c-i-1;i=c,r=0}else o===46&&r!==-1?++r:r=-1}return e}const di={toPosix(s){return Xw(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){Oi(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(Oi(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const n=ml(this.toPosix(t??pn.get().getBaseUrl())),i=ml(this.toPosix(e??this.rootname(n)));return s=this.toPosix(s),s.startsWith("/")?di.join(i,s.slice(1)):this.isAbsolute(s)?s:this.join(n,s)},normalize(s){if(Oi(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const n=s.endsWith("/");return s=Vw(s),s.length>0&&n&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Oi(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const n=s[e];if(Oi(n),n.length>0)if(t===void 0)t=n;else{const i=s[e-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?t+=`/../${n}`:t+=`/${n}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Oi(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let n=-1,i=!0;const r=this.getProtocol(s),o=s;s=s.slice(r.length);for(let c=s.length-1;c>=1;--c)if(t=s.charCodeAt(c),t===47){if(!i){n=c;break}}else i=!1;return n===-1?e?"/":this.isUrl(o)?r+s:r:e&&n===1?"//":r+s.slice(0,n)},rootname(s){Oi(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Oi(s),t&&Oi(t),s=ml(this.toPosix(s));let e=0,n=-1,i=!0,r;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,c=-1;for(r=s.length-1;r>=0;--r){const f=s.charCodeAt(r);if(f===47){if(!i){e=r+1;break}}else c===-1&&(i=!1,c=r+1),o>=0&&(f===t.charCodeAt(o)?--o===-1&&(n=r):(o=-1,n=c))}return e===n?n=c:n===-1&&(n=s.length),s.slice(e,n)}for(r=s.length-1;r>=0;--r)if(s.charCodeAt(r)===47){if(!i){e=r+1;break}}else n===-1&&(i=!1,n=r+1);return n===-1?"":s.slice(e,n)},extname(s){Oi(s),s=ml(this.toPosix(s));let t=-1,e=0,n=-1,i=!0,r=0;for(let o=s.length-1;o>=0;--o){const c=s.charCodeAt(o);if(c===47){if(!i){e=o+1;break}continue}n===-1&&(i=!1,n=o+1),c===46?t===-1?t=o:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||n===-1||r===0||r===1&&t===n-1&&t===e+1?"":s.slice(t,n)},parse(s){Oi(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=ml(this.toPosix(s));let e=s.charCodeAt(0);const n=this.isAbsolute(s);let i;t.root=this.rootname(s),n||this.hasProtocol(s)?i=1:i=0;let r=-1,o=0,c=-1,f=!0,y=s.length-1,x=0;for(;y>=i;--y){if(e=s.charCodeAt(y),e===47){if(!f){o=y+1;break}continue}c===-1&&(f=!1,c=y+1),e===46?r===-1?r=y:x!==1&&(x=1):r!==-1&&(x=-1)}return r===-1||c===-1||x===0||x===1&&r===c-1&&r===o+1?c!==-1&&(o===0&&n?t.base=t.name=s.slice(1,c):t.base=t.name=s.slice(o,c)):(o===0&&n?(t.name=s.slice(1,r),t.base=s.slice(1,c)):(t.name=s.slice(o,r),t.base=s.slice(o,c)),t.ext=s.slice(r,c)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function Rg(s,t,e,n,i){const r=t[e];for(let o=0;o<r.length;o++){const c=r[o];e<t.length-1?Rg(s.replace(n[e],c),t,e+1,n,i):i.push(s.replace(n[e],c))}}function zw(s){const t=/\{(.*?)\}/g,e=s.match(t),n=[];if(e){const i=[];e.forEach(r=>{const o=r.substring(1,r.length-1).split(",");i.push(o)}),Rg(s,i,0,e,n)}else n.push(s);return n}const Eh=s=>!Array.isArray(s);class Ma{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&")}}getAlias(t){const{alias:e,src:n}=t;return Ri(e||n,r=>typeof r=="string"?r:Array.isArray(r)?r.map(o=>(o==null?void 0:o.src)??o):r!=null&&r.src?r.src:r,!0)}addManifest(t){this._manifest&&vn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const n=[];let i=e;Array.isArray(e)||(i=Object.entries(e).map(([r,o])=>typeof o=="string"||Array.isArray(o)?{alias:r,src:o}:{alias:r,...o})),i.forEach(r=>{const o=r.src,c=r.alias;let f;if(typeof c=="string"){const y=this._createBundleAssetId(t,c);n.push(y),f=[c,y]}else{const y=c.map(x=>this._createBundleAssetId(t,x));n.push(...y),f=[...c,...y]}this.add({...r,alias:f,src:o})}),this._bundles[t]=n}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let n;n=r=>{this.hasKey(r)&&vn(`[Resolver] already has key: ${r} overwriting`)},Ri(e).forEach(r=>{const{src:o}=r;let{data:c,format:f,loadParser:y,parser:x}=r;const l=Ri(o).map(u=>typeof u=="string"?zw(u):Array.isArray(u)?u:[u]),p=this.getAlias(r);Array.isArray(p)?p.forEach(n):n(p);const b=[],_=u=>{const w=this._parsers.find(M=>M.test(u));return{...w==null?void 0:w.parse(u),src:u}};l.forEach(u=>{u.forEach(w=>{let M={};if(typeof w!="object"?M=_(w):(c=w.data??c,f=w.format??f,(w.loadParser||w.parser)&&(y=w.loadParser??y,x=w.parser??x),M={..._(w.src),...w}),!p)throw new Error(`[Resolver] alias is undefined for this asset: ${M.src}`);M=this._buildResolvedAsset(M,{aliases:p,data:c,format:f,loadParser:y,parser:x,progressSize:r.progressSize}),b.push(M)})}),p.forEach(u=>{this._assetMap[u]=b})})}resolveBundle(t){const e=Eh(t);t=Ri(t);const n={};return t.forEach(i=>{const r=this._bundles[i];if(r){const o=this.resolve(r),c={};for(const f in o){const y=o[f];c[this._extractAssetIdFromBundle(i,f)]=y}n[i]=c}}),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const n={};for(const i in e)n[i]=e[i].src;return n}return e.src}resolve(t){const e=Eh(t);t=Ri(t);const n={};return t.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let r=this._assetMap[i];const o=this._getPreferredOrder(r);o==null||o.priority.forEach(c=>{o.params[c].forEach(f=>{const y=r.filter(x=>x[c]?x[c]===f:!1);y.length&&(r=y)})}),this._resolverHash[i]=r[0]}else this._resolverHash[i]=this._buildResolvedAsset({alias:[i],src:i},{});n[i]=this._resolverHash[i]}),e?n[t[0]]:n}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const n=t[e],i=this._preferredOrder.find(r=>r.params.format.includes(n.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:n,data:i,loadParser:r,parser:o,format:c,progressSize:f}=e;return(this._basePath||this._rootPath)&&(t.src=di.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=n??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...i||{},...t.data},t.loadParser=r??t.loadParser,t.parser=o??t.parser,t.format=c??t.format??Kw(t.src),f!==void 0&&(t.progressSize=f),t}}Ma.RETINA_PREFIX=/@([0-9\.]+)x/;function Kw(s){return s.split(".").pop().split("?").shift().split("#").shift()}const Zd=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},Fg=class vl{constructor(t,e){this.linkedSheets=[];let n=t;(t==null?void 0:t.source)instanceof Ni&&(n={texture:t,data:e});const{texture:i,data:r,cachePrefix:o=""}=n;this.cachePrefix=o,this._texture=i instanceof te?i:null,this.textureSource=i.source,this.textures={},this.animations={},this.data=r;const c=parseFloat(r.meta.scale);c?(this.resolution=c,i.source.resolution=this.resolution):this.resolution=i.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=vl.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const n=vl.BATCH_SIZE;for(;e-t<n&&e<this._frameKeys.length;){const i=this._frameKeys[e],r=this._frames[i],o=r.frame;if(o){let c=null,f=null;const y=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,x=new oe(0,0,Math.floor(y.w)/this.resolution,Math.floor(y.h)/this.resolution);r.rotated?c=new oe(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):c=new oe(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(f=new oe(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[i]=new te({source:this.textureSource,frame:c,orig:x,trim:f,rotate:r.rotated?2:0,defaultAnchor:r.anchor,defaultBorders:r.borders,label:i.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let n=0;n<t[e].length;n++){const i=t[e][n];this.animations[e].push(this.textures[i])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*vl.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*vl.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const n in this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Fg.BATCH_SIZE=1e3;let s_=Fg;const $w=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Bg(s,t,e){const n={};if(s.forEach(i=>{n[i]=t}),Object.keys(t.textures).forEach(i=>{n[`${t.cachePrefix}${i}`]=t.textures[i]}),!e){const i=di.dirname(s[0]);t.linkedSheets.forEach((r,o)=>{const c=Bg([`${i}/${t.data.meta.related_multi_packs[o]}`],r,!0);Object.assign(n,c)})}return n}const jw={extension:Rt.Asset,cache:{test:s=>s instanceof s_,getCacheableAssets:(s,t)=>Bg(s,t,!1)},resolver:{extension:{type:Rt.ResolveParser,name:"resolveSpritesheet"},test:s=>{const e=s.split("?")[0].split("."),n=e.pop(),i=e.pop();return n==="json"&&$w.includes(i)},parse:s=>{var e;const t=s.split(".");return{resolution:parseFloat(((e=Ma.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:Rt.LoadParser,priority:so.Normal,name:"spritesheetLoader"},async testParse(s,t){return di.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){var l,p;const{texture:n,imageFilename:i,textureOptions:r,cachePrefix:o}=(t==null?void 0:t.data)??{};let c=di.dirname(t.src);c&&c.lastIndexOf("/")!==c.length-1&&(c+="/");let f;if(n instanceof te)f=n;else{const b=Zd(c+(i??s.meta.image),t.src);f=(await e.load([{src:b,data:r}]))[b]}const y=new s_({texture:f.source,data:s,cachePrefix:o});await y.parse();const x=(l=s==null?void 0:s.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(x)){const b=[];for(const u of x){if(typeof u!="string")continue;let w=c+u;(p=t.data)!=null&&p.ignoreMultiPack||(w=Zd(w,t.src),b.push(e.load({src:w,data:{textureOptions:r,ignoreMultiPack:!0}})))}const _=await Promise.all(b);y.linkedSheets=_,_.forEach(u=>{u.linkedSheets=[y].concat(y.linkedSheets.filter(w=>w!==u))})}return y},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};Es.add(jw);const bd=Object.create(null),i_=Object.create(null);function _f(s,t){let e=i_[s];return e===void 0&&(bd[t]===void 0&&(bd[t]=1),i_[s]=e=bd[t]++),e}let da;function Ng(){return(!da||da!=null&&da.isContextLost())&&(da=pn.get().createCanvas().getContext("webgl",{})),da}let uh;function qw(){if(!uh){uh="mediump";const s=Ng();s&&s.getShaderPrecisionFormat&&(uh=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?"highp":"mediump")}return uh}function Zw(s,t,e){return t?s:e?(s=s.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${s}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${s}
        `}function Qw(s,t,e){const n=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(s.substring(0,9)!=="precision"){let i=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return i==="highp"&&n!=="highp"&&(i="mediump"),`precision ${i} float;
${s}`}else if(n!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}function Jw(s,t){return t?`#version 300 es
${s}`:s}const tM={},eM={};function nM(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const n=e?tM:eM;return n[t]?(n[t]++,t+=`-${n[t]}`):n[t]=1,s.indexOf("#define SHADER_NAME")!==-1?s:`${`#define SHADER_NAME ${t}`}
${s}`}function sM(s,t){return t?s.replace("#version 300 es",""):s}const Ad={stripVersion:sM,ensurePrecision:Qw,addProgramDefines:Zw,setProgramName:nM,insertVersion:Jw},_l=Object.create(null),Ug=class Qd{constructor(t){t={...Qd.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,n={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:qw()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let i=t.fragment,r=t.vertex;Object.keys(Ad).forEach(o=>{const c=n[o];i=Ad[o](i,c,!0),r=Ad[o](r,c,!1)}),this.fragment=i,this.vertex=r,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=_f(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,_l[this._cacheKey]=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return _l[e]||(_l[e]=new Qd(t),_l[e]._cacheKey=e),_l[e]}};Ug.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Rh=Ug;const r_={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function iM(s){return r_[s]??r_.float32}const rM={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function oM({source:s,entryPoint:t}){const e={},n=s.indexOf(`fn ${t}`);if(n!==-1){const i=s.indexOf("->",n);if(i!==-1){const r=s.substring(n,i),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let c;for(;(c=o.exec(r))!==null;){const f=rM[c[3]]??"float32";e[c[2]]={location:parseInt(c[1],10),format:f,stride:iM(f).stride,offset:0,instance:!1,start:0}}}}return e}function Sd(s){var l,p;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,n=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,r=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,c=/(\w+)\s*:\s*([\w\<\>]+)/g,f=/struct\s+(\w+)/,y=(l=s.match(t))==null?void 0:l.map(b=>({group:parseInt(b.match(e)[1],10),binding:parseInt(b.match(n)[1],10),name:b.match(i)[2],isUniform:b.match(i)[1]==="<uniform>",type:b.match(r)[1]}));if(!y)return{groups:[],structs:[]};const x=((p=s.match(o))==null?void 0:p.map(b=>{const _=b.match(f)[1],u=b.match(c).reduce((w,M)=>{const[v,I]=M.split(":");return w[v.trim()]=I.trim(),w},{});return u?{name:_,members:u}:null}).filter(({name:b})=>y.some(_=>_.type===b)))??[];return{groups:y,structs:x}}var El=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(El||{});function aM({groups:s}){const t=[];for(let e=0;e<s.length;e++){const n=s[e];t[n.group]||(t[n.group]=[]),n.isUniform?t[n.group].push({binding:n.binding,visibility:El.VERTEX|El.FRAGMENT,buffer:{type:"uniform"}}):n.type==="sampler"?t[n.group].push({binding:n.binding,visibility:El.FRAGMENT,sampler:{type:"filtering"}}):n.type==="texture_2d"&&t[n.group].push({binding:n.binding,visibility:El.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function lM({groups:s}){const t=[];for(let e=0;e<s.length;e++){const n=s[e];t[n.group]||(t[n.group]={}),t[n.group][n.name]=n.binding}return t}function cM(s,t){const e=new Set,n=new Set,i=[...s.structs,...t.structs].filter(o=>e.has(o.name)?!1:(e.add(o.name),!0)),r=[...s.groups,...t.groups].filter(o=>{const c=`${o.name}-${o.binding}`;return n.has(c)?!1:(n.add(c),!0)});return{structs:i,groups:r}}const gl=Object.create(null);class Ta{constructor(t){var c,f;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:n,layout:i,gpuLayout:r,name:o}=t;if(this.name=o,this.fragment=e,this.vertex=n,e.source===n.source){const y=Sd(e.source);this.structsAndGroups=y}else{const y=Sd(n.source),x=Sd(e.source);this.structsAndGroups=cM(y,x)}this.layout=i??lM(this.structsAndGroups),this.gpuLayout=r??aM(this.structsAndGroups),this.autoAssignGlobalUniforms=((c=this.layout[0])==null?void 0:c.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((f=this.layout[1])==null?void 0:f.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,n=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=_f(n,"program")}get attributeData(){return this._attributeData??(this._attributeData=oM(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,gl[this._cacheKey]=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return gl[e]||(gl[e]=new Ta(t),gl[e]._cacheKey=e),gl[e]}}const Wg=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],hM=Wg.reduce((s,t)=>(s[t]=!0,s),{});function uM(s,t){switch(s){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Dg=class Gg{constructor(t,e){this._touched=0,this.uid=Xn("uniform"),this._resourceType="uniformGroup",this._resourceId=Xn("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...Gg.defaultOptions,...e},this.uniformStructures=t;const n={};for(const i in t){const r=t[i];if(r.name=i,r.size=r.size??1,!hM[r.type]){const o=r.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(o){const[,c,f]=o;throw new Error(`Uniform type ${r.type} is not supported. Use type: '${c}', size: ${f} instead.`)}throw new Error(`Uniform type ${r.type} is not supported. Supported uniform types are: ${Wg.join(", ")}`)}r.value??(r.value=uM(r.type,r.size)),n[i]=r.value}this.uniforms=n,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=_f(Object.keys(n).map(i=>`${i}-${t[i].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Dg.defaultOptions={ubo:!1,isStatic:!1};let Hg=Dg;class Sh{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const n in t){const i=t[n];this.setResource(i,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const n in this.resources)t[e++]=this.resources[n]._resourceId;this._key=t.join("|")}setResource(t,e){var i,r;const n=this.resources[e];t!==n&&(n&&((i=t.off)==null||i.call(t,"change",this.onResourceChange,this)),(r=t.on)==null||r.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const n in e)e[n]._touched=t}destroy(){var e;const t=this.resources;for(const n in t){const i=t[n];(e=i==null?void 0:i.off)==null||e.call(i,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const n in e)e[n]===t&&(e[n]=null)}else this._updateKey()}}var Rl=(s=>(s[s.WEBGL=1]="WEBGL",s[s.WEBGPU=2]="WEBGPU",s[s.BOTH=3]="BOTH",s))(Rl||{});class Fh extends Bi{constructor(t){super(),this.uid=Xn("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:e,glProgram:n,groups:i,resources:r,compatibleRenderers:o,groupMap:c}=t;this.gpuProgram=e,this.glProgram=n,o===void 0&&(o=0,e&&(o|=Rl.WEBGPU),n&&(o|=Rl.WEBGL)),this.compatibleRenderers=o;const f={};if(!r&&!i&&(r={}),r&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&i&&!c)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&i&&c)for(const y in c)for(const x in c[y]){const l=c[y][x];f[l]={group:y,binding:x,name:l}}else if(e&&i&&!c){const y=e.structsAndGroups.groups;c={},y.forEach(x=>{c[x.group]=c[x.group]||{},c[x.group][x.binding]=x.name,f[x.name]=x})}else if(r){i={},c={},e&&e.structsAndGroups.groups.forEach(l=>{c[l.group]=c[l.group]||{},c[l.group][l.binding]=l.name,f[l.name]=l});let y=0;for(const x in r)f[x]||(i[99]||(i[99]=new Sh,this._ownedBindGroups.push(i[99])),f[x]={group:99,binding:y,name:x},c[99]=c[99]||{},c[99][y]=x,y++);for(const x in r){const l=x;let p=r[x];!p.source&&!p._resourceType&&(p=new Hg(p));const b=f[l];b&&(i[b.group]||(i[b.group]=new Sh,this._ownedBindGroups.push(i[b.group])),i[b.group].setResource(p,b.binding))}}this.groups=i,this._uniformBindMap=c,this.resources=this._buildResourceAccessor(i,f)}addResource(t,e,n){var i,r;(i=this._uniformBindMap)[e]||(i[e]={}),(r=this._uniformBindMap[e])[n]||(r[n]=t),this.groups[e]||(this.groups[e]=new Sh,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const n={};for(const i in e){const r=e[i];Object.defineProperty(n,r.name,{get(){return t[r.group].getResource(r.binding)},set(o){t[r.group].setResource(o,r.binding)}})}return n}destroy(t=!1){var e,n;this._destroyed||(this._destroyed=!0,this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(n=this.glProgram)==null||n.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(i=>{i.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(t){const{gpu:e,gl:n,...i}=t;let r,o;return e&&(r=Ta.from(e)),n&&(o=Rh.from(n)),new Fh({gpuProgram:r,glProgram:o,...i})}}const dM={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},wd=0,Md=1,Td=2,vd=3,Ed=4,Cd=5,Jd=class Yg{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<wd)}set blend(t){!!(this.data&1<<wd)!==t&&(this.data^=1<<wd)}get offsets(){return!!(this.data&1<<Md)}set offsets(t){!!(this.data&1<<Md)!==t&&(this.data^=1<<Md)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Td)}set culling(t){!!(this.data&1<<Td)!==t&&(this.data^=1<<Td)}get depthTest(){return!!(this.data&1<<vd)}set depthTest(t){!!(this.data&1<<vd)!==t&&(this.data^=1<<vd)}get depthMask(){return!!(this.data&1<<Cd)}set depthMask(t){!!(this.data&1<<Cd)!==t&&(this.data^=1<<Cd)}get clockwiseFrontFace(){return!!(this.data&1<<Ed)}set clockwiseFrontFace(t){!!(this.data&1<<Ed)!==t&&(this.data^=1<<Ed)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=dM[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Yg;return t.depthTest=!1,t.blend=!0,t}};Jd.default2d=Jd.for2d();let fM=Jd;const Xg=class tf extends Fh{constructor(t){t={...tf.defaultOptions,...t},super(t),this.enabled=!0,this._state=fM.for2d(),this.blendMode=t.blendMode,this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias,this.resolution=t.resolution,this.blendRequired=t.blendRequired,this.clipToViewport=t.clipToViewport,this.addResource("uTexture",0,1),t.blendRequired&&this.addResource("uBackTexture",0,3)}apply(t,e,n,i){t.applyFilter(this,e,n,i)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(t){const{gpu:e,gl:n,...i}=t;let r,o;return e&&(r=Ta.from(e)),n&&(o=Rh.from(n)),new tf({gpuProgram:r,glProgram:o,...i})}};Xg.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let Vg=Xg;const ef=[];Es.handleByNamedList(Rt.Environment,ef);async function pM(s){if(!s)for(let t=0;t<ef.length;t++){const e=ef[t];if(e.value.test()){await e.value.load();return}}}let yl;function mM(){if(typeof yl=="boolean")return yl;try{yl=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{yl=!1}return yl}function o_(s,t,e=2){const n=t&&t.length,i=n?t[0]*e:s.length;let r=zg(s,0,i,e,!0);const o=[];if(!r||r.next===r.prev)return o;let c,f,y;if(n&&(r=bM(s,t,r,e)),s.length>80*e){c=s[0],f=s[1];let x=c,l=f;for(let p=e;p<i;p+=e){const b=s[p],_=s[p+1];b<c&&(c=b),_<f&&(f=_),b>x&&(x=b),_>l&&(l=_)}y=Math.max(x-c,l-f),y=y!==0?32767/y:0}return Fl(r,o,e,c,f,y,0),o}function zg(s,t,e,n,i){let r;if(i===OM(s,t,e,n)>0)for(let o=t;o<e;o+=n)r=a_(o/n|0,s[o],s[o+1],r);else for(let o=e-n;o>=t;o-=n)r=a_(o/n|0,s[o],s[o+1],r);return r&&wa(r,r.next)&&(Nl(r),r=r.next),r}function Oo(s,t){if(!s)return s;t||(t=s);let e=s,n;do if(n=!1,!e.steiner&&(wa(e,e.next)||Un(e.prev,e,e.next)===0)){if(Nl(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function Fl(s,t,e,n,i,r,o){if(!s)return;!o&&r&&TM(s,n,i,r);let c=s;for(;s.prev!==s.next;){const f=s.prev,y=s.next;if(r?gM(s,n,i,r):_M(s)){t.push(f.i,s.i,y.i),Nl(s),s=y.next,c=y.next;continue}if(s=y,s===c){o?o===1?(s=yM(Oo(s),t),Fl(s,t,e,n,i,r,2)):o===2&&xM(s,t,e,n,i,r):Fl(Oo(s),t,e,n,i,r,1);break}}}function _M(s){const t=s.prev,e=s,n=s.next;if(Un(t,e,n)>=0)return!1;const i=t.x,r=e.x,o=n.x,c=t.y,f=e.y,y=n.y,x=Math.min(i,r,o),l=Math.min(c,f,y),p=Math.max(i,r,o),b=Math.max(c,f,y);let _=n.next;for(;_!==t;){if(_.x>=x&&_.x<=p&&_.y>=l&&_.y<=b&&Cl(i,c,r,f,o,y,_.x,_.y)&&Un(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function gM(s,t,e,n){const i=s.prev,r=s,o=s.next;if(Un(i,r,o)>=0)return!1;const c=i.x,f=r.x,y=o.x,x=i.y,l=r.y,p=o.y,b=Math.min(c,f,y),_=Math.min(x,l,p),u=Math.max(c,f,y),w=Math.max(x,l,p),M=nf(b,_,t,e,n),v=nf(u,w,t,e,n);let I=s.prevZ,L=s.nextZ;for(;I&&I.z>=M&&L&&L.z<=v;){if(I.x>=b&&I.x<=u&&I.y>=_&&I.y<=w&&I!==i&&I!==o&&Cl(c,x,f,l,y,p,I.x,I.y)&&Un(I.prev,I,I.next)>=0||(I=I.prevZ,L.x>=b&&L.x<=u&&L.y>=_&&L.y<=w&&L!==i&&L!==o&&Cl(c,x,f,l,y,p,L.x,L.y)&&Un(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;I&&I.z>=M;){if(I.x>=b&&I.x<=u&&I.y>=_&&I.y<=w&&I!==i&&I!==o&&Cl(c,x,f,l,y,p,I.x,I.y)&&Un(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;L&&L.z<=v;){if(L.x>=b&&L.x<=u&&L.y>=_&&L.y<=w&&L!==i&&L!==o&&Cl(c,x,f,l,y,p,L.x,L.y)&&Un(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function yM(s,t){let e=s;do{const n=e.prev,i=e.next.next;!wa(n,i)&&$g(n,e,e.next,i)&&Bl(n,i)&&Bl(i,n)&&(t.push(n.i,e.i,i.i),Nl(e),Nl(e.next),e=s=i),e=e.next}while(e!==s);return Oo(e)}function xM(s,t,e,n,i,r){let o=s;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&CM(o,c)){let f=jg(o,c);o=Oo(o,o.next),f=Oo(f,f.next),Fl(o,t,e,n,i,r,0),Fl(f,t,e,n,i,r,0);return}c=c.next}o=o.next}while(o!==s)}function bM(s,t,e,n){const i=[];for(let r=0,o=t.length;r<o;r++){const c=t[r]*n,f=r<o-1?t[r+1]*n:s.length,y=zg(s,c,f,n,!1);y===y.next&&(y.steiner=!0),i.push(EM(y))}i.sort(AM);for(let r=0;r<i.length;r++)e=SM(i[r],e);return e}function AM(s,t){let e=s.x-t.x;if(e===0&&(e=s.y-t.y,e===0)){const n=(s.next.y-s.y)/(s.next.x-s.x),i=(t.next.y-t.y)/(t.next.x-t.x);e=n-i}return e}function SM(s,t){const e=wM(s,t);if(!e)return t;const n=jg(e,s);return Oo(n,n.next),Oo(e,e.next)}function wM(s,t){let e=t;const n=s.x,i=s.y;let r=-1/0,o;if(wa(s,e))return e;do{if(wa(s,e.next))return e.next;if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){const l=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(l<=n&&l>r&&(r=l,o=e.x<e.next.x?e:e.next,l===n))return o}e=e.next}while(e!==t);if(!o)return null;const c=o,f=o.x,y=o.y;let x=1/0;e=o;do{if(n>=e.x&&e.x>=f&&n!==e.x&&Kg(i<y?n:r,i,f,y,i<y?r:n,i,e.x,e.y)){const l=Math.abs(i-e.y)/(n-e.x);Bl(e,s)&&(l<x||l===x&&(e.x>o.x||e.x===o.x&&MM(o,e)))&&(o=e,x=l)}e=e.next}while(e!==c);return o}function MM(s,t){return Un(s.prev,s,t.prev)<0&&Un(t.next,s,s.next)<0}function TM(s,t,e,n){let i=s;do i.z===0&&(i.z=nf(i.x,i.y,t,e,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,vM(i)}function vM(s){let t,e=1;do{let n=s,i;s=null;let r=null;for(t=0;n;){t++;let o=n,c=0;for(let y=0;y<e&&(c++,o=o.nextZ,!!o);y++);let f=e;for(;c>0||f>0&&o;)c!==0&&(f===0||!o||n.z<=o.z)?(i=n,n=n.nextZ,c--):(i=o,o=o.nextZ,f--),r?r.nextZ=i:s=i,i.prevZ=r,r=i;n=o}r.nextZ=null,e*=2}while(t>1);return s}function nf(s,t,e,n,i){return s=(s-e)*i|0,t=(t-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function EM(s){let t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function Kg(s,t,e,n,i,r,o,c){return(i-o)*(t-c)>=(s-o)*(r-c)&&(s-o)*(n-c)>=(e-o)*(t-c)&&(e-o)*(r-c)>=(i-o)*(n-c)}function Cl(s,t,e,n,i,r,o,c){return!(s===o&&t===c)&&Kg(s,t,e,n,i,r,o,c)}function CM(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!IM(s,t)&&(Bl(s,t)&&Bl(t,s)&&PM(s,t)&&(Un(s.prev,s,t.prev)||Un(s,t.prev,t))||wa(s,t)&&Un(s.prev,s,s.next)>0&&Un(t.prev,t,t.next)>0)}function Un(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function wa(s,t){return s.x===t.x&&s.y===t.y}function $g(s,t,e,n){const i=fh(Un(s,t,e)),r=fh(Un(s,t,n)),o=fh(Un(e,n,s)),c=fh(Un(e,n,t));return!!(i!==r&&o!==c||i===0&&dh(s,e,t)||r===0&&dh(s,n,t)||o===0&&dh(e,s,n)||c===0&&dh(e,t,n))}function dh(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function fh(s){return s>0?1:s<0?-1:0}function IM(s,t){let e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&$g(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function Bl(s,t){return Un(s.prev,s,s.next)<0?Un(s,t,s.next)>=0&&Un(s,s.prev,t)>=0:Un(s,t,s.prev)<0||Un(s,s.next,t)<0}function PM(s,t){let e=s,n=!1;const i=(s.x+t.x)/2,r=(s.y+t.y)/2;do e.y>r!=e.next.y>r&&e.next.y!==e.y&&i<(e.next.x-e.x)*(r-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==s);return n}function jg(s,t){const e=sf(s.i,s.x,s.y),n=sf(t.i,t.x,t.y),i=s.next,r=t.prev;return s.next=t,t.prev=s,e.next=i,i.prev=e,n.next=e,e.prev=n,r.next=n,n.prev=r,n}function a_(s,t,e,n){const i=sf(s,t,e);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Nl(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function sf(s,t,e){return{i:s,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function OM(s,t,e,n){let i=0;for(let r=t,o=e-n;r<e;r+=n)i+=(s[o]-s[r])*(s[r+1]+s[o+1]),o=r;return i}const LM=o_.default||o_;var qg=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(qg||{});class kM{constructor(t){this.items=[],this._name=t}emit(t,e,n,i,r,o,c,f){const{name:y,items:x}=this;for(let l=0,p=x.length;l<p;l++)x[l][y](t,e,n,i,r,o,c,f);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const RM=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Zg=class Qg extends Bi{constructor(t){super(),this.uid=Xn("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...RM,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await pM(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const n in this._systemsHash)t={...this._systemsHash[n].constructor.defaultOptions,...t};t={...Qg.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let n=0;n<this.runners.init.items.length;n++)await this.runners.init.items[n].init(t);this._initOptions=t}render(t,e){let n=t;if(n instanceof st&&(n={container:n},e&&(ae(ze,"passing a second argument is deprecated, please use render options instead"),n.target=e.renderTexture)),n.target||(n.target=this.view.renderTarget),n.target===this.view.renderTarget&&(this._lastObjectRendered=n.container,n.clearColor??(n.clearColor=this.background.colorRgba),n.clear??(n.clear=this.background.clearBeforeRender)),n.clearColor){const i=Array.isArray(n.clearColor)&&n.clearColor.length===4;n.clearColor=i?n.clearColor:ss.shared.setValue(n.clearColor).toArray()}n.transform||(n.container.updateLocalTransform(),n.transform=n.container.localTransform),n.container.visible&&(n.container.enableRenderGroup(),this.runners.prerender.emit(n),this.runners.renderStart.emit(n),this.runners.render.emit(n),this.runners.renderEnd.emit(n),this.runners.postrender.emit(n))}resize(t,e,n){const i=this.view.resolution;this.view.resize(t,e,n),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),n!==void 0&&n!==i&&this.runners.resolutionChange.emit(n)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=qg.ALL);const{clear:n,clearColor:i,target:r}=t;ss.shared.setValue(i??this.background.colorRgba),e.renderTarget.clear(r,n,ss.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new kM(e)})}_addSystems(t){let e;for(e in t){const n=t[e];this._addSystem(n.value,n.name)}}_addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const i in this.runners)this.runners[i].add(n);return this}_addPipes(t,e){const n=e.reduce((i,r)=>(i[r.name]=r.value,i),{});t.forEach(i=>{const r=i.value,o=i.name,c=n[o];this.renderPipes[o]=new r(this,c?new c:null),this.runners.destroy.add(this.renderPipes[o])})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),(t===!0||typeof t=="object"&&t.releaseGlobalResources)&&Hl.release(),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!mM())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Zg.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Jg=Zg,ph;function FM(s){return ph!==void 0||(ph=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:s??Jg.defaultOptions.failIfMajorPerformanceCaveat};try{if(!pn.get().getWebGLRenderingContext())return!1;let i=pn.get().createCanvas().getContext("webgl",t);const r=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const o=i.getExtension("WEBGL_lose_context");o&&o.loseContext()}return i=null,r}catch{return!1}})()),ph}let mh;async function BM(s={}){return mh!==void 0||(mh=await(async()=>{const t=pn.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),mh}const l_=["webgl","webgpu","canvas"];async function NM(s){let t=[];s.preference?(t.push(s.preference),l_.forEach(r=>{r!==s.preference&&t.push(r)})):t=l_.slice();let e,n={};for(let r=0;r<t.length;r++){const o=t[r];if(o==="webgpu"&&await BM()){const{WebGPURenderer:c}=await Th(async()=>{const{WebGPURenderer:f}=await import("./WebGPURenderer-BB_7q_tj.js");return{WebGPURenderer:f}},__vite__mapDeps([3,2,4]));e=c,n={...s,...s.webgpu};break}else if(o==="webgl"&&FM(s.failIfMajorPerformanceCaveat??Jg.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:c}=await Th(async()=>{const{WebGLRenderer:f}=await import("./WebGLRenderer-DD-go-of.js");return{WebGLRenderer:f}},__vite__mapDeps([5,2,4]));e=c,n={...s,...s.webgl};break}else if(o==="canvas")throw n={...s},new Error("CanvasRenderer is not yet implemented")}if(delete n.webgpu,delete n.webgl,!e)throw new Error("No available renderer for the current environment");const i=new e;return await i.init(n),i}const ty="8.14.3";class ey{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,ty)}static destroy(){}}ey.extension=Rt.Application;class UM{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,ty)}destroy(){this._renderer=null}}UM.extension={type:[Rt.WebGLSystem,Rt.WebGPUSystem],name:"initHook",priority:-10};const ny=class rf{constructor(...t){this.stage=new st,t[0]!==void 0&&ae(ze,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.stage||(this.stage=new st),this.renderer=await NM(t),rf._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return ae(ze,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const n=rf._plugins.slice(0);n.reverse(),n.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};ny._plugins=[];let sy=ny;Es.handleByList(Rt.Application,sy._plugins);Es.add(ey);class iy extends Bi{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return ae(ze,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return ae(ze,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return ae(ze,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return ae(ze,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return ae(ze,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const n in this.chars)(e=this.chars[n].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(n=>n.texture.destroy(!0)),this.pages=null)}}/**
 * tiny-lru
 *
 * @copyright 2025 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.4.5
 */class WM{constructor(t=0,e=0,n=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.resetTtl=n,this.size=0,this.ttl=e}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){const e=this.items[t];delete this.items[t],this.size--,e.prev!==null&&(e.prev.next=e.next),e.next!==null&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev)}return this}entries(t=this.keys()){return t.map(e=>[e,this.get(e)])}evict(t=!1){if(t||this.size>0){const e=this.first;delete this.items[e.key],--this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}return this}expiresAt(t){let e;return this.has(t)&&(e=this.items[t].expiry),e}get(t){const e=this.items[t];if(e!==void 0){if(this.ttl>0&&e.expiry<=Date.now()){this.delete(t);return}return this.moveToEnd(e),e.value}}has(t){return t in this.items}moveToEnd(t){this.last!==t&&(t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),t.prev=this.last,t.next=null,this.last!==null&&(this.last.next=t),this.last=t,this.first===null&&(this.first=t))}keys(){const t=[];let e=this.first;for(;e!==null;)t.push(e.key),e=e.next;return t}setWithEvicted(t,e,n=this.resetTtl){let i=null;if(this.has(t))this.set(t,e,!0,n);else{this.max>0&&this.size===this.max&&(i={...this.first},this.evict(!0));let r=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e};++this.size===1?this.first=r:this.last.next=r,this.last=r}return i}set(t,e,n=!1,i=this.resetTtl){let r=this.items[t];return n||r!==void 0?(r.value=e,n===!1&&i&&(r.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(r)):(this.max>0&&this.size===this.max&&this.evict(!0),r=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e},++this.size===1?this.first=r:this.last.next=r,this.last=r),this}values(t=this.keys()){return t.map(e=>this.get(e))}}function ry(s=1e3,t=0,e=!1){if(isNaN(s)||s<0)throw new TypeError("Invalid max value");if(isNaN(t)||t<0)throw new TypeError("Invalid ttl value");if(typeof e!="boolean")throw new TypeError("Invalid resetTtl value");return new WM(s,t,e)}const DM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Ch(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let n=e.length-1;n>=0;n--){let i=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&!DM.includes(i)&&(i=`"${i}"`),e[n]=i}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const Id={willReadFrequently:!0},Ui=class Ot{static get experimentalLetterSpacingSupported(){let t=Ot._experimentalLetterSpacingSupported;if(t===void 0){const e=pn.get().getCanvasRenderingContext2D().prototype;t=Ot._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,n,i,r,o,c,f,y){this.text=t,this.style=e,this.width=n,this.height=i,this.lines=r,this.lineWidths=o,this.lineHeight=c,this.maxLineWidth=f,this.fontProperties=y}static measureText(t=" ",e,n=Ot._canvas,i=e.wordWrap){var v;const r=`${t}-${e.styleKey}-wordWrap-${i}`;if(Ot._measurementCache.has(r))return Ot._measurementCache.get(r);const o=Ch(e),c=Ot.measureFont(o);c.fontSize===0&&(c.fontSize=e.fontSize,c.ascent=e.fontSize);const f=Ot.__context;f.font=o;const x=(i?Ot._wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),l=new Array(x.length);let p=0;for(let I=0;I<x.length;I++){const L=Ot._measureText(x[I],e.letterSpacing,f);l[I]=L,p=Math.max(p,L)}const b=((v=e._stroke)==null?void 0:v.width)||0;let _=p+b;e.dropShadow&&(_+=e.dropShadow.distance);const u=e.lineHeight||c.fontSize;let w=Math.max(u,c.fontSize+b)+(x.length-1)*(u+e.leading);e.dropShadow&&(w+=e.dropShadow.distance);const M=new Ot(t,e,_,w,x,l,u+e.leading,p,c);return Ot._measurementCache.set(r,M),M}static _measureText(t,e,n){let i=!1;Ot.experimentalLetterSpacingSupported&&(Ot.experimentalLetterSpacing?(n.letterSpacing=`${e}px`,n.textLetterSpacing=`${e}px`,i=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));const r=n.measureText(t);let o=r.width;const c=-r.actualBoundingBoxLeft;let y=r.actualBoundingBoxRight-c;if(o>0)if(i)o-=e,y-=e;else{const x=(Ot.graphemeSegmenter(t).length-1)*e;o+=x,y+=x}return Math.max(o,y)}static _wordWrap(t,e,n=Ot._canvas){const i=n.getContext("2d",Id);let r=0,o="",c="";const f=Object.create(null),{letterSpacing:y,whiteSpace:x}=e,l=Ot._collapseSpaces(x),p=Ot._collapseNewlines(x);let b=!l;const _=e.wordWrapWidth+y,u=Ot._tokenize(t);for(let w=0;w<u.length;w++){let M=u[w];if(Ot._isNewline(M)){if(!p){c+=Ot._addLine(o),b=!l,o="",r=0;continue}M=" "}if(l){const I=Ot.isBreakingSpace(M),L=Ot.isBreakingSpace(o[o.length-1]);if(I&&L)continue}const v=Ot._getFromCache(M,y,f,i);if(v>_)if(o!==""&&(c+=Ot._addLine(o),o="",r=0),Ot.canBreakWords(M,e.breakWords)){const I=Ot.wordWrapSplit(M);for(let L=0;L<I.length;L++){let K=I[L],W=K,U=1;for(;I[L+U];){const J=I[L+U];if(!Ot.canBreakChars(W,J,M,L,e.breakWords))K+=J;else break;W=J,U++}L+=U-1;const gt=Ot._getFromCache(K,y,f,i);gt+r>_&&(c+=Ot._addLine(o),b=!1,o="",r=0),o+=K,r+=gt}}else{o.length>0&&(c+=Ot._addLine(o),o="",r=0);const I=w===u.length-1;c+=Ot._addLine(M,!I),b=!1,o="",r=0}else v+r>_&&(b=!1,c+=Ot._addLine(o),o="",r=0),(o.length>0||!Ot.isBreakingSpace(M)||b)&&(o+=M,r+=v)}return c+=Ot._addLine(o,!1),c}static _addLine(t,e=!0){return t=Ot._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,n,i){let r=n[t];return typeof r!="number"&&(r=Ot._measureText(t,e,i)+e,n[t]=r),r}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const n=t[e];if(!Ot.isBreakingSpace(n))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:Ot._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:Ot._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let n="";if(typeof t!="string")return e;for(let i=0;i<t.length;i++){const r=t[i],o=t[i+1];if(Ot.isBreakingSpace(r,o)||Ot._isNewline(r)){n!==""&&(e.push(n),n=""),r==="\r"&&o===`
`?(e.push(`\r
`),i++):e.push(r);continue}n+=r}return n!==""&&e.push(n),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,n,i,r){return!0}static wordWrapSplit(t){return Ot.graphemeSegmenter(t)}static measureFont(t){if(Ot._fonts[t])return Ot._fonts[t];const e=Ot._context;e.font=t;const n=e.measureText(Ot.METRICS_STRING+Ot.BASELINE_SYMBOL),i={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return Ot._fonts[t]=i,i}static clearMetrics(t=""){t?delete Ot._fonts[t]:Ot._fonts={}}static get _canvas(){if(!Ot.__canvas){let t;try{const e=new OffscreenCanvas(0,0),n=e.getContext("2d",Id);if(n!=null&&n.measureText)return Ot.__canvas=e,e;t=pn.get().createCanvas()}catch{t=pn.get().createCanvas()}t.width=t.height=10,Ot.__canvas=t}return Ot.__canvas}static get _context(){return Ot.__context||(Ot.__context=Ot._canvas.getContext("2d",Id)),Ot.__context}};Ui.METRICS_STRING="|ÉqÅ";Ui.BASELINE_SYMBOL="M";Ui.BASELINE_MULTIPLIER=1.4;Ui.HEIGHT_MULTIPLIER=2;Ui.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>{const e=s.segment(t),n=[];let i=0;for(const r of e)n[i++]=r.segment;return n}}return s=>[...s]})();Ui.experimentalLetterSpacing=!1;Ui._fonts={};Ui._newlines=[10,13];Ui._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Ui._measurementCache=ry(1e3);let nr=Ui;const c_=[{offset:0,color:"white"},{offset:1,color:"black"}],gf=class of{constructor(...t){this.uid=Xn("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let e=GM(t);e={...e.type==="radial"?of.defaultRadialOptions:of.defaultLinearOptions,...lg(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(i=>{this.addColorStop(i.offset,i.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:ss.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:n,y:i}=this.end,r=n-t,o=i-e;const c=r<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(r<0){const w=t;t=n,n=w,r*=-1}if(o<0){const w=e;e=i,i=w,o*=-1}}const f=this.colorStops.length?this.colorStops:c_,y=this._textureSize,{canvas:x,context:l}=u_(y,1),p=c?l.createLinearGradient(this._textureSize,0,0,0):l.createLinearGradient(0,0,this._textureSize,0);h_(p,f),l.fillStyle=p,l.fillRect(0,0,y,1),this.texture=new te({source:new Po({resource:x,addressMode:this._wrapMode})});const b=Math.sqrt(r*r+o*o),_=Math.atan2(o,r),u=new Oe;u.scale(b/y,1),u.rotate(_),u.translate(t,e),this.textureSpace==="local"&&u.scale(y,y),this.transform=u}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:c_,e=this._textureSize,{canvas:n,context:i}=u_(e,e),{x:r,y:o}=this.center,{x:c,y:f}=this.outerCenter,y=this.innerRadius,x=this.outerRadius,l=c-x,p=f-x,b=e/(x*2),_=(r-l)*b,u=(o-p)*b,w=i.createRadialGradient(_,u,y*b,(c-l)*b,(f-p)*b,x*b);h_(w,t),i.fillStyle=t[t.length-1].color,i.fillRect(0,0,e,e),i.fillStyle=w,i.translate(_,u),i.rotate(this.rotation),i.scale(1,this.scale),i.translate(-_,-u),i.fillRect(0,0,e,e),this.texture=new te({source:new Po({resource:n,addressMode:this._wrapMode})});const M=new Oe;M.scale(1/b,1/b),M.translate(l,p),this.textureSpace==="local"&&M.scale(e,e),this.transform=M}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};gf.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};gf.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Cr=gf;function h_(s,t){for(let e=0;e<t.length;e++){const n=t[e];s.addColorStop(n.offset,n.color)}}function u_(s,t){const e=pn.get().createCanvas(s,t),n=e.getContext("2d");return{canvas:e,context:n}}function GM(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(ae("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??Cr.defaultLinearOptions.textureSize}),t}const d_={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Bh{constructor(t,e){this.uid=Xn("fillPattern"),this._tick=0,this.transform=new Oe,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=d_[e].addressModeU,t.source.style.addressModeV=d_[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._tick++}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture=t,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var HM=XM,Pd={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},YM=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function XM(s){var t=[];return s.replace(YM,function(e,n,i){var r=n.toLowerCase();for(i=zM(i),r=="m"&&i.length>2&&(t.push([n].concat(i.splice(0,2))),r="l",n=n=="m"?"l":"L");;){if(i.length==Pd[r])return i.unshift(n),t.push(i);if(i.length<Pd[r])throw new Error("malformed path data");t.push([n].concat(i.splice(0,Pd[r])))}}),t}var VM=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function zM(s){var t=s.match(VM);return t?t.map(Number):[]}const KM=ig(HM);function $M(s,t){const e=KM(s),n=[];let i=null,r=0,o=0;for(let c=0;c<e.length;c++){const f=e[c],y=f[0],x=f;switch(y){case"M":r=x[1],o=x[2],t.moveTo(r,o);break;case"m":r+=x[1],o+=x[2],t.moveTo(r,o);break;case"H":r=x[1],t.lineTo(r,o);break;case"h":r+=x[1],t.lineTo(r,o);break;case"V":o=x[1],t.lineTo(r,o);break;case"v":o+=x[1],t.lineTo(r,o);break;case"L":r=x[1],o=x[2],t.lineTo(r,o);break;case"l":r+=x[1],o+=x[2],t.lineTo(r,o);break;case"C":r=x[5],o=x[6],t.bezierCurveTo(x[1],x[2],x[3],x[4],r,o);break;case"c":t.bezierCurveTo(r+x[1],o+x[2],r+x[3],o+x[4],r+x[5],o+x[6]),r+=x[5],o+=x[6];break;case"S":r=x[3],o=x[4],t.bezierCurveToShort(x[1],x[2],r,o);break;case"s":t.bezierCurveToShort(r+x[1],o+x[2],r+x[3],o+x[4]),r+=x[3],o+=x[4];break;case"Q":r=x[3],o=x[4],t.quadraticCurveTo(x[1],x[2],r,o);break;case"q":t.quadraticCurveTo(r+x[1],o+x[2],r+x[3],o+x[4]),r+=x[3],o+=x[4];break;case"T":r=x[1],o=x[2],t.quadraticCurveToShort(r,o);break;case"t":r+=x[1],o+=x[2],t.quadraticCurveToShort(r,o);break;case"A":r=x[6],o=x[7],t.arcToSvg(x[1],x[2],x[3],x[4],x[5],r,o);break;case"a":r+=x[6],o+=x[7],t.arcToSvg(x[1],x[2],x[3],x[4],x[5],r,o);break;case"Z":case"z":t.closePath(),n.length>0&&(i=n.pop(),i?(r=i.startX,o=i.startY):(r=0,o=0)),i=null;break;default:vn(`Unknown SVG path command: ${y}`)}y!=="Z"&&y!=="z"&&i===null&&(i={startX:r,startY:o},n.push(i))}return t}class yf{constructor(t=0,e=0,n=0){this.type="circle",this.x=t,this.y=e,this.radius=n}clone(){return new yf(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let i=this.x-t,r=this.y-e;return i*=i,r*=r,i+r<=n}strokeContains(t,e,n,i=.5){if(this.radius===0)return!1;const r=this.x-t,o=this.y-e,c=this.radius,f=(1-i)*n,y=Math.sqrt(r*r+o*o);return y<=c+f&&y>c-(n-f)}getBounds(t){return t||(t=new oe),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class xf{constructor(t=0,e=0,n=0,i=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=n,this.halfHeight=i}clone(){return new xf(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let n=(t-this.x)/this.halfWidth,i=(e-this.y)/this.halfHeight;return n*=n,i*=i,n+i<=1}strokeContains(t,e,n,i=.5){const{halfWidth:r,halfHeight:o}=this;if(r<=0||o<=0)return!1;const c=n*(1-i),f=n-c,y=r-f,x=o-f,l=r+c,p=o+c,b=t-this.x,_=e-this.y,u=b*b/(y*y)+_*_/(x*x),w=b*b/(l*l)+_*_/(p*p);return u>1&&w<=1}getBounds(t){return t||(t=new oe),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function jM(s,t,e,n,i,r){const o=s-e,c=t-n,f=i-e,y=r-n,x=o*f+c*y,l=f*f+y*y;let p=-1;l!==0&&(p=x/l);let b,_;p<0?(b=e,_=n):p>1?(b=i,_=r):(b=e+p*f,_=n+p*y);const u=s-b,w=t-_;return u*u+w*w}let qM,ZM;class Ol{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const n=[];for(let i=0,r=e.length;i<r;i++)n.push(e[i].x,e[i].y);e=n}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,n=e.length;for(let i=0;i<n;i+=2){const r=e[i],o=e[i+1],c=e[(i+2)%n],f=e[(i+3)%n];t+=(c-r)*(f+o)}return t<0}containsPolygon(t){const e=this.getBounds(qM),n=t.getBounds(ZM);if(!e.containsRect(n))return!1;const i=t.points;for(let r=0;r<i.length;r+=2){const o=i[r],c=i[r+1];if(!this.contains(o,c))return!1}return!0}clone(){const t=this.points.slice(),e=new Ol(t);return e.closePath=this.closePath,e}contains(t,e){let n=!1;const i=this.points.length/2;for(let r=0,o=i-1;r<i;o=r++){const c=this.points[r*2],f=this.points[r*2+1],y=this.points[o*2],x=this.points[o*2+1];f>e!=x>e&&t<(y-c)*((e-f)/(x-f))+c&&(n=!n)}return n}strokeContains(t,e,n,i=.5){const r=n*n,o=r*(1-i),c=r-o,{points:f}=this,y=f.length-(this.closePath?0:2);for(let x=0;x<y;x+=2){const l=f[x],p=f[x+1],b=f[(x+2)%f.length],_=f[(x+3)%f.length],u=jM(t,e,l,p,b,_),w=Math.sign((b-l)*(e-p)-(_-p)*(t-l));if(u<=(w<0?c:o))return!0}return!1}getBounds(t){t||(t=new oe);const e=this.points;let n=1/0,i=-1/0,r=1/0,o=-1/0;for(let c=0,f=e.length;c<f;c+=2){const y=e[c],x=e[c+1];n=y<n?y:n,i=y>i?y:i,r=x<r?x:r,o=x>o?x:o}return t.x=n,t.width=i-n,t.y=r,t.height=o-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return ae("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return ae("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const _h=(s,t,e,n,i,r,o)=>{const c=s-e,f=t-n,y=Math.sqrt(c*c+f*f);return y>=i-r&&y<=i+o};class bf{constructor(t=0,e=0,n=0,i=0,r=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=n,this.height=i,this.radius=r}getBounds(t){return t||(t=new oe),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new bf(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let i=t-(this.x+n),r=e-(this.y+n);const o=n*n;if(i*i+r*r<=o||(i=t-(this.x+this.width-n),i*i+r*r<=o)||(r=e-(this.y+this.height-n),i*i+r*r<=o)||(i=t-(this.x+n),i*i+r*r<=o))return!0}return!1}strokeContains(t,e,n,i=.5){const{x:r,y:o,width:c,height:f,radius:y}=this,x=n*(1-i),l=n-x,p=r+y,b=o+y,_=c-y*2,u=f-y*2,w=r+c,M=o+f;return(t>=r-x&&t<=r+l||t>=w-l&&t<=w+x)&&e>=b&&e<=b+u||(e>=o-x&&e<=o+l||e>=M-l&&e<=M+x)&&t>=p&&t<=p+_?!0:t<p&&e<b&&_h(t,e,p,b,y,l,x)||t>w-y&&e<b&&_h(t,e,w-y,b,y,l,x)||t>w-y&&e>M-y&&_h(t,e,w-y,M-y,y,l,x)||t<p&&e>M-y&&_h(t,e,p,M-y,y,l,x)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const oy={};function QM(s,t,e){let n=2166136261;for(let i=0;i<t;i++)n^=s[i].uid,n=Math.imul(n,16777619),n>>>=0;return oy[n]||JM(s,t,n,e)}function JM(s,t,e,n){const i={};let r=0;for(let c=0;c<n;c++){const f=c<t?s[c]:te.EMPTY.source;i[r++]=f.source,i[r++]=f.style}const o=new Sh(i);return oy[e]=o,o}class f_{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function p_(s,t){const e=s.byteLength/8|0,n=new Float64Array(s,0,e);new Float64Array(t,0,e).set(n);const r=s.byteLength-e*8;if(r>0){const o=new Uint8Array(s,e*8,r);new Uint8Array(t,e*8,r).set(o)}}const tT={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var eT=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",s[s.NONE=5]="NONE",s))(eT||{});function m_(s,t){return t.alphaMode==="no-premultiply-alpha"&&tT[s]||s}const nT=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function sT(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function iT(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const n=nT.replace(/%forloop%/gi,sT(s));if(t.shaderSource(e,n),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}}finally{t.deleteShader(e)}return s}let fa=null;function rT(){var t;if(fa)return fa;const s=Ng();return fa=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),fa=iT(fa,s),(t=s.getExtension("WEBGL_lose_context"))==null||t.loseContext(),fa}class oT{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class aT{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new oT,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Ll=[];let Ih=0;Hl.register({clear:()=>{if(Ll.length>0)for(const s of Ll)s&&s.destroy();Ll.length=0,Ih=0}});function __(){return Ih>0?Ll[--Ih]:new aT}function g_(s){Ll[Ih++]=s}let xl=0;const ay=class ly{constructor(t){this.uid=Xn("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...ly.defaultOptions,...t},t.maxTextures||(ae("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=rT());const{maxTextures:e,attributesInitialSize:n,indicesInitialSize:i}=t;this.attributeBuffer=new f_(n*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)g_(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const n=t._batch.textures.ids[e._source.uid];return!n&&n!==0?!1:(t._textureId=n,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let n=__(),i=n.textures;i.clear();const r=e[this.elementStart];let o=m_(r.blendMode,r.texture._source),c=r.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const f=this.attributeBuffer.float32View,y=this.attributeBuffer.uint32View,x=this.indexBuffer;let l=this._batchIndexSize,p=this._batchIndexStart,b="startBatch";const _=this.maxTextures;for(let u=this.elementStart;u<this.elementSize;++u){const w=e[u];e[u]=null;const v=w.texture._source,I=m_(w.blendMode,v),L=o!==I||c!==w.topology;if(v._batchTick===xl&&!L){w._textureId=v._textureBindLocation,l+=w.indexSize,w.packAsQuad?(this.packQuadAttributes(w,f,y,w._attributeStart,w._textureId),this.packQuadIndex(x,w._indexStart,w._attributeStart/this.vertexSize)):(this.packAttributes(w,f,y,w._attributeStart,w._textureId),this.packIndex(w,x,w._indexStart,w._attributeStart/this.vertexSize)),w._batch=n;continue}v._batchTick=xl,(i.count>=_||L)&&(this._finishBatch(n,p,l-p,i,o,c,t,b),b="renderBatch",p=l,o=I,c=w.topology,n=__(),i=n.textures,i.clear(),++xl),w._textureId=v._textureBindLocation=i.count,i.ids[v.uid]=i.count,i.textures[i.count++]=v,w._batch=n,l+=w.indexSize,w.packAsQuad?(this.packQuadAttributes(w,f,y,w._attributeStart,w._textureId),this.packQuadIndex(x,w._indexStart,w._attributeStart/this.vertexSize)):(this.packAttributes(w,f,y,w._attributeStart,w._textureId),this.packIndex(w,x,w._indexStart,w._attributeStart/this.vertexSize))}i.count>0&&(this._finishBatch(n,p,l-p,i,o,c,t,b),p=l,++xl),this.elementStart=this.elementSize,this._batchIndexStart=p,this._batchIndexSize=l}_finishBatch(t,e,n,i,r,o,c,f){t.gpuBindGroup=null,t.bindGroup=null,t.action=f,t.batcher=this,t.textures=i,t.blendMode=r,t.topology=o,t.start=e,t.size=n,++xl,this.batches[this.batchIndex++]=t,c.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),n=new f_(e);p_(this.attributeBuffer.rawBinaryData,n.rawBinaryData),this.attributeBuffer=n}_resizeIndexBuffer(t){const e=this.indexBuffer;let n=Math.max(t,e.length*1.5);n+=n%2;const i=n>65535?new Uint32Array(n):new Uint16Array(n);if(i.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let r=0;r<e.length;r++)i[r]=e[r];else p_(e.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(t,e,n){t[e]=n+0,t[e+1]=n+1,t[e+2]=n+2,t[e+3]=n+0,t[e+4]=n+2,t[e+5]=n+3}packIndex(t,e,n,i){const r=t.indices,o=t.indexSize,c=t.indexOffset,f=t.attributeOffset;for(let y=0;y<o;y++)e[n++]=i+r[y+c]-f}destroy(t={}){var e;if(this.batches!==null){for(let n=0;n<this.batches.length;n++)g_(this.batches[n]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,t.shader&&((e=this.shader)==null||e.destroy(),this.shader=null);for(let n=0;n<this._elements.length;n++)this._elements[n]&&(this._elements[n]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};ay.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let lT=ay;var ti=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(ti||{});class Ul extends Bi{constructor(t){let{data:e,size:n}=t;const{usage:i,label:r,shrinkToFit:o}=t;super(),this.uid=Xn("buffer"),this._resourceType="buffer",this._resourceId=Xn("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,n??(n=e==null?void 0:e.byteLength);const c=!!e;this.descriptor={size:n,usage:i,mappedAtCreation:c,label:r},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&ti.STATIC)}set static(t){t?this.descriptor.usage|=ti.STATIC:this.descriptor.usage&=~ti.STATIC}setDataWithSize(t,e,n){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){n&&this.emit("update",this);return}const i=this._data;if(this._data=t,this._dataInt32=null,!i||i.length!==t.length){!this.shrinkToFit&&i&&t.byteLength<i.byteLength?n&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=Xn("resource"),this.emit("change",this));return}n&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function cy(s,t){if(!(s instanceof Ul)){let e=t?ti.INDEX:ti.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=ti.INDEX|ti.COPY_DST):(s=new Float32Array(s),e=ti.VERTEX|ti.COPY_DST)),s=new Ul({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function cT(s,t,e){const n=s.getAttribute(t);if(!n)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const i=n.buffer.data;let r=1/0,o=1/0,c=-1/0,f=-1/0;const y=i.BYTES_PER_ELEMENT,x=(n.offset||0)/y,l=(n.stride||2*4)/y;for(let p=x;p<i.length;p+=l){const b=i[p],_=i[p+1];b>c&&(c=b),_>f&&(f=_),b<r&&(r=b),_<o&&(o=_)}return e.minX=r,e.minY=o,e.maxX=c,e.maxY=f,e}function hT(s){return(s instanceof Ul||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=cy(s.buffer,!1),s}class uT extends Bi{constructor(t={}){super(),this.uid=Xn("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Fi,this._boundsDirty=!0;const{attributes:e,indexBuffer:n,topology:i}=t;if(this.buffers=[],this.attributes={},e)for(const r in e)this.addAttribute(r,e[r]);this.instanceCount=t.instanceCount??1,n&&this.addIndex(n),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const n=hT(e);this.buffers.indexOf(n.buffer)===-1&&(this.buffers.push(n.buffer),n.buffer.on("update",this.onBufferUpdate,this),n.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=n}addIndex(t){this.indexBuffer=cy(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,cT(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(n=>n.destroy()),(e=this.indexBuffer)==null||e.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const dT=new Float32Array(1),fT=new Uint32Array(1);class pT extends uT{constructor(){const e=new Ul({data:dT,label:"attribute-batch-buffer",usage:ti.VERTEX|ti.COPY_DST,shrinkToFit:!1}),n=new Ul({data:fT,label:"index-batch-buffer",usage:ti.INDEX|ti.COPY_DST,shrinkToFit:!1}),i=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:i,offset:0},aUV:{buffer:e,format:"float32x2",stride:i,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:i,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:i,offset:5*4}},indexBuffer:n})}}function y_(s,t,e){if(s)for(const n in s){const i=n.toLocaleLowerCase(),r=t[i];if(r){let o=s[n];n==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&r.push(`//----${e}----//`),r.push(o)}else vn(`${n} placement hook does not exist in shader`)}}const mT=/\{\{(.*?)\}\}/g;function x_(s){var n;const t={};return(((n=s.match(mT))==null?void 0:n.map(i=>i.replace(/[{()}]/g,"")))??[]).forEach(i=>{t[i]=[]}),t}function b_(s,t){let e;const n=/@in\s+([^;]+);/g;for(;(e=n.exec(s))!==null;)t.push(e[1])}function A_(s,t,e=!1){const n=[];b_(t,n),s.forEach(c=>{c.header&&b_(c.header,n)});const i=n;e&&i.sort();const r=i.map((c,f)=>`       @location(${f}) ${c},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${r}
`),o}function S_(s,t){let e;const n=/@out\s+([^;]+);/g;for(;(e=n.exec(s))!==null;)t.push(e[1])}function _T(s){const e=/\b(\w+)\s*:/g.exec(s);return e?e[1]:""}function gT(s){const t=/@.*?\s+/g;return s.replace(t,"")}function yT(s,t){const e=[];S_(t,e),s.forEach(f=>{f.header&&S_(f.header,e)});let n=0;const i=e.sort().map(f=>f.indexOf("builtin")>-1?f:`@location(${n++}) ${f}`).join(`,
`),r=e.sort().map(f=>`       var ${gT(f)};`).join(`
`),o=`return VSOutput(
            ${e.sort().map(f=>` ${_T(f)}`).join(`,
`)});`;let c=t.replace(/@out\s+[^;]+;\s*/g,"");return c=c.replace("{{struct}}",`
${i}
`),c=c.replace("{{start}}",`
${r}
`),c=c.replace("{{return}}",`
${o}
`),c}function w_(s,t){let e=s;for(const n in t){const i=t[n];i.join(`
`).length?e=e.replace(`{{${n}}}`,`//-----${n} START-----//
${i.join(`
`)}
//----${n} FINISH----//`):e=e.replace(`{{${n}}}`,"")}return e}const eo=Object.create(null),Od=new Map;let xT=0;function bT({template:s,bits:t}){const e=hy(s,t);if(eo[e])return eo[e];const{vertex:n,fragment:i}=ST(s,t);return eo[e]=uy(n,i,t),eo[e]}function AT({template:s,bits:t}){const e=hy(s,t);return eo[e]||(eo[e]=uy(s.vertex,s.fragment,t)),eo[e]}function ST(s,t){const e=t.map(o=>o.vertex).filter(o=>!!o),n=t.map(o=>o.fragment).filter(o=>!!o);let i=A_(e,s.vertex,!0);i=yT(e,i);const r=A_(n,s.fragment,!0);return{vertex:i,fragment:r}}function hy(s,t){return t.map(e=>(Od.has(e)||Od.set(e,xT++),Od.get(e))).sort((e,n)=>e-n).join("-")+s.vertex+s.fragment}function uy(s,t,e){const n=x_(s),i=x_(t);return e.forEach(r=>{y_(r.vertex,n,r.name),y_(r.fragment,i,r.name)}),{vertex:w_(s,n),fragment:w_(t,i)}}const wT=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,MT=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,TT=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,vT=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,ET={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},CT={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function IT({bits:s,name:t}){const e=bT({template:{fragment:MT,vertex:wT},bits:[ET,...s]});return Ta.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function PT({bits:s,name:t}){return new Rh({name:t,...AT({template:{vertex:TT,fragment:vT},bits:[CT,...s]})})}const OT={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},LT={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Ld={};function kT(s){const t=[];if(s===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let n=0;n<s;n++)t.push(`@group(1) @binding(${e++}) var textureSource${n+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${n+1}: sampler;`)}return t.join(`
`)}function RT(s){const t=[];if(s===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<s;e++)e===s-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function FT(s){return Ld[s]||(Ld[s]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${kT(s)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${RT(s)}
            `}}),Ld[s]}const kd={};function BT(s){const t=[];for(let e=0;e<s;e++)e>0&&t.push("else"),e<s-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function NT(s){return kd[s]||(kd[s]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${s}];

            `,main:`

                ${BT(s)}
            `}}),kd[s]}const UT={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},WT={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},M_={};function DT(s){let t=M_[s];if(t)return t;const e=new Int32Array(s);for(let n=0;n<s;n++)e[n]=n;return t=M_[s]=new Hg({uTextures:{value:e,type:"i32",size:s}},{isStatic:!0}),t}class T_ extends Fh{constructor(t){const e=PT({name:"batch",bits:[LT,NT(t),WT]}),n=IT({name:"batch",bits:[OT,FT(t),UT]});super({glProgram:e,gpuProgram:n,resources:{batchSamplers:DT(t)}}),this.maxTextures=t}}let bl=null;const dy=class fy extends lT{constructor(t){super(t),this.geometry=new pT,this.name=fy.extension.name,this.vertexSize=6,bl??(bl=new T_(t.maxTextures)),this.shader=bl}packAttributes(t,e,n,i,r){const o=r<<16|t.roundPixels&65535,c=t.transform,f=c.a,y=c.b,x=c.c,l=c.d,p=c.tx,b=c.ty,{positions:_,uvs:u}=t,w=t.color,M=t.attributeOffset,v=M+t.attributeSize;for(let I=M;I<v;I++){const L=I*2,K=_[L],W=_[L+1];e[i++]=f*K+x*W+p,e[i++]=l*W+y*K+b,e[i++]=u[L],e[i++]=u[L+1],n[i++]=w,n[i++]=o}}packQuadAttributes(t,e,n,i,r){const o=t.texture,c=t.transform,f=c.a,y=c.b,x=c.c,l=c.d,p=c.tx,b=c.ty,_=t.bounds,u=_.maxX,w=_.minX,M=_.maxY,v=_.minY,I=o.uvs,L=t.color,K=r<<16|t.roundPixels&65535;e[i+0]=f*w+x*v+p,e[i+1]=l*v+y*w+b,e[i+2]=I.x0,e[i+3]=I.y0,n[i+4]=L,n[i+5]=K,e[i+6]=f*u+x*v+p,e[i+7]=l*v+y*u+b,e[i+8]=I.x1,e[i+9]=I.y1,n[i+10]=L,n[i+11]=K,e[i+12]=f*u+x*M+p,e[i+13]=l*M+y*u+b,e[i+14]=I.x2,e[i+15]=I.y2,n[i+16]=L,n[i+17]=K,e[i+18]=f*w+x*M+p,e[i+19]=l*M+y*w+b,e[i+20]=I.x3,e[i+21]=I.y3,n[i+22]=L,n[i+23]=K}_updateMaxTextures(t){this.shader.maxTextures!==t&&(bl=new T_(t),this.shader=bl)}destroy(){this.shader=null,super.destroy()}};dy.extension={type:[Rt.Batcher],name:"default"};let GT=dy;function HT(s,t,e,n,i,r,o,c=null){let f=0;e*=t,i*=r;const y=c.a,x=c.b,l=c.c,p=c.d,b=c.tx,_=c.ty;for(;f<o;){const u=s[e],w=s[e+1];n[i]=y*u+l*w+b,n[i+1]=x*u+p*w+_,i+=r,e+=t,f++}}function YT(s,t,e,n){let i=0;for(t*=e;i<n;)s[t]=0,s[t+1]=0,t+=e,i++}function py(s,t,e,n,i){const r=t.a,o=t.b,c=t.c,f=t.d,y=t.tx,x=t.ty;e||(e=0),n||(n=2),i||(i=s.length/n-e);let l=e*n;for(let p=0;p<i;p++){const b=s[l],_=s[l+1];s[l]=r*b+c*_+y,s[l+1]=o*b+f*_+x,l+=n}}const XT=new Oe;class my{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,n=this.renderable;return n?yg(e,n.groupColor)+(this.alpha*n.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||XT}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const Wl={extension:{type:Rt.ShapeBuilder,name:"circle"},build(s,t){let e,n,i,r,o,c;if(s.type==="circle"){const L=s;if(o=c=L.radius,o<=0)return!1;e=L.x,n=L.y,i=r=0}else if(s.type==="ellipse"){const L=s;if(o=L.halfWidth,c=L.halfHeight,o<=0||c<=0)return!1;e=L.x,n=L.y,i=r=0}else{const L=s,K=L.width/2,W=L.height/2;e=L.x+K,n=L.y+W,o=c=Math.max(0,Math.min(L.radius,Math.min(K,W))),i=K-o,r=W-c}if(i<0||r<0)return!1;const f=Math.ceil(2.3*Math.sqrt(o+c)),y=f*8+(i?4:0)+(r?4:0);if(y===0)return!1;if(f===0)return t[0]=t[6]=e+i,t[1]=t[3]=n+r,t[2]=t[4]=e-i,t[5]=t[7]=n-r,!0;let x=0,l=f*4+(i?2:0)+2,p=l,b=y,_=i+o,u=r,w=e+_,M=e-_,v=n+u;if(t[x++]=w,t[x++]=v,t[--l]=v,t[--l]=M,r){const L=n-u;t[p++]=M,t[p++]=L,t[--b]=L,t[--b]=w}for(let L=1;L<f;L++){const K=Math.PI/2*(L/f),W=i+Math.cos(K)*o,U=r+Math.sin(K)*c,gt=e+W,J=e-W,at=n+U,it=n-U;t[x++]=gt,t[x++]=at,t[--l]=at,t[--l]=J,t[p++]=J,t[p++]=it,t[--b]=it,t[--b]=gt}_=i,u=r+c,w=e+_,M=e-_,v=n+u;const I=n-u;return t[x++]=w,t[x++]=v,t[--b]=I,t[--b]=w,i&&(t[x++]=M,t[x++]=v,t[--b]=I,t[--b]=M),!0},triangulate(s,t,e,n,i,r){if(s.length===0)return;let o=0,c=0;for(let x=0;x<s.length;x+=2)o+=s[x],c+=s[x+1];o/=s.length/2,c/=s.length/2;let f=n;t[f*e]=o,t[f*e+1]=c;const y=f++;for(let x=0;x<s.length;x+=2)t[f*e]=s[x],t[f*e+1]=s[x+1],x>0&&(i[r++]=f,i[r++]=y,i[r++]=f-1),f++;i[r++]=y+1,i[r++]=y,i[r++]=f-1}},VT={...Wl,extension:{...Wl.extension,name:"ellipse"}},zT={...Wl,extension:{...Wl.extension,name:"roundedRectangle"}},_y=1e-4,v_=1e-4;function KT(s){const t=s.length;if(t<6)return 1;let e=0;for(let n=0,i=s[t-2],r=s[t-1];n<t;n+=2){const o=s[n],c=s[n+1];e+=(o-i)*(c+r),i=o,r=c}return e<0?-1:1}function E_(s,t,e,n,i,r,o,c){const f=s-e*i,y=t-n*i,x=s+e*r,l=t+n*r;let p,b;o?(p=n,b=-e):(p=-n,b=e);const _=f+p,u=y+b,w=x+p,M=l+b;return c.push(_,u),c.push(w,M),2}function So(s,t,e,n,i,r,o,c){const f=e-s,y=n-t;let x=Math.atan2(f,y),l=Math.atan2(i-s,r-t);c&&x<l?x+=Math.PI*2:!c&&x>l&&(l+=Math.PI*2);let p=x;const b=l-x,_=Math.abs(b),u=Math.sqrt(f*f+y*y),w=(15*_*Math.sqrt(u)/Math.PI>>0)+1,M=b/w;if(p+=M,c){o.push(s,t),o.push(e,n);for(let v=1,I=p;v<w;v++,I+=M)o.push(s,t),o.push(s+Math.sin(I)*u,t+Math.cos(I)*u);o.push(s,t),o.push(i,r)}else{o.push(e,n),o.push(s,t);for(let v=1,I=p;v<w;v++,I+=M)o.push(s+Math.sin(I)*u,t+Math.cos(I)*u),o.push(s,t);o.push(i,r),o.push(s,t)}return w*2}function $T(s,t,e,n,i,r){const o=_y;if(s.length===0)return;const c=t;let f=c.alignment;if(t.alignment!==.5){let ot=KT(s);f=(f-.5)*ot+.5}const y=new Fs(s[0],s[1]),x=new Fs(s[s.length-2],s[s.length-1]),l=n,p=Math.abs(y.x-x.x)<o&&Math.abs(y.y-x.y)<o;if(l){s=s.slice(),p&&(s.pop(),s.pop(),x.set(s[s.length-2],s[s.length-1]));const ot=(y.x+x.x)*.5,tt=(x.y+y.y)*.5;s.unshift(ot,tt),s.push(ot,tt)}const b=i,_=s.length/2;let u=s.length;const w=b.length/2,M=c.width/2,v=M*M,I=c.miterLimit*c.miterLimit;let L=s[0],K=s[1],W=s[2],U=s[3],gt=0,J=0,at=-(K-U),it=L-W,Nt=0,Et=0,bt=Math.sqrt(at*at+it*it);at/=bt,it/=bt,at*=M,it*=M;const Ye=f,ft=(1-Ye)*2,At=Ye*2;l||(c.cap==="round"?u+=So(L-at*(ft-At)*.5,K-it*(ft-At)*.5,L-at*ft,K-it*ft,L+at*At,K+it*At,b,!0)+2:c.cap==="square"&&(u+=E_(L,K,at,it,ft,At,!0,b))),b.push(L-at*ft,K-it*ft),b.push(L+at*At,K+it*At);for(let ot=1;ot<_-1;++ot){L=s[(ot-1)*2],K=s[(ot-1)*2+1],W=s[ot*2],U=s[ot*2+1],gt=s[(ot+1)*2],J=s[(ot+1)*2+1],at=-(K-U),it=L-W,bt=Math.sqrt(at*at+it*it),at/=bt,it/=bt,at*=M,it*=M,Nt=-(U-J),Et=W-gt,bt=Math.sqrt(Nt*Nt+Et*Et),Nt/=bt,Et/=bt,Nt*=M,Et*=M;const tt=W-L,Z=K-U,j=W-gt,It=J-U,G=tt*j+Z*It,Y=Z*j-It*tt,Ft=Y<0;if(Math.abs(Y)<.001*Math.abs(G)){b.push(W-at*ft,U-it*ft),b.push(W+at*At,U+it*At),G>=0&&(c.join==="round"?u+=So(W,U,W-at*ft,U-it*ft,W-Nt*ft,U-Et*ft,b,!1)+4:u+=2,b.push(W-Nt*At,U-Et*At),b.push(W+Nt*ft,U+Et*ft));continue}const fe=(-at+L)*(-it+U)-(-at+W)*(-it+K),ve=(-Nt+gt)*(-Et+U)-(-Nt+W)*(-Et+J),Ke=(tt*ve-j*fe)/Y,Ut=(It*fe-Z*ve)/Y,Qe=(Ke-W)*(Ke-W)+(Ut-U)*(Ut-U),ue=W+(Ke-W)*ft,mn=U+(Ut-U)*ft,xe=W-(Ke-W)*At,cn=U-(Ut-U)*At,Le=Math.min(tt*tt+Z*Z,j*j+It*It),$e=Ft?ft:At,Pn=Le+$e*$e*v;Qe<=Pn?c.join==="bevel"||Qe/v>I?(Ft?(b.push(ue,mn),b.push(W+at*At,U+it*At),b.push(ue,mn),b.push(W+Nt*At,U+Et*At)):(b.push(W-at*ft,U-it*ft),b.push(xe,cn),b.push(W-Nt*ft,U-Et*ft),b.push(xe,cn)),u+=2):c.join==="round"?Ft?(b.push(ue,mn),b.push(W+at*At,U+it*At),u+=So(W,U,W+at*At,U+it*At,W+Nt*At,U+Et*At,b,!0)+4,b.push(ue,mn),b.push(W+Nt*At,U+Et*At)):(b.push(W-at*ft,U-it*ft),b.push(xe,cn),u+=So(W,U,W-at*ft,U-it*ft,W-Nt*ft,U-Et*ft,b,!1)+4,b.push(W-Nt*ft,U-Et*ft),b.push(xe,cn)):(b.push(ue,mn),b.push(xe,cn)):(b.push(W-at*ft,U-it*ft),b.push(W+at*At,U+it*At),c.join==="round"?Ft?u+=So(W,U,W+at*At,U+it*At,W+Nt*At,U+Et*At,b,!0)+2:u+=So(W,U,W-at*ft,U-it*ft,W-Nt*ft,U-Et*ft,b,!1)+2:c.join==="miter"&&Qe/v<=I&&(Ft?(b.push(xe,cn),b.push(xe,cn)):(b.push(ue,mn),b.push(ue,mn)),u+=2),b.push(W-Nt*ft,U-Et*ft),b.push(W+Nt*At,U+Et*At),u+=2)}L=s[(_-2)*2],K=s[(_-2)*2+1],W=s[(_-1)*2],U=s[(_-1)*2+1],at=-(K-U),it=L-W,bt=Math.sqrt(at*at+it*it),at/=bt,it/=bt,at*=M,it*=M,b.push(W-at*ft,U-it*ft),b.push(W+at*At,U+it*At),l||(c.cap==="round"?u+=So(W-at*(ft-At)*.5,U-it*(ft-At)*.5,W-at*ft,U-it*ft,W+at*At,U+it*At,b,!1)+2:c.cap==="square"&&(u+=E_(W,U,at,it,ft,At,!1,b)));const P=v_*v_;for(let ot=w;ot<u+w-2;++ot)L=b[ot*2],K=b[ot*2+1],W=b[(ot+1)*2],U=b[(ot+1)*2+1],gt=b[(ot+2)*2],J=b[(ot+2)*2+1],!(Math.abs(L*(U-J)+W*(J-K)+gt*(K-U))<P)&&r.push(ot,ot+1,ot+2)}function jT(s,t,e,n){const i=_y;if(s.length===0)return;const r=s[0],o=s[1],c=s[s.length-2],f=s[s.length-1],y=t||Math.abs(r-c)<i&&Math.abs(o-f)<i,x=e,l=s.length/2,p=x.length/2;for(let b=0;b<l;b++)x.push(s[b*2]),x.push(s[b*2+1]);for(let b=0;b<l-1;b++)n.push(p+b,p+b+1);y&&n.push(p+l-1,p)}function gy(s,t,e,n,i,r,o){const c=LM(s,t,2);if(!c)return;for(let y=0;y<c.length;y+=3)r[o++]=c[y]+i,r[o++]=c[y+1]+i,r[o++]=c[y+2]+i;let f=i*n;for(let y=0;y<s.length;y+=2)e[f]=s[y],e[f+1]=s[y+1],f+=n}const qT=[],ZT={extension:{type:Rt.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return!0},triangulate(s,t,e,n,i,r){gy(s,qT,t,e,n,i,r)}},QT={extension:{type:Rt.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,n=e.x,i=e.y,r=e.width,o=e.height;return r>0&&o>0?(t[0]=n,t[1]=i,t[2]=n+r,t[3]=i,t[4]=n+r,t[5]=i+o,t[6]=n,t[7]=i+o,!0):!1},triangulate(s,t,e,n,i,r){let o=0;n*=e,t[n+o]=s[0],t[n+o+1]=s[1],o+=e,t[n+o]=s[2],t[n+o+1]=s[3],o+=e,t[n+o]=s[6],t[n+o+1]=s[7],o+=e,t[n+o]=s[4],t[n+o+1]=s[5],o+=e;const c=n/e;i[r++]=c,i[r++]=c+1,i[r++]=c+2,i[r++]=c+1,i[r++]=c+3,i[r++]=c+2}},JT={extension:{type:Rt.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,!0},triangulate(s,t,e,n,i,r){let o=0;n*=e,t[n+o]=s[0],t[n+o+1]=s[1],o+=e,t[n+o]=s[2],t[n+o+1]=s[3],o+=e,t[n+o]=s[4],t[n+o+1]=s[5];const c=n/e;i[r++]=c,i[r++]=c+1,i[r++]=c+2}},tv=new Oe,ev=new oe;function nv(s,t,e,n){const i=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const o=e.getBounds(ev);t.width&&o.pad(t.width);const{x:c,y:f}=o,y=1/o.width,x=1/o.height,l=-c*y,p=-f*x,b=i.a,_=i.b,u=i.c,w=i.d;i.a*=y,i.b*=y,i.c*=x,i.d*=x,i.tx=l*b+p*u+i.tx,i.ty=l*_+p*w+i.ty}else i.translate(t.texture.frame.x,t.texture.frame.y),i.scale(1/t.texture.source.width,1/t.texture.source.height);const r=t.texture.source.style;return!(t.fill instanceof Cr)&&r.addressMode==="clamp-to-edge"&&(r.addressMode="repeat",r.update()),n&&i.append(tv.copyFrom(n).invert()),i}const Nh={};Es.handleByMap(Rt.ShapeBuilder,Nh);Es.add(QT,ZT,JT,Wl,VT,zT);const sv=new oe,iv=new Oe;function rv(s,t){const{geometryData:e,batches:n}=t;n.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let i=0;i<s.instructions.length;i++){const r=s.instructions[i];if(r.action==="texture")ov(r.data,n,e);else if(r.action==="fill"||r.action==="stroke"){const o=r.action==="stroke",c=r.data.path.shapePath,f=r.data.style,y=r.data.hole;o&&y&&C_(y.shapePath,f,!0,n,e),y&&(c.shapePrimitives[c.shapePrimitives.length-1].holes=y.shapePath.shapePrimitives),C_(c,f,o,n,e)}}}function ov(s,t,e){const n=[],i=Nh.rectangle,r=sv;r.x=s.dx,r.y=s.dy,r.width=s.dw,r.height=s.dh;const o=s.transform;if(!i.build(r,n))return;const{vertices:c,uvs:f,indices:y}=e,x=y.length,l=c.length/2;o&&py(n,o),i.triangulate(n,c,2,l,y,x);const p=s.image,b=p.uvs;f.push(b.x0,b.y0,b.x1,b.y1,b.x3,b.y3,b.x2,b.y2);const _=Ei.get(my);_.indexOffset=x,_.indexSize=y.length-x,_.attributeOffset=l,_.attributeSize=c.length/2-l,_.baseColor=s.style,_.alpha=s.alpha,_.texture=p,_.geometryData=e,t.push(_)}function C_(s,t,e,n,i){const{vertices:r,uvs:o,indices:c}=i;s.shapePrimitives.forEach(({shape:f,transform:y,holes:x})=>{const l=[],p=Nh[f.type];if(!p.build(f,l))return;const b=c.length,_=r.length/2;let u="triangle-list";if(y&&py(l,y),e){const I=f.closePath??!0,L=t;L.pixelLine?(jT(l,I,r,c),u="line-list"):$T(l,L,!1,I,r,c)}else if(x){const I=[],L=l.slice();av(x).forEach(W=>{I.push(L.length/2),L.push(...W)}),gy(L,I,r,2,_,c,b)}else p.triangulate(l,r,2,_,c,b);const w=o.length/2,M=t.texture;if(M!==te.WHITE){const I=nv(iv,t,f,y);HT(r,2,_,o,w,2,r.length/2-_,I)}else YT(o,w,2,r.length/2-_);const v=Ei.get(my);v.indexOffset=b,v.indexSize=c.length-b,v.attributeOffset=_,v.attributeSize=r.length/2-_,v.baseColor=t.color,v.alpha=t.alpha,v.texture=M,v.geometryData=i,v.topology=u,n.push(v)})}function av(s){const t=[];for(let e=0;e<s.length;e++){const n=s[e].shape,i=[];Nh[n.type].build(n,i)&&t.push(i)}return t}class lv{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class cv{constructor(){this.instructions=new Sg}init(t){const e=t.maxTextures;this.batcher?this.batcher._updateMaxTextures(e):this.batcher=new GT({maxTextures:e}),this.instructions.reset()}get geometry(){return ae(ew,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const Af=class af{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){af.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??af.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),rv(t,e);const n=t.batchMode;t.customShader||n==="no-batch"?e.isBatchable=!1:n==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=Ei.get(cv,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:n,geometryData:i}=this._gpuContextHash[t.uid],r=i.vertices.length,o=i.indices.length;for(let x=0;x<n.length;x++)n[x].applyTransform=!1;const c=e.batcher;c.ensureAttributeBuffer(r),c.ensureIndexBuffer(o),c.begin();for(let x=0;x<n.length;x++){const l=n[x];c.add(l)}c.finish(e.instructions);const f=c.geometry;f.indexBuffer.setDataWithSize(c.indexBuffer,c.indexSize,!0),f.buffers[0].setDataWithSize(c.attributeBuffer.float32View,c.attributeSize,!0);const y=c.batches;for(let x=0;x<y.length;x++){const l=y[x];l.bindGroup=QM(l.textures.textures,l.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new lv;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(Ei.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(n=>{Ei.return(n)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};Af.extension={type:[Rt.WebGLSystem,Rt.WebGPUSystem,Rt.CanvasSystem],name:"graphicsContext"};Af.defaultOptions={bezierSmoothness:.5};let yy=Af;const hv=8,gh=11920929e-14,uv=1;function xy(s,t,e,n,i,r,o,c,f,y){const l=Math.min(.99,Math.max(0,y??yy.defaultOptions.bezierSmoothness));let p=(uv-l)/1;return p*=p,dv(t,e,n,i,r,o,c,f,s,p),s}function dv(s,t,e,n,i,r,o,c,f,y){lf(s,t,e,n,i,r,o,c,f,y,0),f.push(o,c)}function lf(s,t,e,n,i,r,o,c,f,y,x){if(x>hv)return;const l=(s+e)/2,p=(t+n)/2,b=(e+i)/2,_=(n+r)/2,u=(i+o)/2,w=(r+c)/2,M=(l+b)/2,v=(p+_)/2,I=(b+u)/2,L=(_+w)/2,K=(M+I)/2,W=(v+L)/2;if(x>0){let U=o-s,gt=c-t;const J=Math.abs((e-o)*gt-(n-c)*U),at=Math.abs((i-o)*gt-(r-c)*U);if(J>gh&&at>gh){if((J+at)*(J+at)<=y*(U*U+gt*gt)){f.push(K,W);return}}else if(J>gh){if(J*J<=y*(U*U+gt*gt)){f.push(K,W);return}}else if(at>gh){if(at*at<=y*(U*U+gt*gt)){f.push(K,W);return}}else if(U=K-(s+o)/2,gt=W-(t+c)/2,U*U+gt*gt<=y){f.push(K,W);return}}lf(s,t,l,p,M,v,K,W,f,y,x+1),lf(K,W,I,L,u,w,o,c,f,y,x+1)}const fv=8,pv=11920929e-14,mv=1;function _v(s,t,e,n,i,r,o,c){const y=Math.min(.99,Math.max(0,c??yy.defaultOptions.bezierSmoothness));let x=(mv-y)/1;return x*=x,gv(t,e,n,i,r,o,s,x),s}function gv(s,t,e,n,i,r,o,c){cf(o,s,t,e,n,i,r,c,0),o.push(i,r)}function cf(s,t,e,n,i,r,o,c,f){if(f>fv)return;const y=(t+n)/2,x=(e+i)/2,l=(n+r)/2,p=(i+o)/2,b=(y+l)/2,_=(x+p)/2;let u=r-t,w=o-e;const M=Math.abs((n-r)*w-(i-o)*u);if(M>pv){if(M*M<=c*(u*u+w*w)){s.push(b,_);return}}else if(u=b-(t+r)/2,w=_-(e+o)/2,u*u+w*w<=c){s.push(b,_);return}cf(s,t,e,y,x,b,_,c,f+1),cf(s,b,_,l,p,r,o,c,f+1)}function by(s,t,e,n,i,r,o,c){let f=Math.abs(i-r);(!o&&i>r||o&&r>i)&&(f=2*Math.PI-f),c||(c=Math.max(6,Math.floor(6*Math.pow(n,1/3)*(f/Math.PI)))),c=Math.max(c,3);let y=f/c,x=i;y*=o?-1:1;for(let l=0;l<c+1;l++){const p=Math.cos(x),b=Math.sin(x),_=t+p*n,u=e+b*n;s.push(_,u),x+=y}}function yv(s,t,e,n,i,r){const o=s[s.length-2],f=s[s.length-1]-e,y=o-t,x=i-e,l=n-t,p=Math.abs(f*l-y*x);if(p<1e-8||r===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const b=f*f+y*y,_=x*x+l*l,u=f*x+y*l,w=r*Math.sqrt(b)/p,M=r*Math.sqrt(_)/p,v=w*u/b,I=M*u/_,L=w*l+M*y,K=w*x+M*f,W=y*(M+v),U=f*(M+v),gt=l*(w+I),J=x*(w+I),at=Math.atan2(U-K,W-L),it=Math.atan2(J-K,gt-L);by(s,L+t,K+e,r,at,it,y*x>l*f)}const kl=Math.PI*2,Rd={centerX:0,centerY:0,ang1:0,ang2:0},Fd=({x:s,y:t},e,n,i,r,o,c,f)=>{s*=e,t*=n;const y=i*s-r*t,x=r*s+i*t;return f.x=y+o,f.y=x+c,f};function xv(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),n=t===1.5707963267948966?.551915024494:e,i=Math.cos(s),r=Math.sin(s),o=Math.cos(s+t),c=Math.sin(s+t);return[{x:i-r*n,y:r+i*n},{x:o+c*n,y:c-o*n},{x:o,y:c}]}const I_=(s,t,e,n)=>{const i=s*n-t*e<0?-1:1;let r=s*e+t*n;return r>1&&(r=1),r<-1&&(r=-1),i*Math.acos(r)},bv=(s,t,e,n,i,r,o,c,f,y,x,l,p)=>{const b=Math.pow(i,2),_=Math.pow(r,2),u=Math.pow(x,2),w=Math.pow(l,2);let M=b*_-b*w-_*u;M<0&&(M=0),M/=b*w+_*u,M=Math.sqrt(M)*(o===c?-1:1);const v=M*i/r*l,I=M*-r/i*x,L=y*v-f*I+(s+e)/2,K=f*v+y*I+(t+n)/2,W=(x-v)/i,U=(l-I)/r,gt=(-x-v)/i,J=(-l-I)/r,at=I_(1,0,W,U);let it=I_(W,U,gt,J);c===0&&it>0&&(it-=kl),c===1&&it<0&&(it+=kl),p.centerX=L,p.centerY=K,p.ang1=at,p.ang2=it};function Av(s,t,e,n,i,r,o,c=0,f=0,y=0){if(r===0||o===0)return;const x=Math.sin(c*kl/360),l=Math.cos(c*kl/360),p=l*(t-n)/2+x*(e-i)/2,b=-x*(t-n)/2+l*(e-i)/2;if(p===0&&b===0)return;r=Math.abs(r),o=Math.abs(o);const _=Math.pow(p,2)/Math.pow(r,2)+Math.pow(b,2)/Math.pow(o,2);_>1&&(r*=Math.sqrt(_),o*=Math.sqrt(_)),bv(t,e,n,i,r,o,f,y,x,l,p,b,Rd);let{ang1:u,ang2:w}=Rd;const{centerX:M,centerY:v}=Rd;let I=Math.abs(w)/(kl/4);Math.abs(1-I)<1e-7&&(I=1);const L=Math.max(Math.ceil(I),1);w/=L;let K=s[s.length-2],W=s[s.length-1];const U={x:0,y:0};for(let gt=0;gt<L;gt++){const J=xv(u,w),{x:at,y:it}=Fd(J[0],r,o,l,x,M,v,U),{x:Nt,y:Et}=Fd(J[1],r,o,l,x,M,v,U),{x:bt,y:Ye}=Fd(J[2],r,o,l,x,M,v,U);xy(s,K,W,at,it,Nt,Et,bt,Ye),K=bt,W=Ye,u+=w}}function Sv(s,t,e){const n=(o,c)=>{const f=c.x-o.x,y=c.y-o.y,x=Math.sqrt(f*f+y*y),l=f/x,p=y/x;return{len:x,nx:l,ny:p}},i=(o,c)=>{o===0?s.moveTo(c.x,c.y):s.lineTo(c.x,c.y)};let r=t[t.length-1];for(let o=0;o<t.length;o++){const c=t[o%t.length],f=c.radius??e;if(f<=0){i(o,c),r=c;continue}const y=t[(o+1)%t.length],x=n(c,r),l=n(c,y);if(x.len<1e-4||l.len<1e-4){i(o,c),r=c;continue}let p=Math.asin(x.nx*l.ny-x.ny*l.nx),b=1,_=!1;x.nx*l.nx-x.ny*-l.ny<0?p<0?p=Math.PI+p:(p=Math.PI-p,b=-1,_=!0):p>0&&(b=-1,_=!0);const u=p/2;let w,M=Math.abs(Math.cos(u)*f/Math.sin(u));M>Math.min(x.len/2,l.len/2)?(M=Math.min(x.len/2,l.len/2),w=Math.abs(M*Math.sin(u)/Math.cos(u))):w=f;const v=c.x+l.nx*M+-l.ny*w*b,I=c.y+l.ny*M+l.nx*w*b,L=Math.atan2(x.ny,x.nx)+Math.PI/2*b,K=Math.atan2(l.ny,l.nx)-Math.PI/2*b;o===0&&s.moveTo(v+Math.cos(L)*w,I+Math.sin(L)*w),s.arc(v,I,w,L,K,_),r=c}}function wv(s,t,e,n){const i=(c,f)=>Math.sqrt((c.x-f.x)**2+(c.y-f.y)**2),r=(c,f,y)=>({x:c.x+(f.x-c.x)*y,y:c.y+(f.y-c.y)*y}),o=t.length;for(let c=0;c<o;c++){const f=t[(c+1)%o],y=f.radius??e;if(y<=0){c===0?s.moveTo(f.x,f.y):s.lineTo(f.x,f.y);continue}const x=t[c],l=t[(c+2)%o],p=i(x,f);let b;if(p<1e-4)b=f;else{const w=Math.min(p/2,y);b=r(f,x,w/p)}const _=i(l,f);let u;if(_<1e-4)u=f;else{const w=Math.min(_/2,y);u=r(f,l,w/_)}c===0?s.moveTo(b.x,b.y):s.lineTo(b.x,b.y),s.quadraticCurveTo(f.x,f.y,u.x,u.y,n)}}const Mv=new oe;class Tv{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Fi,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const n=this._currentPoly.points,i=n[n.length-2],r=n[n.length-1];return(i!==t||r!==e)&&n.push(t,e),this}arc(t,e,n,i,r,o){this._ensurePoly(!1);const c=this._currentPoly.points;return by(c,t,e,n,i,r,o),this}arcTo(t,e,n,i,r){this._ensurePoly();const o=this._currentPoly.points;return yv(o,t,e,n,i,r),this}arcToSvg(t,e,n,i,r,o,c){const f=this._currentPoly.points;return Av(f,this._currentPoly.lastX,this._currentPoly.lastY,o,c,t,e,n,i,r),this}bezierCurveTo(t,e,n,i,r,o,c){this._ensurePoly();const f=this._currentPoly;return xy(this._currentPoly.points,f.lastX,f.lastY,t,e,n,i,r,o,c),this}quadraticCurveTo(t,e,n,i,r){this._ensurePoly();const o=this._currentPoly;return _v(this._currentPoly.points,o.lastX,o.lastY,t,e,n,i,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const n=this.shapePrimitives,i=n.length;for(let r=0;r<t.instructions.length;r++){const o=t.instructions[r];this[o.action](...o.data)}if(t.checkForHoles&&n.length-i>1){let r=null;for(let o=i;o<n.length;o++){const c=n[o];if(c.shape.type==="polygon"){const f=c.shape,y=r==null?void 0:r.shape;y&&y.containsPolygon(f)?(r.holes||(r.holes=[]),r.holes.push(c),n.copyWithin(o,o+1),n.length--,o--):r=c}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,n,i,r){return this.drawShape(new oe(t,e,n,i),r),this}circle(t,e,n,i){return this.drawShape(new yf(t,e,n),i),this}poly(t,e,n){const i=new Ol(t);return i.closePath=e,this.drawShape(i,n),this}regularPoly(t,e,n,i,r=0,o){i=Math.max(i|0,3);const c=-1*Math.PI/2+r,f=Math.PI*2/i,y=[];for(let x=0;x<i;x++){const l=c-x*f;y.push(t+n*Math.cos(l),e+n*Math.sin(l))}return this.poly(y,!0,o),this}roundPoly(t,e,n,i,r,o=0,c){if(i=Math.max(i|0,3),r<=0)return this.regularPoly(t,e,n,i,o);const f=n*Math.sin(Math.PI/i)-.001;r=Math.min(r,f);const y=-1*Math.PI/2+o,x=Math.PI*2/i,l=(i-2)*Math.PI/i/2;for(let p=0;p<i;p++){const b=p*x+y,_=t+n*Math.cos(b),u=e+n*Math.sin(b),w=b+Math.PI+l,M=b-Math.PI-l,v=_+r*Math.cos(w),I=u+r*Math.sin(w),L=_+r*Math.cos(M),K=u+r*Math.sin(M);p===0?this.moveTo(v,I):this.lineTo(v,I),this.quadraticCurveTo(_,u,L,K,c)}return this.closePath()}roundShape(t,e,n=!1,i){return t.length<3?this:(n?wv(this,t,e,i):Sv(this,t,e),this.closePath())}filletRect(t,e,n,i,r){if(r===0)return this.rect(t,e,n,i);const o=Math.min(n,i)/2,c=Math.min(o,Math.max(-o,r)),f=t+n,y=e+i,x=c<0?-c:0,l=Math.abs(c);return this.moveTo(t,e+l).arcTo(t+x,e+x,t+l,e,l).lineTo(f-l,e).arcTo(f-x,e+x,f,e+l,l).lineTo(f,y-l).arcTo(f-x,y-x,t+n-l,y,l).lineTo(t+l,y).arcTo(t+x,y-x,t,y-l,l).closePath()}chamferRect(t,e,n,i,r,o){if(r<=0)return this.rect(t,e,n,i);const c=Math.min(r,Math.min(n,i)/2),f=t+n,y=e+i,x=[t+c,e,f-c,e,f,e+c,f,y-c,f-c,y,t+c,y,t,y-c,t,e+c];for(let l=x.length-1;l>=2;l-=2)x[l]===x[l-2]&&x[l-1]===x[l-3]&&x.splice(l-1,2);return this.poly(x,!0,o)}ellipse(t,e,n,i,r){return this.drawShape(new xf(t,e,n,i),r),this}roundRect(t,e,n,i,r,o){return this.drawShape(new bf(t,e,n,i,r),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let n=this._currentPoly;return n&&this.endPoly(),n=new Ol,n.points.push(t,e),this._currentPoly=n,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new Ol,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let n=e.shape.x,i=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const r=e.transform,o=n;n=r.a*n+r.c*i+r.tx,i=r.b*o+r.d*i+r.ty}this._currentPoly.points.push(n,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const n=t.instructions[e];this[n.action](...n.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let n=0;n<e.length;n++){const i=e[n],r=i.shape.getBounds(Mv);i.transform?t.addRect(r,i.transform):t.addRect(r)}return t}}class Er{constructor(t,e=!1){this.instructions=[],this.uid=Xn("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?$M(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new Tv(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,n,i,r){const o=this.instructions[this.instructions.length-1],c=this.getLastPoint(Fs.shared);let f=0,y=0;if(!o||o.action!=="bezierCurveTo")f=c.x,y=c.y;else{f=o.data[2],y=o.data[3];const x=c.x,l=c.y;f=x+(x-f),y=l+(l-y)}return this.instructions.push({action:"bezierCurveTo",data:[f,y,t,e,n,i,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,n){const i=this.instructions[this.instructions.length-1],r=this.getLastPoint(Fs.shared);let o=0,c=0;if(!i||i.action!=="quadraticCurveTo")o=r.x,c=r.y;else{o=i.data[0],c=i.data[1];const f=r.x,y=r.y;o=f+(f-o),c=y+(y-c)}return this.instructions.push({action:"quadraticCurveTo",data:[o,c,t,e,n]}),this._dirty=!0,this}rect(t,e,n,i,r){return this.instructions.push({action:"rect",data:[t,e,n,i,r]}),this._dirty=!0,this}circle(t,e,n,i){return this.instructions.push({action:"circle",data:[t,e,n,i]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,n,i,r,o,c){r||(r=i/2);const f=-1*Math.PI/2+o,y=n*2,x=Math.PI*2/y,l=[];for(let p=0;p<y;p++){const b=p%2?r:i,_=p*x+f;l.push(t+b*Math.cos(_),e+b*Math.sin(_))}return this.poly(l,!0,c),this}clone(t=!1){const e=new Er;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let n=0;n<this.instructions.length;n++){const i=this.instructions[n];e.instructions.push({action:i.action,data:i.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,n=t.b,i=t.c,r=t.d,o=t.tx,c=t.ty;let f=0,y=0,x=0,l=0,p=0,b=0,_=0,u=0;for(let w=0;w<this.instructions.length;w++){const M=this.instructions[w],v=M.data;switch(M.action){case"moveTo":case"lineTo":f=v[0],y=v[1],v[0]=e*f+i*y+o,v[1]=n*f+r*y+c;break;case"bezierCurveTo":x=v[0],l=v[1],p=v[2],b=v[3],f=v[4],y=v[5],v[0]=e*x+i*l+o,v[1]=n*x+r*l+c,v[2]=e*p+i*b+o,v[3]=n*p+r*b+c,v[4]=e*f+i*y+o,v[5]=n*f+r*y+c;break;case"quadraticCurveTo":x=v[0],l=v[1],f=v[2],y=v[3],v[0]=e*x+i*l+o,v[1]=n*x+r*l+c,v[2]=e*f+i*y+o,v[3]=n*f+r*y+c;break;case"arcToSvg":f=v[5],y=v[6],_=v[0],u=v[1],v[0]=e*_+i*u,v[1]=n*_+r*u,v[5]=e*f+i*y+o,v[6]=n*f+r*y+c;break;case"circle":v[4]=Al(v[3],t);break;case"rect":v[4]=Al(v[4],t);break;case"ellipse":v[8]=Al(v[8],t);break;case"roundRect":v[5]=Al(v[5],t);break;case"addPath":v[0].transform(t);break;case"poly":v[2]=Al(v[2],t);break;default:vn("unknown transform action",M.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,n=this.instructions[e];if(!n)return t.x=0,t.y=0,t;for(;n.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;n=this.instructions[e]}switch(n.action){case"moveTo":case"lineTo":t.x=n.data[0],t.y=n.data[1];break;case"quadraticCurveTo":t.x=n.data[2],t.y=n.data[3];break;case"bezierCurveTo":t.x=n.data[4],t.y=n.data[5];break;case"arc":case"arcToSvg":t.x=n.data[5],t.y=n.data[6];break;case"addPath":n.data[0].getLastPoint(t);break}return t}}function Al(s,t){return s?s.prepend(t):t.clone()}function Yn(s,t,e){const n=s.getAttribute(t);return n?Number(n):e}function vv(s,t){const e=s.querySelectorAll("defs");for(let n=0;n<e.length;n++){const i=e[n];for(let r=0;r<i.children.length;r++){const o=i.children[r];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=Ev(o);break;case"radialgradient":t.defs[o.id]=Cv();break}}}}function Ev(s){const t=Yn(s,"x1",0),e=Yn(s,"y1",0),n=Yn(s,"x2",1),i=Yn(s,"y2",0),r=s.getAttribute("gradientUnits")||"objectBoundingBox",o=new Cr(t,e,n,i,r==="objectBoundingBox"?"local":"global");for(let c=0;c<s.children.length;c++){const f=s.children[c],y=Yn(f,"offset",0),x=ss.shared.setValue(f.getAttribute("stop-color")).toNumber();o.addColorStop(y,x)}return o}function Cv(s){return vn("[SVG Parser] Radial gradients are not yet supported"),new Cr(0,0,1,0)}function P_(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const O_={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Ay(s,t){const e=s.getAttribute("style"),n={},i={},r={strokeStyle:n,fillStyle:i,useFill:!1,useStroke:!1};for(const o in O_){const c=s.getAttribute(o);c&&L_(t,r,o,c.trim())}if(e){const o=e.split(";");for(let c=0;c<o.length;c++){const f=o[c].trim(),[y,x]=f.split(":");O_[y]&&L_(t,r,y,x.trim())}}return{strokeStyle:r.useStroke?n:null,fillStyle:r.useFill?i:null,useFill:r.useFill,useStroke:r.useStroke}}function L_(s,t,e,n){switch(e){case"stroke":if(n!=="none"){if(n.startsWith("url(")){const i=P_(n);t.strokeStyle.fill=s.defs[i]}else t.strokeStyle.color=ss.shared.setValue(n).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(n);break;case"fill":if(n!=="none"){if(n.startsWith("url(")){const i=P_(n);t.fillStyle.fill=s.defs[i]}else t.fillStyle.color=ss.shared.setValue(n).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(n);break;case"stroke-opacity":t.strokeStyle.alpha=Number(n);break;case"opacity":t.fillStyle.alpha=Number(n),t.strokeStyle.alpha=Number(n);break}}function Iv(s){if(s.length<=2)return!0;const t=s.map(c=>c.area).sort((c,f)=>f-c),[e,n]=t,i=t[t.length-1],r=e/n,o=n/i;return!(r>3&&o<2)}function Pv(s){return s.split(/(?=[Mm])/).filter(n=>n.trim().length>0)}function Ov(s){const t=s.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!t||t.length<4)return 0;const e=t.map(Number),n=[],i=[];for(let x=0;x<e.length;x+=2)x+1<e.length&&(n.push(e[x]),i.push(e[x+1]));if(n.length===0||i.length===0)return 0;const r=Math.min(...n),o=Math.max(...n),c=Math.min(...i),f=Math.max(...i);return(o-r)*(f-c)}function k_(s,t){const e=new Er(s,!1);for(const n of e.instructions)t.instructions.push(n)}function Lv(s,t){if(typeof s=="string"){const o=document.createElement("div");o.innerHTML=s.trim(),s=o.querySelector("svg")}const e={context:t,defs:{},path:new Er};vv(s,e);const n=s.children,{fillStyle:i,strokeStyle:r}=Ay(s,e);for(let o=0;o<n.length;o++){const c=n[o];c.nodeName.toLowerCase()!=="defs"&&Sy(c,e,i,r)}return t}function Sy(s,t,e,n){const i=s.children,{fillStyle:r,strokeStyle:o}=Ay(s,t);r&&e?e={...e,...r}:r&&(e=r),o&&n?n={...n,...o}:o&&(n=o);const c=!e&&!n;c&&(e={color:0});let f,y,x,l,p,b,_,u,w,M,v,I,L,K,W,U,gt;switch(s.nodeName.toLowerCase()){case"path":{K=s.getAttribute("d");const J=s.getAttribute("fill-rule"),at=Pv(K),it=J==="evenodd",Nt=at.length>1;if(it&&Nt){const bt=at.map(ft=>({path:ft,area:Ov(ft)}));if(bt.sort((ft,At)=>At.area-ft.area),at.length>3||!Iv(bt))for(let ft=0;ft<bt.length;ft++){const At=bt[ft],P=ft===0;t.context.beginPath();const ot=new Er(void 0,!0);k_(At.path,ot),t.context.path(ot),P?(e&&t.context.fill(e),n&&t.context.stroke(n)):t.context.cut()}else for(let ft=0;ft<bt.length;ft++){const At=bt[ft],P=ft%2===1;t.context.beginPath();const ot=new Er(void 0,!0);k_(At.path,ot),t.context.path(ot),P?t.context.cut():(e&&t.context.fill(e),n&&t.context.stroke(n))}}else{const bt=J?J==="evenodd":!0;W=new Er(K,bt),t.context.path(W),e&&t.context.fill(e),n&&t.context.stroke(n)}break}case"circle":_=Yn(s,"cx",0),u=Yn(s,"cy",0),w=Yn(s,"r",0),t.context.ellipse(_,u,w,w),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"rect":f=Yn(s,"x",0),y=Yn(s,"y",0),U=Yn(s,"width",0),gt=Yn(s,"height",0),M=Yn(s,"rx",0),v=Yn(s,"ry",0),M||v?t.context.roundRect(f,y,U,gt,M||v):t.context.rect(f,y,U,gt),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"ellipse":_=Yn(s,"cx",0),u=Yn(s,"cy",0),M=Yn(s,"rx",0),v=Yn(s,"ry",0),t.context.beginPath(),t.context.ellipse(_,u,M,v),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"line":x=Yn(s,"x1",0),l=Yn(s,"y1",0),p=Yn(s,"x2",0),b=Yn(s,"y2",0),t.context.beginPath(),t.context.moveTo(x,l),t.context.lineTo(p,b),n&&t.context.stroke(n);break;case"polygon":L=s.getAttribute("points"),I=L.match(/\d+/g).map(J=>parseInt(J,10)),t.context.poly(I,!0),e&&t.context.fill(e),n&&t.context.stroke(n);break;case"polyline":L=s.getAttribute("points"),I=L.match(/\d+/g).map(J=>parseInt(J,10)),t.context.poly(I,!1),n&&t.context.stroke(n);break;case"g":case"svg":break;default:{vn(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}c&&(e=null);for(let J=0;J<i.length;J++)Sy(i[J],t,e,n)}function kv(s){return ss.isColorLike(s)}function R_(s){return s instanceof Bh}function F_(s){return s instanceof Cr}function Rv(s){return s instanceof te}function Fv(s,t,e){const n=ss.shared.setValue(t??0);return s.color=n.toNumber(),s.alpha=n.alpha===1?e.alpha:n.alpha,s.texture=te.WHITE,{...e,...s}}function Bv(s,t,e){return s.texture=t,{...e,...s}}function B_(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function N_(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function Nv(s,t){const e={...t,...s},n=ss.shared.setValue(e.color);return e.alpha*=n.alpha,e.color=n.toNumber(),e}function Io(s,t){if(s==null)return null;const e={},n=s;return kv(s)?Fv(e,s,t):Rv(s)?Bv(e,s,t):R_(s)?B_(e,s,t):F_(s)?N_(e,s,t):n.fill&&R_(n.fill)?B_(n,n.fill,t):n.fill&&F_(n.fill)?N_(n,n.fill,t):Nv(n,t)}function Ph(s,t){const{width:e,alignment:n,miterLimit:i,cap:r,join:o,pixelLine:c,...f}=t,y=Io(s,f);return y?{width:e,alignment:n,miterLimit:i,cap:r,join:o,pixelLine:c,...y}:null}const Uv=new Fs,U_=new Oe,Sf=class er extends Bi{constructor(){super(...arguments),this.uid=Xn("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Er,this._transform=new Oe,this._fillStyle={...er.defaultFillStyle},this._strokeStyle={...er.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Fi,this._boundsDirty=!0}clone(){const t=new er;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Io(t,er.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Ph(t,er.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Io(t,er.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Io(t,er.defaultStrokeStyle),this}texture(t,e,n,i,r,o){return this.instructions.push({action:"texture",data:{image:t,dx:n||0,dy:i||0,dw:r||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?ss.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Er,this}fill(t,e){let n;const i=this.instructions[this.instructions.length-1];return this._tick===0&&(i==null?void 0:i.action)==="stroke"?n=i.data.path:n=this._activePath.clone(),n?(t!=null&&(e!==void 0&&typeof t=="number"&&(ae(ze,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Io(t,er.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(Fs.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const n=this.instructions[this.instructions.length-1];return this._tick===0&&(n==null?void 0:n.action)==="fill"?e=n.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Ph(t,er.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],n=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(n);else{e.data.hole=n;break}}return this._initNextPathLocation(),this}arc(t,e,n,i,r,o){this._tick++;const c=this._transform;return this._activePath.arc(c.a*t+c.c*e+c.tx,c.b*t+c.d*e+c.ty,n,i,r,o),this}arcTo(t,e,n,i,r){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*n+o.c*i+o.tx,o.b*n+o.d*i+o.ty,r),this}arcToSvg(t,e,n,i,r,o,c){this._tick++;const f=this._transform;return this._activePath.arcToSvg(t,e,n,i,r,f.a*o+f.c*c+f.tx,f.b*o+f.d*c+f.ty),this}bezierCurveTo(t,e,n,i,r,o,c){this._tick++;const f=this._transform;return this._activePath.bezierCurveTo(f.a*t+f.c*e+f.tx,f.b*t+f.d*e+f.ty,f.a*n+f.c*i+f.tx,f.b*n+f.d*i+f.ty,f.a*r+f.c*o+f.tx,f.b*r+f.d*o+f.ty,c),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,n,i){return this._tick++,this._activePath.ellipse(t,e,n,i,this._transform.clone()),this}circle(t,e,n){return this._tick++,this._activePath.circle(t,e,n,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const n=this._transform;return this._activePath.lineTo(n.a*t+n.c*e+n.tx,n.b*t+n.d*e+n.ty),this}moveTo(t,e){this._tick++;const n=this._transform,i=this._activePath.instructions,r=n.a*t+n.c*e+n.tx,o=n.b*t+n.d*e+n.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=r,i[0].data[1]=o,this):(this._activePath.moveTo(r,o),this)}quadraticCurveTo(t,e,n,i,r){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*n+o.c*i+o.tx,o.b*n+o.d*i+o.ty,r),this}rect(t,e,n,i){return this._tick++,this._activePath.rect(t,e,n,i,this._transform.clone()),this}roundRect(t,e,n,i,r){return this._tick++,this._activePath.roundRect(t,e,n,i,r,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,n,i,r=0,o){return this._tick++,this._activePath.regularPoly(t,e,n,i,r,o),this}roundPoly(t,e,n,i,r,o){return this._tick++,this._activePath.roundPoly(t,e,n,i,r,o),this}roundShape(t,e,n,i){return this._tick++,this._activePath.roundShape(t,e,n,i),this}filletRect(t,e,n,i,r){return this._tick++,this._activePath.filletRect(t,e,n,i,r),this}chamferRect(t,e,n,i,r,o){return this._tick++,this._activePath.chamferRect(t,e,n,i,r,o),this}star(t,e,n,i,r=0,o=0){return this._tick++,this._activePath.star(t,e,n,i,r,o,this._transform.clone()),this}svg(t){return this._tick++,Lv(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,n,i,r,o){return t instanceof Oe?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,n,i,r,o),this)}transform(t,e,n,i,r,o){return t instanceof Oe?(this._transform.append(t),this):(U_.set(t,e,n,i,r,o),this._transform.append(U_),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const n=this.instructions[e],i=n.action;if(i==="fill"){const r=n.data;t.addBounds(r.path.bounds)}else if(i==="texture"){const r=n.data;t.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)}if(i==="stroke"){const r=n.data,o=r.style.alignment,c=r.style.width*(1-o),f=r.path.bounds;t.addFrame(f.minX-c,f.minY-c,f.maxX+c,f.maxY+c)}}return t}containsPoint(t){var i;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let n=!1;for(let r=0;r<e.length;r++){const o=e[r],c=o.data,f=c.path;if(!o.action||!f)continue;const y=c.style,x=f.shapePath.shapePrimitives;for(let l=0;l<x.length;l++){const p=x[l].shape;if(!y||!p)continue;const b=x[l].transform,_=b?b.applyInverse(t,Uv):t;if(o.action==="fill")n=p.contains(_.x,_.y);else{const w=y;n=p.strokeContains(_.x,_.y,w.width,w.alignment)}const u=c.hole;if(u){const w=(i=u.shapePath)==null?void 0:i.shapePrimitives;if(w)for(let M=0;M<w.length;M++)w[M].shape.contains(_.x,_.y)&&(n=!1)}if(n)return!0}}return n}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(n)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(n))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Sf.defaultFillStyle={color:16777215,alpha:1,texture:te.WHITE,matrix:null,fill:null,textureSpace:"local"};Sf.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:te.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Ti=Sf;const wf=class ma extends Bi{constructor(t={}){super(),this.uid=Xn("textStyle"),this._tick=0,Wv(t);const e={...ma.defaultTextStyle,...t};for(const n in e){const i=n;this[i]=e[n]}this.update(),this._tick=0}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.update())}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...ma.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...ma.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.update())}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.update())}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.update())}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.update())}get filters(){return this._filters}set filters(t){this._filters!==t&&(this._filters=Object.freeze(t),this.update())}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.update())}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Ti.defaultFillStyle,...t},()=>{this._fill=Io({...this._originalFill},Ti.defaultFillStyle)})),this._fill=Io(t===0?"black":t,Ti.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Ti.defaultStrokeStyle,...t},()=>{this._stroke=Ph({...this._originalStroke},Ti.defaultStrokeStyle)})),this._stroke=Ph(t,Ti.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const t=ma.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new ma({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){var n,i,r,o;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const c=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(n=this._fill)!=null&&n.texture&&this._fill.texture.destroy(c),(i=this._originalFill)!=null&&i.texture&&this._originalFill.texture.destroy(c),(r=this._stroke)!=null&&r.texture&&this._stroke.texture.destroy(c),(o=this._originalStroke)!=null&&o.texture&&this._originalStroke.texture.destroy(c)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(n,i,r)=>(n[i]===r||(n[i]=r,e==null||e(i,r),this.update()),!0)})}_isFillStyle(t){return(t??null)!==null&&!(ss.isColorLike(t)||t instanceof Cr||t instanceof Bh)}};wf.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};wf.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let _e=wf;function Wv(s){const t=s;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=_e.defaultDropShadow;s.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){ae(ze,"strokeThickness is now a part of stroke");const e=t.stroke;let n={};if(ss.isColorLike(e))n.color=e;else if(e instanceof Cr||e instanceof Bh)n.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))n=e;else throw new Error("Invalid stroke value.");s.stroke={...n,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){if(ae(ze,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(t.fill)||t.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");t.fill.length!==t.fillGradientStops.length&&vn("The number of fill colors must match the number of fill gradient stops.");const e=new Cr({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),n=t.fillGradientStops.slice(),i=t.fill.map(r=>ss.shared.setValue(r).toNumber());n.forEach((r,o)=>{e.addColorStop(r,i[o])}),s.fill={fill:e}}}class Dv{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const n=pn.get().createCanvas();n.width=t,n.height=e;const i=n.getContext("2d");return{canvas:n,context:i}}getOptimalCanvasAndContext(t,e,n=1){t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),t=xa(t),e=xa(e);const i=(t<<17)+(e<<1);this._canvasPool[i]||(this._canvasPool[i]=[]);let r=this._canvasPool[i].pop();return r||(r=this._createCanvasAndContext(t,e)),r}returnCanvasAndContext(t){const e=t.canvas,{width:n,height:i}=e,r=(n<<17)+(i<<1);t.context.resetTransform(),t.context.clearRect(0,0,n,i),this._canvasPool[r].push(t)}clear(){this._canvasPool={}}}const Dl=new Dv;Hl.register(Dl);const W_=1e5;function Oh(s,t,e,n=0){if(s.texture===te.WHITE&&!s.fill)return ss.shared.setValue(s.color).setAlpha(s.alpha??1).toHexa();if(s.fill){if(s.fill instanceof Bh){const i=s.fill,r=t.createPattern(i.texture.source.resource,"repeat"),o=i.transform.copyTo(Oe.shared);return o.scale(i.texture.frame.width,i.texture.frame.height),r.setTransform(o),r}else if(s.fill instanceof Cr){const i=s.fill,r=i.type==="linear",o=i.textureSpace==="local";let c=1,f=1;o&&e&&(c=e.width+n,f=e.height+n);let y,x=!1;if(r){const{start:l,end:p}=i;y=t.createLinearGradient(l.x*c,l.y*f,p.x*c,p.y*f),x=Math.abs(p.x-l.x)<Math.abs((p.y-l.y)*.1)}else{const{center:l,innerRadius:p,outerCenter:b,outerRadius:_}=i;y=t.createRadialGradient(l.x*c,l.y*f,p*c,b.x*c,b.y*f,_*c)}if(x&&o&&e){const l=e.lineHeight/f;for(let p=0;p<e.lines.length;p++){const b=(p*e.lineHeight+n/2)/f;i.colorStops.forEach(_=>{const u=b+_.offset*l;y.addColorStop(Math.floor(u*W_)/W_,ss.shared.setValue(_.color).toHex())})}}else i.colorStops.forEach(l=>{y.addColorStop(l.offset,ss.shared.setValue(l.color).toHex())});return y}}else{const i=t.createPattern(s.texture.source.resource,"repeat"),r=s.matrix.copyTo(Oe.shared);return r.scale(s.texture.frame.width,s.texture.frame.height),i.setTransform(r),i}return vn("FillStyle not recognised",s),"red"}const wy=class My extends iy{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...My.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const n=e.style.clone();e.overrideFill&&(n._fill.color=16777215,n._fill.alpha=1,n._fill.texture=te.WHITE,n._fill.fill=null),this.applyFillAsTint=e.overrideFill;const i=n.fontSize;n.fontSize=this.baseMeasurementFontSize;const r=Ch(n);e.overrideSize?n._stroke&&(n._stroke.width*=this.baseRenderedFontSize/i):n.fontSize=this.baseRenderedFontSize=i,this._style=n,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,e.textureStyle&&(this._textureStyle=e.textureStyle instanceof ba?e.textureStyle:new ba(e.textureStyle)),this.fontMetrics=nr.measureFont(r),this.lineHeight=n.lineHeight||this.fontMetrics.fontSize||n.fontSize}ensureCharacters(t){var w,M;const e=nr.graphemeSegmenter(t).filter(v=>!this._currentChars.includes(v)).filter((v,I,L)=>L.indexOf(v)===I);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let n;this._currentPageIndex===-1?n=this._nextPage():n=this.pages[this._currentPageIndex];let{canvas:i,context:r}=n.canvasAndContext,o=n.texture.source;const c=this._style;let f=this._currentX,y=this._currentY,x=this._currentMaxCharHeight;const l=this.baseRenderedFontSize/this.baseMeasurementFontSize,p=this._padding*l;let b=!1;const _=i.width/this.resolution,u=i.height/this.resolution;for(let v=0;v<e.length;v++){const I=e[v],L=nr.measureText(I,c,i,!1);L.lineHeight=L.height;const K=L.width*l,W=Math.ceil((c.fontStyle==="italic"?2:1)*K),U=L.height*l,gt=W+p*2,J=U+p*2;if(b=!1,I!==`
`&&I!=="\r"&&I!=="	"&&I!==" "&&(b=!0,x=Math.ceil(Math.max(J,x))),f+gt>_&&(y+=x,x=J,f=0,y+x>u)){o.update();const it=this._nextPage();i=it.canvasAndContext.canvas,r=it.canvasAndContext.context,o=it.texture.source,f=0,y=0,x=0}const at=K/l-(((w=c.dropShadow)==null?void 0:w.distance)??0)-(((M=c._stroke)==null?void 0:M.width)??0);if(this.chars[I]={id:I.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:at,kerning:{}},b){this._drawGlyph(r,L,f+p,y+p,l,c);const it=o.width*l,Nt=o.height*l,Et=new oe(f/it*o.width,y/Nt*o.height,gt/it*o.width,J/Nt*o.height);this.chars[I].texture=new te({source:o,frame:Et}),f+=Math.ceil(gt)}}o.update(),this._currentX=f,this._currentY=y,this._currentMaxCharHeight=x,this._skipKerning&&this._applyKerning(e,r)}get pageTextures(){return ae(ze,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const n=this._measureCache;for(let i=0;i<t.length;i++){const r=t[i];for(let o=0;o<this._currentChars.length;o++){const c=this._currentChars[o];let f=n[r];f||(f=n[r]=e.measureText(r).width);let y=n[c];y||(y=n[c]=e.measureText(c).width);let x=e.measureText(r+c).width,l=x-(f+y);l&&(this.chars[r].kerning[c]=l),x=e.measureText(r+c).width,l=x-(f+y),l&&(this.chars[c].kerning[r]=l)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=Dl.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const n=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),i=new te({source:new Po({resource:e.canvas,resolution:n,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(i.source.style=this._textureStyle);const r={canvasAndContext:e,texture:i};return this.pages[this._currentPageIndex]=r,r}_setupContext(t,e,n){e.fontSize=this.baseRenderedFontSize,t.scale(n,n),t.font=Ch(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const i=e._stroke,r=(i==null?void 0:i.width)??0;if(i&&(t.lineWidth=r,t.lineJoin=i.join,t.miterLimit=i.miterLimit,t.strokeStyle=Oh(i,t)),e._fill&&(t.fillStyle=Oh(e._fill,t)),e.dropShadow){const o=e.dropShadow,c=ss.shared.setValue(o.color).toArray(),f=o.blur*n,y=o.distance*n;t.shadowColor=`rgba(${c[0]*255},${c[1]*255},${c[2]*255},${o.alpha})`,t.shadowBlur=f,t.shadowOffsetX=Math.cos(o.angle)*y,t.shadowOffsetY=Math.sin(o.angle)*y}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,n,i,r,o){const c=e.text,f=e.fontProperties,y=o._stroke,x=((y==null?void 0:y.width)??0)*r,l=n+x/2,p=i-x/2,b=f.descent*r,_=e.lineHeight*r;let u=!1;o.stroke&&x&&(u=!0,t.strokeText(c,l,p+_-b));const{shadowBlur:w,shadowOffsetX:M,shadowOffsetY:v}=t;o._fill&&(u&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.fillText(c,l,p+_-b)),u&&(t.shadowBlur=w,t.shadowOffsetX=M,t.shadowOffsetY=v)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:n}=this.pages[t];Dl.returnCanvasAndContext(e),n.destroy(!0)}this.pages=null}};wy.defaultOptions={textureSize:512,style:new _e,mipmap:!0};let D_=wy;function Gv(s,t,e,n){const i={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=e.baseLineOffset;let r=i.lines[0],o=null,c=!0;const f={width:0,start:0,index:0,positions:[],chars:[]},y=e.baseMeasurementFontSize/t.fontSize,x=t.letterSpacing*y,l=t.wordWrapWidth*y,p=t.lineHeight?t.lineHeight*y:e.lineHeight,b=t.wordWrap&&t.breakWords,_=M=>{const v=r.width;for(let I=0;I<f.index;I++){const L=M.positions[I];r.chars.push(M.chars[I]),r.charPositions.push(L+v)}r.width+=M.width,c=!1,f.width=0,f.index=0,f.chars.length=0},u=()=>{let M=r.chars.length-1;if(n){let v=r.chars[M];for(;v===" ";)r.width-=e.chars[v].xAdvance,v=r.chars[--M]}i.width=Math.max(i.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},c=!0,i.lines.push(r),i.height+=p},w=M=>M-x>l;for(let M=0;M<s.length+1;M++){let v;const I=M===s.length;I||(v=s[M]);const L=e.chars[v]||e.chars[" "];if(/(?:\s)/.test(v)||v==="\r"||v===`
`||I){if(!c&&t.wordWrap&&w(r.width+f.width)?(u(),_(f),I||r.charPositions.push(0)):(f.start=r.width,_(f),I||r.charPositions.push(0)),v==="\r"||v===`
`)u();else if(!I){const gt=L.xAdvance+(L.kerning[o]||0)+x;r.width+=gt,r.spaceWidth=gt,r.spacesIndex.push(r.charPositions.length),r.chars.push(v)}}else{const U=L.kerning[o]||0,gt=L.xAdvance+U+x;b&&w(r.width+f.width+gt)&&(_(f),u()),f.positions[f.index++]=f.width+U,f.chars.push(v),f.width+=gt}o=v}return u(),t.align==="center"?Hv(i):t.align==="right"?Yv(i):t.align==="justify"&&Xv(i),i}function Hv(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],n=s.width/2-e.width/2;for(let i=0;i<e.charPositions.length;i++)e.charPositions[i]+=n}}function Yv(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],n=s.width-e.width;for(let i=0;i<e.charPositions.length;i++)e.charPositions[i]+=n}}function Xv(s){const t=s.width;for(let e=0;e<s.lines.length;e++){const n=s.lines[e];let i=0,r=n.spacesIndex[i++],o=0;const c=n.spacesIndex.length,y=(t-n.width)/c;for(let x=0;x<n.charPositions.length;x++)x===r&&(r=n.spacesIndex[i++],o+=y),n.charPositions[x]+=o}}function Vv(s){if(s==="")return[];typeof s=="string"&&(s=[s]);const t=[];for(let e=0,n=s.length;e<n;e++){const i=s[e];if(Array.isArray(i)){if(i.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);if(i[0].length===0||i[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const r=i[0].charCodeAt(0),o=i[1].charCodeAt(0);if(o<r)throw new Error("[BitmapFont]: Invalid character range.");for(let c=r,f=o;c<=f;c++)t.push(String.fromCharCode(c))}else t.push(...Array.from(i))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let yh=0;class zv{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=ry(1e3)}getFont(t,e){var o;let n=`${e.fontFamily}-bitmap`,i=!0;if(e._fill.fill&&!e._stroke?(n+=e._fill.fill.styleKey,i=!1):(e._stroke||e.dropShadow)&&(n=`${e.styleKey}-bitmap`,i=!1),!Tn.has(n)){const c=Object.create(e);c.lineHeight=0;const f=new D_({style:c,overrideFill:i,overrideSize:!0,...this.defaultOptions});yh++,yh>50&&vn("BitmapText",`You have dynamically created ${yh} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),f.once("destroy",()=>{yh--,Tn.remove(n)}),Tn.set(n,f)}const r=Tn.get(n);return(o=r.ensureCharacters)==null||o.call(r,t),r}getLayout(t,e,n=!0){const i=this.getFont(t,e),r=`${t}-${e.styleKey}-${n}`;if(this.measureCache.has(r))return this.measureCache.get(r);const o=nr.graphemeSegmenter(t),c=Gv(o,e,i,n);return this.measureCache.set(r,c),c}measureText(t,e,n=!0){return this.getLayout(t,e,n)}install(...t){var y,x,l,p;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(y=t[2])==null?void 0:y.chars,resolution:(x=t[2])==null?void 0:x.resolution,padding:(l=t[2])==null?void 0:l.padding,skipKerning:(p=t[2])==null?void 0:p.skipKerning},ae(ze,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const n=e==null?void 0:e.name;if(!n)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const i=e.style,r=i instanceof _e?i:new _e(i),o=e.dynamicFill??this._canUseTintForStyle(r),c=new D_({style:r,overrideFill:o,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),f=Vv(e.chars);return c.ensureCharacters(f.join("")),Tn.set(`${n}-bitmap`,c),c.once("destroy",()=>Tn.remove(`${n}-bitmap`)),c}uninstall(t){const e=`${t}-bitmap`,n=Tn.get(e);n&&n.destroy()}_canUseTintForStyle(t){return!t._stroke&&(!t.dropShadow||t.dropShadow.color===0)&&!t._fill.fill&&t._fill.color===16777215}}const G_=new zv;class Ty extends iy{constructor(t,e){super();const{textures:n,data:i}=t;Object.keys(i.pages).forEach(r=>{const o=i.pages[parseInt(r,10)],c=n[o.id];this.pages.push({texture:c})}),Object.keys(i.chars).forEach(r=>{const o=i.chars[r],{frame:c,source:f,rotate:y}=n[o.page],x=rn.transformRectCoords(o,c,y,new oe),l=new te({frame:x,orig:new oe(0,0,o.width,o.height),source:f,rotate:y});this.chars[r]={id:r.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:l}}),this.baseRenderedFontSize=i.fontSize,this.baseMeasurementFontSize=i.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:i.fontSize},this.baseLineOffset=i.baseLineOffset,this.lineHeight=i.lineHeight,this.fontFamily=i.fontFamily,this.distanceField=i.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){G_.install(t)}static uninstall(t){G_.uninstall(t)}}const Bd={test(s){return typeof s=="string"&&s.startsWith("info face=")},parse(s){const t=s.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const l in t){const p=t[l].match(/^[a-z]+/gm)[0],b=t[l].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),_={};for(const u in b){const w=b[u].split("="),M=w[0],v=w[1].replace(/"/gm,""),I=parseFloat(v),L=isNaN(I)?v:I;_[M]=L}e[p].push(_)}const n={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[i]=e.info,[r]=e.common,[o]=e.distanceField??[];o&&(n.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),n.fontSize=parseInt(i.size,10),n.fontFamily=i.face,n.lineHeight=parseInt(r.lineHeight,10);const c=e.page;for(let l=0;l<c.length;l++)n.pages.push({id:parseInt(c[l].id,10)||0,file:c[l].file});const f={};n.baseLineOffset=n.lineHeight-parseInt(r.base,10);const y=e.char;for(let l=0;l<y.length;l++){const p=y[l],b=parseInt(p.id,10);let _=p.letter??p.char??String.fromCharCode(b);_==="space"&&(_=" "),f[b]=_,n.chars[_]={id:b,page:parseInt(p.page,10)||0,x:parseInt(p.x,10),y:parseInt(p.y,10),width:parseInt(p.width,10),height:parseInt(p.height,10),xOffset:parseInt(p.xoffset,10),yOffset:parseInt(p.yoffset,10),xAdvance:parseInt(p.xadvance,10),kerning:{}}}const x=e.kerning||[];for(let l=0;l<x.length;l++){const p=parseInt(x[l].first,10),b=parseInt(x[l].second,10),_=parseInt(x[l].amount,10);n.chars[f[b]].kerning[f[p]]=_}return n}},H_={test(s){const t=s;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(s){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=s.getElementsByTagName("info")[0],n=s.getElementsByTagName("common")[0],i=s.getElementsByTagName("distanceField")[0];i&&(t.distanceField={type:i.getAttribute("fieldType"),range:parseInt(i.getAttribute("distanceRange"),10)});const r=s.getElementsByTagName("page"),o=s.getElementsByTagName("char"),c=s.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(n.getAttribute("lineHeight"),10);for(let y=0;y<r.length;y++)t.pages.push({id:parseInt(r[y].getAttribute("id"),10)||0,file:r[y].getAttribute("file")});const f={};t.baseLineOffset=t.lineHeight-parseInt(n.getAttribute("base"),10);for(let y=0;y<o.length;y++){const x=o[y],l=parseInt(x.getAttribute("id"),10);let p=x.getAttribute("letter")??x.getAttribute("char")??String.fromCharCode(l);p==="space"&&(p=" "),f[l]=p,t.chars[p]={id:l,page:parseInt(x.getAttribute("page"),10)||0,x:parseInt(x.getAttribute("x"),10),y:parseInt(x.getAttribute("y"),10),width:parseInt(x.getAttribute("width"),10),height:parseInt(x.getAttribute("height"),10),xOffset:parseInt(x.getAttribute("xoffset"),10),yOffset:parseInt(x.getAttribute("yoffset"),10),xAdvance:parseInt(x.getAttribute("xadvance"),10),kerning:{}}}for(let y=0;y<c.length;y++){const x=parseInt(c[y].getAttribute("first"),10),l=parseInt(c[y].getAttribute("second"),10),p=parseInt(c[y].getAttribute("amount"),10);t.chars[f[l]].kerning[f[x]]=p}return t}},Y_={test(s){return typeof s=="string"&&s.match(/<font(\s|>)/)?H_.test(pn.get().parseXML(s)):!1},parse(s){return H_.parse(pn.get().parseXML(s))}},Kv=[".xml",".fnt"],$v={extension:{type:Rt.CacheParser,name:"cacheBitmapFont"},test:s=>s instanceof Ty,getCacheableAssets(s,t){const e={};return s.forEach(n=>{e[n]=t,e[`${n}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},jv={extension:{type:Rt.LoadParser,priority:so.Normal},name:"loadBitmapFont",id:"bitmap-font",test(s){return Kv.includes(di.extname(s).toLowerCase())},async testParse(s){return Bd.test(s)||Y_.test(s)},async parse(s,t,e){const n=Bd.test(s)?Bd.parse(s):Y_.parse(s),{src:i}=t,{pages:r}=n,o=[],c=n.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let l=0;l<r.length;++l){const p=r[l].file;let b=di.join(di.dirname(i),p);b=Zd(b,i),o.push({src:b,data:c})}const f=await e.load(o),y=o.map(l=>f[l.src]);return new Ty({data:n,textures:y},i)},async load(s,t){return await(await pn.get().fetch(s)).text()},async unload(s,t,e){await Promise.all(s.pages.map(n=>e.unload(n.texture.source._sourceOrigin))),s.destroy()}};class qv{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Zv={extension:{type:Rt.CacheParser,name:"cacheTextureArray"},test:s=>Array.isArray(s)&&s.every(t=>t instanceof te),getCacheableAssets:(s,t)=>{const e={};return s.forEach(n=>{t.forEach((i,r)=>{e[n+(r===0?"":r+1)]=i})}),e}};async function vy(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Qv={extension:{type:Rt.DetectionParser,priority:1},test:async()=>vy("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")},X_=["png","jpg","jpeg"],Jv={extension:{type:Rt.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...X_],remove:async s=>s.filter(t=>!X_.includes(t))},tE="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Uh(s){return tE?!1:document.createElement("video").canPlayType(s)!==""}const eE={extension:{type:Rt.DetectionParser,priority:0},test:async()=>Uh("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")},nE={extension:{type:Rt.DetectionParser,priority:0},test:async()=>Uh("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")},sE={extension:{type:Rt.DetectionParser,priority:0},test:async()=>Uh("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")},iE={extension:{type:Rt.DetectionParser,priority:0},test:async()=>vy("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")},Ey=class wh{constructor(){this.loadOptions={...wh.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,n)=>(this._parsersValidated=!1,t[e]=n,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(async()=>{var o,c;let i=null,r=null;if((e.parser||e.loadParser)&&(r=this._parserHash[e.parser||e.loadParser],e.loadParser&&vn(`[Assets] "loadParser" is deprecated, use "parser" instead for ${t}`),r||vn(`[Assets] specified load parser "${e.parser||e.loadParser}" not found while loading ${t}`)),!r){for(let f=0;f<this.parsers.length;f++){const y=this.parsers[f];if(y.load&&((o=y.test)!=null&&o.call(y,t,e,this))){r=y;break}}if(!r)return vn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await r.load(t,e,this),n.parser=r;for(let f=0;f<this.parsers.length;f++){const y=this.parsers[f];y.parse&&y.parse&&await((c=y.testParse)==null?void 0:c.call(y,i,e,this))&&(i=await y.parse(i,e,this)||i,n.parser=y)}return i})(),n}async load(t,e){this._parsersValidated||this._validateParsers();const n=typeof e=="function"?{...wh.defaultOptions,...this.loadOptions,onProgress:e}:{...wh.defaultOptions,...this.loadOptions,...e||{}},{onProgress:i,onError:r,strategy:o,retryCount:c,retryDelay:f}=n;let y=0;const x={},l=Eh(t),p=Ri(t,u=>({alias:[u],src:u,data:{}})),b=p.reduce((u,w)=>u+(w.progressSize||1),0),_=p.map(async u=>{const w=di.toAbsolute(u.src);x[u.src]||(await this._loadAssetWithRetry(w,u,{onProgress:i,onError:r,strategy:o,retryCount:c,retryDelay:f},x),y+=u.progressSize||1,i&&i(y/b))});return await Promise.all(_),l?x[p[0].src]:x}async unload(t){const n=Ri(t,i=>({alias:[i],src:i})).map(async i=>{var c,f;const r=di.toAbsolute(i.src),o=this.promiseCache[r];if(o){const y=await o.promise;delete this.promiseCache[r],await((f=(c=o.parser)==null?void 0:c.unload)==null?void 0:f.call(c,y,i,this))}});await Promise.all(n)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name||t.id).reduce((t,e)=>(!e.name&&!e.id?vn("[Assets] parser should have an id"):(t[e.name]||t[e.id])&&vn(`[Assets] parser id conflict "${e.id}"`),t[e.name]=e,e.id&&(t[e.id]=e),t),{})}async _loadAssetWithRetry(t,e,n,i){let r=0;const{onError:o,strategy:c,retryCount:f,retryDelay:y}=n,x=l=>new Promise(p=>setTimeout(p,l));for(;;)try{this.promiseCache[t]||(this.promiseCache[t]=this._getLoadPromiseAndParser(t,e)),i[e.src]=await this.promiseCache[t].promise;return}catch(l){delete this.promiseCache[t],delete i[e.src],r++;const p=c!=="retry"||r>f;if(c==="retry"&&!p){o&&o(l,e),await x(y);continue}if(c==="skip"){o&&o(l,e);return}throw o&&o(l,e),new Error(`[Loader.load] Failed to load ${t}.
${l}`)}}};Ey.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let rE=Ey;function va(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Ea(s,t){const e=s.split("?")[0],n=di.extname(e).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const oE=".json",aE="application/json",lE={extension:{type:Rt.LoadParser,priority:so.Low},name:"loadJson",id:"json",test(s){return va(s,aE)||Ea(s,oE)},async load(s){return await(await pn.get().fetch(s)).json()}},cE=".txt",hE="text/plain",uE={name:"loadTxt",id:"text",extension:{type:Rt.LoadParser,priority:so.Low,name:"loadTxt"},test(s){return va(s,hE)||Ea(s,cE)},async load(s){return await(await pn.get().fetch(s)).text()}},dE=["normal","bold","100","200","300","400","500","600","700","800","900"],fE=[".ttf",".otf",".woff",".woff2"],pE=["font/ttf","font/otf","font/woff","font/woff2"],mE=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function _E(s){const t=di.extname(s),i=di.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1));let r=i.length>0;for(const c of i)if(!c.match(mE)){r=!1;break}let o=i.join(" ");return r||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const gE=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function yE(s){return gE.test(s)?s:encodeURI(s)}const xE={extension:{type:Rt.LoadParser,priority:so.Low},name:"loadWebFont",id:"web-font",test(s){return va(s,pE)||Ea(s,fE)},async load(s,t){var n,i,r;const e=pn.get().getFontFaceSet();if(e){const o=[],c=((n=t.data)==null?void 0:n.family)??_E(s),f=((r=(i=t.data)==null?void 0:i.weights)==null?void 0:r.filter(x=>dE.includes(x)))??["normal"],y=t.data??{};for(let x=0;x<f.length;x++){const l=f[x],p=new FontFace(c,`url(${yE(s)})`,{...y,weight:l});await p.load(),e.add(p),o.push(p)}return Tn.has(`${c}-and-url`)?Tn.get(`${c}-and-url`).entries.push({url:s,faces:o}):Tn.set(`${c}-and-url`,{entries:[{url:s,faces:o}]}),o.length===1?o[0]:o}return vn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){const t=Array.isArray(s)?s:[s],e=t[0].family,n=Tn.get(`${e}-and-url`),i=n.entries.find(r=>r.faces.some(o=>t.indexOf(o)!==-1));i.faces=i.faces.filter(r=>t.indexOf(r)===-1),i.faces.length===0&&(n.entries=n.entries.filter(r=>r!==i)),t.forEach(r=>{pn.get().getFontFaceSet().delete(r)}),n.entries.length===0&&Tn.remove(`${e}-and-url`)}};function Mf(s,t=1){var n;const e=(n=Ma.RETINA_PREFIX)==null?void 0:n.exec(s);return e?parseFloat(e[1]):t}function Tf(s,t,e){s.label=e,s._sourceOrigin=e;const n=new te({source:s,label:e}),i=()=>{delete t.promiseCache[e],Tn.has(e)&&Tn.remove(e)};return n.source.once("destroy",()=>{t.promiseCache[e]&&(vn("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),n.once("destroy",()=>{s.destroyed||(vn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),n}const bE=".svg",AE="image/svg+xml",SE={extension:{type:Rt.LoadParser,priority:so.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return va(s,AE)||Ea(s,bE)},async load(s,t,e){var n;return((n=t.data)==null?void 0:n.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?ME(s):wE(s,t,e,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function wE(s,t,e,n){var w,M,v;const i=await pn.get().fetch(s),r=pn.get().createImage();r.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await i.text())}`,r.crossOrigin=n,await r.decode();const o=((w=t.data)==null?void 0:w.width)??r.width,c=((M=t.data)==null?void 0:M.height)??r.height,f=((v=t.data)==null?void 0:v.resolution)||Mf(s),y=Math.ceil(o*f),x=Math.ceil(c*f),l=pn.get().createCanvas(y,x),p=l.getContext("2d");p.imageSmoothingEnabled=!0,p.imageSmoothingQuality="high",p.drawImage(r,0,0,o*f,c*f);const{parseAsGraphicsContext:b,..._}=t.data??{},u=new Po({resource:l,alphaMode:"premultiply-alpha-on-upload",resolution:f,..._});return Tf(u,e,s)}async function ME(s){const e=await(await pn.get().fetch(s)).text(),n=new Ti;return n.svg(e),n}const TE=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let ga=null,hf=class{constructor(){ga||(ga=URL.createObjectURL(new Blob([TE],{type:"application/javascript"}))),this.worker=new Worker(ga)}};hf.revokeObjectURL=function(){ga&&(URL.revokeObjectURL(ga),ga=null)};const vE=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let ya=null;class Cy{constructor(){ya||(ya=URL.createObjectURL(new Blob([vE],{type:"application/javascript"}))),this.worker=new Worker(ya)}}Cy.revokeObjectURL=function(){ya&&(URL.revokeObjectURL(ya),ya=null)};let V_=0,Nd;class EE{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new hf;e.addEventListener("message",n=>{e.terminate(),hf.revokeObjectURL(),t(n.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var n;return this._run("loadImageBitmap",[t,(n=e==null?void 0:e.data)==null?void 0:n.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Nd===void 0&&(Nd=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<Nd&&(this._createdWorkers++,t=new Cy().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){this._resolveHash[t.uuid]&&(t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),delete this._resolveHash[t.uuid])}async _run(t,e){await this._initWorkers();const n=new Promise((i,r)=>{this._queue.push({id:t,arguments:e,resolve:i,reject:r})});return this._next(),n}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),n=e.id;this._resolveHash[V_]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:V_++,id:n})}reset(){this._workerPool.forEach(t=>t.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:t})=>{t==null||t(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const z_=new EE,CE=[".jpeg",".jpg",".png",".webp",".avif"],IE=["image/jpeg","image/png","image/webp","image/avif"];async function PE(s,t){var i;const e=await pn.get().fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const n=await e.blob();return((i=t==null?void 0:t.data)==null?void 0:i.alphaMode)==="premultiplied-alpha"?createImageBitmap(n,{premultiplyAlpha:"none"}):createImageBitmap(n)}const Iy={name:"loadTextures",id:"texture",extension:{type:Rt.LoadParser,priority:so.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return va(s,IE)||Ea(s,CE)},async load(s,t,e){var r;let n=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await z_.isImageBitmapSupported()?n=await z_.loadImageBitmap(s,t):n=await PE(s,t):n=await new Promise((o,c)=>{n=pn.get().createImage(),n.crossOrigin=this.config.crossOrigin,n.src=s,n.complete?o(n):(n.onload=()=>{o(n)},n.onerror=c)});const i=new Po({resource:n,alphaMode:"premultiply-alpha-on-upload",resolution:((r=t.data)==null?void 0:r.resolution)||Mf(s),...t.data});return Tf(i,e,s)},unload(s){s.destroy(!0)}},OE=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let Ud,Wd;function LE(s,t,e){e===void 0&&!t.startsWith("data:")?s.crossOrigin=RE(t):e!==!1&&(s.crossOrigin=typeof e=="string"?e:"anonymous")}function kE(s){return new Promise((t,e)=>{s.addEventListener("canplaythrough",n),s.addEventListener("error",i),s.load();function n(){r(),t()}function i(o){r(),e(o)}function r(){s.removeEventListener("canplaythrough",n),s.removeEventListener("error",i)}})}function RE(s,t=globalThis.location){if(s.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function FE(){const s=[],t=[];for(const e of OE){const n=Pl.MIME_TYPES[e.substring(1)]||`video/${e.substring(1)}`;Uh(n)&&(s.push(e),t.includes(n)||t.push(n))}return{validVideoExtensions:s,validVideoMime:t}}const BE={name:"loadVideo",id:"video",extension:{type:Rt.LoadParser,name:"loadVideo"},test(s){if(!Ud||!Wd){const{validVideoExtensions:n,validVideoMime:i}=FE();Ud=n,Wd=i}const t=va(s,Wd),e=Ea(s,Ud);return t||e},async load(s,t,e){var f,y;const n={...Pl.defaultOptions,resolution:((f=t.data)==null?void 0:f.resolution)||Mf(s),alphaMode:((y=t.data)==null?void 0:y.alphaMode)||await Og(),...t.data},i=document.createElement("video"),r={preload:n.autoLoad!==!1?"auto":void 0,"webkit-playsinline":n.playsinline!==!1?"":void 0,playsinline:n.playsinline!==!1?"":void 0,muted:n.muted===!0?"":void 0,loop:n.loop===!0?"":void 0,autoplay:n.autoPlay!==!1?"":void 0};Object.keys(r).forEach(x=>{const l=r[x];l!==void 0&&i.setAttribute(x,l)}),n.muted===!0&&(i.muted=!0),LE(i,s,n.crossorigin);const o=document.createElement("source");let c;if(n.mime)c=n.mime;else if(s.startsWith("data:"))c=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const x=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();c=Pl.MIME_TYPES[x]||`video/${x}`}return o.src=s,c&&(o.type=c),new Promise(x=>{const l=async()=>{const p=new Pl({...n,resource:i});i.removeEventListener("canplay",l),t.data.preload&&await kE(i),x(Tf(p,e,s))};n.preload&&!n.autoPlay&&i.load(),i.addEventListener("canplay",l),i.appendChild(o)})},unload(s){s.destroy(!0)}},Py={extension:{type:Rt.ResolveParser,name:"resolveTexture"},test:Iy.test,parse:s=>{var t;return{resolution:parseFloat(((t=Ma.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}},NE={extension:{type:Rt.ResolveParser,priority:-2,name:"resolveJson"},test:s=>Ma.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:Py.parse};class UE{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ma,this.loader=new rE,this.cache=Tn,this._backgroundLoader=new qv(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var r,o;if(this._initialized){vn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let c=t.manifest;typeof c=="string"&&(c=await this.load(c)),this.resolver.addManifest(c)}const e=((r=t.texturePreference)==null?void 0:r.resolution)??1,n=typeof e=="number"?[e]:e,i=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:n}}),t.preferences&&this.setPreferences(t.preferences),t.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...t.loadOptions})}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const n=Eh(t),i=Ri(t).map(c=>{if(typeof c!="string"){const f=this.resolver.getAlias(c);return f.some(y=>!this.resolver.hasKey(y))&&this.add(c),Array.isArray(f)?f[0]:f}return this.resolver.hasKey(c)||this.add({alias:c,src:c}),c}),r=this.resolver.resolve(i),o=await this._mapLoadToResolve(r,e);return n?o[i[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let n=!1;typeof t=="string"&&(n=!0,t=[t]);const i=this.resolver.resolveBundle(t),r={},o=Object.keys(i);let c=0;const f=[],y=()=>{e==null||e(f.reduce((l,p)=>l+p,0)/c)},x=o.map((l,p)=>{const b=i[l],_=Object.values(b),w=[...new Set(_.flat())].reduce((M,v)=>M+(v.progressSize||1),0);return f.push(0),c+=w,this._mapLoadToResolve(b,M=>{f[p]=M*w,y()}).then(M=>{r[l]=M})});return await Promise.all(x),n?r[t[0]]:r}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Tn.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=Tn.get(t[n]);return e}async _mapLoadToResolve(t,e){const n=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const i=await this.loader.load(n,e);this._backgroundLoader.active=!0;const r={};return n.forEach(o=>{const c=i[o.src],f=[o.src];o.alias&&f.push(...o.alias),f.forEach(y=>{r[y]=c}),Tn.set(f,c)}),r}async unload(t){this._initialized||await this.init();const e=Ri(t).map(i=>typeof i!="string"?i.src:i),n=this.resolver.resolve(e);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=Ri(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map(i=>this._unloadFromResolved(e[i]));await Promise.all(n)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(n=>{Tn.remove(n.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const n of t.detections)t.skipDetections||await n.test()?e=await n.add(e):t.skipDetections||(e=await n.remove(e));return e=e.filter((n,i)=>e.indexOf(n)===i),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(n=>n in t).forEach(n=>{e.config[n]=t[n]})})}}const _s=new UE;Es.handleByList(Rt.LoadParser,_s.loader.parsers).handleByList(Rt.ResolveParser,_s.resolver.parsers).handleByList(Rt.CacheParser,_s.cache.parsers).handleByList(Rt.DetectionParser,_s.detections);Es.add(Zv,Jv,Qv,iE,eE,nE,sE,lE,uE,xE,SE,Iy,BE,jv,$v,Py,NE);const K_={loader:Rt.LoadParser,resolver:Rt.ResolveParser,cache:Rt.CacheParser,detection:Rt.DetectionParser};Es.handle(Rt.Asset,s=>{const t=s.ref;Object.entries(K_).filter(([e])=>!!t[e]).forEach(([e,n])=>Es.add(Object.assign(t[e],{extension:t[e].extension??n})))},s=>{const t=s.ref;Object.keys(K_).filter(e=>!!t[e]).forEach(e=>Es.remove(t[e]))});const Oy={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},WE=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join(`
`);function DE(s){const t=Oy[s],e=t.length;let n=WE,i="";const r="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;";let o;for(let c=0;c<s;c++){let f=r.replace("%index%",c.toString());o=c,c>=e&&(o=s-c-1),f=f.replace("%value%",t[o].toString()),i+=f,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",s.toString()),n}const GE=`
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;

    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function HE(s,t){const e=Math.ceil(s/2);let n=GE,i="",r;t?r="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":r="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let o=0;o<s;o++){let c=r.replace("%index%",o.toString());c=c.replace("%sampleIndex%",`${o-(e-1)}.0`),i+=c,i+=`
`}return n=n.replace("%blur%",i),n=n.replace("%size%",s.toString()),n=n.replace("%dimension%",t?"z":"w"),n}function YE(s,t){const e=HE(t,s),n=DE(t);return Rh.from({vertex:e,fragment:n,name:`blur-${s?"horizontal":"vertical"}-pass-filter`})}var XE=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;function VE(s,t){const e=Oy[t],n=e.length,i=[],r=[],o=[];for(let l=0;l<t;l++){i[l]=`@location(${l}) offset${l}: vec2<f32>,`,s?r[l]=`filteredCord + vec2(${l-n+1} * pixelStrength, 0.0),`:r[l]=`filteredCord + vec2(0.0, ${l-n+1} * pixelStrength),`;const p=l<n?l:t-l-1,b=e[p].toString();o[l]=`finalColor += textureSample(uTexture, uSampler, offset${l}) * ${b};`}const c=i.join(`
`),f=r.join(`
`),y=o.join(`
`),x=XE.replace("%blur-struct%",c).replace("%blur-vertex-out%",f).replace("%blur-fragment-in%",c).replace("%blur-sampling%",y).replace("%dimension%",s?"z":"w");return Ta.from({vertex:{source:x,entryPoint:"mainVertex"},fragment:{source:x,entryPoint:"mainFragment"}})}const Ly=class ky extends Vg{constructor(t){t={...ky.defaultOptions,...t};const e=YE(t.horizontal,t.kernelSize),n=VE(t.horizontal,t.kernelSize);super({glProgram:e,gpuProgram:n,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...t}),this.horizontal=t.horizontal,this._quality=0,this.quality=t.quality,this.blur=t.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(t,e,n,i){if(this._uniforms.uStrength=this.strength/this.passes,this.passes===1)t.applyFilter(this,e,n,i);else{const r=Sa.getSameSizeTexture(e);let o=e,c=r;this._state.blend=!1;const f=t.renderer.type===Rl.WEBGPU;for(let y=0;y<this.passes-1;y++){t.applyFilter(this,o,c,y===0?!0:f);const x=c;c=o,o=x}this._state.blend=!0,t.applyFilter(this,o,n,i),Sa.returnTexture(r)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}};Ly.defaultOptions={strength:8,quality:4,kernelSize:5};let Dd=Ly;class Co extends Vg{constructor(...t){let e=t[0]??{};typeof e=="number"&&(ae(ze,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),e={strength:e},t[1]!==void 0&&(e.quality=t[1]),t[2]!==void 0&&(e.resolution=t[2]||"inherit"),t[3]!==void 0&&(e.kernelSize=t[3])),e={...Dd.defaultOptions,...e};const{strength:n,strengthX:i,strengthY:r,quality:o,...c}=e;super({...c,compatibleRenderers:Rl.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new Dd({horizontal:!0,...e}),this.blurYFilter=new Dd({horizontal:!1,...e}),this.quality=o,this.strengthX=i??n,this.strengthY=r??n,this.repeatEdgePixels=!1}apply(t,e,n,i){const r=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(r&&o){const c=Sa.getSameSizeTexture(e);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(t,e,c,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(t,c,n,i),Sa.returnTexture(c)}else o?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(t,e,n,i)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(t,e,n,i))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))*2}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get strengthX(){return this.blurXFilter.blur}set strengthX(t){this.blurXFilter.blur=t,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(t){this.blurYFilter.blur=t,this.updatePadding()}get blur(){return ae("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(t){ae("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=t}get blurX(){return ae("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(t){ae("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=t}get blurY(){return ae("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(t){ae("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}Co.defaultOptions={strength:8,quality:4,kernelSize:5};class xt extends mf{constructor(t){t instanceof Ti&&(t={context:t});const{context:e,roundPixels:n,...i}=t||{};super({label:"Graphics",...i}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new Ti,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=n??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new xt(this._context.clone()):(this._ownedContext=null,new xt(this._context))}lineStyle(t,e,n){ae(ze,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return t&&(i.width=t),e&&(i.color=e),n&&(i.alpha=n),this.context.strokeStyle=i,this}beginFill(t,e){ae(ze,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const n={};return t!==void 0&&(n.color=t),e!==void 0&&(n.alpha=e),this.context.fillStyle=n,this}endFill(){ae(ze,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==Ti.defaultStrokeStyle.width||t.color!==Ti.defaultStrokeStyle.color||t.alpha!==Ti.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return ae(ze,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return ae(ze,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return ae(ze,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return ae(ze,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return ae(ze,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return ae(ze,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class Gl extends Se{constructor(...t){let e=t[0];Array.isArray(t[0])&&(e={textures:t[0],autoUpdate:t[1]});const{animationSpeed:n=1,autoPlay:i=!1,autoUpdate:r=!0,loop:o=!0,onComplete:c=null,onFrameChange:f=null,onLoop:y=null,textures:x,updateAnchor:l=!1,...p}=e,[b]=x;super({...p,texture:b instanceof te?b:b.texture}),this._textures=null,this._durations=null,this._autoUpdate=r,this._isConnectedToTicker=!1,this.animationSpeed=n,this.loop=o,this.updateAnchor=l,this.onComplete=c,this.onFrameChange=f,this.onLoop=y,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=x,i&&this.play()}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(to.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(to.shared.add(this.update,this,vh.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;const e=t.deltaTime,n=this.animationSpeed*e,i=this.currentFrame;if(this._durations!==null){let r=this._currentTime%1*this._durations[this.currentFrame];for(r+=n/60*1e3;r<0;)this._currentTime--,r+=this._durations[this.currentFrame];const o=Math.sign(this.animationSpeed*e);for(this._currentTime=Math.floor(this._currentTime);r>=this._durations[this.currentFrame];)r-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=r/this._durations[this.currentFrame]}else this._currentTime+=n;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this._updateTexture())}_updateTexture(){const t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this.texture=this._textures[t],this.updateAnchor&&this.texture.defaultAnchor&&this.anchor.copyFrom(this.texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t=!1){if(typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._textures.forEach(i=>{this.texture!==i&&i.destroy(n)})}this._textures=[],this._durations=null,this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){const e=[];for(let n=0;n<t.length;++n)e.push(te.from(t[n]));return new Gl(e)}static fromImages(t){const e=[];for(let n=0;n<t.length;++n)e.push(te.from(t[n]));return new Gl(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof te)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this._updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);const e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this._updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(to.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(to.shared.add(this.update,this),this._isConnectedToTicker=!0))}}class zE extends mf{constructor(t,e){const{text:n,resolution:i,style:r,anchor:o,width:c,height:f,roundPixels:y,...x}=t;super({...x}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=n??"",this.style=r,this.resolution=i??null,this.allowChildren=!1,this._anchor=new vs({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=y??!1,c!==void 0&&(this.width=c),f!==void 0&&(this.height=f)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,n=this.bounds.height,i=-e*this.anchor.x;let r=0;return t.x>=i&&t.x<=i+e&&(r=-n*this.anchor.y,t.y>=r&&t.y<=r+n)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function KE(s,t){let e=s[0]??{};return(typeof e=="string"||s[1])&&(ae(ze,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:s[1]}),e}let wo=null,Tr=null;function $E(s,t){wo||(wo=pn.get().createCanvas(256,128),Tr=wo.getContext("2d",{willReadFrequently:!0}),Tr.globalCompositeOperation="copy",Tr.globalAlpha=1),(wo.width<s||wo.height<t)&&(wo.width=xa(s),wo.height=xa(t))}function $_(s,t,e){for(let n=0,i=4*e*t;n<t;++n,i+=4)if(s[i+3]!==0)return!1;return!0}function j_(s,t,e,n,i){const r=4*t;for(let o=n,c=n*r+4*e;o<=i;++o,c+=r)if(s[c+3]!==0)return!1;return!0}function jE(...s){let t=s[0];t.canvas||(t={canvas:s[0],resolution:s[1]});const{canvas:e}=t,n=Math.min(t.resolution??1,1),i=t.width??e.width,r=t.height??e.height;let o=t.output;if($E(i,r),!Tr)throw new TypeError("Failed to get canvas 2D context");Tr.drawImage(e,0,0,i,r,0,0,i*n,r*n);const f=Tr.getImageData(0,0,i,r).data;let y=0,x=0,l=i-1,p=r-1;for(;x<r&&$_(f,i,x);)++x;if(x===r)return oe.EMPTY;for(;$_(f,i,p);)--p;for(;j_(f,i,y,x,p);)++y;for(;j_(f,i,l,x,p);)--l;return++l,++p,Tr.globalCompositeOperation="source-over",Tr.strokeRect(y,x,l-y,p-x),Tr.globalCompositeOperation="copy",o??(o=new oe),o.set(y/n,x/n,(l-y)/n,(p-x)/n),o}const q_=new oe;class qE{getCanvasAndContext(t){const{text:e,style:n,resolution:i=1}=t,r=n._getFinalPadding(),o=nr.measureText(e||" ",n),c=Math.ceil(Math.ceil(Math.max(1,o.width)+r*2)*i),f=Math.ceil(Math.ceil(Math.max(1,o.height)+r*2)*i),y=Dl.getOptimalCanvasAndContext(c,f);this._renderTextToCanvas(e,n,r,i,y);const x=n.trim?jE({canvas:y.canvas,width:c,height:f,resolution:1,output:q_}):q_.set(0,0,c,f);return{canvasAndContext:y,frame:x}}returnCanvasAndContext(t){Dl.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,n,i,r){var I,L,K,W;const{canvas:o,context:c}=r,f=Ch(e),y=nr.measureText(t||" ",e),x=y.lines,l=y.lineHeight,p=y.lineWidths,b=y.maxLineWidth,_=y.fontProperties,u=o.height;if(c.resetTransform(),c.scale(i,i),c.textBaseline=e.textBaseline,(I=e._stroke)!=null&&I.width){const U=e._stroke;c.lineWidth=U.width,c.miterLimit=U.miterLimit,c.lineJoin=U.join,c.lineCap=U.cap}c.font=f;let w,M;const v=e.dropShadow?2:1;for(let U=0;U<v;++U){const gt=e.dropShadow&&U===0,J=gt?Math.ceil(Math.max(1,u)+n*2):0,at=J*i;if(gt){c.fillStyle="black",c.strokeStyle="black";const Et=e.dropShadow,bt=Et.color,Ye=Et.alpha;c.shadowColor=ss.shared.setValue(bt).setAlpha(Ye).toRgbaString();const ft=Et.blur*i,At=Et.distance*i;c.shadowBlur=ft,c.shadowOffsetX=Math.cos(Et.angle)*At,c.shadowOffsetY=Math.sin(Et.angle)*At+at}else{if(c.fillStyle=e._fill?Oh(e._fill,c,y,n*2):null,(L=e._stroke)!=null&&L.width){const Et=e._stroke.width*.5+n*2;c.strokeStyle=Oh(e._stroke,c,y,Et)}c.shadowColor="black"}let it=(l-_.fontSize)/2;l-_.fontSize<0&&(it=0);const Nt=((K=e._stroke)==null?void 0:K.width)??0;for(let Et=0;Et<x.length;Et++)w=Nt/2,M=Nt/2+Et*l+_.ascent+it,e.align==="right"?w+=b-p[Et]:e.align==="center"&&(w+=(b-p[Et])/2),(W=e._stroke)!=null&&W.width&&this._drawLetterSpacing(x[Et],e,r,w+n,M+n-J,!0),e._fill!==void 0&&this._drawLetterSpacing(x[Et],e,r,w+n,M+n-J)}}_drawLetterSpacing(t,e,n,i,r,o=!1){const{context:c}=n,f=e.letterSpacing;let y=!1;if(nr.experimentalLetterSpacingSupported&&(nr.experimentalLetterSpacing?(c.letterSpacing=`${f}px`,c.textLetterSpacing=`${f}px`,y=!0):(c.letterSpacing="0px",c.textLetterSpacing="0px")),f===0||y){o?c.strokeText(t,i,r):c.fillText(t,i,r);return}let x=i;const l=nr.graphemeSegmenter(t);let p=c.measureText(t).width,b=0;for(let _=0;_<l.length;++_){const u=l[_];o?c.strokeText(u,x,r):c.fillText(u,x,r);let w="";for(let M=_+1;M<l.length;++M)w+=l[M];b=c.measureText(w).width,x+=p-b+f,p=b}}}const Z_=new qE;class yt extends zE{constructor(...t){const e=KE(t,"Text");super(e,_e),this.renderPipeId="text",e.textureStyle&&(this.textureStyle=e.textureStyle instanceof ba?e.textureStyle:new ba(e.textureStyle))}updateBounds(){const t=this._bounds,e=this._anchor;let n=0,i=0;if(this._style.trim){const{frame:r,canvasAndContext:o}=Z_.getCanvasAndContext({text:this.text,style:this._style,resolution:1});Z_.returnCanvasAndContext(o),n=r.width,i=r.height}else{const r=nr.measureText(this._text,this._style);n=r.width,i=r.height}t.minX=-e._x*n,t.maxX=t.minX+n,t.minY=-e._y*i,t.maxY=t.minY+i}}Es.add(zS,KS);function Ry(s){const t=(s||"en").toLowerCase();return t==="tr"||t.startsWith("tr-")?!1:["en","es","fr","de","it","pt","nl","sv","da","no","fi","id","tl","pl","cs","sk","hu","ro"].some(n=>t===n||t.startsWith(n+"-"))}function Li(s){return Ry(s)?'"Micro5"':ki(s)}function Q_(s){return Ry(s)?'"Micro5"':ki(s)}function Fy(s){switch(s){case"ar":return{fontSizeMul:.8,letterSpacing:0,lineHeightMul:1.15,uppercase:!1};case"hi":return{fontSizeMul:.6,letterSpacing:0,lineHeightMul:1.2,uppercase:!1};case"zh":return{fontSizeMul:.8,letterSpacing:0,lineHeightMul:1.2,uppercase:!1};case"ja":return{fontSizeMul:.7,letterSpacing:-1,lineHeightMul:1.1,uppercase:!1};case"ko":return{fontSizeMul:.8,letterSpacing:0,lineHeightMul:1.1,uppercase:!1};case"tr":return{fontSizeMul:1.1,letterSpacing:0,lineHeightMul:1.1,uppercase:!1};case"vi":return{fontSizeMul:.7,letterSpacing:0,lineHeightMul:1.1,uppercase:!0};case"ru":return{fontSizeMul:.7,letterSpacing:1,lineHeightMul:1.05,uppercase:!0};default:return{fontSizeMul:1,letterSpacing:2,lineHeightMul:1,uppercase:!0}}}function Re(s){const t=Pe();return Fy(t).uppercase?s.toUpperCase():s}function we(s){const t=Pe(),e=Fy(t),n={...s};return n.fontFamily=ki(t),typeof n.fontSize=="number"&&(n.fontSize=Math.round(n.fontSize*e.fontSizeMul)),n.letterSpacing!=null&&(n.letterSpacing=e.letterSpacing),typeof n.lineHeight=="number"&&(n.lineHeight=Math.round(n.lineHeight*e.lineHeightMul)),n}let By=1,Ny=1;function ZE(s,t=s){By=s,Ny=t}function QE(s){return Math.random}function Uy(s,t){return{x:s%t,y:Math.floor(s/t)}}function Lh(s,t,e){return t*e+s}function Wy(s,t,e,n){return s>=0&&s<e&&t>=0&&t<n}function Dy(s,t){let e=0;for(const r in s)e+=s[r];const n=t()*e;let i=0;for(const r in s)if(i+=s[r],n<=i)return r;return Object.keys(s)[0]}function JE(s,t,e){let n=0;for(let r=0;r<t.length;r++)n+=t[r];if(n<=0)return s[Math.floor(e()*s.length)];let i=e()*n;for(let r=0;r<s.length;r++)if(i-=t[r],i<=0)return s[r];return s[s.length-1]}function Gd(s){let t=0;for(let e=0;e<s.length;e++)s[e].id==="S1"&&t++;return t}function tC(s,t,e){if(s==="S1"||s==="W1")return 0;const n=s.startsWith("L"),i=Number(s.slice(1))-1,r=e.find(o=>t>=o.min&&t<=o.max)??e[0];return n?r.L[i]??0:r.H[i]??0}function eC(s,t,e,n){const i=t*e,r=new Array(i).fill(!1),o=[],c=l=>s[l].id,f=["L1","L2","L3","L4","H1","H2","H3","H4","H5"];for(const l of f){r.fill(!1);for(let p=0;p<i;p++){if(r[p])continue;const b=c(p);if(!(b===l||b==="W1")){r[p]=!0;continue}const u=[p],w=[];for(r[p]=!0;u.length;){const M=u.pop();w.push(M);const{x:v,y:I}=Uy(M,t),L=[{x:v+1,y:I},{x:v-1,y:I},{x:v,y:I+1},{x:v,y:I-1}];for(const K of L){if(!Wy(K.x,K.y,t,e))continue;const W=Lh(K.x,K.y,t);if(r[W])continue;const U=c(W);(U===l||U==="W1")&&(r[W]=!0,u.push(W))}}w.length>=5&&o.push({id:l,positions:w,size:w.length,payoutX:tC(l,w.length,n)})}}o.sort((l,p)=>p.payoutX-l.payoutX||p.size-l.size);const y=new Set,x=[];for(const l of o)l.positions.some(p=>y.has(p))||(l.positions.forEach(p=>y.add(p)),x.push(l));return x}function nC(s,t,e,n,i,r){const o=n*i,c=new Array(o).fill(null);for(let f=0;f<n;f++){const y=[];for(let x=i-1;x>=0;x--){const l=Lh(f,x,n);t.has(l)||y.push({id:s[l].id})}for(;y.length<i;)y.push({id:Dy(e,r)});for(let x=i-1;x>=0;x--)c[Lh(f,x,n)]=y[i-1-x]}return c}function sC(s,t,e,n){const i=t*e;return Array.from({length:i},()=>({id:Dy(s,n)}))}function iC(s,t,e,n,i){var tt;const r=QE(),o=!0,c=1;let f=0;globalThis.__SIM_VER__||(globalThis.__SIM_VER__=!0,console.log("[SIM] simulateSpin running ✅"));const y=s.COLS,x=s.ROWS,l=s.LADDER,p=s.MAX_TUMBLES,b=s.TOTAL_WINX_CAP,_=s.SCATTER_THRESHOLD,u=s.FS_AWARD_BASE??10,w=s.FS_AWARD_FS??5,M=s.FS_TOTAL_CAP??20,v=2,I=1.6,L=1,W={...t==="FREE_SPINS"?s.WEIGHTS_FS:s.WEIGHTS_BASE};t==="BASE"&&s.SCATTER_WEIGHT_MUL_BASE&&(W.S1=W.S1*s.SCATTER_WEIGHT_MUL_BASE);let U=sC(W,y,x,r);const gt=U.map(Z=>({id:Z.id}));t==="BASE"&&!globalThis.__SC_MUL_ONCE__&&(globalThis.__SC_MUL_ONCE__=!0,console.log("[SIM] BASE scatter mul =",s.SCATTER_WEIGHT_MUL_BASE,"S1 effective =",W.S1));let J=0;const at=Gd(U);let it=at;at>=_&&(J+=t==="BASE"?u:w);const Nt=[];let Et=t==="FREE_SPINS"?n:0,bt=0,Ye=!1,ft=!1;for(let Z=0;Z<p;Z++){const j=eC(U,y,x,s.PAY_BANDS);if(j.length&&(Ye=!0),!j.length){if(Ye&&o&&f<c){const Le=U.map(Pn=>({id:Pn.id})),$e=U.map((Pn,ei)=>ei).filter(Pn=>U[Pn].id!=="W1"&&U[Pn].id!=="S1");if($e.length>0){const Pn=[];for(const _n of $e){const{x:Fe,y:Pt}=Uy(_n,y),Wn=[{x:Fe+1,y:Pt},{x:Fe-1,y:Pt},{x:Fe,y:Pt+1},{x:Fe,y:Pt-1}];let Dn=0,Vn=0;for(const hs of Wn){if(!Wy(hs.x,hs.y,y,x))continue;const On=Lh(hs.x,hs.y,y),Me=U[On].id;Me.startsWith("H")?Dn++:Me==="W1"&&Vn++}const Bs=1+Dn*6+Vn*1;Pn.push(Bs)}const ei=JE($e,Pn,r);U[ei]={id:"W1"},f++;const Ee=U.map(_n=>({id:_n.id}));Nt.push({grid:Le,nextGrid:Ee,clusters:[],explodePositions:[],multiplier:1,stepWinX:0,aftershockWildSpawned:!0,aftershockWildIndex:ei});continue}}break}let It=0;for(const Le of j){let $e=0;for(const Pn of Le.positions)((tt=U[Pn])==null?void 0:tt.id)==="W1"&&$e++;$e>=v&&(Le.payoutX*=I,It++)}const G=t==="FREE_SPINS"?Ny:By;globalThis.__RTP_SCALE_ONCE__||(globalThis.__RTP_SCALE_ONCE__=!0);for(const Le of j)Le.payoutX*=G;let Y=Et,Ft=!1;const fe=Gd(U);let ve=0;ft||j.length>0&&fe===2&&(Y=Et+L,ft=!0,Ft=!0,ve=fe);const Ke=l[Math.min(Y,l.length-1)]??1,Qe=j.reduce((Le,$e)=>Le+$e.payoutX,0)*Ke,ue=new Set;for(const Le of j)for(const $e of Le.positions)ue.add($e);const mn=Array.from(new Set(j.flatMap(Le=>Le.positions))),xe=nC(U,ue,W,y,x,r),cn=Gd(xe);cn>=_&&it<_&&(J+=t==="BASE"?u:w),it=cn,Nt.push({grid:U,nextGrid:xe,clusters:j,explodePositions:mn,multiplier:Ke,stepWinX:Qe,scatterInfusionUsed:Ft,infusedScatters:ve,enchantedClusters:It,enchantedWildUsed:It>0}),bt+=Qe,U=xe,Et++}bt=Math.min(bt,b);const P=Math.max(0,e-(t==="FREE_SPINS"?1:0))+J,ot=Math.min(M,P);return{mode:t,initialGrid:gt,steps:Nt,totalWinX:bt,fsAwarded:J,fsRemainingAfter:ot,ladderIndexAfter:Et}}const rC=.5,oC=.48;function Js({app:s,IS_TOUCH:t}){const e=s.screen.width,n=s.screen.height,i=e/n;return!!t||e<820||i<.9}function He({app:s,LOCK_MOBILE_TO_PORTRAIT:t,IS_TOUCH:e}){if(t&&Js({app:s,IS_TOUCH:e}))return!0;const n=s.screen.width,i=s.screen.height,r=n/i;return(n<820||r<.9)&&i>=n}function ln({app:s,LOCK_MOBILE_TO_PORTRAIT:t,IS_TOUCH:e}){return t&&Js({app:s,IS_TOUCH:e})?!1:Js({app:s,IS_TOUCH:e})&&s.screen.width>s.screen.height}function no(s){return Js(s)}function Hd(s,t,e){no(s)||(t.cursor=e)}function xh(s){return He(s)}function ns(s){return new Promise(t=>setTimeout(t,s))}function aC(s,t=.18){s=Math.max(0,Math.min(1,s));const e=s*s*(3-2*s);return s+(e-s)*t}function Hs(s){return 1-Math.pow(1-s,3)}function pa(s){return s*s*s}function ms(s,t=1.18){const e=t;return 1+(e+1)*Math.pow(s-1,3)+e*Math.pow(s-1,2)}function ye(s,t,e,n=Hs){const i=performance.now();function r(o){const c=Math.min(1,(o-i)/s),f=n(c);t(f),c<1?requestAnimationFrame(r):e==null||e()}requestAnimationFrame(r)}function ke(s,t){return new Promise(e=>{const n=performance.now(),i=r=>{const o=(r-n)/s,c=Math.max(0,Math.min(1,o));t(c),c<1?requestAnimationFrame(i):e()};requestAnimationFrame(i)})}const uf=[];let J_=!1;function fn(s){return uf.push(s),s}function lC(s){J_||(J_=!0,s.ticker.add(()=>{const t=Math.min(.05,s.ticker.deltaMS/1e3);for(let e=0;e<uf.length;e++)uf[e](t)}))}const In=[1,2,3,5,8,12,20],cC=1.12,vf={L1:22,L2:20,L3:18,L4:16,H1:8,H2:7,H3:6,H4:5,H5:2,W1:7,S1:1},hC={...vf,W1:9,S1:2},Mh={L1:"symbol_low_L1_gummy.png",L2:"symbol_low_L2_gummy.png",L3:"symbol_low_L3_gummy.png",L4:"symbol_low_L4_gummy.png",H1:"symbol_high_H1_choco.png",H2:"symbol_high_H2_choco.png",H3:"symbol_high_H3_hard.png",H4:"symbol_high_H4_hard.png",H5:"symbol_high_H5_hard.png",W1:"symbol_wild_W1_gummy.png",S1:"symbol_scatter_S1_gold.png"},uC=[{min:5,max:6,L:[.4,.55,.75,1],H:[.6,.85,1.15,1.55,2]},{min:7,max:8,L:[.85,1.1,1.55,2.1],H:[1.3,1.8,2.45,3.3,4.3]},{min:9,max:10,L:[1.2,1.6,2.25,3],H:[2,2.9,4.1,5.8,7.5]},{min:11,max:12,L:[2,2.7,3.8,5],H:[3.1,4.7,6.8,9.8,12.5]},{min:13,max:15,L:[3.6,4.8,6.8,8.8],H:[4.8,7.6,11.5,16,20]},{min:16,max:19,L:[6.6,8.8,12.6,16],H:[9.5,15.8,25,37,47]},{min:20,max:999,L:[12.5,17.5,25,33],H:[18.5,31,56,96,120]}];function dC(s){const{COLS:t,ROWS:e,fsTotalCap:n}=s;return{COLS:t,ROWS:e,LADDER:In,WEIGHTS_BASE:vf,WEIGHTS_FS:hC,PAY_BANDS:uC,SYMBOL_FRAMES:Mh,SCATTER_WEIGHT_MUL_BASE:cC,MAX_TUMBLES:25,TOTAL_WINX_CAP:1e4,SCATTER_THRESHOLD:3,FS_AWARD_BASE:10,FS_AWARD_FS:5,FS_TOTAL_CAP:n}}function fC(s){var pi,Cs,ni,Ir,Ln,Vs;const{app:t,root:e,state:n,uiDimmer:i,settingsBtnPixi:r,onClosed:o,texUI:c,setScaleToHeight:f,makePngButton:y,ICON_INFO:x,ICON_SFX_ON:l,ICON_SFX_OFF:p,ICON_MUSIC_ON:b,ICON_MUSIC_OFF:_,CLOSE_UP:u,CLOSE_HOVER:w,CLOSE_DOWN:M,getSfxMuted:v,setSfxMuted:I,getMusicMuted:L,setMusicMuted:K,applyAudioUI:W,makeSlider:U,getSfxValue01:gt,getMusicValue01:J,setSfxValue01:at,setMusicValue01:it,t:Nt}=s,Et=(pt,Dt)=>(Nt==null?void 0:Nt(pt))??Dt,bt=(pt,Dt)=>Re(Et(pt,Dt)),Ye=pt=>{const Dt=we(pt);return Dt.fontFamily=Li(Pe()),Dt},ft=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||((Cs=(pi=window.matchMedia)==null?void 0:pi.call(window,"(pointer: coarse)"))==null?void 0:Cs.matches);function At(){const pt=t.screen.width,Dt=t.screen.height,qt=pt/Dt;return(!!ft||pt<820||qt<.9)&&pt>Dt}const P=new st;P.zIndex=9e3,e.addChild(P),P.visible=!1,P.eventMode="static",P.cursor="default";const ot=new st;ot.zIndex=9500,ot.visible=!1,ot.eventMode="static",P.addChild(ot);const tt=new xt;tt.eventMode="static",tt.cursor="default",tt.on("pointertap",()=>Pn()),ot.addChild(tt);const Z=new xt;ot.addChild(Z);const j=new yt(bt("ui.gameInfoTitle","BLOCKY FARM – GAME INFO"),new _e(Ye({fontSize:38,fill:16765802,letterSpacing:2,stroke:{color:0,width:4}})));j.anchor.set(.5,0),ot.addChild(j);const It=`
GAME RULES
Blocky Farm is a tumbling slot game using cluster pays.
A win is formed when 5 or more identical symbols connect anywhere on the grid.

Winning symbols explode and are removed. New symbols fall into place and may create
additional wins in the same spin. This continues until no further wins occur.

WAYS TO WIN
• Land 5 or more matching symbols to win
• Winning symbols tumble and can trigger multiple wins per spin
• Wilds substitute for all regular symbols except bonus symbols

GLOBAL MULTIPLIER
• Starts at 1× on every spin
• Increases by +1 after each winning tumble
• Applies to all wins during the spin
• Resets at the end of the spin

ENCHANTED WILDS
• Substitute for regular symbols
• May persist across tumbles
• Help extend winning sequences

INFUSED SCATTERS
• Contribute to triggering the Bonus Game
• Charge additional effects when collected
• Enhance the Bonus Game when activated

BONUS GAME
• Triggered by Scatter symbols
• Awards Free Spins
• Uses the same tumbling mechanics
• Features remain active during the bonus

PAYTABLE
Payouts depend on symbol type, cluster size, and multiplier.
Exact values are shown in the Paytable section.

GENERAL TERMS
• All wins are paid according to the paytable
• Malfunctions void all pays
• Incomplete games may be resumed
`,G=new yt(It,new _e({fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",fontSize:20,fill:16777215,align:"center",wordWrap:!0,wordWrapWidth:760,lineHeight:30}));G.anchor.set(.5,0);const Y=new st;ot.addChild(Y);const Ft=new xt;ot.addChild(Ft),Y.addChild(G),Y.mask=Ft;let fe=0,ve=0,Ke=0,Ut=0,Qe=0,ue=!1,mn=0,xe=0;Z.eventMode="static",Z.on("pointerdown",pt=>{ue=!0,mn=pt.global.y,xe=fe}),Z.on("pointerup",()=>ue=!1),Z.on("pointerupoutside",()=>ue=!1),Z.on("pointermove",pt=>{if(!ue)return;const Dt=pt.global.y-mn;cn(xe+Dt)});function cn(pt){const Dt=G.height,qt=Math.min(0,Qe-Dt);pt<qt&&(pt=qt),pt>0&&(pt=0),fe=pt,Y.y=Math.round(Ke+fe)}window.addEventListener("wheel",pt=>{ot.visible&&cn(fe-pt.deltaY)},{passive:!0});const Le=new xt;Le.eventMode="static",Le.cursor="pointer",Le.on("pointertap",()=>Pn()),ot.addChild(Le);function $e(){ot.visible=!0,ei()}function Pn(){ot.visible=!1}function ei(){const pt=t.screen.width,Dt=t.screen.height;tt.clear(),tt.rect(0,0,pt,Dt).fill({color:0,alpha:.7});const qt=Math.min(900,Math.round(pt*.9)),zt=Math.min(700,Math.round(Dt*.85)),hn=(pt-qt)/2,zn=(Dt-zt)/2;Z.clear(),Z.roundRect(hn,zn,qt,zt,16).fill({color:723723,alpha:.95}).stroke({width:2,color:11579568,alpha:.35}),j.x=pt/2,j.y=zn+20;const ge=30,kn=90;ve=hn+ge,Ke=zn+kn,Ut=qt-ge*2,Qe=zt-kn-ge,Y.x=ve,G.style.wordWrapWidth=Ut,G.x=Math.round(Ut/2),G.y=0,Ft.clear(),Ft.rect(ve,Ke,Ut,Qe).fill({color:16777215,alpha:1}),cn(fe);const rs=hn+qt-30,ys=zn+30;Le.clear(),Le.circle(rs,ys,16).fill({color:0,alpha:.4}).stroke({width:2,color:16777215,alpha:.8}).moveTo(rs-6,ys-6).lineTo(rs+6,ys+6).moveTo(rs+6,ys-6).lineTo(rs-6,ys+6).stroke({width:3,color:16777215})}let Ee=new oe;const _n=new xt;P.addChild(_n);const Fe=new xt;P.addChild(Fe),Fe.eventMode="static",Fe.cursor="default",Fe.on("pointerdown",pt=>{var Dt;return(Dt=pt.stopPropagation)==null?void 0:Dt.call(pt)}),Fe.on("pointertap",pt=>{var Dt;return(Dt=pt.stopPropagation)==null?void 0:Dt.call(pt)});const Pt=new st;P.addChild(Pt);const Wn=new xt;Pt.addChild(Wn),Wn.alpha=0;const Dn=new Se(c(x));Dn.anchor.set(.5),Dn.eventMode="none";const Vn=new yt({text:bt("ui.info","INFO"),style:Ye({fill:16765802,fontSize:35,fontWeight:"100",letterSpacing:2,stroke:{color:0,width:4}})});Vn.anchor.set(0,.5),Vn.eventMode="none",Pt.addChild(Dn,Vn),Pt.eventMode="static",Pt.cursor="pointer",Pt.on("pointertap",pt=>{var Dt;(Dt=pt.stopPropagation)==null||Dt.call(pt),$e()}),Pt.on("pointerover",()=>{Wn.alpha=.35}),Pt.on("pointerout",()=>{Wn.alpha=0});function Xs(pt,Dt,qt){const zt=Math.round(qt*.86),hn=At()?56:70,zn=18,ge=-zt/2+48,kn=ge+34;Pt.x=pt-12,Pt.y=Dt,Wn.clear(),Wn.roundRect(-zt/2,-hn/2,zt,hn,zn).fill(0),Pt.hitArea=new oe(-zt/2,-hn/2,zt,hn),Dn.x=ge,Dn.y=0,Vn.x=kn,Vn.y=0}const Bs=y(u,w,M,()=>Je());P.addChild(Bs);const hs=200;Bs.hitArea=new oe(-hs/2,-hs/2,hs,hs);const On=U(l,p,gt(),pt=>{var qt;at(pt);const Dt=pt<=.001;I(Dt),(qt=On.setMuted)==null||qt.call(On,v()),W()}),Me=U(b,_,J(),pt=>{var qt;it(pt);const Dt=pt<=.001;K(Dt),(qt=Me.setMuted)==null||qt.call(Me,L()),W()});(ni=On.bindIconTap)==null||ni.call(On,()=>{var pt;I(!v()),(pt=On.setMuted)==null||pt.call(On,v()),W()}),(Ir=Me.bindIconTap)==null||Ir.call(Me,()=>{var pt;K(!L()),(pt=Me.setMuted)==null||pt.call(Me,L()),W()});function is(){const pt=new st,Dt=new xt;return pt.addChild(Dt),Dt.visible=!0,Dt.alpha=0,pt.eventMode="static",pt.cursor="pointer",pt.on("pointerover",()=>{Dt.alpha=.35}),pt.on("pointerout",()=>{Dt.alpha=0}),pt.on("pointertap",qt=>{var zt;return(zt=qt.stopPropagation)==null?void 0:zt.call(qt)}),pt._bg=Dt,pt}const on=is(),pe=is();on.addChild(On),pe.addChild(Me),P.addChild(on,pe);function Ce(){var rr;const pt=At();_n.clear(),_n.rect(0,0,t.screen.width,t.screen.height).fill({color:0,alpha:.001}),_n.eventMode="static",_n.cursor="default",(rr=_n.removeAllListeners)==null||rr.call(_n,"pointertap"),_n.on("pointertap",()=>Je());const Dt=t.screen.width,qt=t.screen.height,zt=(Dt<820||Dt/qt<.9)&&qt>=Dt,hn=pt?Math.min(980,Math.round(Dt*.88)):zt?Math.min(900,Math.round(Dt*.72)):Math.min(520,Math.round(Dt*.55)),zn=pt?Math.min(280,Math.round(qt*.6)):zt?Math.min(520,Math.round(qt*.52)):Math.min(420,Math.round(qt*.35)),ge=0,kn=Math.round(t.screen.width/2),rs=Math.round(t.screen.height/2)-20;Fe.clear(),Fe.roundRect(kn-hn/2,rs-zn/2,hn,zn,ge).fill({color:723723,alpha:.75}).stroke({width:2,color:11579568,alpha:.35}),Ee.x=kn-hn/2,Ee.y=rs-zn/2,Ee.width=hn,Ee.height=zn;let ys,zs,xs;if(pt)ys=Math.round(rs-zn/2+56),zs=Math.round(ys+66),xs=Math.round(zs+66);else{const Zn=zt?90:110,Ci=zt?60:80,Ct=rs-zn/2+Zn,mi=(rs+zn/2-Ci-Ct)/2;ys=Math.round(Ct+mi*0),zs=Math.round(Ct+mi*1),xs=Math.round(Ct+mi*2)}Xs(kn,ys,hn),on.x=kn,on.y=zs,pe.x=kn,pe.y=xs,on.x=kn,on.y=zs,pe.x=kn,pe.y=xs;const Gn=Math.round(hn*.86),sr=pt?56:70,io=pt?74:40,Pr=pt?34:40,si=Gn-io-Pr-60;function Or(Zn){const Ci=Zn._bg;Ci.clear(),Ci.roundRect(-Gn/2,-sr/2,Gn,sr,18).fill(0),Zn.hitArea=new oe(-Gn/2,-sr/2,Gn,sr)}Or(on),Or(pe);const ir=-Gn/2+io;On.layout(ir,0,si),Me.layout(ir,0,si),Bs.x=kn+hn/2-36,Bs.y=rs-zn/2+36,f(Bs,zn*.07)}function Xe(){Vn.text=bt("ui.info","INFO"),j.text=bt("ui.gameInfoTitle","BLOCKY FARM – GAME INFO"),P.visible=!0,Ce()}function fi(){P.visible=!1}function Je(){Pn(),n.ui.settingsOpen&&(n.ui.settingsOpen=!1,r.setOn(!1),fi(),i.visible=!1,o())}return window.addEventListener("resize",Ce),Ce(),(Ln=On.setMuted)==null||Ln.call(On,v()),(Vs=Me.setMuted)==null||Vs.call(Me,L()),W(),{layer:P,layout:Ce,open:Xe,close:fi,closeFromOutside:Je}}function pC(s){var ro,oo;let t=!1,e=0;const{app:n,root:i,state:r,audio:o,texExtra:c,setScaleToHeight:f,makePngButton:y,t:x,fmtMoney:l,updateBetUI:p,refreshSpinAffordability:b,enterFreeSpins:_,CLOSE_UP:u,CLOSE_HOVER:w,CLOSE_DOWN:M,BET_DOWN_UP:v,BET_DOWN_HOVER:I,BET_DOWN_DOWN:L,BET_UP_UP:K,BET_UP_HOVER:W,BET_UP_DOWN:U,waitMs:gt,animateMs:J,tween:at,easeOutCubic:it,easeOutBack:Nt,easeInCubic:Et}=s,bt=(H,V)=>(x==null?void 0:x(H))??V,Ye=(H,V)=>Re(bt(H,V));function ft(){var V,St;const H=Li(Pe());Me.style.fontFamily=H,is.style.fontFamily=H,on.style.fontFamily=H,pe.style.fontFamily=H;for(const mt of Gn){const wt=mt==null?void 0:mt._body;wt&&(wt.style.fontFamily=H);const he=mt==null?void 0:mt._price;he&&(he.style.fontFamily=H);const Gt=mt==null?void 0:mt._buyBtn,ie=(V=Gt==null?void 0:Gt.children)==null?void 0:V.find(re=>re instanceof yt);ie&&(ie.style.fontFamily=H)}{const mt=(St=zt==null?void 0:zt.children)==null?void 0:St.find(wt=>wt instanceof yt);mt&&(mt.style.fontFamily=H)}pt.style.fontFamily=H}function At(H=.9){var V,St;(V=o==null?void 0:o.initFromUserGesture)==null||V.call(o),(St=o==null?void 0:o.playSfx)==null||St.call(o,"ui_click",H)}const P=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||((oo=(ro=window.matchMedia)==null?void 0:ro.call(window,"(pointer: coarse)"))==null?void 0:oo.matches);function ot(){const H=n.screen.width,V=n.screen.height;return(H<820||H/V<.9)&&V>=H}function tt(){const H=n.screen.width,V=n.screen.height,St=H/V;return(!!P||H<820||St<.9)&&H>V}const Z=s.onBalanceUpdated,j=new st;j.zIndex=9e3,j.visible=!1,j.eventMode="static",j.cursor="default",i.addChild(j),i.sortChildren();const It=new xt;It.eventMode="static",It.cursor="default",j.addChild(It);const G=new yt({text:Ye("ui.buyBonus","BUY BONUS"),style:we({fontFamily:"Pixeldown",fill:16777215,fontSize:38,fontWeight:"100",align:"center",letterSpacing:2,dropShadow:!0,dropShadowAlpha:.6,dropShadowDistance:2,dropShadowBlur:0,dropShadowAngle:-Math.PI/4})});G.anchor.set(.5),j.addChild(G);const Y=new xt;j.addChild(Y);let Ft=0,fe=0;const ve=y(u,w,M,()=>Wi());ve.eventMode="static",ve.cursor="pointer",j.addChild(ve);const Ke=72;ve.hitArea=new oe(-Ke/2,-Ke/2,Ke,Ke);const Ut=new st;Ut.eventMode="static",Ut.cursor="default",j.addChild(Ut);const Qe=new xt;Ut.addChild(Qe);const ue=new st;Ut.addChild(ue),ue.mask=Qe;const mn=new st;mn.eventMode="none",mn.zIndex=99999,i.addChild(mn),i.sortChildren();const xe=new yt({text:"",style:we({fontFamily:"Micro5",stroke:{color:0,width:6},fill:16769248,fontSize:30,align:"center",letterSpacing:1})});xe.anchor.set(.5),xe.visible=!1,xe.alpha=0,mn.addChild(xe);let cn=null;function Le(){const H=n.screen.width,V=n.screen.height;xe.x=Math.round(H/2),xe.y=Math.round(V-120)}function $e(H){Le(),xe.text=H,xe.visible=!0,xe.alpha=1,cn&&clearTimeout(cn),cn=setTimeout(()=>{const V=performance.now(),St=250,mt=()=>{const wt=(performance.now()-V)/St;xe.alpha=Math.max(0,1-wt),wt<1?requestAnimationFrame(mt):xe.visible=!1};requestAnimationFrame(mt),xe.text=Re(H)},900)}const Pn=bt("ui.insufficientBalance","OOPS, NOT ENOUGH BALANCE"),ei=bt("ui.insufficientBalanceOrChangeBet","OOPS — NOT ENOUGH BALANCE or CHANGE BET AMOUNT");function Ee(){return ot()?Pn:ei}function _n(){var H,V;$e(Ee()),requestAnimationFrame(()=>{Le(),Fe()}),r.ui.auto=!1,(V=(H=s.autoBtnPixi)==null?void 0:H.setOn)==null||V.call(H,!1)}function Fe(){if(!xe.visible)return;const H=xe.x,V=12,St=260,mt=performance.now();function wt(he){const Gt=Math.min(1,(he-mt)/St),ie=1-Gt*Gt*(3-2*Gt),re=Math.sin(Gt*Math.PI*12)*ie;xe.x=Math.round(H+re*V),Gt<1?requestAnimationFrame(wt):xe.x=H}requestAnimationFrame(wt)}const Pt=new st;let Wn=!1;Pt.eventMode="static",Pt.cursor="default",j.addChild(Pt);const Dn=new xt;Pt.addChild(Dn);const Vn=new xt;Pt.addChild(Vn);const Xs=we({fontFamily:"Micro5",fill:11635967,fontSize:24,letterSpacing:2});Xs.fontFamily=Li(Pe());const Bs=new _e(Xs),hs=we({fontFamily:"Micro5",fill:16777215,fontSize:40,letterSpacing:1,stroke:{color:0,width:4}});hs.fontFamily=Li(Pe());const On=new _e(hs),Me=new yt({text:Ye("ui.balance","BALANCE"),style:Bs}),is=new yt({text:l(r.bank.balance),style:On}),on=new yt({text:Ye("ui.bet","BET"),style:Bs}),pe=new yt({text:l(r.bank.betLevels[r.bank.betIndex]),style:On});Pt.addChild(Me,is,on,pe);const Ce=y(v,I,L,()=>{var H;(H=Ce.resetVisual)==null||H.call(Ce),r.bank.betIndex>0&&(r.bank.betIndex--,p(),b(),fi(),Pr(),_i())}),Xe=y(K,W,U,()=>{var H;(H=Xe.resetVisual)==null||H.call(Xe),r.bank.betIndex<r.bank.betLevels.length-1&&(r.bank.betIndex++,p(),b(),fi(),Pr(),_i())});Pt.addChild(Ce,Xe);function fi(){var H,V;is.text=l(r.bank.balance),pe.text=l(r.bank.betLevels[r.bank.betIndex]),(H=Ce.setEnabled)==null||H.call(Ce,r.bank.betIndex>0),(V=Xe.setEnabled)==null||V.call(Xe,r.bank.betIndex<r.bank.betLevels.length-1)}const Je=new st;Je.sortableChildren=!0,Je.zIndex=99999,Je.visible=!1,Je.eventMode="none",i.addChild(Je),i.sortChildren();const pi=new xt;pi.eventMode="static",pi.cursor="default",Je.addChild(pi);const Cs=new xt;Je.addChild(Cs);const ni=new xt;Je.addChild(ni);let Ir=1,Ln=0;const Vs=new yt({text:"",style:we({fontFamily:"Pixeldown",fill:16777215,fontSize:38,fontWeight:"100",align:"center",letterSpacing:2,dropShadow:!0,dropShadowAlpha:.6,dropShadowDistance:2,dropShadowBlur:0,dropShadowAngle:-Math.PI/4})});Vs.anchor.set(.5),Je.addChild(Vs);const pt=new yt({text:"",style:we({fontFamily:"Micro5",fill:16765802,fontSize:42,fontWeight:"100",align:"center",letterSpacing:2,dropShadow:!0,dropShadowAlpha:.65,dropShadowDistance:2,dropShadowBlur:0,dropShadowAngle:-Math.PI/4})});pt.anchor.set(.5),Je.addChild(pt);function Dt(H,V,St="ui_click",mt=.9){const wt=new st,he=new xt,Gt=we({fontFamily:"Micro5",fill:16777215,fontSize:45,fontWeight:"100",letterSpacing:2,align:"center",stroke:{color:0,width:4}});Gt.fontFamily=Li(Pe());const ie=new yt({text:Re(H),style:Gt});ie.anchor.set(.5),ie.position.set(110,22),wt.addChild(he,ie);function re(){he.clear().rect(0,0,220,56).fill({color:1624420})}function gn(){he.clear().rect(0,0,220,56).fill({color:13840175}),ie.style.fill=16777215}return re(),wt.eventMode="static",wt.cursor="pointer",wt.on("pointertap",Ge=>{var bs,Rn,us;(bs=Ge==null?void 0:Ge.stopPropagation)==null||bs.call(Ge),(Rn=o==null?void 0:o.initFromUserGesture)==null||Rn.call(o),(us=o==null?void 0:o.playSfx)==null||us.call(o,St,mt),V()}),wt.setLabel=Ge=>ie.text=Re(Ge),ie.style.fontFamily=Li(Pe()),wt.setRed=()=>gn(),wt.setGreen=()=>re(),wt}let qt=null;const zt=Dt(bt("ui.btnConfirm","CONFIRM"),()=>{const H=qt;ys(),H==null||H()},"ui_click");Je.addChild(zt);let hn=0;function zn(){hn++;const H=hn,V=6,St=140,mt=220,wt=1800,he=()=>zt._baseY??zt.y;(async()=>{for(;H===hn&&Je.visible;){const Gt=he();zt.y=Gt,await J(St,ie=>{if(H!==hn)return;const re=Nt(ie,1.05);zt.y=Gt-V*re}),await J(mt,ie=>{if(H!==hn)return;const re=ie*ie*(3-2*ie);zt.y=Gt-V+V*re}),zt.y=Gt,await gt(wt)}})()}function ge(){hn++;const H=zt._baseY??zt.y;zt.y=H}function kn(){const H=n.screen.width,V=n.screen.height;pi.clear().rect(0,0,H,V).fill({color:0,alpha:.72});const St=Math.min(460,H*.72),mt=210,wt=(H-St)/2,he=(V-mt)/2;Cs.clear().rect(wt,he,St,mt).fill(2829099).stroke({width:2,color:11579568,alpha:.35});const Gt=Math.round(H/2),ie=50;Vs.position.set(Gt,Math.round(V/2-64)),pt.position.set(Gt,Math.round(Vs.y+ie));const re=Math.min(260,St*.65),gn=Math.round((Vs.y+pt.y)*.5),Ge=re*Ir*.5;ni.clear(),ni.moveTo(H/2-Ge,gn),ni.lineTo(H/2+Ge,gn),ni.stroke({width:3,color:16777215,alpha:.85}),zt.position.set(H/2-110,V/2+20),zt._baseY=zt.y,i.sortChildren()}function rs(H,V,St){qt=St,Vs.text=Re(H),pt.text=l(V),kn(),Ir=0,Ln++;const mt=Ln,wt=400,he=performance.now();function Gt(ie){if(mt!==Ln)return;const re=Math.min(1,(ie-he)/wt);Ir=Math.min(1,it(re)),kn(),re<1&&requestAnimationFrame(Gt)}requestAnimationFrame(Gt),Je.visible=!0,Je.eventMode="static",ge(),zn()}function ys(){ge(),Je.visible=!1,Je.eventMode="none",qt=null}pi.on("pointertap",()=>ys());function zs(H,V){const St=new st,mt=new xt,wt=we({fontFamily:"Micro5",fill:16777215,fontSize:45,fontWeight:"100",letterSpacing:2,align:"center",stroke:{color:0,width:4}});wt.fontFamily=Li(Pe());const he=new yt({text:Re(H),style:wt});he.anchor.set(.5),he.position.set(110,22),St.addChild(mt,he);function Gt(){mt.clear().rect(0,0,220,56).fill({color:1624420})}function ie(){mt.clear().rect(0,0,220,56).fill({color:13840175})}return Gt(),St.eventMode="static",St.cursor="pointer",St.on("pointertap",re=>{var gn;(gn=re==null?void 0:re.stopPropagation)==null||gn.call(re),At(.9),V()}),St.setLabel=re=>he.text=Re(re),he.style.fontFamily=Li(Pe()),St.setRed=()=>ie(),St.setGreen=()=>Gt(),St}const xs=[{title:bt("ui.buyCard.pickMixTitle","PICK & MIX"),body:bt("ui.buyCard.pickMixBody",`ENTRY BONUS
STARTS AT 1× MULTIPLIER`),priceMult:67,startMult:1,fsCount:10,artFrame:"buy_art_pick.png"},{title:bt("ui.buyCard.gigaTitle","GIGA"),body:bt("ui.buyCard.gigaBody",`HIGHER VOLATILITY
STARTS AT 2× MULTIPLIER`),priceMult:78,startMult:2,fsCount:10,artFrame:"buy_art_giga.png"},{title:bt("ui.buyCard.superTitle","SUPER"),body:bt("ui.buyCard.superBody",`STRONG FEATURE
STARTS AT 3× MULTIPLIER`),priceMult:90,startMult:3,fsCount:10,artFrame:"buy_art_super.png"},{title:bt("ui.buyCard.ultraTitle","ULTRA"),body:bt("ui.buyCard.ultraBody",`MAXIMUM INTENSITY
STARTS AT 5× MULTIPLIER`),priceMult:100,startMult:5,fsCount:10,artFrame:"buy_art_ultra.png"}],Gn=[];function sr(){const H=r.bank.betLevels[r.bank.betIndex];return typeof H=="number"?H:Number(H)}function io(H){const V=new st;V.eventMode="static",V.cursor="default";const St=new xt;V.addChild(St);const mt=new yt({text:Re(H.title),style:we({fontFamily:"Pixeldown",fill:16765802,fontSize:31,align:"center",letterSpacing:1,stroke:{color:0,width:5},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.85,dropShadowDistance:3,dropShadowBlur:0,dropShadowAngle:-Math.PI/4})});mt.anchor.set(.5,0),V.addChild(mt);const wt=new Se(c(H.artFrame));wt.anchor.set(.5),wt.roundPixels=!0,wt.eventMode="none",V.addChild(wt),V._art=wt;const he=we({fontFamily:"Micro5",fill:16777215,fontSize:30,lineHeight:24,align:"center",letterSpacing:1});he.fontFamily=Li(Pe());const Gt=new yt({text:H.body,style:he});Gt.anchor.set(.5,0),V.addChild(Gt);const ie=new yt({text:"",style:we({fontFamily:"Micro5",fill:16777215,fontSize:37,align:"center",letterSpacing:2,stroke:{color:0,width:5},dropShadow:!1})});ie.anchor.set(.5,0),V.addChild(ie);const re=zs(bt("ui.btnBuy","BUY"),()=>{const Be=sr()*H.priceMult;if(r.bank.balance<Be){_n(),Fe(),window.open("https://stake.com/wallet","_blank","noopener,noreferrer");return}rs(H.title,Be,()=>{var tn;r.bank.balance-=Be,(tn=s.onBalanceUpdated)==null||tn.call(s),b(),fi(),Z==null||Z(),Wi(),_(H.fsCount,H.startMult)})});V.addChild(re),re.on("pointerdown",Be=>{var tn;return(tn=Be.stopPropagation)==null?void 0:tn.call(Be)}),re.on("pointertap",Be=>{var tn;return(tn=Be.stopPropagation)==null?void 0:tn.call(Be)});const gn=12,Ge=120,bs=160;let Rn=0;V._baseY=0;function us(Be,tn){Rn++;const be=Rn,gi=V.y;at(tn,Di=>{if(be!==Rn)return;const or=Di*Di*(3-2*Di);V.y=gi+(Be-gi)*or})}return V.on("pointerover",()=>{var tn,be,gi;(tn=o==null?void 0:o.initFromUserGesture)==null||tn.call(o),((be=o==null?void 0:o.playSfxThrottled)==null?void 0:be.call(o,"multiplier",120,.35,1))??((gi=o==null?void 0:o.playSfx)==null||gi.call(o,"multiplier",.35,1));const Be=V._baseY??V.y;us(Be-gn,Ge),V.canAfford||setTimeout(()=>{j.visible&&(V.canAfford||($e(Ee()),requestAnimationFrame(()=>{Le(),Fe()})))},250)}),V.on("pointerout",()=>{const Be=V._baseY??V.y;us(Be,bs)}),V._bg=St,V._title=mt,V._body=Gt,V._price=ie,V._buyBtn=re,V.canAfford=!1,V}for(const H of xs){const V=io(H);ue.addChild(V),Gn.push(V)}function Pr(){for(let H=0;H<Gn.length;H++){const V=xs[H],St=sr()*V.priceMult,mt=Gn[H],wt=mt._price,he=mt._buyBtn,Gt=r.bank.balance>=St;mt.canAfford=Gt,wt.text=`${l(St)}  (${V.priceMult}x)`,Gt?(he.setGreen(),he.setLabel(bt("ui.btnBuy","BUY"))):(he.setRed(),he.setLabel(bt("ui.btnTopUp","TOP UP")));for(const ie of mt.children)ie===he?ie.alpha=1:ie.alpha=Gt?1:.45}}let si=0,Or=0,ir=!1,rr=0,Zn=0;function Ci(H,V,St){return Math.max(V,Math.min(St,H))}Ut.on("pointerdown",H=>{var V;ot()&&(ir=!0,rr=H.global.y,Zn=si,(V=H.stopPropagation)==null||V.call(H))}),Ut.on("pointerup",()=>{ir=!1}),Ut.on("pointerupoutside",()=>{ir=!1}),Ut.on("pointermove",H=>{var St;if(!ot()||!ir)return;const V=H.global.y-rr;si=Ci(Zn+V,-Or,0),ue.y=Math.round(si),(St=H.stopPropagation)==null||St.call(H)});let Ct=0;function Wt(){Ct++;const H=Ct,V=Gn[3];if(!V)return;const St=V._buyBtn;if(!St)return;const mt=6,wt=140,he=220,Gt=1600,ie=()=>St._baseY??St.y;(async()=>{for(;H===Ct&&j.visible;){if(Je.visible){await gt(120);continue}const gn=ie();St.y=gn,await J(wt,Ge=>{if(H!==Ct)return;const bs=Nt(Ge,1.05);St.y=gn-mt*bs}),await J(he,Ge=>{if(H!==Ct)return;const bs=Ge*Ge*(3-2*Ge);St.y=gn-mt+mt*bs}),St.y=gn,await gt(Gt)}const re=ie();St.y=re})()}function mi(){Ct++;const H=Gn[3],V=H?H._buyBtn:null;V&&(V.y=V._baseY??V.y)}function _i(){var Vl,zl,Kl,Lr;const H=n.screen.width,V=n.screen.height;It.clear(),It.rect(0,0,H,V).fill({color:0,alpha:.85});const he=ot()?.11:tt()?.07:.27;G.x=Math.round(H/2),G.y=Math.round(V*he);const Gt=Math.min(340,H*.55),ie=Math.round(G.y+(tt()?26:34)),re=Gt*Ft*.5;Y.clear(),Y.moveTo(Math.round(H/2-re),ie),Y.lineTo(Math.round(H/2+re),ie),Y.stroke({width:3,color:16777215,alpha:.85});const gn=26;if(ve.x=Math.round(H-gn),ve.y=Math.round(gn),f(ve,V*.045),!ot()){Ut.visible=!0,Ut.eventMode="passive",Ut.cursor="default",Ut.x=0,Ut.y=0,ue.mask=null,Qe.clear(),si=0,ue.visible=!0,ue.alpha=1;const As=320,Ns=420,yi=22,Hi=4*As+3*yi,xi=Math.min(1,H*.92/Hi);ue.scale.set(xi);const Ia=-30;ue.scale.set(xi),ue.x=Math.round(H/2),ue.y=Math.round(V*.55)+(tt()?Ia:0);for(let ar=0;ar<Gn.length;ar++){const Is=Gn[ar],lr=-Hi/2+As/2+ar*(As+yi);Is.x=lr,Is.y=0,Is._baseY=Is.y,Is._bg.clear().rect(-As/2,-Ns/2,As,Ns).fill(2829099).stroke({width:2,color:11579568,alpha:.35});const ii=Is._title,Yi=Is._body,Xi=Is._price,Vi=Is._art,Ii=Is._buyBtn;ii.x=0,ii.y=-Ns/2+26,Vi.x=0,Vi.y=-Ns/2+155;const zi=160,kr=Math.max(1,Vi.texture.width);Vi.scale.set(zi/kr),Yi.x=0,Yi.y=-Ns/2+240,Xi.x=0,Xi.y=Ns/2-120,Ii.x=-110,Ii.y=Ns/2-70,Ii._baseY=Ii.y}}if(ot()){Pt.visible=!0,Ut.visible=!0,Ut.eventMode="static",ue.mask=Qe,Pt.sortableChildren=!0,Me.anchor.set(.5),is.anchor.set(.5),on.anchor.set(.5),pe.anchor.set(.5),f(Xe,30),f(Ce,30);const As=22,Ns=18,yi=54,Hi=is.width;(Vl=Xe.resetVisual)==null||Vl.call(Xe),(zl=Ce.resetVisual)==null||zl.call(Ce);const xi=((Kl=Xe.btnWidth)==null?void 0:Kl.call(Xe))??Xe.getLocalBounds().width,Ia=((Lr=Ce.btnWidth)==null?void 0:Lr.call(Ce))??Ce.getLocalBounds().width,ar=Math.max(xi,Ia);if(!t){const bi=r.bank.betLevels[r.bank.betLevels.length-1]??0,Us=l(Number(bi)),$l=pe.text;pe.text=Us,e=pe.width,pe.text=$l,t=!0}const Is=e||pe.width,lr=0;on.x=lr,pe.x=lr;const Yi=tt()?10:36;on.y=Math.round(-Yi*.5),pe.y=Math.round(Yi*.5),Ce.x=lr-Is*.5-ar*.5-Ns,Ce.y=pe.y,Xe.x=lr+Is*.5+ar*.5+Ns,Xe.y=pe.y;const Xi=lr+Math.max(Is,140)*.5+yi+Math.max(Hi,160)*.5;if(Me.x=Xi,Me.y=-26,is.x=Xi,is.y=10,!Wn){const bi=Pt.getLocalBounds();Pt.pivot.set(Math.round(bi.x+bi.width*.5),Math.round(bi.y+bi.height*.5)),Wn=!0}Pt.x=Math.round(H*.5);const Ii=Pt.getLocalBounds().height+28;Pt.y=Math.round(V-As-Ii*.5),Dn.clear();const zi=Pt.getLocalBounds();Dn.rect(zi.x-18,zi.y-14,zi.width+36,zi.height+28).fill({color:0,alpha:.25}),Dn.zIndex=-1;const kr=14,Rr=18,cr=Math.round(G.y+52),hr=As+Ii,Gh=kr,Hh=cr,Oa=Math.round(H-kr*2),ao=Math.round(V-hr-cr);Ut.x=Gh,Ut.y=Hh,Qe.clear(),Qe.rect(0,0,Oa,ao).fill({color:16777215,alpha:1}),ue.x=Math.round(Oa/2);const Ks=Math.min(520,Math.max(320,Math.floor(Oa))),Fn=440;let La=Math.round(Fn/2);for(let bi=0;bi<Gn.length;bi++){const Us=Gn[bi];Us.x=0,Us.y=La,Us._baseY=Us.y,La+=Fn+Rr,Us._bg.clear().rect(-Ks/2,-Fn/2,Ks,Fn).fill(2829099).stroke({width:2,color:11579568,alpha:.35});const ka=Us._title,jl=Us._body,ql=Us._price,Ro=Us._art,Fo=Us._buyBtn;ka.x=0,ka.y=Math.round(-Fn*.5+22),Ro.x=0;const lo=28,co=28;Ro.y=Math.round(-Fn*.5+135+lo),jl.y=Math.round(-Fn*.5+205+co);const Bo=Math.round(Ks*.42),ds=Math.max(1,Ro.texture.width);Ro.scale.set(Bo/ds),jl.x=0,ql.x=0,ql.y=Math.round(Fn*.5-120),Fo.x=-110,Fo.y=Math.round(Fn*.5-76),Fo._baseY=Fo.y}const Yh=Gn.length*Fn+(Gn.length-1)*Rr;Or=Math.max(0,Yh-ao),si=Ci(si,-Or,0),ue.y=Math.round(si),Le(),Je.visible&&kn();return}const Rn=tt()?26:32,us=2;Me.y=Math.round(us-Rn*.5),is.y=Math.round(us+Rn*.5),on.y=Math.round(us-Rn*.5),pe.y=Math.round(us+Rn*.5);const Be=Math.min(520,Math.round(H*.55)),tn=Math.round(V*.9);Pt.x=Math.round(H/2),Pt.y=tn,Me.anchor.set(0,.5),is.anchor.set(0,.5),Me.x=-Be/2+26,is.x=-Be/2+26,on.anchor.set(.5,.5),pe.anchor.set(.5,.5),on.x=0,pe.x=0;const Di=tt()?26:32,or=2;on.y=Math.round(or-Di*.5),pe.y=Math.round(or+Di*.5);const Ca=-2,Yl=90;Ce.x=Yl,Xe.x=Yl;const Wh=-10,ko=1,Xl=tt()?17:20,Dh=tt()?Wh:0,Gi=pe.y+Ca+Dh;if(Xe.y=Math.round(Gi-Xl),Ce.y=Math.round(Gi+Xl),f(Ce,24),f(Xe,24),tt()&&(Ce.scale.set(Ce.scale.x*ko,Ce.scale.y*ko),Xe.scale.set(Xe.scale.x*ko,Xe.scale.y*ko)),!ot()){const yi=Hi=>{const xi=Hi.getLocalBounds();Hi.hitArea=new oe(xi.x-26,xi.y-22,xi.width+52,xi.height+44)};yi(Xe),yi(Ce)}if(fi(),!ot()){Vn.clear().roundRect(-130/2,-72/2,130,72,0).fill({color:7237230,alpha:.8});const yi=-6;Vn.x=Math.round(pe.x),Vn.y=Math.round(pe.y+yi)}if(Pt.sortableChildren=!0,Vn.zIndex=0,on.zIndex=1,pe.zIndex=1,Xe.zIndex=1,Ce.zIndex=1,!ot()){const As=Pt.getLocalBounds();Pt.x=Math.round(H*.5-(As.x+As.width*.5)),Pt.y=tn}Le(),Je.visible&&kn()}window.addEventListener("resize",()=>{t=!1,e=0,Wn=!1,_i()});function Lo(){var wt,he,Gt,ie,re,gn,Ge,bs,Rn,us,Be,tn,be,gi;G.text=Ye("ui.buyBonus","BUY BONUS"),Me.text=Ye("ui.balance","BALANCE"),on.text=Ye("ui.bet","BET"),ft(),t=!1,e=0,Wn=!1,Wn=!1,r.ui.buyMenuOpen=!0,j.visible=!0,j.eventMode="static",Ft=0,fe++;const H=fe,V=400,St=performance.now();function mt(Di){if(H!==fe)return;const or=Math.min(1,(Di-St)/V);Ft=Math.min(1,it(or)),_i(),or<1&&requestAnimationFrame(mt)}requestAnimationFrame(mt),(he=(wt=s.spinBtnPixi)==null?void 0:wt.setEnabled)==null||he.call(wt,!1),(ie=(Gt=s.settingsBtnPixi)==null?void 0:Gt.setEnabled)==null||ie.call(Gt,!1),(gn=(re=s.buyBtnPixi)==null?void 0:re.setEnabled)==null||gn.call(re,!1),(bs=(Ge=s.autoBtnPixi)==null?void 0:Ge.setEnabled)==null||bs.call(Ge,!1),(us=(Rn=s.turboBtnPixi)==null?void 0:Rn.setEnabled)==null||us.call(Rn,!1),(tn=(Be=s.betDownBtnPixi)==null?void 0:Be.setEnabled)==null||tn.call(Be,!1),(gi=(be=s.betUpBtnPixi)==null?void 0:be.setEnabled)==null||gi.call(be,!1),_i(),Pr(),fi(),mi(),Wt(),i.sortChildren()}function Wi(){var H,V,St,mt,wt,he,Gt,ie,re,gn,Ge,bs,Rn,us,Be,tn,be;r.ui.buyMenuOpen=!1,j.visible=!1,j.eventMode="none",(V=(H=s.spinBtnPixi)==null?void 0:H.setEnabled)==null||V.call(H,!r.ui.spinning),(mt=(St=s.settingsBtnPixi)==null?void 0:St.setEnabled)==null||mt.call(St,!0),(he=(wt=s.buyBtnPixi)==null?void 0:wt.setEnabled)==null||he.call(wt,!0),(ie=(Gt=s.autoBtnPixi)==null?void 0:Gt.setEnabled)==null||ie.call(Gt,!0),(gn=(re=s.turboBtnPixi)==null?void 0:re.setEnabled)==null||gn.call(re,!0),(bs=(Ge=s.betDownBtnPixi)==null?void 0:Ge.setEnabled)==null||bs.call(Ge,!0),(us=(Rn=s.betUpBtnPixi)==null?void 0:Rn.setEnabled)==null||us.call(Rn,!0),(tn=(Be=s.buyBtnPixi)==null?void 0:Be.resetVisual)==null||tn.call(Be),(be=ve==null?void 0:ve.resetVisual)==null||be.call(ve),mi()}return It.on("pointertap",H=>{const V=H.global,St=Ut.getBounds(),mt=Pt.getBounds(),wt=V.x>=St.x&&V.x<=St.x+St.width&&V.y>=St.y&&V.y<=St.y+St.height,he=V.x>=mt.x&&V.x<=mt.x+mt.width&&V.y>=mt.y&&V.y<=mt.y+mt.height;wt||he||Wi()}),_i(),{openBuy:Lo,closeBuy:Wi,layoutBuy:_i,buyLayer:j,showToast:$e,showInsufficientToast:_n}}function mC(s){var ot;const{app:t,root:e,onPick:n,audio:i,t:r}=s,o=(tt,Z)=>(r==null?void 0:r(tt))??Z,c=new st;c.visible=!1,c.eventMode="none",e.addChild(c);const f=(tt,Z)=>Re(o(tt,Z)),y=tt=>{const Z=we(tt);return Z.fontFamily=Li(Pe()),Z};c.zIndex=7500,(ot=e.sortChildren)==null||ot.call(e);const x=s.uiDimmer??(()=>{const tt=new xt;return tt.eventMode="static",tt.cursor="pointer",c.addChild(tt),tt})();s.uiDimmer&&(x.parent||c.addChild(x),x.eventMode="static",x.cursor="pointer");const l=new st;c.addChild(l),l.scale.set(.6);const p=new xt;l.addChild(p);const b=new _e(y({fontSize:54,fill:16761856,letterSpacing:2})),_=new _e(y({fontSize:44,fill:16777215,letterSpacing:2})),u=new st;l.addChild(u),u.scale.set(1.12);const w=new yt({text:f("ui.autoPlayTitle","AUTO PLAY"),style:b}),M=new yt({text:f("ui.autoPlaySubtitle","NUMBER OF ROUNDS"),style:_});w.anchor.set(.5,0),M.anchor.set(.5,0),w.y=0,M.y=w.height+10,u.addChild(w,M);const v=new st;l.addChild(v);const I=[-1,10,25,50,75,100,500,1e3],L=[],K=new _e(we({fontFamily:"Micro5",fontSize:60,fill:2829099,letterSpacing:1}));let W=s.initialSelectedRounds??-999;const U=-5,gt=-5,J="btn_submenu_auto_up.png",at="btn_submenu_auto_down.png",it="btn_submenu_auto_on.png";function Nt(tt){W=tt;for(const Z of L){const j=Z.rounds===W;Z.btn.texture=s.texAutoMenu(j?it:J),Z.label.style.fill=2829099,Z.label.style.fontSize=Z.label.style.fontSize,Et(Z.btn,Z.label,Z.pressed?2:0)}}function Et(tt,Z,j=0){const It=tt.getLocalBounds(),G=It.x+It.width*.5,Y=It.y+It.height*.5;Z.position.set(Math.round(G+gt),Math.round(Y+U+j))}function bt(tt){const Z=new st;Z.eventMode="static",Z.cursor="pointer";const j=new Se(s.texAutoMenu(J));j.anchor.set(.5),j.roundPixels=!0;const It=new yt({text:tt===-1?"∞":String(tt),style:K});It.anchor.set(.5),It.roundPixels=!0,Z.addChild(j,It);const G={rounds:tt,wrap:Z,btn:j,label:It,pressed:!1};Z.on("pointerdown",Ft=>{var fe;(fe=Ft.stopPropagation)==null||fe.call(Ft),G.pressed=!0,G.btn.texture=s.texAutoMenu(at),G.btn.y=2,Et(G.btn,G.label,2)});const Y=()=>{G.pressed=!1,G.btn.y=0,G.btn.texture=s.texAutoMenu(G.rounds===W?it:J),Et(G.btn,G.label,0)};return Z.on("pointerup",Ft=>{var fe;(fe=Ft.stopPropagation)==null||fe.call(Ft),Y()}),Z.on("pointerupoutside",Y),Z.on("pointerout",()=>{G.pressed&&Y()}),Z.on("pointertap",Ft=>{var fe;(fe=Ft.stopPropagation)==null||fe.call(Ft),i==null||i.playSfx("ui_click",.85),Nt(tt),n(tt)}),Z.hitArea=new oe(-90,-90,180,180),G}for(const tt of I){const Z=bt(tt);L.push(Z),v.addChild(Z.wrap)}x.on("pointertap",()=>ft()),l.eventMode="static",l.on("pointertap",tt=>tt.stopPropagation());function Ye(){var tt;w.text=f("ui.autoPlayTitle","AUTO PLAY"),M.text=f("ui.autoPlaySubtitle","NUMBER OF ROUNDS"),c.visible=!0,c.eventMode="static",(tt=e.sortChildren)==null||tt.call(e),P()}function ft(){var tt;i==null||i.playSfx("ui_toggle",.9),c.visible=!1,c.eventMode="none",(tt=s.onClosed)==null||tt.call(s)}function At(){return c.visible}function P(){const tt=t.renderer.width,Z=t.renderer.height;x.clear(),x.beginFill(0,.65),x.drawRect(0,0,tt,Z),x.endFill();const j=Z>=tt,It=Math.min(tt*(j?.86:.55),640),G=Math.min(Z*(j?.95:.82),j?1100:980),Y=l.scale.x,Ft=j?window.innerWidth:tt,fe=j?window.innerHeight:Z;l.x=Math.round((Ft-It*Y)*.5),l.y=Math.round((fe-G*Y)*.5),j&&(l.y-=80),p.clear(),p.beginFill(2039583,.92),p.drawRoundedRect(0,0,It,G,36),p.endFill(),p.beginFill(16777215,.06),p.drawRoundedRect(10,10,It-20,120,30),p.endFill();const ve=10,Ke=10,Ut=It-20,Qe=120;M.y=Math.round(w.height+10);const ue=u.getLocalBounds();u.pivot.set(ue.x+ue.width*.5,ue.y+ue.height*.5),u.x=Math.round(ve+Ut*.5),u.y=Math.round(Ke+Qe*.5),u.y+=-6;const mn=2,xe=4,cn=200,Le=44,$e=24,Pn=G-cn-Le,ei=(xe-1)*$e,Ee=Math.max(1,Pn-ei),_n=It/mn,Fe=Ee/xe,Pt=Math.min(_n,Fe)*.28,Wn=Math.max(44,Math.min(62,Pt)),Dn=Wn*2,Vn=s.texAutoMenu(J),Xs=s.texAutoMenu(at),Bs=s.texAutoMenu(it),hs=Math.max(Vn.width||1,Xs.width||1,Bs.width||1),On=Math.max(Vn.height||1,Xs.height||1,Bs.height||1),is=Math.min(Dn/hs,Dn/On)*2;for(let on=0;on<L.length;on++){const pe=L[on],Ce=on%mn,Xe=Math.floor(on/mn),fi=Math.round(Ce*_n+_n*.5),Je=Math.round(cn+Xe*(Fe+$e)+Fe*.5);pe.wrap.x=fi,pe.wrap.y=Je;const pi=pe.rounds===W?it:J;pe.btn.texture=s.texAutoMenu(pi),pe.btn.scale.set(is);const Cs=Math.round(Math.max(34,Math.min(60,Wn*.95)));pe.label.style=new _e(we({fontFamily:"Micro5",fontSize:Cs,fill:2829099,letterSpacing:1})),Et(pe.btn,pe.label,pe.pressed?2:0)}Nt(W===-999?-1:W)}return Nt(W),{layer:c,open:Ye,close:ft,layout:P,isOpen:At,setSelected:Nt}}function Yd(s){const t=we({fontFamily:"Pixeldown",fill:16777215,fontSize:35,fontWeight:"200",letterSpacing:1,align:"center",stroke:{color:0,width:4},dropShadow:!0,dropShadowAlpha:.9,dropShadowBlur:0,dropShadowDistance:4,dropShadowAngle:-Math.PI/4});s.style=new _e(t),s.anchor.set(.5),s.eventMode="static",s.cursor="pointer",s.hitArea=new oe(-360,-60,720,120)}function Sl(){const s=getComputedStyle(document.documentElement).getPropertyValue("env(safe-area-inset-bottom)"),t=parseFloat(s);return Number.isFinite(t)?t:0}function wl(){const s=getComputedStyle(document.documentElement).getPropertyValue("env(safe-area-inset-top)"),t=parseFloat(s);return Number.isFinite(t)?t:0}function _C(s){const t=r=>new Promise(o=>setTimeout(o,r)),e=()=>s()?.5:1;return{wait:t,waitT:r=>t(Math.round(r*e())),durT:r=>Math.round(r*e()),turboFactor:e}}function gC(s){let t=0;for(const i in s)t+=s[i];const e=Math.random()*t;let n=0;for(const i in s)if(n+=s[i],e<=n)return i;return Object.keys(s)[0]}function yC(s,t,e){const n=s*t;return Array.from({length:n},()=>({id:gC(e)}))}function tg(s,t){return{x:s%t,y:Math.floor(s/t)}}function Xd(s,t,e){return t*e+s}const xC=new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:2});function cs(s){return xC.format(s)}var Mr={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(s){(function(){var t=function(){this.init()};t.prototype={init:function(){var l=this||e;return l._counter=1e3,l._html5AudioPool=[],l.html5PoolSize=10,l._codecs={},l._howls=[],l._muted=!1,l._volume=1,l._canPlayEvent="canplaythrough",l._navigator=typeof window<"u"&&window.navigator?window.navigator:null,l.masterGain=null,l.noAudio=!1,l.usingWebAudio=!0,l.autoSuspend=!0,l.ctx=null,l.autoUnlock=!0,l._setup(),l},volume:function(l){var p=this||e;if(l=parseFloat(l),p.ctx||x(),typeof l<"u"&&l>=0&&l<=1){if(p._volume=l,p._muted)return p;p.usingWebAudio&&p.masterGain.gain.setValueAtTime(l,e.ctx.currentTime);for(var b=0;b<p._howls.length;b++)if(!p._howls[b]._webAudio)for(var _=p._howls[b]._getSoundIds(),u=0;u<_.length;u++){var w=p._howls[b]._soundById(_[u]);w&&w._node&&(w._node.volume=w._volume*l)}return p}return p._volume},mute:function(l){var p=this||e;p.ctx||x(),p._muted=l,p.usingWebAudio&&p.masterGain.gain.setValueAtTime(l?0:p._volume,e.ctx.currentTime);for(var b=0;b<p._howls.length;b++)if(!p._howls[b]._webAudio)for(var _=p._howls[b]._getSoundIds(),u=0;u<_.length;u++){var w=p._howls[b]._soundById(_[u]);w&&w._node&&(w._node.muted=l?!0:w._muted)}return p},stop:function(){for(var l=this||e,p=0;p<l._howls.length;p++)l._howls[p].stop();return l},unload:function(){for(var l=this||e,p=l._howls.length-1;p>=0;p--)l._howls[p].unload();return l.usingWebAudio&&l.ctx&&typeof l.ctx.close<"u"&&(l.ctx.close(),l.ctx=null,x()),l},codecs:function(l){return(this||e)._codecs[l.replace(/^x-/,"")]},_setup:function(){var l=this||e;if(l.state=l.ctx&&l.ctx.state||"suspended",l._autoSuspend(),!l.usingWebAudio)if(typeof Audio<"u")try{var p=new Audio;typeof p.oncanplaythrough>"u"&&(l._canPlayEvent="canplay")}catch{l.noAudio=!0}else l.noAudio=!0;try{var p=new Audio;p.muted&&(l.noAudio=!0)}catch{}return l.noAudio||l._setupCodecs(),l},_setupCodecs:function(){var l=this||e,p=null;try{p=typeof Audio<"u"?new Audio:null}catch{return l}if(!p||typeof p.canPlayType!="function")return l;var b=p.canPlayType("audio/mpeg;").replace(/^no$/,""),_=l._navigator?l._navigator.userAgent:"",u=_.match(/OPR\/(\d+)/g),w=u&&parseInt(u[0].split("/")[1],10)<33,M=_.indexOf("Safari")!==-1&&_.indexOf("Chrome")===-1,v=_.match(/Version\/(.*?) /),I=M&&v&&parseInt(v[1],10)<15;return l._codecs={mp3:!!(!w&&(b||p.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!b,opus:!!p.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!p.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!p.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(p.canPlayType('audio/wav; codecs="1"')||p.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!p.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!p.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(p.canPlayType("audio/x-m4a;")||p.canPlayType("audio/m4a;")||p.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(p.canPlayType("audio/x-m4b;")||p.canPlayType("audio/m4b;")||p.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(p.canPlayType("audio/x-mp4;")||p.canPlayType("audio/mp4;")||p.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!I&&p.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!I&&p.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!p.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(p.canPlayType("audio/x-flac;")||p.canPlayType("audio/flac;")).replace(/^no$/,"")},l},_unlockAudio:function(){var l=this||e;if(!(l._audioUnlocked||!l.ctx)){l._audioUnlocked=!1,l.autoUnlock=!1,!l._mobileUnloaded&&l.ctx.sampleRate!==44100&&(l._mobileUnloaded=!0,l.unload()),l._scratchBuffer=l.ctx.createBuffer(1,1,22050);var p=function(b){for(;l._html5AudioPool.length<l.html5PoolSize;)try{var _=new Audio;_._unlocked=!0,l._releaseHtml5Audio(_)}catch{l.noAudio=!0;break}for(var u=0;u<l._howls.length;u++)if(!l._howls[u]._webAudio)for(var w=l._howls[u]._getSoundIds(),M=0;M<w.length;M++){var v=l._howls[u]._soundById(w[M]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}l._autoResume();var I=l.ctx.createBufferSource();I.buffer=l._scratchBuffer,I.connect(l.ctx.destination),typeof I.start>"u"?I.noteOn(0):I.start(0),typeof l.ctx.resume=="function"&&l.ctx.resume(),I.onended=function(){I.disconnect(0),l._audioUnlocked=!0,document.removeEventListener("touchstart",p,!0),document.removeEventListener("touchend",p,!0),document.removeEventListener("click",p,!0),document.removeEventListener("keydown",p,!0);for(var L=0;L<l._howls.length;L++)l._howls[L]._emit("unlock")}};return document.addEventListener("touchstart",p,!0),document.addEventListener("touchend",p,!0),document.addEventListener("click",p,!0),document.addEventListener("keydown",p,!0),l}},_obtainHtml5Audio:function(){var l=this||e;if(l._html5AudioPool.length)return l._html5AudioPool.pop();var p=new Audio().play();return p&&typeof Promise<"u"&&(p instanceof Promise||typeof p.then=="function")&&p.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(l){var p=this||e;return l._unlocked&&p._html5AudioPool.push(l),p},_autoSuspend:function(){var l=this;if(!(!l.autoSuspend||!l.ctx||typeof l.ctx.suspend>"u"||!e.usingWebAudio)){for(var p=0;p<l._howls.length;p++)if(l._howls[p]._webAudio){for(var b=0;b<l._howls[p]._sounds.length;b++)if(!l._howls[p]._sounds[b]._paused)return l}return l._suspendTimer&&clearTimeout(l._suspendTimer),l._suspendTimer=setTimeout(function(){if(l.autoSuspend){l._suspendTimer=null,l.state="suspending";var _=function(){l.state="suspended",l._resumeAfterSuspend&&(delete l._resumeAfterSuspend,l._autoResume())};l.ctx.suspend().then(_,_)}},3e4),l}},_autoResume:function(){var l=this;if(!(!l.ctx||typeof l.ctx.resume>"u"||!e.usingWebAudio))return l.state==="running"&&l.ctx.state!=="interrupted"&&l._suspendTimer?(clearTimeout(l._suspendTimer),l._suspendTimer=null):l.state==="suspended"||l.state==="running"&&l.ctx.state==="interrupted"?(l.ctx.resume().then(function(){l.state="running";for(var p=0;p<l._howls.length;p++)l._howls[p]._emit("resume")}),l._suspendTimer&&(clearTimeout(l._suspendTimer),l._suspendTimer=null)):l.state==="suspending"&&(l._resumeAfterSuspend=!0),l}};var e=new t,n=function(l){var p=this;if(!l.src||l.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}p.init(l)};n.prototype={init:function(l){var p=this;return e.ctx||x(),p._autoplay=l.autoplay||!1,p._format=typeof l.format!="string"?l.format:[l.format],p._html5=l.html5||!1,p._muted=l.mute||!1,p._loop=l.loop||!1,p._pool=l.pool||5,p._preload=typeof l.preload=="boolean"||l.preload==="metadata"?l.preload:!0,p._rate=l.rate||1,p._sprite=l.sprite||{},p._src=typeof l.src!="string"?l.src:[l.src],p._volume=l.volume!==void 0?l.volume:1,p._xhr={method:l.xhr&&l.xhr.method?l.xhr.method:"GET",headers:l.xhr&&l.xhr.headers?l.xhr.headers:null,withCredentials:l.xhr&&l.xhr.withCredentials?l.xhr.withCredentials:!1},p._duration=0,p._state="unloaded",p._sounds=[],p._endTimers={},p._queue=[],p._playLock=!1,p._onend=l.onend?[{fn:l.onend}]:[],p._onfade=l.onfade?[{fn:l.onfade}]:[],p._onload=l.onload?[{fn:l.onload}]:[],p._onloaderror=l.onloaderror?[{fn:l.onloaderror}]:[],p._onplayerror=l.onplayerror?[{fn:l.onplayerror}]:[],p._onpause=l.onpause?[{fn:l.onpause}]:[],p._onplay=l.onplay?[{fn:l.onplay}]:[],p._onstop=l.onstop?[{fn:l.onstop}]:[],p._onmute=l.onmute?[{fn:l.onmute}]:[],p._onvolume=l.onvolume?[{fn:l.onvolume}]:[],p._onrate=l.onrate?[{fn:l.onrate}]:[],p._onseek=l.onseek?[{fn:l.onseek}]:[],p._onunlock=l.onunlock?[{fn:l.onunlock}]:[],p._onresume=[],p._webAudio=e.usingWebAudio&&!p._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(p),p._autoplay&&p._queue.push({event:"play",action:function(){p.play()}}),p._preload&&p._preload!=="none"&&p.load(),p},load:function(){var l=this,p=null;if(e.noAudio){l._emit("loaderror",null,"No audio support.");return}typeof l._src=="string"&&(l._src=[l._src]);for(var b=0;b<l._src.length;b++){var _,u;if(l._format&&l._format[b])_=l._format[b];else{if(u=l._src[b],typeof u!="string"){l._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}_=/^data:audio\/([^;,]+);/i.exec(u),_||(_=/\.([^.]+)$/.exec(u.split("?",1)[0])),_&&(_=_[1].toLowerCase())}if(_||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),_&&e.codecs(_)){p=l._src[b];break}}if(!p){l._emit("loaderror",null,"No codec support for selected audio sources.");return}return l._src=p,l._state="loading",window.location.protocol==="https:"&&p.slice(0,5)==="http:"&&(l._html5=!0,l._webAudio=!1),new i(l),l._webAudio&&o(l),l},play:function(l,p){var b=this,_=null;if(typeof l=="number")_=l,l=null;else{if(typeof l=="string"&&b._state==="loaded"&&!b._sprite[l])return null;if(typeof l>"u"&&(l="__default",!b._playLock)){for(var u=0,w=0;w<b._sounds.length;w++)b._sounds[w]._paused&&!b._sounds[w]._ended&&(u++,_=b._sounds[w]._id);u===1?l=null:_=null}}var M=_?b._soundById(_):b._inactiveSound();if(!M)return null;if(_&&!l&&(l=M._sprite||"__default"),b._state!=="loaded"){M._sprite=l,M._ended=!1;var v=M._id;return b._queue.push({event:"play",action:function(){b.play(v)}}),v}if(_&&!M._paused)return p||b._loadQueue("play"),M._id;b._webAudio&&e._autoResume();var I=Math.max(0,M._seek>0?M._seek:b._sprite[l][0]/1e3),L=Math.max(0,(b._sprite[l][0]+b._sprite[l][1])/1e3-I),K=L*1e3/Math.abs(M._rate),W=b._sprite[l][0]/1e3,U=(b._sprite[l][0]+b._sprite[l][1])/1e3;M._sprite=l,M._ended=!1;var gt=function(){M._paused=!1,M._seek=I,M._start=W,M._stop=U,M._loop=!!(M._loop||b._sprite[l][2])};if(I>=U){b._ended(M);return}var J=M._node;if(b._webAudio){var at=function(){b._playLock=!1,gt(),b._refreshBuffer(M);var bt=M._muted||b._muted?0:M._volume;J.gain.setValueAtTime(bt,e.ctx.currentTime),M._playStart=e.ctx.currentTime,typeof J.bufferSource.start>"u"?M._loop?J.bufferSource.noteGrainOn(0,I,86400):J.bufferSource.noteGrainOn(0,I,L):M._loop?J.bufferSource.start(0,I,86400):J.bufferSource.start(0,I,L),K!==1/0&&(b._endTimers[M._id]=setTimeout(b._ended.bind(b,M),K)),p||setTimeout(function(){b._emit("play",M._id),b._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?at():(b._playLock=!0,b.once("resume",at),b._clearTimer(M._id))}else{var it=function(){J.currentTime=I,J.muted=M._muted||b._muted||e._muted||J.muted,J.volume=M._volume*e.volume(),J.playbackRate=M._rate;try{var bt=J.play();if(bt&&typeof Promise<"u"&&(bt instanceof Promise||typeof bt.then=="function")?(b._playLock=!0,gt(),bt.then(function(){b._playLock=!1,J._unlocked=!0,p?b._loadQueue():b._emit("play",M._id)}).catch(function(){b._playLock=!1,b._emit("playerror",M._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),M._ended=!0,M._paused=!0})):p||(b._playLock=!1,gt(),b._emit("play",M._id)),J.playbackRate=M._rate,J.paused){b._emit("playerror",M._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}l!=="__default"||M._loop?b._endTimers[M._id]=setTimeout(b._ended.bind(b,M),K):(b._endTimers[M._id]=function(){b._ended(M),J.removeEventListener("ended",b._endTimers[M._id],!1)},J.addEventListener("ended",b._endTimers[M._id],!1))}catch(Ye){b._emit("playerror",M._id,Ye)}};J.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(J.src=b._src,J.load());var Nt=window&&window.ejecta||!J.readyState&&e._navigator.isCocoonJS;if(J.readyState>=3||Nt)it();else{b._playLock=!0,b._state="loading";var Et=function(){b._state="loaded",it(),J.removeEventListener(e._canPlayEvent,Et,!1)};J.addEventListener(e._canPlayEvent,Et,!1),b._clearTimer(M._id)}}return M._id},pause:function(l){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"pause",action:function(){p.pause(l)}}),p;for(var b=p._getSoundIds(l),_=0;_<b.length;_++){p._clearTimer(b[_]);var u=p._soundById(b[_]);if(u&&!u._paused&&(u._seek=p.seek(b[_]),u._rateSeek=0,u._paused=!0,p._stopFade(b[_]),u._node))if(p._webAudio){if(!u._node.bufferSource)continue;typeof u._node.bufferSource.stop>"u"?u._node.bufferSource.noteOff(0):u._node.bufferSource.stop(0),p._cleanBuffer(u._node)}else(!isNaN(u._node.duration)||u._node.duration===1/0)&&u._node.pause();arguments[1]||p._emit("pause",u?u._id:null)}return p},stop:function(l,p){var b=this;if(b._state!=="loaded"||b._playLock)return b._queue.push({event:"stop",action:function(){b.stop(l)}}),b;for(var _=b._getSoundIds(l),u=0;u<_.length;u++){b._clearTimer(_[u]);var w=b._soundById(_[u]);w&&(w._seek=w._start||0,w._rateSeek=0,w._paused=!0,w._ended=!0,b._stopFade(_[u]),w._node&&(b._webAudio?w._node.bufferSource&&(typeof w._node.bufferSource.stop>"u"?w._node.bufferSource.noteOff(0):w._node.bufferSource.stop(0),b._cleanBuffer(w._node)):(!isNaN(w._node.duration)||w._node.duration===1/0)&&(w._node.currentTime=w._start||0,w._node.pause(),w._node.duration===1/0&&b._clearSound(w._node))),p||b._emit("stop",w._id))}return b},mute:function(l,p){var b=this;if(b._state!=="loaded"||b._playLock)return b._queue.push({event:"mute",action:function(){b.mute(l,p)}}),b;if(typeof p>"u")if(typeof l=="boolean")b._muted=l;else return b._muted;for(var _=b._getSoundIds(p),u=0;u<_.length;u++){var w=b._soundById(_[u]);w&&(w._muted=l,w._interval&&b._stopFade(w._id),b._webAudio&&w._node?w._node.gain.setValueAtTime(l?0:w._volume,e.ctx.currentTime):w._node&&(w._node.muted=e._muted?!0:l),b._emit("mute",w._id))}return b},volume:function(){var l=this,p=arguments,b,_;if(p.length===0)return l._volume;if(p.length===1||p.length===2&&typeof p[1]>"u"){var u=l._getSoundIds(),w=u.indexOf(p[0]);w>=0?_=parseInt(p[0],10):b=parseFloat(p[0])}else p.length>=2&&(b=parseFloat(p[0]),_=parseInt(p[1],10));var M;if(typeof b<"u"&&b>=0&&b<=1){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,p)}}),l;typeof _>"u"&&(l._volume=b),_=l._getSoundIds(_);for(var v=0;v<_.length;v++)M=l._soundById(_[v]),M&&(M._volume=b,p[2]||l._stopFade(_[v]),l._webAudio&&M._node&&!M._muted?M._node.gain.setValueAtTime(b,e.ctx.currentTime):M._node&&!M._muted&&(M._node.volume=b*e.volume()),l._emit("volume",M._id))}else return M=_?l._soundById(_):l._sounds[0],M?M._volume:0;return l},fade:function(l,p,b,_){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"fade",action:function(){u.fade(l,p,b,_)}}),u;l=Math.min(Math.max(0,parseFloat(l)),1),p=Math.min(Math.max(0,parseFloat(p)),1),b=parseFloat(b),u.volume(l,_);for(var w=u._getSoundIds(_),M=0;M<w.length;M++){var v=u._soundById(w[M]);if(v){if(_||u._stopFade(w[M]),u._webAudio&&!v._muted){var I=e.ctx.currentTime,L=I+b/1e3;v._volume=l,v._node.gain.setValueAtTime(l,I),v._node.gain.linearRampToValueAtTime(p,L)}u._startFadeInterval(v,l,p,b,w[M],typeof _>"u")}}return u},_startFadeInterval:function(l,p,b,_,u,w){var M=this,v=p,I=b-p,L=Math.abs(I/.01),K=Math.max(4,L>0?_/L:_),W=Date.now();l._fadeTo=b,l._interval=setInterval(function(){var U=(Date.now()-W)/_;W=Date.now(),v+=I*U,v=Math.round(v*100)/100,I<0?v=Math.max(b,v):v=Math.min(b,v),M._webAudio?l._volume=v:M.volume(v,l._id,!0),w&&(M._volume=v),(b<p&&v<=b||b>p&&v>=b)&&(clearInterval(l._interval),l._interval=null,l._fadeTo=null,M.volume(b,l._id),M._emit("fade",l._id))},K)},_stopFade:function(l){var p=this,b=p._soundById(l);return b&&b._interval&&(p._webAudio&&b._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(b._interval),b._interval=null,p.volume(b._fadeTo,l),b._fadeTo=null,p._emit("fade",l)),p},loop:function(){var l=this,p=arguments,b,_,u;if(p.length===0)return l._loop;if(p.length===1)if(typeof p[0]=="boolean")b=p[0],l._loop=b;else return u=l._soundById(parseInt(p[0],10)),u?u._loop:!1;else p.length===2&&(b=p[0],_=parseInt(p[1],10));for(var w=l._getSoundIds(_),M=0;M<w.length;M++)u=l._soundById(w[M]),u&&(u._loop=b,l._webAudio&&u._node&&u._node.bufferSource&&(u._node.bufferSource.loop=b,b&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop,l.playing(w[M])&&(l.pause(w[M],!0),l.play(w[M],!0)))));return l},rate:function(){var l=this,p=arguments,b,_;if(p.length===0)_=l._sounds[0]._id;else if(p.length===1){var u=l._getSoundIds(),w=u.indexOf(p[0]);w>=0?_=parseInt(p[0],10):b=parseFloat(p[0])}else p.length===2&&(b=parseFloat(p[0]),_=parseInt(p[1],10));var M;if(typeof b=="number"){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,p)}}),l;typeof _>"u"&&(l._rate=b),_=l._getSoundIds(_);for(var v=0;v<_.length;v++)if(M=l._soundById(_[v]),M){l.playing(_[v])&&(M._rateSeek=l.seek(_[v]),M._playStart=l._webAudio?e.ctx.currentTime:M._playStart),M._rate=b,l._webAudio&&M._node&&M._node.bufferSource?M._node.bufferSource.playbackRate.setValueAtTime(b,e.ctx.currentTime):M._node&&(M._node.playbackRate=b);var I=l.seek(_[v]),L=(l._sprite[M._sprite][0]+l._sprite[M._sprite][1])/1e3-I,K=L*1e3/Math.abs(M._rate);(l._endTimers[_[v]]||!M._paused)&&(l._clearTimer(_[v]),l._endTimers[_[v]]=setTimeout(l._ended.bind(l,M),K)),l._emit("rate",M._id)}}else return M=l._soundById(_),M?M._rate:l._rate;return l},seek:function(){var l=this,p=arguments,b,_;if(p.length===0)l._sounds.length&&(_=l._sounds[0]._id);else if(p.length===1){var u=l._getSoundIds(),w=u.indexOf(p[0]);w>=0?_=parseInt(p[0],10):l._sounds.length&&(_=l._sounds[0]._id,b=parseFloat(p[0]))}else p.length===2&&(b=parseFloat(p[0]),_=parseInt(p[1],10));if(typeof _>"u")return 0;if(typeof b=="number"&&(l._state!=="loaded"||l._playLock))return l._queue.push({event:"seek",action:function(){l.seek.apply(l,p)}}),l;var M=l._soundById(_);if(M)if(typeof b=="number"&&b>=0){var v=l.playing(_);v&&l.pause(_,!0),M._seek=b,M._ended=!1,l._clearTimer(_),!l._webAudio&&M._node&&!isNaN(M._node.duration)&&(M._node.currentTime=b);var I=function(){v&&l.play(_,!0),l._emit("seek",_)};if(v&&!l._webAudio){var L=function(){l._playLock?setTimeout(L,0):I()};setTimeout(L,0)}else I()}else if(l._webAudio){var K=l.playing(_)?e.ctx.currentTime-M._playStart:0,W=M._rateSeek?M._rateSeek-M._seek:0;return M._seek+(W+K*Math.abs(M._rate))}else return M._node.currentTime;return l},playing:function(l){var p=this;if(typeof l=="number"){var b=p._soundById(l);return b?!b._paused:!1}for(var _=0;_<p._sounds.length;_++)if(!p._sounds[_]._paused)return!0;return!1},duration:function(l){var p=this,b=p._duration,_=p._soundById(l);return _&&(b=p._sprite[_._sprite][1]/1e3),b},state:function(){return this._state},unload:function(){for(var l=this,p=l._sounds,b=0;b<p.length;b++)p[b]._paused||l.stop(p[b]._id),l._webAudio||(l._clearSound(p[b]._node),p[b]._node.removeEventListener("error",p[b]._errorFn,!1),p[b]._node.removeEventListener(e._canPlayEvent,p[b]._loadFn,!1),p[b]._node.removeEventListener("ended",p[b]._endFn,!1),e._releaseHtml5Audio(p[b]._node)),delete p[b]._node,l._clearTimer(p[b]._id);var _=e._howls.indexOf(l);_>=0&&e._howls.splice(_,1);var u=!0;for(b=0;b<e._howls.length;b++)if(e._howls[b]._src===l._src||l._src.indexOf(e._howls[b]._src)>=0){u=!1;break}return r&&u&&delete r[l._src],e.noAudio=!1,l._state="unloaded",l._sounds=[],l=null,null},on:function(l,p,b,_){var u=this,w=u["_on"+l];return typeof p=="function"&&w.push(_?{id:b,fn:p,once:_}:{id:b,fn:p}),u},off:function(l,p,b){var _=this,u=_["_on"+l],w=0;if(typeof p=="number"&&(b=p,p=null),p||b)for(w=0;w<u.length;w++){var M=b===u[w].id;if(p===u[w].fn&&M||!p&&M){u.splice(w,1);break}}else if(l)_["_on"+l]=[];else{var v=Object.keys(_);for(w=0;w<v.length;w++)v[w].indexOf("_on")===0&&Array.isArray(_[v[w]])&&(_[v[w]]=[])}return _},once:function(l,p,b){var _=this;return _.on(l,p,b,1),_},_emit:function(l,p,b){for(var _=this,u=_["_on"+l],w=u.length-1;w>=0;w--)(!u[w].id||u[w].id===p||l==="load")&&(setTimeout((function(M){M.call(this,p,b)}).bind(_,u[w].fn),0),u[w].once&&_.off(l,u[w].fn,u[w].id));return _._loadQueue(l),_},_loadQueue:function(l){var p=this;if(p._queue.length>0){var b=p._queue[0];b.event===l&&(p._queue.shift(),p._loadQueue()),l||b.action()}return p},_ended:function(l){var p=this,b=l._sprite;if(!p._webAudio&&l._node&&!l._node.paused&&!l._node.ended&&l._node.currentTime<l._stop)return setTimeout(p._ended.bind(p,l),100),p;var _=!!(l._loop||p._sprite[b][2]);if(p._emit("end",l._id),!p._webAudio&&_&&p.stop(l._id,!0).play(l._id),p._webAudio&&_){p._emit("play",l._id),l._seek=l._start||0,l._rateSeek=0,l._playStart=e.ctx.currentTime;var u=(l._stop-l._start)*1e3/Math.abs(l._rate);p._endTimers[l._id]=setTimeout(p._ended.bind(p,l),u)}return p._webAudio&&!_&&(l._paused=!0,l._ended=!0,l._seek=l._start||0,l._rateSeek=0,p._clearTimer(l._id),p._cleanBuffer(l._node),e._autoSuspend()),!p._webAudio&&!_&&p.stop(l._id,!0),p},_clearTimer:function(l){var p=this;if(p._endTimers[l]){if(typeof p._endTimers[l]!="function")clearTimeout(p._endTimers[l]);else{var b=p._soundById(l);b&&b._node&&b._node.removeEventListener("ended",p._endTimers[l],!1)}delete p._endTimers[l]}return p},_soundById:function(l){for(var p=this,b=0;b<p._sounds.length;b++)if(l===p._sounds[b]._id)return p._sounds[b];return null},_inactiveSound:function(){var l=this;l._drain();for(var p=0;p<l._sounds.length;p++)if(l._sounds[p]._ended)return l._sounds[p].reset();return new i(l)},_drain:function(){var l=this,p=l._pool,b=0,_=0;if(!(l._sounds.length<p)){for(_=0;_<l._sounds.length;_++)l._sounds[_]._ended&&b++;for(_=l._sounds.length-1;_>=0;_--){if(b<=p)return;l._sounds[_]._ended&&(l._webAudio&&l._sounds[_]._node&&l._sounds[_]._node.disconnect(0),l._sounds.splice(_,1),b--)}}},_getSoundIds:function(l){var p=this;if(typeof l>"u"){for(var b=[],_=0;_<p._sounds.length;_++)b.push(p._sounds[_]._id);return b}else return[l]},_refreshBuffer:function(l){var p=this;return l._node.bufferSource=e.ctx.createBufferSource(),l._node.bufferSource.buffer=r[p._src],l._panner?l._node.bufferSource.connect(l._panner):l._node.bufferSource.connect(l._node),l._node.bufferSource.loop=l._loop,l._loop&&(l._node.bufferSource.loopStart=l._start||0,l._node.bufferSource.loopEnd=l._stop||0),l._node.bufferSource.playbackRate.setValueAtTime(l._rate,e.ctx.currentTime),p},_cleanBuffer:function(l){var p=this,b=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(!l.bufferSource)return p;if(e._scratchBuffer&&l.bufferSource&&(l.bufferSource.onended=null,l.bufferSource.disconnect(0),b))try{l.bufferSource.buffer=e._scratchBuffer}catch{}return l.bufferSource=null,p},_clearSound:function(l){var p=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);p||(l.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(l){this._parent=l,this.init()};i.prototype={init:function(){var l=this,p=l._parent;return l._muted=p._muted,l._loop=p._loop,l._volume=p._volume,l._rate=p._rate,l._seek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++e._counter,p._sounds.push(l),l.create(),l},create:function(){var l=this,p=l._parent,b=e._muted||l._muted||l._parent._muted?0:l._volume;return p._webAudio?(l._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),l._node.gain.setValueAtTime(b,e.ctx.currentTime),l._node.paused=!0,l._node.connect(e.masterGain)):e.noAudio||(l._node=e._obtainHtml5Audio(),l._errorFn=l._errorListener.bind(l),l._node.addEventListener("error",l._errorFn,!1),l._loadFn=l._loadListener.bind(l),l._node.addEventListener(e._canPlayEvent,l._loadFn,!1),l._endFn=l._endListener.bind(l),l._node.addEventListener("ended",l._endFn,!1),l._node.src=p._src,l._node.preload=p._preload===!0?"auto":p._preload,l._node.volume=b*e.volume(),l._node.load()),l},reset:function(){var l=this,p=l._parent;return l._muted=p._muted,l._loop=p._loop,l._volume=p._volume,l._rate=p._rate,l._seek=0,l._rateSeek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++e._counter,l},_errorListener:function(){var l=this;l._parent._emit("loaderror",l._id,l._node.error?l._node.error.code:0),l._node.removeEventListener("error",l._errorFn,!1)},_loadListener:function(){var l=this,p=l._parent;p._duration=Math.ceil(l._node.duration*10)/10,Object.keys(p._sprite).length===0&&(p._sprite={__default:[0,p._duration*1e3]}),p._state!=="loaded"&&(p._state="loaded",p._emit("load"),p._loadQueue()),l._node.removeEventListener(e._canPlayEvent,l._loadFn,!1)},_endListener:function(){var l=this,p=l._parent;p._duration===1/0&&(p._duration=Math.ceil(l._node.duration*10)/10,p._sprite.__default[1]===1/0&&(p._sprite.__default[1]=p._duration*1e3),p._ended(l)),l._node.removeEventListener("ended",l._endFn,!1)}};var r={},o=function(l){var p=l._src;if(r[p]){l._duration=r[p].duration,y(l);return}if(/^data:[^;]+;base64,/.test(p)){for(var b=atob(p.split(",")[1]),_=new Uint8Array(b.length),u=0;u<b.length;++u)_[u]=b.charCodeAt(u);f(_.buffer,l)}else{var w=new XMLHttpRequest;w.open(l._xhr.method,p,!0),w.withCredentials=l._xhr.withCredentials,w.responseType="arraybuffer",l._xhr.headers&&Object.keys(l._xhr.headers).forEach(function(M){w.setRequestHeader(M,l._xhr.headers[M])}),w.onload=function(){var M=(w.status+"")[0];if(M!=="0"&&M!=="2"&&M!=="3"){l._emit("loaderror",null,"Failed loading audio file with status: "+w.status+".");return}f(w.response,l)},w.onerror=function(){l._webAudio&&(l._html5=!0,l._webAudio=!1,l._sounds=[],delete r[p],l.load())},c(w)}},c=function(l){try{l.send()}catch{l.onerror()}},f=function(l,p){var b=function(){p._emit("loaderror",null,"Decoding audio data failed.")},_=function(u){u&&p._sounds.length>0?(r[p._src]=u,y(p,u)):b()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(l).then(_).catch(b):e.ctx.decodeAudioData(l,_,b)},y=function(l,p){p&&!l._duration&&(l._duration=p.duration),Object.keys(l._sprite).length===0&&(l._sprite={__default:[0,l._duration*1e3]}),l._state!=="loaded"&&(l._state="loaded",l._emit("load"),l._loadQueue())},x=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var l=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),p=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),b=p?parseInt(p[1],10):null;if(l&&b&&b<9){var _=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!_&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};s.Howler=e,s.Howl=n,typeof pl<"u"?(pl.HowlerGlobal=t,pl.Howler=e,pl.Howl=n,pl.Sound=i):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var i=n._howls.length-1;i>=0;i--)n._howls[i].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,i){var r=this;if(!r.ctx||!r.ctx.listener)return r;if(n=typeof n!="number"?r._pos[1]:n,i=typeof i!="number"?r._pos[2]:i,typeof e=="number")r._pos=[e,n,i],typeof r.ctx.listener.positionX<"u"?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]);else return r._pos;return r},HowlerGlobal.prototype.orientation=function(e,n,i,r,o,c){var f=this;if(!f.ctx||!f.ctx.listener)return f;var y=f._orientation;if(n=typeof n!="number"?y[1]:n,i=typeof i!="number"?y[2]:i,r=typeof r!="number"?y[3]:r,o=typeof o!="number"?y[4]:o,c=typeof c!="number"?y[5]:c,typeof e=="number")f._orientation=[e,n,i,r,o,c],typeof f.ctx.listener.forwardX<"u"?(f.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),f.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),f.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),f.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),f.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),f.ctx.listener.upZ.setTargetAtTime(c,Howler.ctx.currentTime,.1)):f.ctx.listener.setOrientation(e,n,i,r,o,c);else return y;return f},Howl.prototype.init=function(e){return function(n){var i=this;return i._orientation=n.orientation||[1,0,0],i._stereo=n.stereo||null,i._pos=n.pos||null,i._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},i._onstereo=n.onstereo?[{fn:n.onstereo}]:[],i._onpos=n.onpos?[{fn:n.onpos}]:[],i._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(e,n)}}),i;var r=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof e=="number")i._stereo=e,i._pos=[e,0,0];else return i._stereo;for(var o=i._getSoundIds(n),c=0;c<o.length;c++){var f=i._soundById(o[c]);if(f)if(typeof e=="number")f._stereo=e,f._pos=[e,0,0],f._node&&(f._pannerAttr.panningModel="equalpower",(!f._panner||!f._panner.pan)&&t(f,r),r==="spatial"?typeof f._panner.positionX<"u"?(f._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),f._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),f._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):f._panner.setPosition(e,0,0):f._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",f._id);else return f._stereo}return i},Howl.prototype.pos=function(e,n,i,r){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(e,n,i,r)}}),o;if(n=typeof n!="number"?0:n,i=typeof i!="number"?-.5:i,typeof r>"u")if(typeof e=="number")o._pos=[e,n,i];else return o._pos;for(var c=o._getSoundIds(r),f=0;f<c.length;f++){var y=o._soundById(c[f]);if(y)if(typeof e=="number")y._pos=[e,n,i],y._node&&((!y._panner||y._panner.pan)&&t(y,"spatial"),typeof y._panner.positionX<"u"?(y._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),y._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),y._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):y._panner.setPosition(e,n,i)),o._emit("pos",y._id);else return y._pos}return o},Howl.prototype.orientation=function(e,n,i,r){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(e,n,i,r)}}),o;if(n=typeof n!="number"?o._orientation[1]:n,i=typeof i!="number"?o._orientation[2]:i,typeof r>"u")if(typeof e=="number")o._orientation=[e,n,i];else return o._orientation;for(var c=o._getSoundIds(r),f=0;f<c.length;f++){var y=o._soundById(c[f]);if(y)if(typeof e=="number")y._orientation=[e,n,i],y._node&&(y._panner||(y._pos||(y._pos=o._pos||[0,0,-.5]),t(y,"spatial")),typeof y._panner.orientationX<"u"?(y._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),y._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),y._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):y._panner.setOrientation(e,n,i)),o._emit("orientation",y._id);else return y._orientation}return o},Howl.prototype.pannerAttr=function(){var e=this,n=arguments,i,r,o;if(!e._webAudio)return e;if(n.length===0)return e._pannerAttr;if(n.length===1)if(typeof n[0]=="object")i=n[0],typeof r>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),e._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:e._panningModel});else return o=e._soundById(parseInt(n[0],10)),o?o._pannerAttr:e._pannerAttr;else n.length===2&&(i=n[0],r=parseInt(n[1],10));for(var c=e._getSoundIds(r),f=0;f<c.length;f++)if(o=e._soundById(c[f]),o){var y=o._pannerAttr;y={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:y.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:y.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:y.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:y.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:y.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:y.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:y.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:y.panningModel};var x=o._panner;x||(o._pos||(o._pos=e._pos||[0,0,-.5]),t(o,"spatial"),x=o._panner),x.coneInnerAngle=y.coneInnerAngle,x.coneOuterAngle=y.coneOuterAngle,x.coneOuterGain=y.coneOuterGain,x.distanceModel=y.distanceModel,x.maxDistance=y.maxDistance,x.refDistance=y.refDistance,x.rolloffFactor=y.rolloffFactor,x.panningModel=y.panningModel}return e},Sound.prototype.init=function(e){return function(){var n=this,i=n._parent;n._orientation=i._orientation,n._stereo=i._stereo,n._pos=i._pos,n._pannerAttr=i._pannerAttr,e.call(this),n._stereo?i.stereo(n._stereo):n._pos&&i.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,i=n._parent;return n._orientation=i._orientation,n._stereo=i._stereo,n._pos=i._pos,n._pannerAttr=i._pannerAttr,n._stereo?i.stereo(n._stereo):n._pos?i.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,i._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var t=function(e,n){n=n||"spatial",n==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(Mr);const eg=.2,bC=.9;class AC{constructor(t={}){Ue(this,"lastMusicKey",null);Ue(this,"musicDuckTarget",1);Ue(this,"musicDuckCurrent",1);Ue(this,"musicDuckToken",0);Ue(this,"inited",!1);Ue(this,"sfxMuted",!1);Ue(this,"musicMuted",!1);Ue(this,"sfxVolume01",.8);Ue(this,"musicVolume01",.6);Ue(this,"sfx");Ue(this,"music");Ue(this,"musicBaseLayers",[]);Ue(this,"baseIntensity01",0);Ue(this,"baseLayersInited",!1);Ue(this,"tickId",null);Ue(this,"tickGain",2.3);Ue(this,"tickOn",!1);Ue(this,"tickLastRate",1);Ue(this,"tickLastVol",0);Ue(this,"tickHighId",null);Ue(this,"tickHighOn",!1);Ue(this,"tickHighVolMul",.35);Ue(this,"tickHighLastRate",1);Ue(this,"tickHighLastVol",0);Ue(this,"ticktockId",null);Ue(this,"ticktockOn",!1);Ue(this,"ticktockVolMul",.6);Ue(this,"ticktockRate",1);Ue(this,"fsIntroTractor");Ue(this,"fsIntroTractorId",null);Ue(this,"fsIntroTractorVolMul",.85);Ue(this,"currentMusic",null);Ue(this,"currentMusicKey",null);this.sfxMuted=!!t.sfxMuted,this.musicMuted=!!t.musicMuted,typeof t.sfxVolume01=="number"&&(this.sfxVolume01=Ml(t.sfxVolume01)),typeof t.musicVolume01=="number"&&(this.musicVolume01=Ml(t.musicVolume01)),this.sfx={infused:this.makeSfx("/assets/audio/infused.mp3"),ui_click:this.makeSfx("/assets/audio/ui_click.mp3"),confirm:this.makeSfx("/assets/audio/confirm.mp3"),ui_toggle:this.makeSfx("/assets/audio/ui_toggle.mp3"),spin_start:this.makeSfx("/assets/audio/spin_start.mp3"),reel_land:this.makeSfx("/assets/audio/reel_land.mp3"),cluster_pop:this.makeSfx("/assets/audio/cluster_pop.mp3"),fs_click:this.makeSfx("/assets/audio/fs_click.mp3"),explode:this.makeSfx("/assets/audio/explode.mp3"),car:this.makeSfx("/assets/audio/car.mp3"),fstrigger:this.makeSfx("/assets/audio/fstrigger.mp3"),bigwin_hit:this.makeSfx("/assets/audio/bigwin_hit.mp3"),final_amount:this.makeSfx("/assets/audio/final_amount.mp3"),final_fsoutro_amount:this.makeSfx("/assets/audio/final_fsoutro_amount.mp3"),bounce:this.makeSfx("/assets/audio/bounce.mp3"),boosted:this.makeSfx("/assets/audio/boosted.mp3"),tick:this.makeSfx("/assets/audio/tick.mp3"),tickhigh:new Mr.Howl({src:["/assets/audio/tickhigh.mp3"],preload:!0,loop:!0,volume:this.sfxVolume01}),ticktock:new Mr.Howl({src:["/assets/audio/ticktock.mp3"],preload:!0,loop:!0,volume:this.sfxVolume01}),multiplier:this.makeSfx("/assets/audio/multiplier.mp3")},this.fsIntroTractor=new Mr.Howl({src:["/assets/audio/tractor.mp3"],preload:!0,html5:!1,volume:0,sprite:{loop:[eg*1e3,(bC-eg)*1e3,!0]}}),console.log("[AUDIO] explode howl exists?",!!this.sfx.explode),this.sfx.explode.on("load",()=>console.log("[AUDIO] explode LOADED ✅")),this.sfx.explode.on("loaderror",(e,n)=>console.warn("[AUDIO] explode LOAD ERROR ❌",n)),this.sfx.explode.on("playerror",(e,n)=>console.warn("[AUDIO] explode PLAY ERROR ❌",n)),this.music={music_base:this.makeMusic("/assets/audio/music_base.mp3"),music_fs:this.makeMusic("/assets/audio/music_free.mp3"),music_bigwin:this.makeMusic("/assets/audio/music_bigwin.mp3")},this.musicBaseLayers=[this.makeMusic("/assets/audio/music_base_drums.mp3"),this.makeMusic("/assets/audio/music_base_drums.mp3"),this.makeMusic("/assets/audio/music_base_drums.mp3")];for(const e of this.musicBaseLayers)e.volume(0);this.apply()}getBaseMusicIntensity01(){return this.baseIntensity01}ensureBaseLayersPlaying(){if(!this.baseLayersInited){this.baseLayersInited=!0;for(const t of this.musicBaseLayers){try{t.stop()}catch{}t.volume(0),t.play()}}}stopBaseLayers(t=250){this.baseLayersInited=!1;for(const e of this.musicBaseLayers)if(e){if(e.playing()){const n=e.volume();e.fade(n,0,t),setTimeout(()=>e.stop(),t+20)}else try{e.stop()}catch{}e.volume(0)}}setBaseMusicIntensity(t,e=250){if(this.currentMusicKey!=="music_base")return;if(this.baseIntensity01=Ml(t),this.musicMuted){for(const f of this.musicBaseLayers)f.playing()&&f.volume(0);return}this.ensureBaseLayersPlaying();const n=this.baseIntensity01,i=this.musicVolume01*(.55+.45*n),r=this.musicVolume01*ng((n-.2)/.45),o=this.musicVolume01*ng((n-.55)/.35),c=[i,r,o];for(let f=0;f<this.musicBaseLayers.length;f++){const y=this.musicBaseLayers[f];if(!y)continue;const x=c[f]??0,l=y.volume();y.fade(l,x,e)}}duckMusic(t,e=300){this.musicDuckToken++;const n=this.musicDuckToken,i=this.musicDuckCurrent,r=Math.max(0,Math.min(1,t)),o=performance.now(),c=()=>{if(n!==this.musicDuckToken)return;const f=Math.min(1,(performance.now()-o)/e),y=f*f*(3-2*f);this.musicDuckCurrent=i+(r-i)*y,this.apply(),f<1&&requestAnimationFrame(c)};c()}getMusicDuck(){return this.musicDuckCurrent}initFromUserGesture(){var t,e;if(!this.inited){this.inited=!0,console.log("[AUDIO] usingWebAudio:",Mr.Howler.usingWebAudio,"ctx:",Mr.Howler.ctx);try{(e=(t=Mr.Howler.ctx)==null?void 0:t.resume)==null||e.call(t)}catch{}this.apply()}}setSfxMuted(t){this.sfxMuted=!!t,this.apply()}setMusicMuted(t){var e,n;this.musicMuted=!!t,this.musicMuted?(e=this.stopMusic)==null||e.call(this,120):this.lastMusicKey&&this.playMusic(this.lastMusicKey,120),(n=this.apply)==null||n.call(this)}setSfxVolume01(t){this.sfxVolume01=Ml(t),this.apply()}setMusicVolume01(t){this.musicVolume01=Ml(t),this.apply()}getSfxMuted(){return this.sfxMuted}getMusicMuted(){return this.musicMuted}getSfxVolume01(){return this.sfxVolume01}getMusicVolume01(){return this.musicVolume01}playSfx(t,e=1,n=1){if(this.initFromUserGesture(),this.sfxMuted)return;const i=this.sfx[t];if(!i)return;const r=this.sfxVolume01*Math.max(0,e),o=Math.max(.5,Math.min(2.5,n));i.rate(o),i.volume(r);const c=i.play();i.rate(o,c),i.volume(r,c)}playSfxThrottled(t,e,n=1,i=1){const r=performance.now(),o=`__thr_${t}`,c=this[o];e>0&&c!=null&&r-c<e||(this[o]=r,this.playSfx(t,n,i))}startFsIntroTractorLoop(t=300,e=.85){if(this.fsIntroTractorVolMul=Math.max(0,e),this.sfxMuted)return;const n=this.sfxVolume01*this.fsIntroTractorVolMul,i=this.fsIntroTractorId;if(i!=null&&this.fsIntroTractor.playing(i)){const o=this.fsIntroTractor.volume(i);this.fsIntroTractor.fade(o,n,t,i);return}this.fsIntroTractor.volume(0);const r=this.fsIntroTractor.play("loop");this.fsIntroTractorId=r,this.fsIntroTractor.fade(0,n,t,r)}stopFsIntroTractorLoop(t=250){if(this.fsIntroTractorId==null)return;const e=this.fsIntroTractorId;if(!this.fsIntroTractor.playing(e)){this.fsIntroTractorId=null;return}const n=this.fsIntroTractor.volume(e);this.fsIntroTractor.fade(n,0,t,e),setTimeout(()=>{if(this.fsIntroTractorId===e){try{this.fsIntroTractor.stop(e)}catch{}this.fsIntroTractorId=null}},t+30)}startTickLoop(t=120,e=.35,n=1){if(this.initFromUserGesture(),this.sfxMuted)return;const i=this.sfx.tick;if(console.log("[TICK] startTickLoop",{sfxMuted:this.sfxMuted,sfxVolume01:this.sfxVolume01,volMul:e,rate:n,tickId:this.tickId,playing:this.tickId!=null?i.playing(this.tickId):!1}),!i)return;this.tickOn=!0;const r=this.sfxVolume01*Math.max(0,e)*this.tickGain,o=Math.max(.5,Math.min(3.5,n));if(this.tickId==null||!i.playing(this.tickId)){i.loop(!0),i.volume(0),i.rate(o);const y=i.play();this.tickId=y}const c=this.tickId,f=i.volume(c);try{i.fade(f,r,t,c)}catch{i.volume(r,c)}this.tickLastRate=o,this.tickLastVol=r}setTickParams(t,e){if(!this.tickOn||this.sfxMuted)return;const n=this.sfx.tick;if(!n||this.tickId==null)return;const i=this.tickId,r=this.sfxVolume01*Math.max(0,t),o=Math.max(.5,Math.min(3.5,e));Math.abs(o-this.tickLastRate)>.01&&(n.rate(o,i),this.tickLastRate=o),Math.abs(r-this.tickLastVol)>.01&&(n.volume(r,i),this.tickLastVol=r)}stopTickLoop(t=140){const e=this.sfx.tick;if(!e||(this.tickOn=!1,this.tickId==null))return;const n=this.tickId;this.tickId=null;try{const i=e.volume(n);e.fade(i,0,t,n),setTimeout(()=>{try{e.stop(n)}catch{}},t+20)}catch{try{e.stop(n)}catch{}}}startTicktockLoop(t=120,e=.6,n=1){if(this.initFromUserGesture(),this.sfxMuted)return;const i=this.sfx.ticktock;if(!i)return;this.ticktockOn=!0,this.ticktockVolMul=Math.max(0,e),this.ticktockRate=Math.max(.5,Math.min(2.5,n));const r=this.sfxVolume01*this.ticktockVolMul;if(this.ticktockId!=null&&i.playing(this.ticktockId)){const c=i.volume(this.ticktockId);try{i.fade(c,r,t,this.ticktockId)}catch{i.volume(r,this.ticktockId)}i.rate(this.ticktockRate,this.ticktockId);return}i.volume(0);const o=i.play();this.ticktockId=o,i.loop(!0,o),i.rate(this.ticktockRate,o);try{i.fade(0,r,t,o)}catch{i.volume(r,o)}}startTickHighLoop(t=80,e=.22,n=1){if(this.initFromUserGesture(),this.sfxMuted)return;const i=this.sfx.tickhigh;if(!i)return;this.tickHighOn=!0;const r=this.sfxVolume01*Math.max(0,e),o=Math.max(.5,Math.min(3.5,n));if(this.tickHighId==null||!i.playing(this.tickHighId)){i.volume(0),i.rate(o);const y=i.play();this.tickHighId=y;try{i.loop(!0,y)}catch{i.loop(!0)}}const c=this.tickHighId,f=i.volume(c);try{i.fade(f,r,t,c)}catch{i.volume(r,c)}this.tickHighLastRate=o,this.tickHighLastVol=r}setTickHighParams(t,e){if(!this.tickHighOn||this.sfxMuted)return;const n=this.sfx.tickhigh;if(!n||this.tickHighId==null)return;const i=this.tickHighId,r=this.sfxVolume01*Math.max(0,t),o=Math.max(.5,Math.min(3.5,e));Math.abs(o-this.tickHighLastRate)>.01&&(n.rate(o,i),this.tickHighLastRate=o),Math.abs(r-this.tickHighLastVol)>.01&&(n.volume(r,i),this.tickHighLastVol=r)}stopTickHighLoop(t=80){const e=this.sfx.tickhigh;if(!e)return;this.tickHighOn=!1;const n=this.tickHighId;if(this.tickHighId=null,n!=null){try{e.loop(!1,n)}catch{}try{const i=e.volume(n);if(t<=0){try{e.stop(n)}catch{}return}e.fade(i,0,t,n),setTimeout(()=>{try{e.stop(n)}catch{}},t+20)}catch{try{e.stop(n)}catch{}}}}stopTicktockLoop(t=120){const e=this.sfx.ticktock;if(!e)return;this.ticktockOn=!1;const n=this.ticktockId;if(this.ticktockId=null,n==null){try{e.loop(!1)}catch{}try{e.stop()}catch{}return}try{e.loop(!1,n)}catch{}try{const i=e.volume(n);if(t<=0){try{e.stop(n)}catch{}try{e.loop(!1)}catch{}try{e.stop()}catch{}return}e.fade(i,0,t,n),setTimeout(()=>{try{e.stop(n)}catch{}try{e.loop(!1)}catch{}try{e.stop()}catch{}},t+30)}catch{try{e.stop(n)}catch{}try{e.loop(!1)}catch{}try{e.stop()}catch{}}}playMusic(t,e=300){var o;if(this.lastMusicKey=t,this.musicMuted){(o=this.stopMusic)==null||o.call(this,e??0);return}if(this.currentMusicKey===t)return;const n=this.currentMusicKey;if(t==="music_base"){if(this.currentMusic){const c=this.currentMusic;c.fade(c.volume(),0,e),setTimeout(()=>c.stop(),e+20),this.currentMusic=null}this.currentMusicKey="music_base",this.ensureBaseLayersPlaying(),this.setBaseMusicIntensity(this.baseIntensity01,e);return}n==="music_base"&&this.stopBaseLayers(e);const i=this.music[t];if(!i)return;const r=this.currentMusic;if(this.currentMusic=i,this.currentMusicKey=t,i.volume(0),i.loop(!0),i.play(),i.fade(0,this.musicVolume01,e),r){const c=r.volume();r.fade(c,0,e),setTimeout(()=>r.stop(),e+20)}}stopMusic(t=250){if(!this.currentMusic)return;this.currentMusicKey==="music_base"&&this.stopBaseLayers(t);const e=this.currentMusic;if(this.currentMusic=null,this.currentMusicKey=null,!e.playing())return;const n=e.volume();e.fade(n,0,t),setTimeout(()=>e.stop(),t+20)}apply(){if(this.fsIntroTractorId!=null){const t=this.fsIntroTractorId;if(this.sfxMuted)this.fsIntroTractor.volume(0,t);else{const e=this.sfxVolume01*this.fsIntroTractorVolMul;this.fsIntroTractor.volume(e,t)}}this.sfxMuted&&this.stopTicktockLoop(0),this.sfxMuted&&this.stopTickLoop(0),this.sfxMuted&&this.stopTickHighLoop(0);for(const t of Object.keys(this.music)){const e=this.music[t];e&&(this.musicMuted?e.playing()&&e.volume(0):this.currentMusicKey===t?e.volume(this.musicVolume01):e.volume(0))}this.currentMusicKey==="music_base"&&this.setBaseMusicIntensity(this.baseIntensity01,60)}makeSfx(t){const e=new Mr.Howl({src:[t],preload:!0,volume:this.sfxVolume01});return e.on("load",()=>console.log("[SFX load OK]",t)),e.on("loaderror",(n,i)=>console.warn("[SFX load ERROR]",t,i)),e.on("playerror",(n,i)=>console.warn("[SFX play ERROR]",t,i)),e}makeMusic(t){return new Mr.Howl({src:[t],preload:!0,loop:!0,volume:this.musicVolume01})}}function ng(s){const t=Math.max(0,Math.min(1,s));return t*t*(3-2*t)}function Ml(s){return Math.max(0,Math.min(1,s))}function SC(s){const{app:t,root:e,isLoadingVisible:n,layoutDeps:i}=s,r=!1;t.canvas.style.cursor="none";const o=new st;o.zIndex=1e6,o.eventMode="none",e.addChild(o),e.sortChildren(),no(i)&&(o.visible=!1,t.renderer.events.cursorStyles.default="default",t.renderer.events.cursorStyles.pointer="default",t.stage.cursor="default");const c=new xt;c.blendMode="none";const f=new st;f.eventMode="none",f.zIndex=2,o.addChild(f);const y=new st;y.eventMode="none",y.zIndex=3,o.addChild(y);const x=new xt;x.blendMode="normal",o.addChild(x);function l(){x.clear();const P=12;x.rect(-Math.floor(P/2),-Math.floor(P/2),P,P).fill(16777215),x.roundPixels=!0,x.x=Math.round(x.x),x.y=Math.round(x.y)}l();const p=[],b=40;let _=!0,u=t.screen.width/2,w=t.screen.height/1.5,M=u,v=w;function I(P,ot,tt){return Math.max(ot,Math.min(tt,P))}const L=[],K=[];function W(P,ot,tt=!1){let Z=L.pop();if(!Z){const ve=new xt;ve.blendMode="add",Z={g:ve,vx:0,vy:0,vr:0,life:0,life0:0,s0:1}}const j=Z.g;j.clear();const It=tt?4+(Math.random()*3|0):3+(Math.random()*2|0),G=tt?4+(Math.random()*4|0):2+(Math.random()*3|0),Y=[2792948];for(let ve=0;ve<G;ve++){const Ke=(-2+Math.random()*4)*It|0,Ut=(-2+Math.random()*4)*It|0;j.rect(Ke,Ut,It,It).fill({color:Y[Math.random()*Y.length|0],alpha:1})}j.x=P+(-6+Math.random()*12),j.y=ot+(-6+Math.random()*12),j.rotation=Math.random()*Math.PI*2;const Ft=Math.random()*Math.PI*2,fe=(tt?240:140)+Math.random()*(tt?340:220);Z.vx=Math.cos(Ft)*fe,Z.vy=Math.sin(Ft)*fe-(tt?260+Math.random()*220:120+Math.random()*160),Z.vr=(-1+Math.random()*2)*(tt?10:7),Z.life0=(tt?.55:.35)+Math.random()*(tt?.35:.22),Z.life=Z.life0,Z.s0=.9+Math.random()*.9,j.scale.set(Z.s0),j.alpha=tt?1:.85,f.addChild(j),K.push(Z)}const U=[],gt=[];function J(P,ot){at(P,ot);const tt=30;for(let Z=0;Z<tt;Z++)W(P,ot,!0)}function at(P,ot){let tt=U.pop();if(!tt){const Y=new xt;Y.blendMode="add",tt={g:Y,life:0,life0:0,rot:0,s0:1}}const Z=tt.g;Z.clear();const j=0,It=10,G=42;for(let Y=0;Y<j;Y++){const Ft=Y/j*Math.PI*2,fe=Math.cos(Ft)*It,ve=Math.sin(Ft)*It,Ke=Math.cos(Ft)*G,Ut=Math.sin(Ft)*G,Qe=Y%2===0?16777215:16765802;Z.moveTo(fe,ve),Z.lineTo(Ke,Ut),Z.stroke({width:3,color:Qe,alpha:.9})}Z.circle(0,0,6).fill({color:16777215,alpha:1}),Z.x=P,Z.y=ot,Z.alpha=1,tt.life0=.28+Math.random()*.1,tt.life=tt.life0,tt.rot=(-1+Math.random()*2)*2.2,tt.s0=.85+Math.random()*.25,Z.scale.set(tt.s0),y.addChild(Z),gt.push(tt)}function it(P){if(c.clear(),!(P.length<2))for(let ot=0;ot<2;ot++){const tt=ot===1,Z=tt?5227519:13627391;for(let j=1;j<P.length;j++){const It=P[j-1],G=P[j],Ft=1-j/(P.length-1),fe=(tt?.38:.22)*(Ft*Ft);if(fe<.01)continue;const ve=(tt?6:14)*Ft+(tt?2.5:4);c.moveTo(It.x,It.y),c.lineTo(G.x,G.y),c.stroke({width:ve,color:Z,alpha:fe,cap:"round",join:"round"})}}}t.stage.eventMode="static",t.stage.hitArea=t.screen;const Nt=-2,Et=-2,bt=8;function Ye(P,ot){return Math.round(P/ot)*ot}t.stage.on("pointermove",P=>{if(no(i))return;const ot=P.global;u=Ye(ot.x+Nt,bt),w=Ye(ot.y+Et,bt)}),t.stage.on("pointerdown",()=>{n()&&_&&J(u,w)});function ft(){_=!1,t.canvas.style.cursor="none";for(let P=K.length-1;P>=0;P--){const ot=K[P];ot.g.removeFromParent(),L.push(ot),K.splice(P,1)}c.clear(),o.removeFromParent()}let At=0;return fn(P=>{if(!_||no(i))return;M=u,v=w,x.position.set(M,v),x.x=Math.round(x.x),x.y=Math.round(x.y),p.unshift({x:M,y:v}),p.length>b&&p.pop(),it(p);const ot=performance.now()*.0032;if(x.scale.set(1+Math.sin(ot)*.06),n()||r){At+=28*P;const j=Math.floor(At);j>0&&(At-=j);for(let It=0;It<j;It++){const G=Math.min(p.length-1,6+(Math.random()*6|0)),Y=p[G]??p[p.length-1];W(Y.x,Y.y,!1)}}for(let Z=K.length-1;Z>=0;Z--){const j=K[Z],It=j.g;j.vy+=620*P,It.x+=j.vx*P,It.y+=j.vy*P,It.rotation+=j.vr*P,j.life-=P;const G=I(j.life/j.life0,0,1);It.alpha=.95*G*G;const Y=j.s0*(.85+.15*G);It.scale.set(Y),j.life<=0&&(It.removeFromParent(),K.splice(Z,1),L.push(j))}for(let Z=gt.length-1;Z>=0;Z--){const j=gt[Z],It=j.g;j.life-=P;const G=I(j.life/j.life0,0,1);It.alpha=G*G,It.rotation+=j.rot*P;const Y=j.s0*(.92+.08*G);It.scale.set(Y),j.life<=0&&(It.removeFromParent(),gt.splice(Z,1),U.push(j))}}),window.__stopLoaderMagicCursor=ft,{stop:ft}}let qn=null,Te=null,se=null,bh=s=>{},sg=.1,Xt=null,Vt=null,wn=null,Mn=null;async function wC(){var Mm,Tm,vm,Em,Cm,Im,Pm,Om;if(window.__GAME_BOOTED__)return;window.__GAME_BOOTED__=!0,ZE(.49295,.49295),console.log("[RTP SCALE SET]",.49295);const s=new URLSearchParams(window.location.search).get("lang")||localStorage.getItem("lang")||"en";HS(s),await Nm("en"),await Nm(Pe()),await document.fonts.load('16px "Micro5"'),await document.fonts.load('16px "Pixeldown"'),await document.fonts.ready;const t=document.createElement("canvas");t.width=t.height=2;const e=t.getContext("2d");e&&(e.font='16px "Micro5"',e.fillText(".",0,0),e.font='16px "Pixeldown"',e.fillText(".",0,0)),(Mm=document.getElementById("rotate-blocker-text"))==null||Mm.style.setProperty("font-family",ki(Pe())),console.log("[LANG]",Pe()),console.log("[FONT]",ki(Pe())),console.log("[FONT CHECK ZH]",document.fonts.check('16px "ZCOOLKuaiLe"')),console.log("[FONT CHECK AR]",document.fonts.check('16px "Marhey"'));const n=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||((vm=(Tm=window.matchMedia)==null?void 0:Tm.call(window,"(pointer: coarse)"))==null?void 0:vm.matches);function i(a){var d;const h=(d=a.style)!=null&&d.clone?a.style.clone():{...a.style};h.fontFamily='"Pixeldown"',a.style=new _e(h)}function r(a){var d;const h=(d=a.style)!=null&&d.clone?a.style.clone():{...a.style};h.fontFamily='"Micro5"',a.style=new _e(h)}function o(a){return y(a)?'"Micro5"':ki(a)}function c(a){var m;if(!a)return;const h=y(Pe())?'"Pixeldown"':ki(Pe()),d=(m=a.style)!=null&&m.clone?a.style.clone():{...a.style};d.fontFamily=h,a.style=new _e(d)}function f(a){var d;if(!a)return;const h=(d=a.style)!=null&&d.clone?a.style.clone():{...a.style};h.fontFamily=o(Pe()),a.style=new _e(h)}function y(a){const h=(a||"en").toLowerCase();return["en","es","fr","de","it","pt","nl","sv","da","no","fi","pl","cs","sk","hu","ro","tr"].some(m=>h===m||h.startsWith(m+"-"))}function x(a){return Li(a)}function l(a){var d;if(!a)return;const h=(d=a.style)!=null&&d.clone?a.style.clone():{...a.style};h.fontFamily=x(Pe()),a.style=new _e(h)}function p(){var A,S,T,E,C,k,R,F;wn&&(wn.text=Re(Jt("ui.popup.boosted"))),Mn&&(Mn.text=Re(Jt("ui.popup.infused")));try{wn&&c(wn),Mn&&c(Mn)}catch{}typeof mt<"u"&&(mt.text=Re(Jt("blocky"))),typeof wt<"u"&&(wt.text=Re(Jt("farm")));try{typeof $s<"u"&&($s.text=Re(Jt("ui.totalWin"))),typeof $s<"u"&&c($s),typeof nn<"u"&&c(nn),typeof Kn<"u"&&c(Kn)}catch{}try{if(typeof be<"u"&&(be!=null&&be.length))for(let O=0;O<be.length;O++){const B=be[O],N=B._splashTitle,D=B._splashSubtitle,z=tn[O];if(N&&(z!=null&&z.titleKey)&&(N.text=Re(Jt(z.titleKey))),D&&(z!=null&&z.bodyKey)&&(D.text=Re(Jt(z.bodyKey))),N&&(N.style=new _e(we({...N.style}))),D){const $=we({...D.style});$.fontFamily=Q_(Pe()),D.style=new _e($)}}typeof ge<"u"&&(ge!=null&&ge.visible)&&typeof Gi=="function"&&Gi()}catch{}if(typeof Fe<"u"&&(Fe.text=Jt("ui.loading")),typeof Pt<"u"){const O=parseInt(String(Pt.text).replace(/[^\d]/g,""),10)||0;Pt.text=`${Jt("ui.loadingPct")} ${O}%`}typeof Fe<"u"&&(Fe.style=new _e(we({...Fe.style}))),typeof Pt<"u"&&(Pt.style=new _e(we({...Pt.style}))),typeof Fe<"u"&&f(Fe),typeof Pt<"u"&&f(Pt),typeof yn<"u"&&(yn.text=Re(Jt("ui.freeSpins")));try{const O=Zn(Pe());if(typeof En<"u"&&En){const B=(A=En.style)!=null&&A.clone?En.style.clone():{...En.style};B.fontFamily=O,En.style=new _e(B)}if(typeof yn<"u"&&yn){const B=(S=yn.style)!=null&&S.clone?yn.style.clone():{...yn.style};B.fontFamily=O,yn.style=new _e(B)}}catch{}fe.text=Jt("ui.rotateBackPortrait");const a=Jt("ui.clickToContinue");typeof en<"u"&&(en.text=Re(a)),typeof Ve<"u"&&(Ve.text=Re(a)),typeof Kn<"u"&&(Kn.text=Re(a)),typeof Ht<"u"&&(Ht.text=Re(a)),typeof $t<"u"&&((T=_==null?void 0:_.overlay)!=null&&T.bigWin)&&_c(Vo??"BIG");try{const O=Zn(Pe());if(typeof $t<"u"&&$t){const B=(E=$t.style)!=null&&E.clone?$t.style.clone():{...$t.style};B.fontFamily=O,$t.style=new _e(B)}if(typeof le<"u"&&le){const B=(C=le.style)!=null&&C.clone?le.style.clone():{...le.style};B.fontFamily=O,le.style=new _e(B)}if(typeof Ht<"u"&&Ht){const B=(k=Ht.style)!=null&&k.clone?Ht.style.clone():{...Ht.style};B.fontFamily=O,Ht.style=new _e(B)}}catch{}const h=we({...en==null?void 0:en.style});typeof en<"u"&&(en.style=new _e(h));const d=we({...Ve==null?void 0:Ve.style});typeof Ve<"u"&&(Ve.style=new _e(d));const m=we({...Kn==null?void 0:Kn.style});typeof Kn<"u"&&(Kn.style=new _e(m));const g=we({...Ht==null?void 0:Ht.style});typeof Ht<"u"&&(Ht.style=new _e(g)),typeof Si<"u"&&r(Si);try{typeof ai<"u"&&l(ai),typeof Os<"u"&&l(Os),typeof qs<"u"&&l(qs),typeof Gs<"u"&&l(Gs),typeof Ls<"u"&&l(Ls),typeof qi<"u"&&l(qi),typeof Oc<"u"&&l(Oc),typeof el<"u"&&l(el)}catch{}try{if(typeof Ct<"u"){Ct.text=Re(Jt("splash.title.blocky"));const O=(R=Ct.style)!=null&&R.clone?Ct.style.clone():{...Ct.style};O.fontFamily=rr(Pe()),Ct.style=new _e(O)}if(typeof Wt<"u"){Wt.text=Re(Jt("splash.title.farm"));const O=(F=Wt.style)!=null&&F.clone?Wt.style.clone():{...Wt.style};O.fontFamily=rr(Pe()),Wt.style=new _e(O)}if(typeof be<"u"&&(be!=null&&be.length))for(let O=0;O<be.length;O++){const B=be[O],N=B._splashTitle,D=B._splashSubtitle,z=tn[O];N&&(z!=null&&z.titleKey)&&(N.text=Re(Jt(z.titleKey))),D&&(z!=null&&z.bodyKey)&&(D.text=Re(Jt(z.bodyKey))),N&&(N.style=new _e(we({...N.style}))),D&&(D.style=new _e(we({...D.style})))}typeof ge<"u"&&(ge!=null&&ge.visible)&&typeof Gi=="function"&&Gi()}catch{}}function b(){["#hud","#topLeftHud","#debugHud",".hud",".top-left-hud",".debug-hud"].forEach(d=>{document.querySelectorAll(d).forEach(m=>m.remove())});const h=["Mode:","Mult:","Win:","FS:","SPIN"];document.querySelectorAll("body *").forEach(d=>{const m=d.innerText;if(m&&h.some(g=>m.includes(g))){const g=d.getBoundingClientRect();g.width<900&&g.height<120&&d.remove()}})}b();const _={overlay:{splash:!1,startup:!1,studio:!1,fsIntro:!1,fsOutro:!1,fsOutroPending:!1,bigWin:!1},mult:{value:1,index:0,maxIndex:0},win:{spinWin:0,totalWin:0,totalWinX:0},ui:{settingsOpen:!1,buyMenuOpen:!1,spinning:!1,auto:!1,turbo:!1,autoPendingRounds:-1,autoArmed:!1,autoRounds:-1,autoLeft:0},game:{mode:"BASE",returningFromFreeSpins:!1},fs:{remaining:0,total:0,ladderIndex:1,sessionTotalWin:0,totalCap:20},bank:{betLevels:[.1,.2,.3,.4,.5,.6,.8,1,1.2,1.4,1.6,1.8,2,3,4,5,6,7,8,9,10,12,14,16,18,20,30,40,50,75,100,150,200,250,300,350,400,450,500,750,1e3],betIndex:7,balance:1e3,lastWin:0}},u=new AC({sfxMuted:!1,musicMuted:!1,sfxVolume01:.8,musicVolume01:.6});window.addEventListener("keydown",async a=>{var d,m,g,A;if(a.key.toLowerCase()!=="m")return;await((d=u==null?void 0:u.initFromUserGesture)==null?void 0:d.call(u));const h=((m=u==null?void 0:u.getMusicMuted)==null?void 0:m.call(u))??!1;(g=u==null?void 0:u.setMusicMuted)==null||g.call(u,!h),(A=u==null?void 0:u.apply)==null||A.call(u),console.log("[M TEST] musicMuted ->",!h)});function w(a=10,h=2){const d=In.indexOf(h);_.fs.ladderIndex=d>=0?d:0;const m=In[_.fs.ladderIndex];h0(m),Lc(m),_.game.mode="FREE_SPINS",sl(),Ae&&(Ae.s.removeFromParent(),Ae=null),Uo(),ur=9999,Ra=!1;for(let g=ds.length-1;g>=0;g--){const A=ds[g];A.c.removeFromParent(),Bo.push(A)}ds.length=0,Ba=!1;for(let g=Ps.length-1;g>=0;g--){const A=Ps[g];A.c.removeFromParent(),tc.push(A)}Ps.length=0,ho=0,hr=!1,lo(),Fn=0,Ua=!0,_.fs.remaining=Math.min(a,_.fs.totalCap),_.fs.total=_.fs.remaining,_.fs.sessionTotalWin=0,Xu("FREE_SPINS"),qp(!0,.72,8,vA),Ai.visible=!1,ji.visible=!1,Ai.alpha=0,ji.alpha=0,console.log("🔥 FORCED FREE SPINS",_.fs.remaining)}const M=new st,v=6,I=5;let L=130;const K=4.1,W=0,U=v*I,gt=1,J=6,at=1.2,it=0,Nt=1.18;function Et(a){const h=a.texture.width||1,d=a.texture.height||1,m=L-J*2,g=L-J*2,A=Math.min(m/h,g/d)*gt;return a.scale.set(A),A}function bt(a,h){const d=Et(a);return h==="S1"?a.scale.set(d*at):h==="W1"?a.scale.set(d*Nt):a.scale.set(d),d}const Ye=document.getElementById("stage");if(!Ye)throw new Error("Missing #stage div. Check index.html.");const ft=!1;let At=!1;const P=new sy,tt=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)?1.25:2;await P.init({resizeTo:window,backgroundAlpha:0,resolution:Math.min(tt,window.devicePixelRatio||1),autoDensity:!0}),lC(P),Ye.appendChild(P.canvas);function Z(){const a=P.screen.width,h=P.screen.height,d=sg,m=Sl(),g=wl(),A=h*(1-d)-g-m-40,T=(a-40)/v,E=A/I;return Math.floor(Math.max(72,Math.min(130,Math.min(T,E))))}let j=0;fn(()=>{const a=P.ticker.deltaMS;a>j&&(j=a,j>300&&console.log("[HITCH]",Math.round(j),"ms"))}),fn(()=>{if(!Xt||!Vt||!_.overlay.splash)return;const a=Xt.visible&&Xt.alpha>.02,h=Vt.visible&&Vt.alpha>.02;!a&&!h&&(console.warn("[SPLASH BLACK] background sprites both OFF",{bgBaseVisible:Xt.visible,bgBaseAlpha:Xt.alpha,bgFreeVisible:Vt.visible,bgFreeAlpha:Vt.alpha,cloudLive:Ps.length,leafLive:ds.length,smokeLive:Ks.length,bgChildren:M.children.length}),M.visible=!0,M.alpha=1,Xt.visible=!0,Xt.alpha=.9,Vt.visible=!1,Vt.alpha=0)});const G={app:P,LOCK_MOBILE_TO_PORTRAIT:!0,IS_TOUCH:n};no(G)?(P.canvas.style.cursor="auto",document.body.style.cursor="auto",(Cm=document.getElementById("stage"))!=null&&Cm.style&&(document.getElementById("stage").style.cursor="auto")):(P.canvas.style.cursor="none",document.body.style.cursor="none",(Em=document.getElementById("stage"))!=null&&Em.style&&(document.getElementById("stage").style.cursor="none"));const Y=new st,Ft=new xt;Ft.zIndex=1e7,Ft.visible=!1,Ft.eventMode="static",Ft.cursor="default",Y.addChild(Ft);const fe=new yt(Jt("ui.rotateBackPortrait"),{...we({fontFamily:"Micro5",fontSize:36,fill:16777215,align:"center",letterSpacing:2,stroke:{color:0,width:4}})});fe.anchor.set(.5),Ft.addChild(fe);function ve(){fe.text=Jt("ui.rotateBackPortrait");const a=P.screen.width,h=P.screen.height;Ft.clear(),Ft.rect(0,0,a,h).fill({color:0,alpha:.85}),fe.x=Math.round(a/2),fe.y=Math.round(h/2)}Y.sortableChildren=!0;const Ke=new xt;Ke.clear(),Ke.rect(0,0,window.innerWidth,window.innerHeight).fill(0),Ke.zIndex=-999999,Y.addChild(Ke),window.addEventListener("resize",()=>{Ke.clear(),Ke.rect(0,0,window.innerWidth,window.innerHeight).fill(0)});const Ut=new st;Ut.skew.set(0,.39),Ut.zIndex=5e3,Ut.visible=!1,Ut.eventMode="none",Ut.scale.set(1,1.1);const Qe=new yt({text:Jt("ui.freeSpins"),style:we({fontFamily:"Pixeldown",fill:16777215,fontSize:40,fontWeight:"100",align:"center",dropShadow:!0,dropShadowDistance:7})}),ue=new yt({text:"0/0",style:we({fontFamily:"Pixeldown",fill:16765802,fontSize:50,fontWeight:"100",align:"center",dropShadow:!0,dropShadowDistance:7})});ue.anchor.set(.5),Qe.anchor.set(.5),Qe.x=0,ue.x=0,Qe.roundPixels=!0,ue.roundPixels=!0,Qe.y=0,ue.y=40,Ut.addChild(Qe,ue),Ut.scale.set(1,1.1),Y.addChild(Ut);function mn(){const a=P.renderer.width,h=P.renderer.height;if(He(G)){Ut.scale.set(.62,.62*1.1),Ut.position.set(Math.round(a*.5),Math.round(h*.06));return}if(ln(G)){Ut.scale.set(.65,.75),Ut.position.set(Math.round(a*.78),Math.round(h*.5));return}Ut.scale.set(1,1.1),Ut.position.set(Math.round(a*.81),148)}function xe(){Qe.text=Jt("ui.freeSpins");const a=_.game.mode==="FREE_SPINS"||_.overlay.fsOutroPending;if(Ut.visible=a,!a)return;const h=_.fs.total>0?_.fs.total:_.fs.remaining;ue.text=`${Math.max(0,_.fs.remaining)}/${Math.max(0,h)}`}function cn(a=5){if(_.game.mode!=="FREE_SPINS")return;const h=_.fs.remaining;_.fs.remaining=Math.min(_.fs.totalCap,_.fs.remaining+a);const d=_.fs.remaining-h;d<=0||(xe(),jp(d))}mn(),fn(a=>{if(!_.overlay.splash||!ni)return;Ce+=a;const h=Ce,d=Math.sin(h*Math.PI*2*Je)*Xe,m=Math.cos(h*Math.PI*2*Je*.9)*fi;Ct.x=mi+m*Cs,Ct.y=_i+d*Cs,Wt.x=Lo+m*Cs,Wt.y=Wi+d*Cs}),fn(()=>{mn(),xe()}),P.stage.addChild(Y);let Le=null;function $e(){Le!=null&&window.clearTimeout(Le),Le=window.setTimeout(()=>{Le=null,requestAnimationFrame(()=>{requestAnimationFrame(()=>{qu(),Y.sortChildren(),P.stage.hitArea=P.screen})})},120)}window.removeEventListener("resize",$e),window.removeEventListener("orientationchange",$e),window.addEventListener("resize",$e,{passive:!0}),window.addEventListener("orientationchange",$e,{passive:!0}),window.visualViewport&&(window.visualViewport.addEventListener("resize",$e,{passive:!0}),window.visualViewport.addEventListener("scroll",$e,{passive:!0}));let Pn=!1;function ei(){Pn||(Pn=!0,Y.sortableChildren=!0,Mt.sortableChildren=!0,M.sortableChildren=!0,M.parent||Y.addChild(M),Mt.parent||Y.addChild(Mt),xn.parent||Y.addChild(xn),Y.sortChildren())}const Ee=new st;Ee.zIndex=999999,Ee.eventMode="static",Ee.cursor="default",Y.addChild(Ee),Y.sortChildren(),SC({app:P,root:Y,layoutDeps:G,isLoadingVisible:()=>Ee.visible});const _n=new xt;Ee.addChild(_n);const Fe=new yt({text:Jt("ui.loading"),style:we({fontFamily:"Micro5",fill:16777215,fontSize:48,fontWeight:"900",letterSpacing:2,dropShadow:!0,dropShadowAlpha:.6,dropShadowDistance:3})});Fe.anchor.set(.5),Ee.addChild(Fe);const Pt=new yt({text:`${Jt("ui.loadingPct")} 0%`,style:we({fontFamily:"Micro5",fill:16765802,fontSize:28,fontWeight:"900",letterSpacing:1,dropShadow:!0,dropShadowAlpha:.5,dropShadowDistance:2})});Fe.anchor.set(.5),Ee.addChild(Fe),Pt.anchor.set(.5),Ee.addChild(Pt),f(Fe),f(Pt),Pt.anchor.set(.5),Ee.addChild(Pt);const Wn=new xt,Dn=new xt;Ee.addChild(Wn,Dn);function Vn(){const a=P.screen.width,h=P.screen.height;_n.clear(),_n.rect(0,0,a,h).fill(0),_n.alpha=1;const d=a/2,m=h/2;Fe.position.set(d,m-70),Pt.position.set(d,m-20);const g=Math.min(520,a*.7),A=18,S=d-g/2,T=m+30;Wn.clear(),Wn.rect(S,T,g,A).fill({color:0,alpha:.18}).stroke({width:2,color:16777215,alpha:.35}),Wn.rect(S+Me,T+Me,g-Me*2,A-Me*2).fill({color:0,alpha:.2}),Dn.clear()}function Xs(a){const h=Math.max(0,Math.min(1,a));Pt.text=`${Math.round(h*100)}%`;const d=P.screen.width,m=Math.min(520,d*.7),g=18,A=d/2,S=Math.round(A-m/2),T=Math.round(P.screen.height/2+30),E=S+Me,C=T+Me,k=m-Me*2,R=g-Me*2,F=Math.max(pe,16),O=Math.min(on,R),B=Math.floor((k+is)/(F+is)),N=Math.round(h*B);Dn.clear();for(let D=0;D<N;D++){const z=E+D*(F+is),$=C+Math.round((R-O)/2);Dn.rect(z,$,F,O).fill({color:16765802,alpha:1}),Dn.rect(z,$,F,2).fill({color:16777215,alpha:.18})}}async function Bs(){Mt.visible=!1,xn.visible=!1;const a=Ee.alpha;await ke(260,h=>{const d=h*h*(3-2*h);Ee.alpha=a*(1-d)}),Ee.visible=!1,Ee.eventMode="none"}let hs=!1;async function On(){if(!hs){hs=!0;try{Xs(1),Zu(),Zc(1,0),await Bs(),wm(),await Kl()}catch(a){throw hs=!1,a}}}const Me=3,is=3,on=18,pe=14;Vn(),Xs(0),window.addEventListener("resize",()=>{Vn();const a=parseInt(Pt.text,10);Number.isNaN(a)||Xs(a/100)});let Ce=0;const Xe=10,fi=4,Je=.18,pi=420;let Cs=0,ni=!1;const Ir=1,Ln=new st;Ln.zIndex=1000002,Ln.visible=!1,Ln.alpha=0,Ln.eventMode="static",Ln.cursor="default",Y.addChild(Ln),Y.sortChildren();const Vs=new xt;Ln.addChild(Vs);const pt=110,Dt=2,qt=new Se(te.WHITE);qt.anchor.set(.5),qt.alpha=0,qt.roundPixels=!0,Ln.addChild(qt);const zt=new Se(te.WHITE);zt.anchor.set(.5),zt.alpha=0,zt.roundPixels=!0,zt.zIndex=10,Ln.addChild(zt),Ln.sortableChildren=!0;let hn=null;function zn(){const a=P.screen.width,h=P.screen.height;Vs.clear(),Vs.rect(0,0,a,h).fill(0),Vs.alpha=1;const d=Math.round(a*.5),m=Math.round(h*.5);qt.position.set(d,m);const g=qt.texture.width||1,A=qt.texture.height||1,S=.42,T=.28,E=a*S,C=h*T,k=Math.min(E/g,C/A);qt.scale.set(k);const R=hn??null;R&&(zt.texture=R,zt.position.set(d,m),zt.scale.set(k),zt.scale.set(k*2))}window.addEventListener("resize",zn);const ge=new st;ge.zIndex=999998,ge.visible=!1,ge.eventMode="static",ge.cursor="pointer",Y.addChild(ge),Y.sortChildren();const kn=new xt;ge.addChild(kn);const rs=new yt({text:`8-BIT WIZARDRY
PRESENTS`,style:{fontFamily:"Micro5",fill:16777215,fontSize:35,align:"center",letterSpacing:1,dropShadow:!1,dropShadowColor:0,dropShadowAlpha:.6,dropShadowDistance:3,dropShadowAngle:-Math.PI/4}});rs.anchor.set(.5),ge.addChild(rs);let ys=!1,zs=[];const xs=new st;xs.eventMode="none",xs.sortableChildren=!1,Ln.addChild(xs);const Gn=60,sr=2.8,io=650,Pr=90,si=220;function Or(){if(ys)return;const a=_s.get(Lr);if(!a){console.warn("[STUDIO] Missing logo texture:",Lr);return}const h=a.source,d=Math.max(8,Math.floor(Gn)),m=Math.floor((a.width||1)/d),g=Math.floor((a.height||1)/d);if(m<=0||g<=0){console.warn("[STUDIO] Logo too small for tiles.",{w:a.width,h:a.height,tile:d});return}const A=qt.scale.x;xs.scale.set(A),xs.position.set(qt.x,qt.y),qt.visible=!1,zs=[];const S=m*d,T=g*d,E=-S/2,C=-T/2;for(let k=0;k<g;k++)for(let R=0;R<m;R++){const F=new oe(R*d,k*d,d,d),O=new te({source:h,frame:F}),B=new Se(O);B.anchor.set(.5),B.roundPixels=!0;const N=E+R*d+d/2,D=C+k*d+d/2;B.x=N,B.y=D,B.rotation=0,xs.addChild(B),zs.push({s:B,homeX:N,homeY:D,col:R,row:k})}ys=!0}async function ir(){var R,F;const a=_s.get(Lr);if(a&&(qt.texture=a),zn(),qt.visible=!1,qt.alpha=0,Or(),!ys)return;Ln.visible=!0,Ln.alpha=1,Ln.eventMode="static",xs.alpha=1;const h=Math.max(...zs.map(O=>O.col))+1,d=Math.max(...zs.map(O=>O.row))+1,m=Array.from({length:h},()=>[]);for(const O of zs)m[O.col].push(O);for(let O=0;O<h;O++)m[O].sort((B,N)=>B.row-N.row);const g=((F=(R=m[0])==null?void 0:R[0])==null?void 0:F.s.texture.frame.height)||Gn,A=d*g,S=Array.from({length:h},(O,B)=>({offsetPx:Math.random()*A,stopping:!1,stopAt:performance.now()+io+B*Pr,stopStart:0,stopFrom:0,stopTo:0}));function T(O,B){for(;O>=B+A;)O-=A;for(;O<B;)O+=A;return O}const E=performance.now(),C=()=>{const O=performance.now(),B=Math.min(.05,P.ticker.deltaMS/1e3),N=Math.min(1,(O-E)/pt),D=N<1?N*N*(3-2*N)*Dt:1,z=sr*A*D;for(let $=0;$<h;$++){const rt=m[$];if(!rt.length)continue;const Q=rt[0].homeY,X=S[$];if(X.stopping){const q=Math.min(1,(O-X.stopStart)/si),ut=1-Math.pow(1-q,3);let vt=X.stopFrom,jt=X.stopTo-vt;jt>A*.5&&(jt-=A),jt<-A*.5&&(jt+=A),X.offsetPx=((vt+jt*ut)%A+A)%A,q>=1&&(X.offsetPx=0)}else if(X.offsetPx=(X.offsetPx+z*B)%A,O>=X.stopAt){X.stopping=!0,X.stopStart=O;const q=X.offsetPx%g,ut=q>g*.5?g-q:-q;let vt=X.offsetPx+ut;vt=(vt%A+A)%A,X.stopFrom=X.offsetPx,X.stopTo=vt}for(const q of rt){let ut=q.homeY+X.offsetPx;ut=T(ut,Q),q.s.y=ut}}};P.ticker.add(C);const k=io+(h-1)*Pr+si+60;await ns(k),P.ticker.remove(C);for(const O of zs)O.s.x=O.homeX,O.s.y=O.homeY,O.s.rotation=0;zt.alpha=0,await ke(260,O=>{const B=O*O*(3-2*O);zt.alpha=B}),await ns(1500),await ke(260,O=>{const B=O*O*(3-2*O);xs.alpha=1-B,zt.alpha=1-B}),zt.alpha=0,xs.alpha=0,Ln.visible=!1,Ln.eventMode="none"}function rr(a){return y(a)?'"Pixeldown"':ki(a)}function Zn(a){const h=(a||"en").toLowerCase();return h==="tr"||h.startsWith("tr-")?ki(a):y(a)?'"Pixeldown"':ki(a)}const Ci={fontFamily:rr(Pe()),fill:16777215,fontSize:100,fontWeight:"200",letterSpacing:0,align:"center",stroke:{color:0,width:14},dropShadow:!0,dropShadowColor:0,dropShadowAngle:-Math.PI/5,dropShadowAlpha:.9,dropShadowDistance:20},Ct=new yt({text:Re(Jt("splash.titleBlocky")),style:Ci});Ct.anchor.set(.5),Ct.skew.set(0,.45);const Wt=new yt({text:Re(Jt("splash.titleFarm")),style:Ci});Wt.anchor.set(.5),Wt.skew.set(0,.45);let mi=0,_i=0,Lo=0,Wi=0,ro=1,oo=1,H=1,V=1;Wt.anchor.set(.5),Wt.skew.set(0,.45);function St(a){const h=a.style.clone?a.style.clone():{...a.style},d=new yt({text:a.text,style:h});return d.style.fill=0,d.style.strokeThickness=0,d.style.dropShadow=!1,d.anchor.set(.5),d.skew.set(-.9,.37),d.filters=[new Co({strength:25})],d.alpha=.35,d.zIndex=5,d}const mt=St(Ct),wt=St(Wt);mt.visible=!1,wt.visible=!1,ge.sortableChildren=!0,Ct.zIndex=20,Wt.zIndex=20,ge.addChild(mt,wt,Ct,Wt);const he=.35,Gt=1.2,ie=22,re=.24,gn=350,Ge=190,bs=1.35,Rn=.69,us=0,Be=new st;Be.zIndex=40,ge.addChild(Be);const tn=[{titleKey:"splash.card1.title",bodyKey:"splash.card1.body"},{titleKey:"splash.card2.title",bodyKey:"splash.card2.body"},{titleKey:"splash.card3.title",bodyKey:"splash.card3.body"}],be=[];for(let a=0;a<tn.length;a++){const h=new st,d=new xt;h.addChild(d);const m=new yt({text:Re(Jt(tn[a].titleKey)),style:we({fontFamily:"pixeldown",fill:16765802,fontSize:50,align:"center",letterSpacing:1,stroke:{color:0,width:6},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.9,dropShadowDistance:4,dropShadowAngle:-Math.PI/4})});m.anchor.set(.5,0),h.addChild(m);const g=we({fontFamily:"Micro5",fill:16777215,fontSize:36,align:"center",letterSpacing:1,stroke:{color:0,width:4},dropShadow:!1,dropShadowColor:0,dropShadowAlpha:.6,dropShadowDistance:3,dropShadowAngle:-Math.PI/4});g.fontFamily=Q_(Pe());const A=new yt({text:Re(Jt(tn[a].bodyKey)),style:g});A.anchor.set(.5,0),h.addChild(A);const S=new st;S.eventMode="none",h.addChild(S),h._splashBg=d,h._splashTitle=m,h._splashSubtitle=A,h._splashArt=S,h.alpha=0,Be.addChild(h),be.push(h)}const gi=.96,Di=26,or=90;function Ca(){return P.screen.height+or}function Yl(){return P.screen.height*gi}function Wh(){en.x=P.screen.width/2}function ko(a,h=320){Wh();const d=Ca(),m=Yl();en.visible=!0,en.alpha=0,en.y=d,ye(h,g=>{const A=Math.max(0,Math.min(1,g));en.alpha=A,en.y=d+(m-d)*A})}const en=new yt({text:Jt("ui.clickToContinue"),style:{}});Yd(en),en.style.dropShadowAngle=-Math.PI/4,en.zIndex=999999,en.visible=!1,en.alpha=0,en.y=Ca(),ge.addChild(en);const Ef=-30,Xl=38,Dh=-50;function Gi(){const a=He(G),h=ln(G),d=P.screen.width,m=P.screen.height;kn.clear(),kn.rect(0,0,d,m).fill(0),kn.alpha=.18,rs.position.set(d*.5,m*.08),rs.visible=!He(G);const g=Math.min(d*.8,1200),A=ln(G)?.35:.6,S=.82,T=-15,E=Ct.getLocalBounds().width,C=Wt.getLocalBounds().width,k=E+T+C,R=g/Math.max(1,k),F=R*A*S,O=R*A;Ct.scale.set(F,O),Wt.scale.set(F,O),ro=F,oo=O,H=F,V=O;const B=Ct.width,N=Wt.width,D=B+T+N,z=d*.5-D/2;Ct.x=z+B/2,Wt.x=Ct.x+B/2+T+N/2,!He(G)&&!ln(G)&&(Wt.x+=Ef);let rt=.25,Q=.15,X=34,q=.1,ut=10,vt,ee;He(G)?(vt=q,ee=ut):ln(G)?(vt=Q,ee=X):(vt=rt,ee=Xl);const jt=h?-28:0;Ct.y=m*vt,Wt.y=m*vt+ee+jt;const Kt=46,Lt=150,ce=.16,et=Ct.scale.y*1.05,_t=Wt.scale.y*1.05;mt.x=Ct.x+Kt,mt.y=Ct.y+Lt,mt.scale.set(et,et*ce),wt.x=Wt.x+Kt,wt.y=Wt.y+Lt,wt.scale.set(_t,_t*ce),mi=Ct.x,Lo=Wt.x,_i=Ct.y,Wi=Wt.y,en.x=d*.5,en.visible||(en.y=Ca());let lt=m*(a?.58:Rn)+us;h&&(lt-=Math.round(m*.08));const ct=ln(G),ws=(a?.62:re)*(a?1:ct?Ir:2.5),Ms=ct?Math.round(Ge*.85):Ge,ts=Math.max(Ms,Math.min(gn,d*ws)),Bt=Math.round(ts*(a?.7:Gt)),ne=Math.round(ts*bs*(ct?.92:1)),Ts=a?Math.round(Bt*.1):0;for(let es=0;es<be.length;es++){const Qs=be[es],Zi=Qs._splashBg,ci=Qs._splashTitle,hi=Qs._splashSubtitle,Rs=Qs._splashArt;if(Zi.clear(),Zi.rect(-ts/2,-Bt/2,ts,Bt).fill({color:0,alpha:he}).stroke({width:2,color:11579568,alpha:.35}),a){Qs.x=Math.round(d*.5);const od=(be.length-1)/2;Qs.y=Math.round(lt+(es-od)*(Bt+Ts))}else Qs.x=Math.round(d/2+(es-1)*ne),Qs.y=Math.round(lt);const Qi=-Bt/2+ie;ci.y=Qi,hi.y=Qi+ci.height+8;const sh=ln(G);a?(ci.scale.set(.75),hi.scale.set(.75),hi.y=Qi+ci.height+6):sh?(ci.scale.set(.68),hi.scale.set(.68),hi.y=Qi+ci.height+6):(ci.scale.set(1),hi.scale.set(1));const Lm={bonus:1.2,multiplier:1.15,maxwin:1},km={bonus:{x:0,y:0},multiplier:{x:0,y:-5},maxwin:{x:0,y:1}},RS=[{scale:.95,x:10,y:0},{scale:1.5,x:0,y:0},{scale:.95,x:-10,y:0}];if(kr(),Rs)if(a)Rs.visible=!1,Rs.removeChildren();else{Rs.visible=!0;const od=16;Rs.x=0,Rs.y=hi.y+hi.height+od;const FS=18,BS=18,Rm=Math.max(10,ts-FS*2),NS=Bt/2,ad=Math.max(10,NS-Rs.y-BS),Fm=(Ji,Sr,ih,Ao=1)=>{const ua=Ji.texture.width||1,fl=Ji.texture.height||1,US=Math.min(Sr/ua,ih/fl)*Ao;Ji.scale.set(US)},ld=Rs.children;if(es===0){const Sr=Math.max(10,(Rm-28)/3),ih=ad;for(let Ao=0;Ao<Math.min(3,ld.length);Ao++){const ua=ld[Ao],fl=RS[Ao]||{scale:1,x:0,y:0};ua.anchor.set(.5),Fm(ua,Sr,ih,Lm.bonus*(fl.scale??1)),ua.x=-Sr-14+Ao*(Sr+14)+(fl.x??0),ua.y=Math.round(ih*.52)+(fl.y??0)}}if(es===1||es===2){const Ji=ld[0];if(Ji){Ji.anchor.set(.5);const Sr=es===1?"multiplier":"maxwin";Fm(Ji,Rm,ad,Lm[Sr]),Ji.x=km[Sr].x||0,Ji.y=Math.round(ad*.55)+(km[Sr].y||0)}}}}if(a){const Qs=Math.round(m*gi)-Math.round(en.height*.5),ci=be[be.length-1].getBounds(),hi=ci.y+ci.height,Rs=Qs-Di,Qi=Math.max(0,Math.round(hi-Rs));if(Qi>0)for(const sh of be)sh.y=Math.round(sh.y-Qi)}}window.addEventListener("resize",Gi);const Vl=.42,zl=18;async function Kl(){Zu(),_.overlay.splash=!0,yS(),Ae&&(Ae.s.removeFromParent(),Ae=null),Ie&&(Ie.s.removeFromParent(),Ie=null),Uo(),kr(),hr=!1,lo(),Fn=0,ni=!1,en.visible=!1,en.alpha=0,en.y=P.screen.height+90,Zc(1,0),ge.visible=!0,ge.alpha=1,ge.eventMode="static",Gi(),Y.sortChildren(),Uf(420),Ba=!0,Uf(420),ho=0,Ps.length===0&&ic(6),Ra=!1,No=0;for(let ct=ds.length-1;ct>=0;ct--){const nt=ds[ct];nt.c.removeFromParent(),Bo.push(nt)}ds.length=0,await bo("BASE",!1,!0);const a=fs.strength;fs.strength=Math.max(a,12),Mt.alpha=0,Mt.eventMode="none",tl(0,0);const h=P.screen.width,d=P.screen.height,m=-Math.max(Ct.height,Wt.height)-140,g=ln(G),A=He(G),S=g?d*Vl:d*.48,T=g?zl:A?10:38,E=700,C=60,k=1.25,R=1.28,F=-15;Ct.y=m,Wt.y=m,Ct.scale.set(ro*k,oo*k),Wt.scale.set(H*R,V*R);const O=Ct.width,B=Wt.width,N=O+F+B,D=h*.5-N/2;Ct.x=D+O/2,Wt.x=Ct.x+O/2+F+B/2,!He(G)&&!ln(G)&&(Wt.x+=Dh);const $=820,rt=ke($,ct=>{mt.visible=!0;const nt=ms(ct,.9);Ct.y=m+(S-m)*nt,mt.x=Ct.x+46,mt.y=Ct.y+150;{const me=Ct.scale.y*1.05;mt.scale.set(me,me*.22)}}),Q=(async()=>{await ns(E),wt.visible=!0,wt.alpha=0,await ke($,ct=>{const nt=ms(ct,.9);wt.alpha=.22*nt,Wt.y=m+(S+T-m)*nt,wt.x=Wt.x+46,wt.y=Wt.y+150;{const me=Wt.scale.y*1.05;wt.scale.set(me,me*.22)}})})();await Promise.all([rt,Q]),await ns(220);const X=520,q=Ct.y,ut=Wt.y,vt=Ct.x,ee=Wt.x,jt=Ct.scale.x,Kt=Ct.scale.y,Lt=Wt.scale.x,ce=Wt.scale.y,et=ke(X,ct=>{const nt=ms(ct,1);Ct.y=q+(_i-q)*nt,Ct.x=vt+(mi-vt)*nt,mt.x=Ct.x+46,mt.y=Ct.y+150;{const me=Ct.scale.y*1.05;mt.scale.set(me,me*.22)}Ct.scale.set(jt+(ro-jt)*nt,Kt+(oo-Kt)*nt),Ct.x=Ct.x+(mi-Ct.x)*nt}),_t=(async()=>{await ns(C),await ke(X,ct=>{const nt=ms(ct,1);Wt.y=ut+(Wi-ut)*nt,Wt.x=ee+(Lo-ee)*nt,wt.x=Wt.x+46,wt.y=Wt.y+150;const Yt=Math.max(0,Math.min(1,(Wi-Wt.y)/200)),me=.98,Ms=.28+Yt*.1,ts=Wt.scale.y*me;wt.scale.set(ts,ts*Ms),Wt.scale.set(Lt+(H-Lt)*nt,ce+(V-ce)*nt)})})();await Promise.all([et,_t]),be.forEach(ct=>{ct.alpha=0;const nt=ct.y;ye(320,Yt=>{const me=Yt*Yt*(3-2*Yt);ct.alpha=me,ct.y=nt-10*(1-me)})}),Ct.x=mi,Ct.y=_i,Wt.x=Lo,Wt.y=Wi,ni=!0,Ce=0,Cs=0,ye(pi,ct=>{Cs=Math.max(0,Math.min(1,ct))},()=>{Cs=1}),Ct.scale.set(ro,oo),Wt.scale.set(H,V),ko(!0,320);const lt=async()=>{if(Cs=0,ni=!1,be.forEach(nt=>nt.alpha=0),!_.overlay.splash)return;ge.off("pointertap",lt);const ct=fs.strength;await ke(320,nt=>{const Yt=nt*nt*(3-2*nt);fs.strength=ct*(1-Yt),ge.alpha=1-Yt}),ge.visible=!1,ge.eventMode="none",_.overlay.splash=!1,xS(),Ba=!0,ho=0,ic(6),Ra=!0,No=0,wm(),setTimeout(()=>{We.visible=!1,d0()},_m+Qu+80)};ge.on("pointertap",lt)}const Lr="/assets/ui/studio_logo.png",As="/assets/ui/studio_logo_house.webp",Ns="/assets/backgrounds/bg_candy_landscape.webp",yi="/assets/backgrounds/bg_candy_landscape_free.webp",Hi="/assets/ui/fs_outro_bg.webp",xi="/assets/ui/infinity.png";let Ia=60,ar=-80,Is=60,lr=-80,Pa=null,ii=null,Yi=null,Xi=null,Vi=null,Ii=null,zi=!1;function kr(){if(!ii||!ii.textures||typeof $r>"u"||!$r||!$r.S1)return;if(He(G)){for(const g of be){const A=g==null?void 0:g._splashArt;A&&(A.removeChildren(),A.visible=!1)}zi=!0;return}if(zi)return;zi=!0;const a=be[0];if(!(a!=null&&a._splashArt))return;const h=be[1];if(h!=null&&h._splashArt){const g=h._splashArt;g.removeChildren();const A=be[2];if(A!=null&&A._splashArt){const T=A._splashArt;T.removeChildren();const E=new Se(rl("splash_max_art.png"));E.anchor.set(.5),E.eventMode="none",E.roundPixels=!0,T.addChild(E)}const S=new Se(rl("splash_multiplier_art.png"));S.anchor.set(.5),S.eventMode="none",S.roundPixels=!0,g.addChild(S)}const d=a._splashArt;d.removeChildren();const m=G0(Mh.S1);for(let g=0;g<3;g++){const A=new Se(m);A.anchor.set(.5),A.eventMode="none",A.roundPixels=!0,d.addChild(A)}}const Rr=new st;Rr.zIndex=120,Rr.eventMode="none",M.addChild(Rr);const cr=new st;cr.sortableChildren=!0,cr.zIndex=200,cr.eventMode="none",M.addChild(cr);let hr=!1,Gh=.9,Hh=.3;const Oa=[{xN:.655,yN:.265,rate:6}],ao=[],Ks=[];let Fn=0,La=!1;const Yh=70,bi=15,Us=3,$l=6;function ka(){const a=new xt,h=Us+Math.random()*($l-Us)|0,d=5+(Math.random()*9|0),m=[16777215,15921906,14277081,13158600];for(let g=0;g<d;g++){const A=(-2+Math.random()*4)*h|0,S=(-2+Math.random()*4)*h|0;Math.random()<.1||a.rect(A,S,h,h).fill({color:m[Math.random()*m.length|0],alpha:1})}return a.alpha=.22+Math.random()*.18,a.scale.set(.9+Math.random()*.7),a}function jl(a,h){const d=P.renderer.width,m=P.renderer.height;let g=ao.pop();g||(g={g:ka(),vx:0,vy:0,life:0,life0:0,spin:0,grow:0});const A=g.g;A.x=d*a+(-6+Math.random()*12),A.y=m*h+(-6+Math.random()*12),g.vx=-4+Math.random()*8,g.vy=-(12+Math.random()*18),g.spin=(-1+Math.random()*2)*.18,g.life0=2.6+Math.random()*1.6,g.life=g.life0,g.vy=-(10+Math.random()*16);const S=Math.max(0,g.life/g.life0);A.alpha=.02+.45*Math.pow(S,2.6),g.grow=.18+Math.random()*.22,A.rotation=Math.random()*Math.PI*2,A.alpha=.14+Math.random()*.1,A.scale.set(.75+Math.random()*.45),_.overlay.fsOutro?lc.addChild(A):cr.addChild(A),Ks.push(g)}function ql(){const a=P.renderer.width,h=P.renderer.height;let d=ao.pop();d||(d={g:ka(),vx:0,vy:0,life:0,life0:0,spin:0,grow:0});const m=d.g,g=a*Gh,A=h*Hh;m.x=g+(-10+Math.random()*20),m.y=A+(-8+Math.random()*16),d.vx=18+Math.random()*26,d.vy=-(22+Math.random()*36),d.spin=(-1+Math.random()*2)*.35,d.life0=1.05+Math.random()*.75,d.life=d.life0,d.grow=.22+Math.random()*.26,m.rotation=Math.random()*Math.PI*2,m.alpha=.22+Math.random()*.18,m.scale.set(.75+Math.random()*.55),cr.addChild(m),Ks.push(d)}function Ro(){const a=P.ticker.deltaMS/1e3,h=P.renderer.width,d=P.renderer.height;if(_.overlay.fsOutro)for(const g of Oa){Fn+=g.rate*a;let A=Math.floor(Fn);A>0&&(Fn-=A),A=Math.min(A,4);for(let S=0;S<A;S++)jl(g.xN,g.yN)}for(let g=Ks.length-1;g>=0;g--){const A=Ks[g],S=A.g,T=Math.sin((S.y+g*17)*.02)*8;S.x+=(A.vx+T)*a,S.y+=A.vy*a,S.rotation+=A.spin*a;const E=S.scale.x+A.grow*a;S.scale.set(E),A.life-=a;const C=Math.max(0,A.life/A.life0);S.alpha=.02+.4*C*C,(A.life<=0||S.x<-220||S.x>h+220||S.y<-220||S.y>d+220)&&(S.removeFromParent(),Ks.splice(g,1),ao.push(A))}if(!hr)return;Fn+=bi*a;let m=Math.floor(Fn);m>0&&(Fn-=m);for(let g=0;g<m&&!(Ks.length>=Yh);g++)ql()}function Fo(){La||(La=!0,fn(()=>Ro()))}function lo(){for(let a=Ks.length-1;a>=0;a--){const h=Ks[a];h.g.removeFromParent(),Ks.splice(a,1),ao.push(h)}Fn=0}Fo();const co=new st;co.sortableChildren=!0,co.zIndex=400,co.eventMode="none",M.sortableChildren=!0,M.addChild(co),M.sortChildren();const Bo=[],ds=[];let No=0,Cf=!1,Ra=!0;const Gy=26,Hy=3,If=4,Yy=7,Pf=.9,Xy=1.35;function Vy(){const a=new st,h=new xt,d=Math.floor(If+Math.random()*(Yy-If+1)),m=4+Math.floor(Math.random()*3),g=3+Math.floor(Math.random()*3),A=(m-1)/2,S=(g-1)/2,T=[7328874,4703338,3126122,9366122];for(let k=0;k<g;k++)for(let R=0;R<m;R++){const F=(R-A)/A,O=(k-S)/S,B=F*F+O*O;B>1.05||Math.random()<.2+B*.25||h.rect(R*d,k*d,d,d).fill({color:T[Math.random()*T.length|0],alpha:1})}const E=h.getLocalBounds();h.x=-E.width/2,h.y=-E.height/2,a.addChild(h),a.alpha=.85+Math.random()*.15;const C=Pf+Math.random()*(Xy-Pf);return a.scale.set(C),a}function zy(){P.renderer.width;const a=P.renderer.height;let h=Bo.pop();h||(h={c:Vy(),vx:0,vy:0,vr:0,life:0}),h.c.x=-80,h.c.y=a*(.15+Math.random()*.65);const d=35+Math.random()*55;h.vx=1*d,h.vy=10+Math.random()*28,h.vr=(-1+Math.random()*2)*.35,h.life=6+Math.random()*4,h.c.rotation=Math.random()*Math.PI*2,co.addChild(h.c),ds.push(h)}function Ky(){if(!Ra)return;const a=P.renderer.width,h=P.renderer.height,d=P.ticker.deltaMS/1e3;No+=Hy*d;const m=Math.floor(No);m>0&&(No-=m);for(let g=0;g<m&&!(ds.length>=Gy);g++)zy();for(let g=ds.length-1;g>=0;g--){const A=ds[g],S=A.c;S.x+=A.vx*d,S.y+=A.vy*d,S.rotation+=A.vr*d,S.y+=Math.sin((S.x+g*13)*.02)*.25,(S.x<-220||S.x>a+220||S.y<-220||S.y>h+220)&&(S.removeFromParent(),ds.splice(g,1),Bo.push(A))}}function $y(){Cf||(Cf=!0,fn(()=>Ky()))}$y();const Fa=new st;Fa.zIndex=119,Fa.eventMode="none",Fa.blendMode="normal",M.addChild(Fa);const Xh=[],Fr=[];let Zl=0;const jy=35,Of=.3,qy=1,Lf=2,Zy=10,Qy=140;function Jy(){return{g:new xt,vx:0,vy:0,life:0,life0:0,s0:1}}function tx(a,h,d,m,g){if(Fr.length>=Qy)return;let A=Xh.pop();A||(A=Jy());const S=A.g;S.clear(),S.blendMode="normal";const T=Lf+Math.random()*(Zy-Lf+1)|0,E=3+(Math.random()*6|0),C=[4868682,5921370,6974058,8026746];for(let $=0;$<E;$++){const rt=(-2+Math.random()*4)*T|0,Q=(-2+Math.random()*4)*T|0;S.rect(rt,Q,T,T).fill({color:C[Math.random()*C.length|0],alpha:1})}const k=-d,R=-m,F=-m,O=d,B=28,N=6;S.x=a+k*B+F*(N*(-1+Math.random()*2))+(-3+Math.random()*6),S.y=h+R*B+O*(N*(-1+Math.random()*2))+(-3+Math.random()*6);const D=Math.max(0,Math.min(1,(g-120)/260)),z=30+70*D;A.vx=k*z+F*(-12+Math.random()*24),A.vy=R*z-(35+55*D)+(-10+Math.random()*20),A.life0=Of+Math.random()*(qy-Of),A.life=A.life0,A.s0=.65+Math.random()*.65,S.scale.set(A.s0),S.alpha=.22+Math.random()*.8,Fa.addChild(S),Fr.push(A)}function ex(a){const h=P.renderer.width,d=P.renderer.height;for(let m=Fr.length-1;m>=0;m--){const g=Fr[m],A=g.g;g.vy-=10*a,A.x+=g.vx*a,A.y+=g.vy*a,g.life-=a;const S=Math.max(0,g.life/g.life0);A.alpha=.35*S*(.35+.65*S);const T=g.s0*(1+(1-S)*.55);A.scale.set(T),(g.life<=0||A.x<-260||A.x>h+260||A.y<-260||A.y>d+260)&&(A.removeFromParent(),Fr.splice(m,1),Xh.push(g))}}function Vh(){Ae&&(Ae.s.removeFromParent(),Ae=null),Ie&&(Ie.s.removeFromParent(),Ie=null),Uo(),ur=9999,Br=9999}function Uo(){for(let a=Fr.length-1;a>=0;a--){const h=Fr[a];h.g.removeFromParent(),Fr.splice(a,1),Xh.push(h)}Zl=0}let Ae=null,ur=0;const Ql=18,kf=35,nx=200;let Ie=null,Br=0;const Jl=10,Rf=18,sx=260,ix=.78;function Ff(){const a=zh();return ln(G)?a*ix:a}function zh(){const a=P.screen.width,h=1920,d=.55,m=1.05,g=a/h;return Math.max(d,Math.min(m,g))}function Kh(){const a=zh(),h=Ff();Ae&&Ae.s.scale.set(a),Ie&&Ie.s.scale.set(h)}const rx=.86,ox=-.08,ax=-.03,lx=.71,$h=220,Bf=520,cx=.86,hx=-.08,ux=-.03,dx=.71,jh=220,Nf=520,Wo=new st;Wo.sortableChildren=!0,Wo.zIndex=300,Wo.eventMode="none",M.sortableChildren=!0,M.addChild(Wo),M.sortChildren();const tc=[],Ps=[];function Uf(a=420){const h=P.renderer.height,d=h*.25,m=h*.6,g=h*.22,A=h*.7,S=Ps.map(k=>k.c.y),T=Ps.map(()=>d+Math.random()*(m-d)),E=ds.map(k=>k.c.y),C=ds.map(()=>g+Math.random()*(A-g));ye(a,k=>{const R=k*k*(3-2*k);for(let F=0;F<Ps.length;F++){const O=Ps[F].c;O.y=S[F]+(T[F]-S[F])*R}for(let F=0;F<ds.length;F++){const O=ds[F].c;O.y=E[F]+(C[F]-E[F])*R}})}let ho=0,Wf=!1,Ba=!0;const Df=10,fx=.35,Gf=4,px=5;function Hf(){const a=new st,h=new xt,d=Math.floor(Gf+Math.random()*(px-Gf+1)),m=10+(Math.random()*10|0),g=4+(Math.random()*5|0),A=(m-1)/2,S=(g-1)/2,T=d,E=d*.55,C=d*.75;function k(N,D){const z=Math.max(0,Math.min(255,Math.round((N>>16&255)*D))),$=Math.max(0,Math.min(255,Math.round((N>>8&255)*D))),rt=Math.max(0,Math.min(255,Math.round((N&255)*D)));return z<<16|$<<8|rt}function R(N,D,z,$){const rt=k(z,1.08),Q=k(z,.92),X=k(z,.84),q=N,ut=D-E,vt=N+T,ee=D,jt=N,Kt=D+E,Lt=N-T,ce=D,et=q,_t=ut+C,lt=vt,ct=ee+C,nt=Lt,Yt=ce+C;h.moveTo(q,ut).lineTo(vt,ee).lineTo(jt,Kt).lineTo(Lt,ce).closePath().fill({color:rt,alpha:$}),h.moveTo(Lt,ce).lineTo(q,ut).lineTo(et,_t).lineTo(nt,Yt).closePath().fill({color:Q,alpha:$}),h.moveTo(q,ut).lineTo(vt,ee).lineTo(lt,ct).lineTo(et,_t).closePath().fill({color:X,alpha:$})}const F=[16777215,16252415,16776178,15921906];for(let N=0;N<g;N++)for(let D=0;D<m;D++){const z=(D-A)/A,$=(N-S)/S,rt=z*z+$*$;if(rt>1.1||Math.random()<.18+rt*.3)continue;const Q=F[Math.random()*F.length|0],X=.65,q=(D-N)*T,ut=(D+N)*E;R(q,ut,Q,X)}const O=h.getLocalBounds();h.x=-O.width/2-O.x,h.y=-O.height/2-O.y,a.addChild(h),a.alpha=.16+Math.random()*.3;const B=1+Math.random()*1.7;return a.scale.set(B),a}function qh(){var B,N,D;if(xh(G)||_.overlay.splash||_.overlay.fsOutroPending||Ie||_.game.mode!=="FREE_SPINS"||_.overlay.fsIntro||_.overlay.fsOutro)return;const a=new Se(Wc("bg_car_night.png"));a.anchor.set(.5),a.scale.set(zh()),a.alpha=1,a.rotation=0;const h=P.renderer.width,d=P.renderer.height,m=Math.round(h*rx),g=Math.round(d*ox),A=Math.round(h*ax),S=Math.round(d*lx);let T=A-m,E=S-g;const C=Math.hypot(T,E)||1,k=T/C,R=E/C,F=A+k*Bf,O=S+R*Bf;a.x=m-k*$h,a.y=g-R*$h,a.rotation=0,(N=(B=a.skew)==null?void 0:B.set)==null||N.call(B,0,0),Rr.addChild(a),(D=u==null?void 0:u.playSfx)==null||D.call(u,"car",.5,1.2),Ie={s:a,vx:sx*2.2+Math.random()*60,nx:k,ny:R,startX:m,startY:g,endX:F,endY:O,t:0}}function Zh(a=!1){var N,D,z;if(xh(G)||_.game.mode==="FREE_SPINS")return;if(_.overlay.fsIntro){Ie&&(Ie.s.removeFromParent(),Ie=null);return}if(_.overlay.fsIntro||_.overlay.fsOutro||_.game.mode!=="BASE"||Ae||Ae||!a&&_.game.mode!=="BASE"||!a&&_.overlay.fsIntro||!a&&_.overlay.fsOutro)return;const h=new Se(Wc("bg_red_car.png"));h.anchor.set(.5),h.scale.set(Ff()),h.alpha=1,h.rotation=0,(D=(N=h.skew)==null?void 0:N.set)==null||D.call(N,0,0);const d=P.renderer.width,m=P.renderer.height,g=Math.round(d*cx),A=Math.round(m*hx),S=Math.round(d*ux),T=Math.round(m*dx);let E=S-g,C=T-A;const k=Math.hypot(E,C)||1,R=E/k,F=C/k,O=S+R*Nf,B=T+F*Nf;h.x=g-R*jh,h.y=A-F*jh,Rr.addChild(h),(z=u==null?void 0:u.playSfx)==null||z.call(u,"car",.5,1.2),Ae={s:h,vx:nx*2.2+Math.random()*60,nx:R,ny:F,startX:g,startY:A,endX:O,endY:B,t:0},console.log("[BG CAR] spawnBgCar OK",{force:a,mode:_.game.mode})}let ec=!1,nc=null,Yf=!1;function Xf(a){return a.code==="Space"||a.key===" "||a.key==="Enter"}function sc(a){var h,d,m;(h=a.preventDefault)==null||h.call(a),(d=a.stopImmediatePropagation)==null||d.call(a),(m=a.stopPropagation)==null||m.call(a)}function mx(){return(Ee==null?void 0:Ee.visible)||_.overlay.startup}function _x(){return _.overlay.bigWin||_.overlay.fsIntro||_.overlay.fsOutro}function gx(a){var h,d,m;if(a.key.toLowerCase()==="r"){a.preventDefault(),a.shiftKey?cn(10):a.altKey?cn(1):cn(5),console.log("[DEBUG] FS retrigger");return}if(a.key.toLowerCase()==="t"){sc(a),(h=u==null?void 0:u.initFromUserGesture)==null||h.call(u),console.log("[TEST] tickhigh: play once + start loop"),(d=u==null?void 0:u.playSfx)==null||d.call(u,"tickhigh",1,1),(m=u==null?void 0:u.startTickHighLoop)==null||m.call(u,0,.35,1),setTimeout(()=>{var g;return(g=u==null?void 0:u.stopTickHighLoop)==null?void 0:g.call(u,80)},800);return}if(a.code==="Space"&&a.preventDefault(),!mx()){if(_.overlay.splash&&Xf(a)){sc(a),ge.emit("pointertap",{});return}if(_x()){Xf(a)?(sc(a),de.emit("pointertap",{stopPropagation(){}})):sc(a);return}if(a.key.toLowerCase()==="i"){console.log("[DEBUG] INFUSED popup"),Ku();return}{if(a.key.toLowerCase()==="i"){console.log("[DEBUG] INFUSED popup"),Ku();return}if(a.key==="1"||a.key==="2"||a.key==="3"||a.key==="4"||a.key==="5"){let g=null;if(a.key==="1"&&(g=fp),a.key==="2"&&(g=pp),a.key==="3"&&(g=mp),a.key==="4"&&(g=_p),a.key==="5"&&(g=gp),g!=null){const A=_.bank.betLevels[_.bank.betIndex],S=g*A;zp(S,g)}return}if(a.key.toLowerCase()==="a"){At=!At,console.log("FORCE_ANTICIPATION =",At);return}if(a.key.toLowerCase()==="x"){const g=Pi.toLocal({x:P.renderer.width*.5,y:P.renderer.height*.5});Zp(g.x,g.y,16765802);return}if(a.key.toLowerCase()==="c"){const g=a.shiftKey,A=a.altKey,S=g?"BASE":A?"FREE_SPINS":_.game.mode;Ae&&(Ae.s.removeFromParent(),Ae=null),typeof Ie<"u"&&Ie&&(Ie.s.removeFromParent(),Ie=null),S==="BASE"?(ur=999,Zh(!0),console.log("[BG CAR] Forced spawn (BASE)")):typeof qh=="function"?(Br=999,qh(),console.log("[BG CAR] Forced spawn (FREE_SPINS)")):console.log("[BG CAR] FS car not wired yet (spawnFsCar missing)");return}if(a.key.toLowerCase()==="o"){a.preventDefault(),a.shiftKey?bh(2500):a.altKey?bh(25):bh(233);return}if(a.key.toLowerCase()==="r"){cn(5);return}if(a.key.toLowerCase()==="f"){_.game.mode!=="FREE_SPINS"&&w(10,1);return}if(a.key.toLowerCase()==="b"){_.game.mode!=="FREE_SPINS"&&w(10,2);return}}if(a.code==="Space"){if(nl()||a.repeat||_.ui.settingsOpen||_.ui.buyMenuOpen||_.ui.spinning||a.repeat||_.ui.settingsOpen||_.ui.buyMenuOpen||_.ui.spinning||ec)return;ec=!0,Yf=_.ui.auto,_.ui.spinning||Jr(),nc=setTimeout(()=>{var g;ec&&(_.ui.settingsOpen||_.ui.buyMenuOpen||(_.ui.auto||(_.ui.auto=!0,(g=dt==null?void 0:dt.setOn)==null||g.call(dt,!0)),_.ui.spinning||Jr()))},350);return}}}function yx(a){var h;a.code==="Space"&&(a.preventDefault(),ec=!1,nc&&(clearTimeout(nc),nc=null),!Yf&&_.ui.auto&&(_.ui.auto=!1,(h=dt==null?void 0:dt.setOn)==null||h.call(dt,!1)))}window.addEventListener("keydown",gx,!0),window.addEventListener("keyup",yx,!0);function xx(){const a=P.renderer.height;let h=tc.pop();h||(h={c:Hf(),vx:0,vy:0,vr:0}),h.c.x=-220;const d=_.overlay.splash,m=d?.25:.05,g=d?.6:.25;h.c.y=a*(m+Math.random()*(g-m));const A=12+Math.random()*22;h.vx=A,h.vy=-1+Math.random()*2,h.vr=(-1+Math.random()*2)*.03;const S=-.12,T=.1;h.c.rotation=S+(-T+Math.random()*T*2),Wo.addChild(h.c),Ps.push(h)}function bx(){var R,F;if(_.overlay.fsOutro||!Ae)return;const a=P.ticker.deltaMS/1e3,h=Ae.s;h.rotation=0,(F=(R=h.skew)==null?void 0:R.set)==null||F.call(R,0,0),h.x+=Ae.nx*Ae.vx*a,h.y+=Ae.ny*Ae.vx*a;const d=performance.now(),m=Math.sin(d*.006)*.1,g=Math.sin(d*.045)*.4+Math.sin(d*.073)*.5+Math.sin(d*.112)*.4,A=Math.max(0,Math.min(1,(Ae.vx-80)/220)),S=.25+.55*A;h.y+=m+g*S,h.x+=Math.sin(d*.091)*(.1+.18*A);const T=h.x-Ae.endX,E=h.y-Ae.endY;if(T*Ae.nx+E*Ae.ny>jh){h.removeFromParent(),Ae=null,Uo(),ur=Ql+Math.random()*(kf-Ql),Br=Jl+Math.random()*(Rf-Jl);return}Zl+=jy*a;let k=Math.floor(Zl);k>0&&(Zl-=k),k=Math.min(k,6);for(let O=0;O<k;O++)tx(h.x,h.y,Ae.nx,Ae.ny,Ae.vx);ex(a)}function Ax(){var k,R;if(_.overlay.fsOutro||!Ie)return;const a=P.ticker.deltaMS/1e3,h=Ie.s;h.rotation=0,(R=(k=h.skew)==null?void 0:k.set)==null||R.call(k,0,0),h.x+=Ie.nx*Ie.vx*a,h.y+=Ie.ny*Ie.vx*a;const d=performance.now(),m=Math.sin(d*.006)*.1,g=Math.sin(d*.045)*.4+Math.sin(d*.073)*.5+Math.sin(d*.112)*.4,A=Math.max(0,Math.min(1,(Ie.vx-80)/220)),S=.25+.55*A;h.y+=m+g*S,h.x+=Math.sin(d*.091)*(.1+.18*A);const T=h.x-Ie.endX,E=h.y-Ie.endY;T*Ie.nx+E*Ie.ny>$h&&(h.removeFromParent(),Ie=null,Br=Jl+Math.random()*(Rf-Jl))}function Sx(){if(!Ba||_.overlay.fsIntro||_.overlay.fsOutro)return;const a=P.renderer.width,h=P.renderer.height,d=P.ticker.deltaMS/1e3;ho+=fx*d;const m=Math.floor(ho);m>0&&(ho-=m);for(let g=0;g<m&&!(Ps.length>=Df);g++)xx();for(let g=Ps.length-1;g>=0;g--){const A=Ps[g],S=A.c;S.x+=A.vx*d,S.y+=A.vy*d,S.rotation+=A.vr*d,S.y+=Math.sin((S.x+g*37)*.004)*.18,(S.x>a+260||S.y<-220||S.y>h+220)&&(S.removeFromParent(),Ps.splice(g,1),tc.push(A))}}function ic(a=5){const h=P.renderer.width,d=P.renderer.height;for(let m=0;m<a&&!(Ps.length>=Df);m++){let g=tc.pop();g||(g={c:Hf(),vx:0,vy:0,vr:0}),g.c.x=Math.random()*(h+260)-130,g.c.y=_.overlay.splash?d*(.25+Math.random()*.35):d*(.05+Math.random()*.2);const A=12+Math.random()*22;g.vx=A,g.vy=-2+Math.random()*1.2,g.vr=(-1+Math.random()*2)*.03,g.c.rotation=-.1+Math.random()*.2,Wo.addChild(g.c),Ps.push(g)}}function wx(){Wf||(Wf=!0,fn(()=>Sx()))}ic(6),wx(),ur=Ql+Math.random()*(kf-Ql),fn(a=>{if(xh(G)){Vh();return}if(_.overlay.splash||_.overlay.fsOutro||_.overlay.fsOutroPending){Vh();return}if(_.game.mode==="BASE"){Ae||(ur-=a,ur<=0&&Zh()),bx();return}if(_.game.mode==="FREE_SPINS"){if(_.overlay.fsIntro)return;Ie||(Br-=a,Br<=0&&qh()),Ax();return}});const Do=new st;Do.sortableChildren=!0,Do.zIndex=1200,Do.eventMode="none",Y.addChild(Do),Y.sortChildren();const Qh=[],Nr=[];let Na=0,Vf=!1,Ua=!1;const Mx=140,Tx=10,zf=2,vx=4,Kf=.9,Ex=1.6;function Cx(){const a=new xt,h=Math.floor(zf+Math.random()*(vx-zf+1)),d=2+(Math.random()*5|0),m=[16777215,16777215,16252415,16776178];for(let A=0;A<d;A++){const S=(-1+Math.random()*2)*h*1.2|0,T=(-1+Math.random()*2)*h*1.2|0;a.rect(S,T,h,h).fill({color:m[Math.random()*m.length|0],alpha:1})}a.alpha=.75+Math.random()*.25;const g=Kf+Math.random()*(Ex-Kf);return a.scale.set(g),a}function Ix(){const a=P.renderer.width;let h=Qh.pop();if(!h){const m=Cx(),g=new xt;g.rect(-1,-10,2,20).fill({color:16777215,alpha:1}),g.rect(-10,-1,20,2).fill({color:16777215,alpha:1}),g.alpha=0,g.visible=!1,g.blendMode=1,h={g:m,gl:g,vx:0,vy:0,vr:0,spin:0,baseA:1,baseS:1,tw:0,twSpeed:0,prevTw01:0,glintT:0,glintArmed:!0}}const d=h.g;d.x=-40+Math.random()*(a+80),d.y=-80-Math.random()*220,h.vy=55+Math.random()*130,h.vx=-25+Math.random()*50,h.spin=.6+Math.random()*1.2,h.vr=(-1+Math.random()*2)*.25,d.rotation=Math.random()*Math.PI*2,h.baseA=d.alpha,h.baseS=d.scale.x,h.tw=Math.random()*Math.PI*2,h.twSpeed=2.2+Math.random()*3.8,h.prevTw01=0,h.glintT=0,h.glintArmed=!0,Do.addChild(d),Do.addChild(h.gl),Nr.push(h)}function Px(){for(let a=Nr.length-1;a>=0;a--){const h=Nr[a];h.g.removeFromParent(),h.gl.removeFromParent(),h.gl.visible=!1,h.gl.alpha=0,h.glintT=0,h.glintArmed=!0,Qh.push(h)}Nr.length=0,Na=0}function Ox(){const a=P.renderer.width,h=P.renderer.height,d=P.ticker.deltaMS/1e3;if(Ua){Na+=Tx*d;const m=Math.floor(Na);m>0&&(Na-=m);for(let g=0;g<m&&!(Nr.length>=Mx);g++)Ix()}for(let m=Nr.length-1;m>=0;m--){const g=Nr[m],A=g.g,S=Math.sin(A.y*.012+m*.7)*(12*d);A.x+=g.vx*d+S,A.y+=g.vy*d,A.rotation+=g.vr*d,g.gl.x=A.x,g.gl.y=A.y,g.gl.rotation=A.rotation,g.tw+=g.twSpeed*d;const T=.5+.5*Math.sin(g.tw),E=T>.985;E||(g.glintArmed=!0),E&&g.glintArmed&&(g.glintArmed=!1,Math.random()<1/70&&(g.glintT=.1+Math.random()*.06));let C=g.baseA*(.78+T*.28),k=g.baseS*(.92+T*.1);if(g.glintT>0){g.glintT-=d;const F=Math.max(0,g.glintT)/.16,O=1+F*.55;C*=1.1*O,k*=O,g.gl.visible=!0,g.gl.alpha=Math.min(1,.15+F*.85);const B=.65+F*.85;g.gl.scale.set(B)}else g.gl.visible=!1,g.gl.alpha=0;A.alpha=Math.min(1,C),A.scale.set(k),(A.y>h+140||A.x<-220||A.x>a+220)&&(A.removeFromParent(),g.gl.removeFromParent(),Nr.splice(m,1),Qh.push(g))}Ua||(Na=0)}function Lx(){Vf||(Vf=!0,fn(()=>Ox()))}Lx();const fs=new Co({strength:12});M.filters=[fs];let kt=null;const ri=new st;ri.zIndex=9451,ri.visible=!1,ri.eventMode="none",Y.addChild(ri),Y.sortChildren();let Jh=0,Ur=0;function tu(){if(kt)return;const a=Wc("tractor_0.png"),h=Wc("tractor_1.png"),d=new Gl([a,h]);d.anchor.set(.5),d.loop=!0,d.animationSpeed=.1,d.autoUpdate=!0,d.play(),d.roundPixels=!0,kt=d,ri.addChild(d),$f();const m=new st;m.eventMode="none",m.visible=!1,d._banner=m;const g=nn.style,A=g!=null&&g.clone?g.clone():{...g||{}},S=$s.style;S!=null&&S.clone?S.clone():{...S||{}};const T=new yt({text:"10",style:new _e({...A,fontSize:300,align:"center"})});T.anchor.set(.5);const E=new yt({text:"",style:we({fontFamily:"Pixeldown",fill:16777215,fontSize:64,letterSpacing:2,stroke:{color:0,width:8}})}),C=new yt({text:"",style:we({fontFamily:"Pixeldown",fill:16777215,fontSize:64,letterSpacing:2,stroke:{color:0,width:8}})}),k=1.2;E.scale.set(k),C.scale.set(k),E.anchor.set(.5),C.anchor.set(.5);function R(Q){const X=Q.getLocalBounds();Q.pivot.set(X.x+X.width/2,X.y+X.height/2),Q.x=0}function F(){const Q=Re(Jt("ui.freeSpins")),X=Q.trim().split(/\s+/);E.text=X[0]??Q,C.text=X.slice(1).join(" ")||"",R(E),R(C)}const O=90,B=60;T.position.set(0,0),E.position.set(0,O),C.position.set(0,O+B),F(),m.addChild(T,E,C),ri.addChild(m);const N=-290,D=ln(G)?-160:He(G)?-275:-235;m.position.set(N,D),d._bannerOffX=N,d._bannerOffY=D;const z=1.4,$=1.4,rt=1;d._bannerScale=ln(G)?rt:He(G)?$:z,m.position.set(N,D),m.scale.set(d._bannerScale),d._banner10=T,d._banner=m}fn(a=>{if(!kt)return;const h=kt._banner;if(!h)return;if(!ri.visible){h.visible=!1;return}const d=kt._bannerOffX??-290,m=kt._bannerOffY??-140;h.x=Math.round(kt.x+d),h.y=Math.round(kt.y+m);const g=kt._bannerScale??1.6;h.scale.set(g)});function $f(){if(!kt)return;const a=P.screen.width,h=P.screen.height,m=Math.round(a*.6),g=kt.texture.width||1,A=m/g;kt.scale.set(A);const S=Math.round(h*.62);ri.visible||(kt.x=Math.round(a*.5),kt.y=S)}window.addEventListener("resize",$f);function kx(){return-((kt==null?void 0:kt.width)||400)*.6}function Rx(){const a=P.screen.width,h=(kt==null?void 0:kt.width)||400;let d=a+h*.8;if(ln(G)){const m=kt==null?void 0:kt._banner,g=(kt==null?void 0:kt._bannerOffX)??-290,A=m&&m.getBounds().width||0;d=a+h*1.6+Math.abs(g)+A*1.2+80}return d}const Fx=293;function Bx(){return Math.round(P.screen.width*.5+Fx)}function jf(){return Math.round(P.screen.height*.62)}function Nx(a=550){if(tu(),!kt)return;Jh++;const h=Jh;ri.visible=!0;const d=kt._banner,m=kt._banner10;d&&(d.visible=!0),m&&(m.text=String(_.fs.remaining));const g=kx(),A=Bx(),S=jf();ac=S,kt.x=g,kt.y=S,kt.alpha=1,ye(a,T=>{if(h!==Jh)return;const E=Math.max(0,Math.min(1,T)),C=aC(E,.12);kt.x=g+(A-g)*C,kt.y=S})}function Ux(a=520){if(tu(),!kt)return Promise.resolve();Ur++;const h=Ur,d=kt.x,m=Rx(),g=jf();return ac=g,new Promise(A=>{ye(a,S=>{if(h!==Ur)return;const T=pa(Math.max(0,Math.min(1,S)));kt.x=d+(m-d)*T,kt.y=g},()=>{if(h!==Ur)return A();ri.visible=!1,Qf();const S=kt==null?void 0:kt._banner;S&&(S.visible=!1),A()})})}function Wx(a=620){if(tu(),!kt)return Promise.resolve();Ur++;const h=Ur,d=kt._banner;d&&(d.visible=!0);const m=P.screen.width,g=kt.x,A=kt.width||400,S=kt._bannerOffX??-290,T=d&&d.getBounds().width||0,E=m+A*1.6+Math.abs(S)+T*1.2+80,C=kt.y;return ac=C,new Promise(k=>{ye(a,R=>{if(h!==Ur)return;const F=Math.max(0,Math.min(1,R)),O=pa(F);kt.x=g+(E-g)*O,kt.y=C,d&&(d.alpha=1-O*O*.35)},()=>{if(h!==Ur)return k();ri.visible=!1,Qf(),d&&(d.visible=!1,d.alpha=1),k()})})}const rc=new st;rc.zIndex=9450,rc.eventMode="none",Y.addChild(rc),Y.sortChildren();const eu=[],Wr=[];let oc=0;const Dx=26,qf=.35,Gx=2,Zf=6,Hx=10,Yx=120,Xx=.37,Vx=-.08;function zx(){return{g:new xt,vx:0,vy:0,life:0,life0:0,s0:1}}function Kx(a,h){if(Wr.length>=Yx)return;let d=eu.pop();d||(d=zx());const m=d.g;m.clear(),m.blendMode="normal";const g=Zf+Math.random()*(Hx-Zf+1)|0,A=3+(Math.random()*6|0),S=[4868682,5921370,6974058,8026746];for(let T=0;T<A;T++){const E=(-2+Math.random()*4)*g|0,C=(-2+Math.random()*4)*g|0;m.rect(E,C,g,g).fill({color:S[Math.random()*S.length|0],alpha:1})}m.x=a+(-3+Math.random()*6),m.y=h+(-3+Math.random()*6),d.vx=-(22+Math.random()*34),d.vy=-(28+Math.random()*44),d.life0=qf+Math.random()*(Gx-qf),d.life=d.life0,d.s0=.65+Math.random()*.65,m.scale.set(d.s0),m.alpha=.22+Math.random()*.45,rc.addChild(m),Wr.push(d)}function $x(a){const h=P.renderer.width,d=P.renderer.height;for(let m=Wr.length-1;m>=0;m--){const g=Wr[m],A=g.g;A.x+=g.vx*a,A.y+=g.vy*a,g.life-=a;const S=Math.max(0,g.life/g.life0);A.alpha=.35*S*(.35+.65*S);const T=g.s0*(1+(1-S)*.55);A.scale.set(T),(g.life<=0||A.x<-260||A.x>h+260||A.y<-260||A.y>d+260)&&(A.removeFromParent(),Wr.splice(m,1),eu.push(g))}}function Qf(){for(let a=Wr.length-1;a>=0;a--){const h=Wr[a];h.g.removeFromParent(),Wr.splice(a,1),eu.push(h)}oc=0}fn(a=>{if(a=Math.min(.05,a),$x(a),!_.overlay.fsIntro||!ri.visible||!kt)return;const h=kt.getBounds(),d=h.x+h.width*(.5+Xx),m=h.y+h.height*(.5+Vx);oc+=Dx*a;let g=Math.floor(oc);g>0&&(oc-=g),g=Math.min(g,6);for(let A=0;A<g;A++)Kx(d,m)});let ac=0;const jx=1.6,qx=.9,Zx=.5,Qx=.006,nu=.045;fn(()=>{if(!ri.visible||!kt)return;const a=performance.now(),h=Math.sin(a*Qx)*jx,d=(Math.sin(a*nu)*.4+Math.sin(a*(nu*1.62))*.5+Math.sin(a*(nu*2.48))*.4)*qx,m=Math.sin(a*.091)*Zx;kt.y=Math.round(ac+h+d),kt.x=Math.round(kt.x+m*.25)});const Jx=300,de=new xt;de.zIndex=9400,de.visible=!1,de.alpha=0,de.eventMode="static",de.cursor="default",Y.addChild(de);const oi=new xt;oi.zIndex=9410,oi.visible=!1,oi.alpha=0,oi.eventMode="static",oi.cursor="default",Y.addChild(oi);const En=new yt({text:"",style:{fontFamily:Zn(Pe()),fill:16765802,fontSize:120,fontWeight:"100",align:"center",dropShadow:!0,dropShadowAlpha:.75,dropShadowBlur:14,dropShadowDistance:3}});En.anchor.set(.5),En.skew.set(0,.39),En.scale.set(1,1.15),En.zIndex=9411,En.visible=!1,En.alpha=0,Y.addChild(En);const yn=new yt({text:Re(Jt("ui.freeSpins")),style:{fontFamily:Zn(Pe()),fill:16777215,fontSize:40,fontWeight:"100",align:"center",letterSpacing:1.5,dropShadow:!0,dropShadowAlpha:.65,dropShadowBlur:10,dropShadowDistance:3}});yn.anchor.set(.5),yn.skew.set(0,.39),yn.scale.set(1,1.15),yn.zIndex=9411,yn.visible=!1,yn.alpha=0,Y.addChild(yn);function Jf(){const a=P.renderer.width,h=P.renderer.height;oi.clear(),oi.rect(0,0,a,h).fill(0);const d=h*.48,m=He(G)?90:ln(G)?120:150;En.position.set(Math.round(a*.5),Math.round(d-m*.5)),yn.position.set(Math.round(a*.5),Math.round(d+m*.5))}const Qn=new st;Qn.zIndex=9460,Qn.visible=!1,Qn.alpha=0,Qn.eventMode="none",Y.addChild(Qn);const dr=new Se(te.WHITE);dr.anchor.set(.5),Qn.addChild(dr);const lc=new st;lc.zIndex=.6,lc.eventMode="none",Qn.addChild(lc),Qn.sortableChildren=!0;const cc=new st;cc.zIndex=.5,cc.eventMode="none",Qn.addChild(cc),Qn.sortableChildren=!0;let hc=!0,tb=.19,eb=.65;const nb=10,sb=60,tp=1.3,ib=3.2,ep=25,rb=160,np=14,ob=26,ab=-6,sp=2,lb=4,ip=.08,cb=.95,su=[],Dr=[];let uc=0,rp=!1;function hb(a){const h=new xt,d=[16777215,16773811,16765802],m=2+(Math.random()*3|0);for(let g=0;g<m;g++){const A=(-1+Math.random()*2)*a*1.1|0,S=(-1+Math.random()*2)*a*1.1|0;h.rect(A,S,a,a).fill({color:d[Math.random()*d.length|0],alpha:1})}return h.roundPixels=!0,h}function op(){const a=P.renderer.width,h=P.renderer.height;return{x:a*tb,y:h*eb}}function ub(){if(!hc||Dr.length>=sb)return;let a=su.pop();const h=sp+Math.random()*(lb-sp)|0;if(!a)a={g:hb(h),vx:0,vy:0,life:0,life0:0,tw:0,twSpeed:0,baseA:0,vox:h};else{a.g.clear();const S=[16777215,16773811,16765802],T=2+(Math.random()*3|0);for(let E=0;E<T;E++){const C=(-1+Math.random()*2)*h*1.1|0,k=(-1+Math.random()*2)*h*1.1|0;a.g.rect(C,k,h,h).fill({color:S[Math.random()*S.length|0],alpha:1})}a.g.roundPixels=!0,a.vox=h}const d=a.g,m=op(),g=Math.random()*Math.PI*2,A=ep+Math.random()*(rb-ep);d.x=m.x+Math.cos(g)*A+(-8+Math.random()*16),d.y=m.y+Math.sin(g)*A+(-8+Math.random()*16),a.vx=(-1+Math.random()*2)*np,a.vy=(-1+Math.random()*2)*np+ab,a.life0=tp+Math.random()*(ib-tp),a.life=a.life0,a.tw=Math.random()*Math.PI*2,a.twSpeed=2+Math.random()*4,a.baseA=.15+Math.random()*.2,d.alpha=0,d.scale.set(1),cc.addChild(d),Dr.push(a)}function ap(){for(let a=Dr.length-1;a>=0;a--){const h=Dr[a];h.g.removeFromParent(),Dr.splice(a,1),su.push(h)}uc=0}function db(){if(!_.overlay.fsOutro||!hc)return;const a=Math.min(.05,P.ticker.deltaMS/1e3);uc+=nb*a;let h=Math.floor(uc);h>0&&(uc-=h),h=Math.min(h,5);for(let m=0;m<h;m++)ub();const d=op();for(let m=Dr.length-1;m>=0;m--){const g=Dr[m],A=g.g,S=d.x-A.x,T=d.y-A.y,E=Math.hypot(S,T)||1,C=ob/Math.max(60,E);g.vx+=S/E*C,g.vy+=T/E*C;const k=Math.sin((A.x+m*17)*.02+g.tw)*6;A.x+=(g.vx+k)*a,A.y+=g.vy*a,g.tw+=g.twSpeed*a;const R=.5+.5*Math.sin(g.tw),F=ip+(cb-ip)*(R*R);A.alpha=Math.min(1,g.baseA+F);const O=.95+R*.2;A.scale.set(O),g.life-=a;const B=1-g.life/g.life0,N=Math.min(1,B/.18),D=Math.min(1,Math.max(0,(B-.72)/.28));A.alpha*=N*(1-D),g.life<=0&&(A.removeFromParent(),Dr.splice(m,1),su.push(g))}}function fb(){rp||(rp=!0,fn(()=>db()))}fb();const $s=new yt({text:Jt("ui.totalWin"),style:{fontFamily:Zn(Pe()),fill:16777215,fontSize:110,fontWeight:"100",align:"center",stroke:{color:0,width:12},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.6,dropShadowBlur:0,dropShadowDistance:12,dropShadowAngle:-Math.PI/4}});$s.anchor.set(.5),$s.skew.set(0,0),Qn.addChild($s);const nn=new yt({text:"0.00",style:{fontFamily:Zn(Pe()),fill:16765802,fontSize:150,fontWeight:"100",align:"center",stroke:{color:0,width:12},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.6,dropShadowBlur:0,dropShadowDistance:14,dropShadowAngle:-Math.PI/4}});nn.anchor.set(.5),nn.skew.set(0,0),Qn.addChild(nn);const pb=!0,Kn=new yt({text:Jt("ui.clickToContinue"),style:{}});Yd(Kn),Kn.style.dropShadowAngle=-Math.PI/4,Kn.anchor.set(.5),Kn.visible=pb,Kn.alpha=1,Kn.zIndex=1,Qn.addChild(Kn),Kn.eventMode="static",Kn.cursor="pointer",Kn.hitArea=new oe(-340,-60,680,120),Kn.on("pointertap",a=>{var h;(h=a.stopPropagation)==null||h.call(a),de.emit("pointertap",{})});function mb(a){if(!He(G))return 1;const h=P.screen.width,d=Math.round(h*.1),m=Math.max(1,h-d*2);$s.scale.set(1,1),nn.scale.set(1,1);const g=nn.text;nn.text=cs(a);const A=Math.max($s.getBounds().width,nn.getBounds().width);if(nn.text=g,A<=m)return 1;const S=m/A;return Math.max(.58,Math.min(1,S))}const _b=.41,gb=.59,yb=.38,xb=.7;function dc(){const a=P.screen.width,h=P.screen.height;dr.x=Math.round(a*.5),dr.y=Math.round(h*.5);const d=dr.texture.width||1,m=dr.texture.height||1,g=Math.max(a/d,h/m);dr.scale.set(g);const A=ln(G),S=A?yb:_b,T=A?xb:gb;$s.position.set(Math.round(a*.5),Math.round(h*S)),nn.position.set(Math.round(a*.5),Math.round(h*T)),Kn.position.set(Math.round(a*.5),Math.round(h*.92)),He(G)&&pc?($s.scale.set(fc),nn.scale.set(fc)):He(G)||($s.scale.set(1,1),nn.scale.set(1,1))}window.addEventListener("resize",dc);let Go=0,Ho=!0,lp=0,fc=1,pc=!1,iu=!1,uo=0;function cp(){uo++;const a=uo,h=nn.scale.x,d=h*1.08,m=260,g=320,A=220;async function S(){for(;a===uo&&_.overlay.fsOutro;)await ke(m,T=>{if(a!==uo)return;const E=Hs(T),C=h+(d-h)*E;nn.scale.set(C,C)}),await ke(g,T=>{if(a!==uo)return;const E=T*T*(3-2*T),C=d+(h-d)*E;nn.scale.set(C,C)}),nn.scale.set(h,h),await ns(A);nn.scale.set(h,h)}S()}function hp(){le.scale.set(1,1),ye(140,a=>{const d=1+.06*ms(a,1.05);le.scale.set(d,d)},()=>{ye(220,a=>{const h=a*a*(3-2*a);le.scale.set(1.06+(1-1.06)*h)})})}function bb(){const a=nn.scale.x||1;nn.scale.set(a,a),ye(140,h=>{const d=ms(h,1.05),m=a*(1+.06*d);nn.scale.set(m,m)},()=>{ye(220,h=>{const d=h*h*(3-2*h),m=a*(1.06+(1-1.06)*d);nn.scale.set(m,m)})})}function up(){iu||(iu=!0,setTimeout(()=>{dA(1.7,1.9)},60),setTimeout(()=>{ja(.9),setTimeout(()=>gu(!0),900)},80),bb())}function Ab(){var a,h;Go++,(a=u==null?void 0:u.stopTickLoop)==null||a.call(u,80),nn.text=cs(lp),Ho=!0,ou(350),(h=u==null?void 0:u.playSfx)==null||h.call(u,"final_fsoutro_amount",1.15),up(),cp()}function Sb(a,h=1400){var C;Go++;const m=Go;lp=a,Ho=!1,iu=!1,(C=u==null?void 0:u.startTickLoop)==null||C.call(u,120,.38,1);const g=performance.now(),A=0;let S=g,T=0;function E(k){var jt,Kt,Lt;const R=Math.min(.05,Math.max(.001,(k-S)/1e3));if(S=k,m!==Go)return;const F=(k-g)/h,O=Math.min(1,F),B=.75,N=14;let D;if(O<=B){const ce=O/B;D=.78*(1-Math.pow(1-ce,3))}else{const ce=Math.min(1,(O-B)/(1-B));D=.78+(1-.78)*(1-Math.pow(1-ce,N))}const z=D-T,$=.3*R,rt=Math.sign(z)*Math.min(Math.abs(z),$),Q=Math.min(1,T+rt);T=Q;const X=A+(a-A)*Q;nn.text=cs(X);const q=Math.max(0,Math.min(1,Q)),ut=.98+.5*Math.pow(q,1.4),vt=1+.2*(ut-1),ee=(.22+.4*Math.pow(q,1.2))*vt;(jt=u==null?void 0:u.setTickParams)==null||jt.call(u,ee,ut),Math.abs(a-X)>.01?requestAnimationFrame(E):((Kt=u==null?void 0:u.stopTickLoop)==null||Kt.call(u,120),nn.text=cs(a),Ho=!0,ou(350),(Lt=u==null?void 0:u.playSfx)==null||Lt.call(u,"final_fsoutro_amount",1.15),up(),setTimeout(()=>{_.overlay.fsOutro&&cp()},420))}nn.text=cs(0),requestAnimationFrame(E)}function wb(a,h,d=420){return new Promise(m=>{ru(a,h,d),setTimeout(m,d+30)})}bh=a=>{var h,d;console.log("[DEBUG] Force FS OUTRO",a),(h=u==null?void 0:u.initFromUserGesture)==null||h.call(u),_.overlay.bigWin=!1,_.overlay.fsIntro=!1,_.overlay.fsOutroPending=!1,Go++,Ho=!0,(d=u==null?void 0:u.stopTickLoop)==null||d.call(u,0),Zr(!1),ru(!0,a,420)};function ru(a,h,d=420){const m=_s.get(Hi);if(m&&(dr.texture=m),dr.visible=!0,dc(),Y.sortChildren(),a){_.overlay.fsOutro=!0,pc=!1,fc=mb(h),pc=!0,dc(),ap(),hc=!0,_.ui.auto=!1,Mt.alpha=0,Mt.eventMode="none",bc(),de.visible=!0,de.eventMode="static",Sb(h,1e3),Qn.visible=!0,Qn.alpha=0,Au(1.6);const g=de.alpha,A=fs.strength;ye(d,S=>{const T=Math.max(0,Math.min(1,S));de.alpha=g+(.55-g)*T,fs.strength=A+(6-A)*T,Qn.alpha=T})}else{pc=!1,fc=1;const g=de.alpha,A=fs.strength,S=Qn.alpha;ye(d,T=>{const E=Math.max(0,Math.min(1,T));de.alpha=g*(1-E),fs.strength=A*(1-E),Qn.alpha=S*(1-E)},()=>{var T;de.alpha=0,fs.strength=0,de.visible=!1,de.eventMode="none",Qn.alpha=0,Qn.visible=!1,Xp(!0),gu(!0),Go++,Ho=!0,(T=u==null?void 0:u.stopTickLoop)==null||T.call(u,0),_.overlay.fsOutro=!1,ou(250),hc=!1,ap(),uo++,b0()})}}let Yo=null;const Mb=.35;let Xo=null;const Tb=.2;function dp(a,h=250){var g;const d=((g=u==null?void 0:u.getMusicVolume01)==null?void 0:g.call(u))??.6,m=Math.max(0,Math.min(1,a));!(u!=null&&u.setMusicVolume01)||!(u!=null&&u.apply)||ke(h,A=>{const S=A*A*(3-2*A);u.setMusicVolume01(d+(m-d)*S),u.apply()})}function vb(a=250){var h;Xo==null&&(Xo=((h=u==null?void 0:u.getMusicVolume01)==null?void 0:h.call(u))??.6),dp(Xo*Tb,a)}function ou(a=250){Xo!=null&&(dp(Xo,a),Xo=null)}let Wa=1,Da=!1,Ga=null,mc=0,Ha=!0,au=0,fr="BIG";const fp=10,pp=20,mp=35,_p=60,gp=100;function Eb(a){return a==="SUPER"?"ui.bigWin.super":a==="MEGA"?"ui.bigWin.mega":a==="EPIC"?"ui.bigWin.epic":a==="MAX"?"ui.bigWin.max":"ui.bigWin.big"}function _c(a){$t.text=Re(Jt(Eb(a)))}function yp(a){return a>=gp?"MAX":a>=_p?"EPIC":a>=mp?"MEGA":a>=pp?"SUPER":"BIG"}let Ya=!1,lu=0,Vo=null;function Cb(){return new _e({fontFamily:Zn(Pe()),fill:16777215,fontSize:110,fontWeight:"100",letterSpacing:2,align:"center",stroke:{color:0,width:14},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.75,dropShadowBlur:0,dropShadowDistance:14,dropShadowAngle:-Math.PI/4})}function Ib(){return new _e({fontFamily:Zn(Pe()),fill:16765802,fontSize:170,fontWeight:"100",letterSpacing:1,align:"center",stroke:{color:0,width:16},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.75,dropShadowBlur:0,dropShadowDistance:16,dropShadowAngle:-Math.PI/4})}function Pb(){return new _e({fontFamily:Zn(Pe()),fill:16777215,fontSize:42,fontWeight:"100",letterSpacing:1,align:"center",stroke:{color:0,width:6},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.7,dropShadowBlur:0,dropShadowDistance:8,dropShadowAngle:-Math.PI/4})}const cu={BIG:16777215,SUPER:10482687,MEGA:16769126,EPIC:16751164,MAX:16727100},hu=16765802,$t=new yt({text:"BIG WIN",style:Cb()});$t.anchor.set(.5),$t.zIndex=9470,$t.visible=!1,$t.alpha=0,Y.addChild($t);const le=new yt({text:"0.00",style:Ib()});le.anchor.set(.5),le.zIndex=9470,le.visible=!1,le.alpha=0,Y.addChild(le);let zo=0;function xp(){zo++;const a=zo,h=le.scale.x,d=h*1.08,m=240,g=320,A=220;async function S(){for(;a===zo&&_.overlay.bigWin;)await ke(m,T=>{if(a!==zo)return;const E=Hs(T),C=h+(d-h)*E;le.scale.set(C,C)}),await ke(g,T=>{if(a!==zo)return;const E=T*T*(3-2*T),C=d+(h-d)*E;le.scale.set(C,C)}),le.scale.set(h,h),await ns(A);le.scale.set(h,h)}S()}function bp(){zo++,le.scale.set(1,1)}const Ht=new yt({text:Jt("ui.clickToContinue"),style:Pb()});Ht.anchor.set(.5),Ht.zIndex=9470,Ht.visible=!1,Ht.alpha=0,Y.addChild(Ht);const os=new xt;os.zIndex=9464,os.visible=!1,os.alpha=0,os.eventMode="none",os.blendMode="add",os.filters=[new Co({strength:40})],Y.addChild(os),Y.sortChildren();let Ob=8191851,Ap=.42,Lb=300,kb=900,Rb=1400,Fb=14,Bb=1.8,Nb=.06,Ub=-40;function Sp(){const a=P.screen.width,h=Math.round(a*.5),d=Ub,m=Math.round(d+Rb),g=Lb,A=kb;os.clear();const S=Math.max(3,Fb|0),T=Math.max(.5,Bb),E=Math.max(0,Math.min(1,Nb));for(let R=0;R<S;R++){const F=R/S,O=(R+1)/S,B=d+(m-d)*F,N=d+(m-d)*O,D=g+(A-g)*F,z=g+(A-g)*O,$=Math.pow(1-F,T),rt=E+(1-E)*$;os.moveTo(h-D*.5,B).lineTo(h+D*.5,B).lineTo(h+z*.5,N).lineTo(h-z*.5,N).closePath().fill({color:Ob,alpha:rt})}const C=g*.4,k=A*.5;for(let R=0;R<S;R++){const F=R/S,O=(R+1)/S,B=d+(m-d)*F,N=d+(m-d)*O,D=C+(k-C)*F,z=C+(k-C)*O,$=Math.pow(1-F,T*1.25),rt=E*.35+(1-E*.35)*$;os.moveTo(h-D*.5,B).lineTo(h+D*.5,B).lineTo(h+z*.5,N).lineTo(h-z*.5,N).closePath().fill({color:15269840,alpha:rt})}}window.addEventListener("resize",()=>{os.visible&&Sp()}),$t.roundPixels=!0,le.roundPixels=!0,Ht.roundPixels=!0;const wp=.39;$t.skew.set(0,wp),le.skew.set(0,wp),Ht.skew.set(0,0),Ht.eventMode="static",Ht.cursor="pointer";function Wb(a){if(!He(G))return 1;const h=P.screen.width,d=Math.round(h*.1),m=Math.max(1,h-d*2),g=Mp;$t.scale.set(g,g),le.scale.set(g,g);const A=$t.text,S=le.text;$t.text="EPIC WIN",le.text=cs(a);const T=Math.max($t.getBounds().width,le.getBounds().width);if($t.text=A,le.text=S,T<=m)return g;const E=m/T,C=g*E;return Math.max(g*.58,Math.min(g,C))}function Ko(){const a=P.screen.width/2,h=P.screen.height/2;if(ln(G)){$t.scale.set(uu),le.scale.set(uu),Ht.scale.set(uu);const E=Math.round(h-P.screen.height*.2),C=Math.round(h+P.screen.height*.1),k=Math.round(P.screen.height*.92);$t.position.set(a,E),le.position.set(a,C),Ht.position.set(a,k);const R=Ht.getLocalBounds();Ht.hitArea=new oe(R.x-60,R.y-24,R.width+120,R.height+48);return}const d=-100,m=70,g=Math.round(h+d);Ya?$t.x=a:$t.position.set(a,g),le.position.set(a,Math.round(h+m)),Ht.position.set(a,Math.round(P.screen.height*.92));const A=Ht.getLocalBounds(),S=60,T=24;if(Ht.hitArea=new oe(A.x-S,A.y-T,A.width+S*2,A.height+T*2),He(G)){const E=Da?Wa:Mp;$t.scale.set(E,E),le.scale.set(E,E)}else $t.scale.set(1,1),le.scale.set(1,1);He(G)&&Da?($t.scale.set(Wa),le.scale.set(Wa)):He(G)||($t.scale.set(1,1),le.scale.set(1,1))}const uu=.6,Mp=.78,Db=180,du=520,fu=360;function Xa(){return-Math.max(1,$t.height||$t.getBounds().height||1)/2-Db}function Tp(a=du,h){Ya=!0,Ko();const d=typeof h=="number"?h:$t.y;$t.y=Xa(),ye(a,m=>{const g=Math.max(0,Math.min(1,m)),A=ms(g,.85);$t.y=Xa()+(d-Xa())*A},()=>{$t.y=d,Ya=!1})}function vp(a=fu,h){Ya=!0;const d=$t.y,m=Xa();ye(a,g=>{const A=Math.max(0,Math.min(1,g)),S=pa(A);$t.y=d+(m-d)*S},()=>{$t.y=m,Ya=!1,h==null||h()})}function Gb(a){lu++;const h=lu;Ko();const d=$t.y;Vo!==a&&(Vo=a,vp(fu,()=>{if(h!==lu)return;$t.alpha=0,$t.y=Xa(),_c(a);const m=cu[a];$t.style.fill=m,le.style.fill=hu,$t.alpha=1,Tp(du,d)}))}window.addEventListener("resize",Ko);const Hb="apple_big_win.png",Yb="pear_big_win.png",Xb="grapes_big_win.png",pu="rake_super_win.png",Ep="sheep_super_win.png",Cp="wateringcan_super_win.png",Ip="cow_mega_win.png",Pp="spade_mega_win.png",Op="wheelbarrow_mega_win.png",Lp="tractor_epic_win.png",kp="axe_epic_win.png",Rp="watermelon_epic_win.png",Vb=[{frame:Hb,weight:.55},{frame:Yb,weight:.3},{frame:Xb,weight:.2}],zb=[{frame:Cp,weight:.2},{frame:pu,weight:.2},{frame:Ep,weight:.55}],Kb=[{frame:Ip,weight:.2},{frame:Pp,weight:.2},{frame:Op,weight:.1}],Fp=[{frame:Lp,weight:.45},{frame:kp,weight:.35},{frame:Rp,weight:.2}],$b={[Cp]:.75,[pu]:1.8,[Ep]:1.3},Bp={[Ip]:1,[Pp]:1.3,[Op]:2},Np={[Lp]:1.85,[kp]:1.45,[Rp]:1.2};function Va(a){let h=0;for(const g of a)h+=g.weight;let d=Math.random()*h;for(const g of a)if(d-=g.weight,d<=0)return{tex:H0(g.frame),frame:g.frame};const m=a[0];return{tex:H0(m.frame),frame:m.frame}}function jb(a){return Va(a==="BIG"?Vb:a==="SUPER"?zb:a==="MEGA"?Kb:Fp)}let Ki=null,za=!1,$o="BIG",pr=!1,Up=!1,gc=0;const Wp=[],fo=[],qb=16,Zb=2,Qb=2,Jb=2,tA=1.75,eA=1.9,nA=1.9;function sA(){Ki||(Ki=new st,Ki.sortableChildren=!0,Ki.zIndex=9465,Y.addChild(Ki),Y.sortChildren())}function yc(){if(!Ki)return;const a=jb($o);if(!a)return;const h=a.tex,d=a.frame;if(fo.length>=qb)return;let m=Wp.pop();if(m)m.s.texture=h;else{const D=new Se(h);D.anchor.set(.5),D.roundPixels=!0,m={s:D,vx:0,vy:0,vr:0,life:0}}m.s.__itemFrame=d;const g=m.s,A=P.renderer.width,S=P.renderer.height,T=.1,E=T+Math.random()*(1-T*2);g.x=Math.round(A*E),g.y=S+60+Math.random()*160;const C=.18+Math.random()*.22;let k=Qb;switch($o){case"SUPER":k=Jb;break;case"MEGA":k=tA;break;case"EPIC":k=eA;break;case"MAX":k=nA;break}const R=g.__itemFrame,F=R?$b[R]??1:1,O=R?Bp[R]??1:1,B=R?Np[R]??1:1;let N=F;if(R&&R in Bp&&(N=O),R&&R in Np&&(N=B),R===pu){const D=P.renderer.height*.55,z=Math.max(1,g.texture.height),$=D/z;g.scale.set($*k)}else g.scale.set(C*k*N);g.scale.set(C*k*N),g.alpha=1,g.rotation=-.2+Math.random()*.4,m.vx=(-1+Math.random()*2)*(6+Math.random()*10),m.vy=-(95+Math.random()*300),m.vr=(-1+Math.random()*2)*.6,Ki.addChild(g),fo.push(m)}function iA(){if(!Ki)return;const a=Math.min(.05,P.ticker.deltaMS/1e3),h=P.renderer.width,d=P.renderer.height;if(za&&!pr){gc+=Zb*a;let m=Math.floor(gc);m>0&&(gc-=m),m=Math.min(m,4);for(let g=0;g<m;g++)yc()}for(let m=fo.length-1;m>=0;m--){const g=fo[m],A=g.s;pr&&(g.vy-=800*a,g.vx*=1-.6*a);const S=2,T=h*.5-A.x;g.vx+=T/Math.max(1,h*.5)*S*a,A.x+=g.vx*a,A.y+=g.vy*a,A.rotation+=g.vr*a,(A.y<-220||A.y>d+260||A.x<-220||A.x>h+220)&&(A.removeFromParent(),fo.splice(m,1),Wp.push(g))}pr&&fo.length===0&&(pr=!1)}function rA(){if(sA(),!!Ki){za=!0,pr=!1,gc=0;for(let a=0;a<8;a++)yc();Up||(Up=!0,fn(()=>iA()))}}function oA(){Ki&&(za=!1,pr=!0,fo.length===0&&(pr=!1))}let Ws=null,Ka=!1,Dp=!1,$a=0;const mu=[],Gr=[];function aA(){Ws||(Ws=new st,Ws.eventMode="none",Ws.zIndex=9466,Y.addChild(Ws),Y.sortChildren())}function _u(a,h){const d=Math.max(0,Math.min(255,Math.round((a>>16&255)*h))),m=Math.max(0,Math.min(255,Math.round((a>>8&255)*h))),g=Math.max(0,Math.min(255,Math.round((a&255)*h)));return d<<16|m<<8|g}const Gp=[16727100,16747068,16769126,5635962,5227519,7028694,16740270];function lA(a,h,d){a.clear();const m=h,g=h*.55,A=h*.75,S=_u(d,1.1),T=_u(d,.92),E=_u(d,.82);a.moveTo(0,-g).lineTo(m,0).lineTo(0,g).lineTo(-m,0).closePath().fill({color:S,alpha:1}),a.moveTo(-m,0).lineTo(0,g).lineTo(0,g+A).lineTo(-m,A).closePath().fill({color:T,alpha:1}),a.moveTo(m,0).lineTo(0,g).lineTo(0,g+A).lineTo(m,A).closePath().fill({color:E,alpha:1})}function Hp(){if(!Ws)return;let a=mu.pop();a||(a={g:new xt,vx:0,vy:0,vr:0,life:0,life0:0,s0:1});const h=a.g,d=P.renderer.width,m=-60+Math.random()*(d+120),g=-120-Math.random()*180,A=4+(Math.random()*5|0),S=Gp[Math.random()*Gp.length|0];lA(h,A,S),h.x=m,h.y=g,h.alpha=.95,h.rotation=Math.random()*Math.PI*2,a.vy=160+Math.random()*360,a.vx=(-1+Math.random()*2)*90,a.vr=(-1+Math.random()*2)*3.2,a.life0=2.2+Math.random()*1.6,a.life=a.life0,a.s0=.85+Math.random()*.9,h.scale.set(a.s0),Ws.addChild(h),Gr.push(a)}function ja(a=1){if(aA(),!Ws)return;Ws&&(Ws.visible=!0),Ka=!0,$a=0;const h=Math.floor(60+a*40);for(let d=0;d<h;d++)Hp();ja._intensity=a,Dp||(Dp=!0,fn(()=>cA())),Ws&&(Ws.visible=!0)}function gu(a=!0){if(Ka=!1,$a=0,a){Ka=!1;return}for(let h=Gr.length-1;h>=0;h--){const d=Gr[h];d.g.removeFromParent(),Gr.splice(h,1),mu.push(d)}}function cA(){if(!Ws)return;const a=Math.min(.05,P.ticker.deltaMS/1e3),h=P.renderer.width,d=P.renderer.height;if(Ka){const g=90+(ja._intensity??1)*70;$a+=g*a;const A=Math.floor($a);$a-=A;const S=Math.min(A,12);for(let T=0;T<S;T++)Hp()}for(let m=Gr.length-1;m>=0;m--){const g=Gr[m],A=g.g;g.vy+=520*a,A.x+=g.vx*a,A.y+=g.vy*a,A.rotation+=g.vr*a,g.life-=a,A.alpha=1,(A.y>d+220||A.x<-260||A.x>h+260)&&(A.removeFromParent(),Gr.splice(m,1),mu.push(g))}!Ka&&Gr.length===0&&Ws&&(Ws.visible=!1)}let $i=null,yu=!1,Yp=!1,qa=0;const xu=[],Hr=[];function hA(){return W0()}function uA(){$i||($i=new st,$i.sortableChildren=!0,$i.zIndex=9005,Y.addChild($i),$i.zIndex=9601,Y.sortChildren())}function bu(a=1){if(!$i)return;const h=hA();if(!h.length)return;const d=P.renderer.width;let m=xu.pop();if(m)m.s.textures=h,m.s.animationSpeed=.28+Math.random()*.25,m.s.gotoAndPlay(0);else{const C=new Gl(h);C.anchor.set(.5),C.loop=!0,C.animationSpeed=.28+Math.random()*.25,C.play(),C.autoUpdate=!0,C.roundPixels=!0,m={s:C,vx:0,vy:0,vr:0,life:0}}const g=m.s;g.x=Math.random()*d,g.y=-40-Math.random()*160;const A=.12,T=A+Math.random()*(.75-A),E=1+Math.min(.28,(a-1)*.12);g.scale.set(T*E),g.alpha=.95,g.rotation=Math.random()*Math.PI*2,m.vx=(-1+Math.random()*2)*(1.1+a*.85),m.vy=(2.3+Math.random()*4.6)*(1+a*.75),m.vr=(-1+Math.random()*2)*.06,m.life=3.2+Math.random()*2.2,$i.addChild(g),Hr.push(m)}function Au(a=1){if(uA(),!!$i){yu=!0,qa=0;for(let h=0;h<.1+Math.floor(a*1);h++)bu(a);Yp||(Yp=!0,fn(()=>fA())),Au._intensity=a}}function dA(a,h=1){const d=Math.floor((12+a*10)*h);for(let m=0;m<d;m++)bu(a)}function Xp(a=!0){var h,d;if(yu=!1,qa=0,a){for(const m of Hr)m.life=9999;return}for(const m of Hr)(d=(h=m.s).stop)==null||d.call(h),m.s.removeFromParent(),xu.push(m);Hr.length=0}function fA(){if(!$i)return;const a=P.renderer.width,h=P.renderer.height,d=P.ticker.deltaMS/1e3;if(yu){const g=Au._intensity??1,A=4+g*3;qa+=A*d;const S=Math.floor(qa);qa-=S;const E=Math.max(0,140-Hr.length),C=Math.min(S,E);for(let k=0;k<C;k++)bu(g)}const m=18;for(let g=Hr.length-1;g>=0;g--){const A=Hr[g],S=A.s;A.vy+=m*d,S.x+=A.vx*60*d,S.y+=A.vy*60*d,S.rotation+=A.vr*60*d,A.life-=d,(S.y>h+120||S.x<-120||S.x>a+120||A.life<=0)&&(A.s.stop(),S.removeFromParent(),Hr.splice(g,1),xu.push(A))}}function pA(a){var d;const h=a==="SUPER"?1.08:a==="MEGA"?1.16:a==="EPIC"?1.24:a==="MAX"?1.34:1;if(a==="SUPER"||a==="MEGA"||a==="EPIC"||a==="MAX"){const m=Number.isFinite(h)?Math.max(.5,Math.min(4,h)):1;(d=u==null?void 0:u.playSfx)==null||d.call(u,"bigwin_hit",1,m)}}function Su(a,h,d,m=520){var g,A,S,T,E;if(Ko(),a){let C=function(Q){var ct,nt,Yt;if(D!==mc)return;const X=Math.min(1,(Q-z)/N),ut=Math.min(1,O*X/200),vt=1-Math.pow(ut,2.8)*.65,ee=Math.min(1,X*vt+X*(1-vt)),jt=F*ee,Kt=jt/R;le.text=cs(jt);const Lt=Math.max(0,Math.min(1,X)),ce=.98+.65*Math.pow(Lt,1.45),et=1+.25*(ce-1),_t=(.22+.45*Math.pow(Lt,1.2))*et;(ct=u==null?void 0:u.setTickParams)==null||ct.call(u,_t,ce);const lt=yp(Kt);if(lt!==$&&($=lt,Gb(lt),pA(lt),$o=lt,$o=lt,lt==="MAX"&&ja(1.35),za&&!pr)){const me=lt==="SUPER"?6:lt==="MEGA"?8:lt==="EPIC"?10:12;for(let Ze=0;Ze<me;Ze++)yc()}X<1?requestAnimationFrame(C):(le.text=cs(F),hp(),(nt=u==null?void 0:u.stopTickLoop)==null||nt.call(u,0),(Yt=u==null?void 0:u.playSfx)==null||Yt.call(u,"final_amount",1.15,1),xc(!0,360),Ha=!0,xp())};_.overlay.bigWin=!0,(g=u==null?void 0:u.playSfx)==null||g.call(u,"bigwin_hit",1),Yo==null&&(Yo=((A=u==null?void 0:u.getMusicVolume01)==null?void 0:A.call(u))??.6);const k=Math.max(0,Math.min(1,Yo*Mb));(S=u==null?void 0:u.setMusicVolume01)==null||S.call(u,k),(T=u==null?void 0:u.apply)==null||T.call(u),p0(!0),$o="BIG",rA(),_.ui.auto=!1,Mt.eventMode="none",bc(),de.visible=!0,de.eventMode="static";{Sp(),os.visible=!0,os.alpha=0;const Q=os.alpha;ye(m,X=>{const q=Math.max(0,Math.min(1,X));os.alpha=Q+(Ap-Q)*q})}xc(!1,0),Vo=null,Ko(),_c("BIG"),$t.style.fill=cu.BIG,le.style.fill=hu,Tp(du),Vo="BIG";const R=_.bank.betLevels[_.bank.betIndex],F=h,O=d;au=F,fr=yp(O),Da=!1,Wa=Wb(au),Da=!0,Ko(),Ha=!1,(E=u==null?void 0:u.startTickLoop)==null||E.call(u,120,.22,1);const N=Math.min(6500,1400+O*45);mc++;const D=mc,z=performance.now();let $=null;$="BIG",requestAnimationFrame(C),[$t,le,Ht].forEach(Q=>{Q.visible=!0,Q.alpha=0});const rt=de.alpha;ye(m,Q=>{const X=Math.max(0,Math.min(1,Q));de.alpha=rt+(.8-rt)*X,$t.alpha=X,le.alpha=X,Ht.alpha=X})}else{Da=!1,Wa=1,bp(),oA(),gu(!0);const C=de.alpha,k=fs.strength;xc(!1,m),vp(fu),ye(m,R=>{const F=Math.max(0,Math.min(1,R));de.alpha=C*(1-F),fs.strength=k*(1-F),$t.alpha=1-F,le.alpha=1-F,Ht.alpha=1-F,os.visible&&(os.alpha=Ap*(1-F))},()=>{var R,F,O,B;[$t,le,Ht].forEach(N=>{N.visible=!1,N.alpha=0}),de.alpha=0,fs.strength=0,de.visible=!1,de.eventMode="static",os.visible=!1,os.alpha=0,Mt.alpha=1,Mt.eventMode="auto",p0(!1),(R=u==null?void 0:u.stopTickLoop)==null||R.call(u,0),_.overlay.bigWin=!1,Yo!=null&&((F=u==null?void 0:u.setMusicVolume01)==null||F.call(u,Yo),(O=u==null?void 0:u.apply)==null||O.call(u),Yo=null),(B=u==null?void 0:u.playMusic)==null||B.call(u,_.game.mode==="FREE_SPINS"?"music_fs":"music_base",350),Ga==null||Ga(),Ga=null})}}function Vp(){var h;if(mc++,le.text=cs(au),(h=u==null?void 0:u.playSfx)==null||h.call(u,"final_amount",1.15,1),setTimeout(()=>{var d;(d=u==null?void 0:u.stopTickLoop)==null||d.call(u,120)},80),hp(),Vo=fr,_c(fr),$o=fr,fr==="MAX"&&ja(1.35),za&&!pr){const d=fr==="SUPER"?8:fr==="MEGA"?10:fr==="EPIC"?12:14;for(let m=0;m<d;m++)yc()}const a=cu[fr];$t.style.fill=a,le.style.fill=hu,Ha=!0,xc(!0,180),xp()}function zp(a,h){return new Promise(d=>{var m;Ga=d,Su(!0,a,h,520),(m=Ht.removeAllListeners)==null||m.call(Ht,"pointertap"),Ht.on("pointertap",g=>{var A,S;if((A=g.stopPropagation)==null||A.call(g),!!_.overlay.bigWin){if(!Ha){Vp();return}(S=u==null?void 0:u.playSfx)==null||S.call(u,"fs_click",1.15),bp(),Su(!1,0,0,260)}})})}de.on("pointertap",()=>{var a,h,d,m,g;if(_.overlay.bigWin){if((a=u==null?void 0:u.initFromUserGesture)==null||a.call(u),!Ha){Vp();return}(h=u==null?void 0:u.playSfx)==null||h.call(u,"fs_click",1.15),Su(!1,0,0,260);return}if(_.overlay.fsOutro){if(uo++,!Ho){Ab();return}(d=u==null?void 0:u.playSfx)==null||d.call(u,"fs_click",1.15),(async()=>(await wb(!1,0,260),await Zr(!1),Nn.alpha=0,Nn.visible=!1,Ja(),b0(),Y.sortChildren(),Hn.visible=!0))(),lo(),Xu("BASE"),bo("BASE",!0),(m=u==null?void 0:u.playMusic)==null||m.call(u,"music_base",450),Ua=!1,Px(),Ra=!0,Ba=!0,ic(6),ho=0,hr=!0,No=0,Fn=0,_.game.returningFromFreeSpins=!0,Lc(In[dn]??1),(async()=>(await u0(),_.game.returningFromFreeSpins=!1))(),d0(),Mt.alpha=1,Mt.eventMode="auto",Xp(!0),_.overlay.bigWin=!1;return}_.overlay.fsIntro&&((g=u==null?void 0:u.playSfx)==null||g.call(u,"fs_click",1),_.overlay.fsIntro=!1,Ae&&(Ae.s.removeFromParent(),Ae=null),Uo(),ur=999,de.eventMode="none",wu(!1,180),(async()=>{var A;He(G)?await Wx(3e3):await Ux(3e3),await bo("FREE_SPINS",!0),!(!Xt||!Vt)&&(Xt.visible=!1,Xt.alpha=0,Vt.visible=!0,Vt.alpha=1,qp(!1,.72,8,EA),await ns(Jx),m0(120,360,.9),(A=u==null?void 0:u.playMusic)==null||A.call(u,"music_fs",450),Br=.6,await ns(220),Jr())})())});const mA=900,Ve=new yt({text:Jt("ui.clickToContinue"),style:{}});Ve.anchor.set(.5),Ve.zIndex=9450,Ve.visible=!1,Ve.alpha=0,Y.addChild(Ve),Yd(Ve);const Ai=new yt({text:"0",style:{}});Ai.anchor.set(.5),Ai.visible=!1,Ai.alpha=0,Ai.zIndex=9452,Y.addChild(Ai);function _A(a=2e3){const h=nn.style,d=h!=null&&h.clone?h.clone():{...h||{}};Ai.style=new _e({...d,fontSize:a})}_A();const ji=new yt({text:Jt("ui.freeSpins"),style:$s.style});ji.anchor.set(.5),ji.visible=!1,ji.alpha=0,ji.zIndex=9452,Y.addChild(ji);function Kp(){const a=P.screen.width,h=P.screen.height,d=Math.round(a*.5),m=h*.52,g=250;Ai.position.set(d,Math.round(m-g/2)),ji.position.set(d,Math.round(m+g/2))}window.addEventListener("resize",Kp),Ve.eventMode="static",Ve.cursor="pointer",Ve.hitArea=new oe(-340,-60,680,120),Ve.on("pointertap",a=>{var h;(h=a.stopPropagation)==null||h.call(a),de.emit("pointertap",{})});const gA=.95,yA=90;function xA(){return P.screen.height+yA}function bA(){return P.screen.height*gA}function $p(){Ve.x=P.screen.width/2}const AA=.95,SA=90;function wA(){return P.screen.height+SA}function MA(){return P.screen.height*AA}function TA(){Ht.x=P.screen.width/2}function xc(a,h=320){TA();const d=wA(),m=MA();if(a)Ht.visible=!0,Ht.alpha=0,Ht.y=d,ye(h,g=>{const A=Math.max(0,Math.min(1,g));Ht.alpha=A,Ht.y=d+(m-d)*A});else{const g=Ht.y,A=Ht.alpha;ye(h,S=>{const T=Math.max(0,Math.min(1,S));Ht.alpha=A*(1-T),Ht.y=g+(d-g)*T},()=>{Ht.alpha=0,Ht.y=d,Ht.visible=!1})}}function wu(a,h=320){$p();const d=xA(),m=bA();if(a)Ve.visible=!0,Ve.alpha=0,Ve.y=d,ye(h,g=>{const A=Math.max(0,Math.min(1,g));Ve.alpha=A,Ve.y=d+(m-d)*A});else{const g=Ve.y,A=Ve.alpha;ye(h,S=>{const T=Math.max(0,Math.min(1,S));Ve.alpha=A*(1-T),Ve.y=g+(d-g)*T},()=>{Ve.alpha=0,Ve.y=d,Ve.visible=!1})}}function bc(){const a=P.screen.width,h=P.screen.height;de.clear(),de.rect(0,0,a,h).fill(0)}Jf();const vA=550,EA=260,CA=1,IA=1,PA=2,OA=2,LA=.75,kA=.8;async function jp(a){var F;Jf(),(F=u==null?void 0:u.playSfxThrottled)==null||F.call(u,"fstrigger",200,1,1),En.text=`+${a}`,En.visible=!0,yn.visible=!0,En.alpha=0,yn.alpha=0;function h(){return ln(G)?{amount:CA,label:IA}:He(G)?{amount:LA,label:kA}:{amount:PA,label:OA}}const{amount:d,label:m}=h();En.scale.set(d,d*1.15),yn.scale.set(m,m*1.15);const g=.55,A=160,S=1200,T=220,E=(O,B)=>new Promise(N=>ye(O,B,N));oi.visible=!0,await E(A,O=>{oi.alpha=g*O,En.alpha=O,yn.alpha=O;const B=.92+.08*O;En.scale.set(d*B,d*1.15*B),yn.scale.set(m*B,m*1.15*B)}),await th(S);const C=oi.alpha,k=En.alpha,R=yn.alpha;await E(T,O=>{const B=1-O;oi.alpha=C*B,En.alpha=k*B,yn.alpha=R*B;const N=.98+.02*B;En.scale.set(d*N,d*1.15*N),yn.scale.set(m*N,m*1.15*N)}),oi.visible=!1,En.visible=!1,yn.visible=!1}function qp(a,h=.72,d=8,m=300){var g,A,S,T,E,C,k;if(a){(g=u==null?void 0:u.initFromUserGesture)==null||g.call(u),(A=u==null?void 0:u.playSfx)==null||A.call(u,"confirm",.9),(S=u==null?void 0:u.setBaseMusicIntensity)==null||S.call(u,.15,250),(T=u==null?void 0:u.startFsIntroTractorLoop)==null||T.call(u,420,.85),_.overlay.fsIntro=!0,Mt.alpha=0,Mt.eventMode="none",Hn.visible=!1,Ie&&(Ie.s.removeFromParent(),Ie=null),Br=9999,bc(),de.hitArea=new oe(0,0,P.screen.width,P.screen.height),de.visible=!0,Y.sortChildren(),de.eventMode="static",de.cursor="pointer",tl(0,m),QA(0,.92,m),Pc(1.06,m+200),wu(!0,m),Nx(m+5500),Ai.text=String(_.fs.remaining);const R=de.alpha,F=fs.strength;ye(m,O=>{de.alpha=R+(h-R)*O,fs.strength=F+(d-F)*O})}else{(E=u==null?void 0:u.stopFsIntroTractorLoop)==null||E.call(u,350),(k=u==null?void 0:u.setBaseMusicIntensity)==null||k.call(u,((C=u==null?void 0:u.getBaseMusicIntensity01)==null?void 0:C.call(u))??1,350),Pc(1,m),wu(!1,m);const R=de.alpha,F=fs.strength;ye(m,O=>{de.alpha=R*(1-O),fs.strength=F*(1-O)},()=>{de.alpha=0,fs.strength=0,de.visible=!1,tl(1,m),de.eventMode="none",_.overlay.fsIntro=!1,Ja(),Ai.visible=!1,ji.visible=!1,Ai.alpha=0,ji.alpha=0})}}const js=new st,Jn=new st;Jn.sortableChildren=!0,Y.sortableChildren=!0;const Ss=new st;Ss.zIndex=999,Jn.zIndex=2e3,M.zIndex=0,js.zIndex=1e3,Ss.zIndex=2100;const RA=7,FA=2200,Mu=.35,Ac=[];fn(a=>{a=Math.min(.033,a);for(let h=Ac.length-1;h>=0;h--){const d=Ac[h],m=d.g,g=d.sh;d.vy+=FA*a,m.x+=d.vx*a,m.y+=d.vy*a,m.rotation+=d.rotV*a,g.x=m.x,g.y=m.y+RA*.85,d.life-=a;const A=1-d.life/d.life0;let S=1;if(A>=Mu){const T=(A-Mu)/(1-Mu);S=1-T*T*(3-2*T)}m.alpha=S,g.alpha=.22*Math.max(0,1-A*3),d.life<=0&&(m.removeFromParent(),g.removeFromParent(),m.destroy(),g.destroy(),Ac.splice(h,1))}});let Tu=1;fn(()=>{const a=P.ticker.FPS??1e3/Math.max(1,P.ticker.deltaMS),h=a>=55?1:a>=48?.8:a>=42?.65:a>=36?.5:.35;Tu+=(h-Tu)*.08});const Pi=new st;Pi.zIndex=99999,Pi.eventMode="none",Y.addChild(Pi),Pi.zIndex=9600,Y.sortChildren(),Y.sortChildren();const BA={L1:14248474,L2:4926627,L3:5221962,L4:14169140,H1:8376319,H2:9132587,H3:16740270,H4:7330938,H5:16761095,W1:16777215,S1:1981695},NA=16762954;function vu(a,h){const d=Math.max(0,Math.min(255,(a>>16&255)*h)),m=Math.max(0,Math.min(255,(a>>8&255)*h)),g=Math.max(0,Math.min(255,(a&255)*h));return(d|0)<<16|(m|0)<<8|(g|0)}function Zp(a,h,d,m,g,A=.7){Pi.parent||(Y.addChild(Pi),Pi.zIndex=2062,Y.sortChildren());const S=7,E=Math.max(10,Math.floor(28*Tu*1.1)),C=900,k=420,R=720,F=1,O=.65;let B=0,N=0;if(m){const z=Math.hypot(m.x,m.y)||1;B=m.x/z,N=m.y/z}const D=[14248474,7028694,10214479,14169140,9132587];for(let z=0;z<E;z++){const $=new xt,rt=typeof g=="number";let Q=d;d===16777215?Q=D[Math.random()*D.length|0]:rt&&(Q=Math.random()<A?d:g);const X=S*(.65+Math.random()*.55),q=S,ut=S*.55;let vt,ee,jt;d===16777215?(vt=D[Math.random()*D.length|0],ee=D[Math.random()*D.length|0],jt=D[Math.random()*D.length|0]):(vt=vu(Q,1.15+Math.random()*.06),ee=vu(Q,.95+Math.random()*.06),jt=vu(Q,.8+Math.random()*.06)),$.moveTo(0,-ut).lineTo(q,0).lineTo(0,ut).lineTo(-q,0).closePath().fill({color:vt,alpha:1}),$.moveTo(-q,0).lineTo(0,ut).lineTo(0,ut+X).lineTo(-q,X).closePath().fill({color:ee,alpha:1}),$.moveTo(q,0).lineTo(0,ut).lineTo(0,ut+X).lineTo(q,X).closePath().fill({color:jt,alpha:1});const Kt=new xt;Kt.ellipse(0,0,S*.9,S*.45).fill({color:0,alpha:1}),Kt.alpha=.18,Kt.scale.y=.6;const Lt=-22+Math.random()*24,ce=-22+Math.random()*24;$.x=a+Lt,$.y=h+ce,Kt.x=$.x,Kt.y=$.y+S*.85;const et=Math.random()*Math.PI*2,_t=k+Math.random()*(R-k);let lt=Math.cos(et)*_t,ct=Math.sin(et)*_t-(300+Math.random()*200);m&&(lt=lt*(1-O)+B*_t*O,ct=ct*(1-O)+N*_t*O);const nt=(-1+Math.random()*2)*7.5;$.alpha=F,Pi.addChild(Kt),Pi.addChild($),Ac.push({g:$,sh:Kt,vx:lt,vy:ct,rotV:nt,life:C/1e3,life0:C/1e3})}}const Eu=[];let Qp=!1;function UA(){const a=P.ticker.deltaMS/1e3;for(let h=Eu.length-1;h>=0;h--){const d=Eu[h],m=d.g;d.vy+=d.grav*a,m.x+=d.vx*a,m.y+=d.vy*a,m.rotation+=d.vr*a,d.life-=a;const g=Math.max(0,d.life/d.life0);m.alpha=g;const A=.9+.1*g;m.scale.set(A),d.life<=0&&(m.removeFromParent(),Eu.splice(h,1))}}function WA(){Qp||(Qp=!0,fn(()=>UA()))}WA();const Mt=new st;Mt.sortableChildren=!0,Mt.zIndex=1500,Y.addChild(Mt),Mt.addChild(js),Mt.addChild(Jn),js.zIndex=1e3,Jn.zIndex=2e3,Mt.sortChildren(),Mt.sortChildren(),Mt.alpha=0,Mt.eventMode="none",Mt.addChild(Ut);const Si=new yt({text:`8-BIT
WIZARDRY`,style:{fontFamily:"Micro5",fill:16777215,fontSize:34,align:"center",letterSpacing:2}});r(Si),Si.anchor.set(.5),Si.zIndex=1600,Si.eventMode="none",Mt.addChild(Si);function DA(){Si.anchor.set(0,0),Si.x=24,Si.y=20,Si.alpha=.85,Si.scale.set(.95)}let Sc=1,wc=!1;const We=new Se(te.WHITE);We.anchor.set(0,.5),We.zIndex=1200,We.eventMode="none",We.anchor.set(0,.5),We.zIndex=1200,Mt.addChild(We),Mt.sortableChildren=!0,Mt.zIndex=1500,We.visible=!1;const Jp=.43;function t0(){const a=P.screen.width/2,h=P.screen.height/2;if(Mt.pivot.set(a,h),Mt.position.set(a,h),We&&!wc){const d=1/Mt.scale.x,m=ln(G)?Jp:1;Sc=d*m,We.scale.set(Sc)}}window.addEventListener("resize",t0);let po=0;function Mc(){if(!We)return;const a=ln(G)?Jp:1,h=1/Math.max(1e-4,Mt.scale.x);if(wc){We.scale.set(Sc);return}We.scale.set(h*a)}function e0(a=520,h=1.04,d=1.03){var A;if(_.overlay.fsIntro||_.overlay.fsOutro)return;(A=u==null?void 0:u.setBaseMusicIntensity)==null||A.call(u,.85,250),po++;const m=po,g=Mt.scale.x||1;ye(a,S=>{if(m!==po)return;const T=S*S*(3-2*S),E=g+(h-g)*T;Mt.scale.set(E),Mc()}),Pc(d,a+80)}function n0(a=260,h=1,d=1){var A;if(_.overlay.fsIntro||_.overlay.fsOutro)return;(A=u==null?void 0:u.setBaseMusicIntensity)==null||A.call(u,.25,400),po++;const m=po,g=Mt.scale.x||1;ye(a,S=>{if(m!==po)return;const T=S*S*(3-2*S),E=g+(h-g)*T;Mt.scale.set(E)},()=>{m===po&&Mt.scale.set(h),Mc()}),Pc(d,a)}let jo=0;function s0(a,h=520){var T,E;jo++;const d=jo,m=[];for(let C=0;C<U;C++){if(((T=a[C])==null?void 0:T.id)!=="S1")continue;const k=(E=qe[C])==null?void 0:E.sprite;if(!k||!k.parent)continue;const R=k.parent,F=R.getChildIndex(k),O=k.zIndex??0,B=k.getGlobalPosition();R.removeChild(k),ra.addChild(k),k.position.copyFrom(ra.toLocal(B)),k.zIndex=10,zu.push({s:k,fromParent:R,fromIndex:F,fromZ:O}),m.push({s:k,base:k.scale.x})}if(!m.length)return;const g=1.12,A=Math.max(90,Math.floor(h*.45));(async()=>{for(;d===jo;)await ke(A,C=>{if(d!==jo)return;const k=C*C*(3-2*C);for(const R of m)R.s.scale.set(R.base*(1+(g-1)*k))}),await ke(A,C=>{if(d!==jo)return;const k=C*C*(3-2*C);for(const R of m)R.s.scale.set(R.base*(g-(g-1)*k))});for(const C of m)C.s.scale.set(C.base)})()}function i0(){jo++;for(const a of zu){const{s:h,fromParent:d,fromIndex:m,fromZ:g}=a;if(!h)continue;const A=h.getGlobalPosition();h.parent&&h.parent.removeChild(h);const S=Math.min(m,d.children.length);d.addChildAt(h,S),h.position.copyFrom(d.toLocal(A)),h.zIndex=g}zu.length=0}const Yr=new xt;Yr.zIndex=2600,Yr.alpha=0,Yr.visible=!0,Yr.blendMode="add",Y.addChild(Yr);function Cu(){const a=an.getBounds(),h=He(G),d=18,m=14,g=18;if(Yr.clear(),h){const S=P.screen.width,T=Math.round(m),E=Math.round(S-m*2),C=Math.round(a.y-d),k=Math.round(a.height+d*2);Yr.rect(T,C,E,k).fill(16777215);return}const A=g;Yr.rect(Math.round(a.x-A),Math.round(a.y-A),Math.round(a.width+A*2),Math.round(a.height+A*2)).fill(16777215)}Jn.sortableChildren=!0;const Tc=new st;Tc.sortableChildren=!0,Tc.zIndex=2e4,Tc.visible=!0,Tc.eventMode="none";const Hn=new st;Hn.zIndex=1400,Y.addChild(Hn),Y.sortChildren(),fn(()=>{(_.overlay.fsIntro||_.overlay.fsOutro)&&(Hn.visible=!1)});const qo=new st;Hn.addChild(qo);const un=[],Zo=108,r0=Zo,mr=88,Iu=0,Xr=mr+Iu,Pu=new st;qo.addChild(Pu);const o0=new xt().rect(0,0,Zo,Xr*4-Iu).fill(16777215);Pu.mask=o0,qo.addChild(o0);const Vr={top:.75,mid:.85,active:1,max:.75};function GA(){const a=new st,h=new xt;h.rect(0,0,Zo,mr).fill(16777215),h.alpha=.25;const d=new xt,m=2,g=m/2;d.rect(g,g,Zo-m,mr-m).stroke({width:m,color:0,alpha:1}),d.visible=!0,d.alpha=0;const A=new yt({text:"1x",style:{fontFamily:"pixeldown",fill:16777215,fontSize:55,fontWeight:"1",letterSpacing:0,stroke:{color:0,width:6},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.75,dropShadowBlur:0,dropShadowDistance:7,dropShadowAngle:-Math.PI/5}});return i(A),A.anchor.set(.5),A.x=Zo/2,A.y=mr/2+4,A.skew.set(0,.39),A.scale.x=.98,a.addChild(h,d,A),Pu.addChild(a),{row:a,bg:h,outline:d,label:A}}for(let a=0;a<4;a++){const h=GA();h.row.pivot.set(Zo,mr/2),h.row.x=r0,h.row.y=a*Xr+mr/2,un.push(h)}const Qo=new yt({text:"◀",style:{fill:16777215,fontSize:25,fontWeight:"900",stroke:{color:0,width:5},dropShadow:!1}});i(Qo),Qo.anchor.set(.5),Qo.x=r0+4,Qo.y=2*Xr+mr/2,Qo.alpha=.9,qo.addChild(Qo);const a0="‎";function Ou(a){const d=Math.abs(a-Math.round(a))<1e-6?String(Math.round(a)):a.toFixed(2);return`${a0}x${d}`}let dn=0,vc=!1,zr=null;function HA(){return new Promise(a=>{const h=()=>{if(!vc&&zr==null)return a();requestAnimationFrame(h)};requestAnimationFrame(h)})}function mo(a){const h=In.length-1,d=In[Math.min(a,h)]??1,m=In[Math.min(a+1,h)]??d,g=In[Math.min(a+2,h)]??m,A=a>0?In[a-1]??d:In[h]??d,S=[g,m,d,A];a===h?(S[0]=null,S[1]=null):a===h-1&&(S[0]=null);for(let T=0;T<4;T++){const E=un[T],C=S[T],k=C==null||Lu(T,a);if(E.row.visible=!k,k)continue;E.label.text=Ou(C),i(E.label);const R=In[In.length-1];E.label.style.fill=C===R?16765802:16777215,Ec(T,E)}}function YA(a){return In[a]}function Lu(a,h){const d=In.length-1;return h>=d?a===0||a===1:h===d-1?a===0:!1}function Za(a){for(let h=0;h<4;h++){const d=un[h],m=Lu(h,a);d.row.visible=!m}}function XA(a){const h=In.length-1;return a<=0?In[h]??1:In[a-1]??1}function Ec(a,h){h.outline.visible=!0,h.outline.alpha=a===2?1:0;const d=[.65,.8,1,.7],m=[2,1,0,1];h.row.alpha=d[a]??1;const g=m[a]??0,A=h._blurAmount??0;if(Math.abs(A-g)>.01){if(g>.01){const T=h._blurFilter??(h._blurFilter=new Co({strength:0}));T.strength=g,h.row.filters=g>.01?[T]:null,h.row.filters=[T]}else h.row.filters=null;h._blurAmount=g}const S=[.18,.28,.55,.22];h.bg.alpha=S[a]??.25,h.label.alpha=a===2?1:.75,a===2?h.row.scale.set(Vr.active):a===1?h.row.scale.set(Vr.mid):a===0?h.row.scale.set(Vr.top):h.row.scale.set(Vr.max)}function Jo(){for(let a=0;a<4;a++){const h=un[a],d=Lu(a,dn);h.row.visible=!d,!d&&Ec(a,h)}}function l0(a,h,d=260,m=g=>ms(g,2)){var jt,Kt,Lt,ce;if(dn>=In.length-1&&a===1){h();return}const g=et=>et*Xr+mr/2,A=a===1?+Xr:-Xr,S=dn+a;if(a===1){const et=un[3];et.row.y=g(0)-Xr;const _t=In.length-1,ct=dn+1+2;ct>_t?(et.row.visible=!1,et.row.alpha=0,et.bg.alpha=0,et.label.alpha=0,et.outline.alpha=0,et.label.text="",et._forceHidden=!0):(et.row.visible=!0,et.row.alpha=1,et._forceHidden=!1,et.label.text=Ou(YA(ct)),Ec(0,et))}else{const et=un[0];et.row.y=g(3)+Xr,et.label.text=Ou(XA(S)),Ec(3,et)}const T=un.map(et=>et.row.y),E=un.map(et=>et.row.scale.x),C=un.map(et=>et.bg.alpha),k=un.map(et=>et.label.alpha),R=[.65,.8,1,.7],F=[0,0,1,0],O=[Vr.top,Vr.mid,Vr.active,Vr.max],B=[.18,.28,.55,.22],N=[.75,.75,1,.75],D=(et,_t)=>(et%_t+_t)%_t,z=(et,_t,lt)=>et+(_t-et)*lt,$=A>0?1:-1,rt=un.map(et=>et.row.alpha),Q=un.map(et=>et.outline.alpha),X=un.map((et,_t)=>O[D(_t+$,4)]),q=un.map((et,_t)=>B[D(_t+$,4)]),ut=un.map((et,_t)=>N[D(_t+$,4)]),vt=un.map((et,_t)=>R[D(_t+$,4)]),ee=un.map((et,_t)=>F[D(_t+$,4)]);if(qo.alpha=1,a===1){const et=((jt=u==null?void 0:u.getSfxMuted)==null?void 0:jt.call(u))??!1,_t=((Kt=u==null?void 0:u.getSfxVolume01)==null?void 0:Kt.call(u))??1;if(console.log("[SFX] multiplier step",{muted:et,vol:_t}),!et&&_t>.001){const lt=(Lt=u==null?void 0:u.playSfxThrottled)==null?void 0:Lt.bind(u);lt?lt("multiplier",60,.95,1):(ce=u==null?void 0:u.playSfx)==null||ce.call(u,"multiplier",.95,1)}}ye(d,et=>{const _t=et,lt=Math.max(0,Math.min(1,et));for(let ct=0;ct<un.length;ct++){const nt=un[ct];if(nt.row.y=T[ct]+A*_t,nt._forceHidden){nt.row.visible=!1,nt.row.alpha=0,nt.bg.alpha=0,nt.label.alpha=0,nt.outline.alpha=0;continue}const Yt=z(E[ct],X[ct],lt);nt.row.scale.set(Yt),nt.bg.alpha=z(C[ct],q[ct],lt),nt.label.alpha=z(k[ct],ut[ct],lt),nt.row.alpha=z(rt[ct],vt[ct],lt),nt.outline.visible=!0,nt.outline.alpha=z(Q[ct],ee[ct],lt)}},()=>{a===1?un.unshift(un.pop()):un.push(un.shift());for(let et=0;et<un.length;et++)un[et].row.y=g(et);qo.alpha=1,h()},m)}function c0(a){if(a===dn)return;vc=!0;const h=a>dn?1:-1,d=()=>new Promise(m=>{l0(h,()=>{dn+=h,mo(dn),Jo(),Za(dn),m()})});(async()=>{for(;dn!==a;)await d();if(vc=!1,zr!==null&&zr!==dn){const m=zr;zr=null,c0(m)}else zr=null})()}function h0(a){let h=In.findIndex(d=>Math.abs(d-a)<1e-6);if(h<0&&(h=0),vc){zr=h;return}if(h===dn){mo(dn);return}c0(h)}function VA(a,h=260,d=m=>ms(m,2)){return new Promise(m=>l0(a,m,h,d))}async function u0(){zr=null;for(const h of un)h._forceHidden=!1,h.row.visible=!0;const a=120;for(;dn>0;)await VA(-1,a,Hs),dn-=1,mo(dn),Jo(),Za(dn),Lc(In[dn]??1)}mo(0),Jo();let zA=1200,KA=140,Cc=!1,ku=0,Ru=0,Fu=0;const $A=10,jA=4,Bu=.18,qA=.012;let _o=0;const ZA=520;let Qa=0;function d0(a=zA){wc=!0,Mc(),We.scale.set(Sc);const h=++Qa;Ja(),DA();const d=We.x,m=We.y,g=-We.height-KA;Cc=!0,_o=0,We.rotation=0,We.visible=!0,We.alpha=1,We.x=d,We.y=g,ye(a,A=>{if(h!==Qa)return;const S=Math.max(0,Math.min(1,A)),T=ms(S,1.25);We.y=g+(m-g)*T},()=>{h===Qa&&(Cc=!1,We.x=d,We.y=m,ku=d,Ru=m,Fu=0,_o=0,ye(ZA,A=>{h===Qa&&(_o=Math.max(0,Math.min(1,A)))},()=>{h===Qa&&(_o=1)}))}),wc=!1,Mc()}function Ja(){if(Ee!=null&&Ee.visible||_.overlay.splash||_.overlay.startup){Hn.visible=!1;return}if(_.overlay.fsIntro||_.overlay.fsOutro){Hn.visible=!1;return}if(_.ui.settingsOpen||_.ui.buyMenuOpen){Hn.visible=!1;return}const a=!He(G)&&!ln(G),h=a?Is:Ia,d=a?lr:ar;We.x=Math.round(jr+yr+h);const m=Math.round(qr+xr*.5+d);if(ku=We.x,Ru=m,Cc||(We.y=m),He(G)){Hn.visible=!0;const E=P.screen.width,C=wl(),k=0,R=70,F=-27;Hn.scale.set(.6),Hn.x=Math.round(E-k-R),Hn.y=Math.round(C+F),mo(dn),Jo(),Za(dn);return}if(ln(G)){Hn.visible=!0;const E=an.getBounds(),C=0,k=.12;Hn.scale.set(.7);const F=Hn.getBounds();Hn.x=Math.round(E.x-C-F.width),Hn.y=Math.round(E.y+E.height*k),mo(dn),Jo(),Za(dn);return}Hn.visible=!0,Hn.x=Math.round(jr+yr-980),Hn.y=Math.round(qr+xr*.08-15);const g=L*4.1,A=mr*4+Iu*3,S=Math.max(.6,Math.min(1.3,g/A)),T=Math.round(S*1e3)/1e3;Hn.scale.set(T),mo(dn),Jo(),Za(dn)}const xn=new st;xn.zIndex=8e3,Y.addChild(xn),ei(),xn.alpha=0,xn.eventMode="none";const ps=new st;xn.addChild(ps);function bn(a,h){const d=a.btnHeight?a.btnHeight():a.height;if(d<=0)return;const m=h/d;a.scale.set(m)}function tl(a,h=250){const d=xn.alpha;a===0&&(xn.eventMode="none"),ye(h,m=>{xn.alpha=d+(a-d)*m},()=>{xn.alpha=a,xn.eventMode=a>0?"auto":"none"})}function QA(a,h,d=300){const m=Mt.alpha,g=Mt.scale.x;Mt.eventMode="none",ye(d,A=>{Mt.alpha=m+(a-m)*A;const S=g+(h-g)*A;Mt.scale.set(S)},()=>{Mt.alpha=a,Mt.scale.set(h),Mt.eventMode="none"})}let Zt=null,Qt=null;function f0(a){var h,d,m,g,A,S,T;xn.eventMode=a?"auto":"none",xn.cursor="default",xn.alpha=1,(h=ht==null?void 0:ht.setEnabled)==null||h.call(ht,a&&(!_.ui.spinning||_.ui.auto)),(d=Ne==null?void 0:Ne.setEnabled)==null||d.call(Ne,a),(m=Tt==null?void 0:Tt.setEnabled)==null||m.call(Tt,a),(g=dt==null?void 0:dt.setEnabled)==null||g.call(dt,a),(A=je==null?void 0:je.setEnabled)==null||A.call(je,a),(S=Qt==null?void 0:Qt.setEnabled)==null||S.call(Qt,a),(T=Zt==null?void 0:Zt.setEnabled)==null||T.call(Zt,a)}function p0(a){a?(f0(!1),Mt.eventMode="none"):(f0(!0),Mt.eventMode="auto")}function m0(a=300,h=300,d=.92){Mt.visible=!0,xn.visible=!0,Mt.alpha=0,Mt.scale.set(d),Mt.eventMode="none",setTimeout(()=>{const m=Mt.alpha,g=Mt.scale.x;ye(h,A=>{Mt.alpha=m+(1-m)*A;const S=g+(1-g)*A;Mt.scale.set(S)},()=>{Mt.alpha=1,Mt.scale.set(1),Mt.eventMode="auto"})},a)}function Nu(){const a=P.screen.width/2,h=P.screen.height/2;M.pivot.set(a,h),M.position.set(a,h)}Nu(),window.addEventListener("resize",()=>{Nu()});let Ic=0;function Pc(a,h=500){if(_.overlay.splash)return;Nu();const d=M,m=d.scale.x,g=++Ic;ye(h,A=>{if(g!==Ic)return;const S=Math.max(0,Math.min(1,A)),T=m+(a-m)*S;d.scale.set(T)},()=>{g===Ic&&d.scale.set(a)})}function Ds(a){const h=a.getLocalBounds();a.pivot.set(h.x+h.width/2,h.y+h.height/2)}function ta(a,h,d,m,g){a.x=Math.round(m*h),a.y=Math.round(g*d)}function _0(a,h,d){const m=a.getLocalBounds();a.hitArea=new oe(m.x-h,m.y-d,m.width+h*2,m.height+d*2)}const Uu=we({fontFamily:"Micro5",fill:16765802,fontSize:32,fontWeight:"200",letterSpacing:2}),Wu=we({fontFamily:"Micro5",fill:16777215,fontSize:40,fontWeight:"200",letterSpacing:1,stroke:{color:0,width:4}}),Os=new yt({text:cs(_.bank.balance),style:Wu}),ai=new yt({text:Jt("ui.balance"),style:Uu});ai.anchor.set(.5),ps.addChild(ai),ps.addChild(Os);const Oc=new yt({text:Jt("ui.mult"),style:{fill:16765802,fontSize:17,fontWeight:"600",letterSpacing:2}});Oc.anchor.set(.5);const el=new yt({text:"x1",style:{fill:16777215,fontSize:30,fontWeight:"700"}});el.anchor.set(.5),new st().addChild(Oc,el);function Lc(a){const h=Math.abs(a-Math.round(a))<1e-6;el.text=`${a0}x${h?String(Math.round(a)):a.toFixed(2)}`}const qs=new yt({text:Jt("ui.win"),style:Uu});qs.anchor.set(.5),qs.anchor.set(.5);const Gs=new yt({text:cs(0),style:Wu});Gs.anchor.set(.5);const Cn=new st;Cn.addChild(qs,Gs),ps.addChild(Cn);function g0(a){_.bank.lastWin=a,Gs.text=cs(a)}const JA=Wu,ea=new xt;ea.rect(0,0,120,44).fill(0),ea.alpha=.35;const qi=new yt({text:cs(_.bank.betLevels[_.bank.betIndex]),style:JA});qi.anchor.set(.5);const Ls=new yt({text:Jt("ui.bet"),style:Uu});Ls.anchor.set(.5);const $n=new st;$n.addChild(ea,qi);const An=new st;An.eventMode="none",ps.addChild(An),An.addChild(ai,Os);const Zs=new st;Zs.eventMode="passive",ps.addChild(Zs);const Bn=new st,Sn=new st;Bn.eventMode="none",Sn.eventMode="passive",ps.addChild(Bn),ps.addChild(Sn);function y0(){const a=_.bank.betLevels[_.bank.betIndex],d=_.fs.remaining>0||_.bank.balance>=a;L1(!d)}function go(){var d;const a=_.bank.betLevels[_.bank.betIndex],h=_.fs.remaining>0||_.bank.balance>=a;(d=ht==null?void 0:ht.setEnabled)==null||d.call(ht,h&&(!_.ui.spinning||_.ui.auto)&&!_.ui.settingsOpen&&!_.ui.buyMenuOpen),y0()}function x0(a){var h,d,m,g,A,S;(h=Ne==null?void 0:Ne.setEnabled)==null||h.call(Ne,a),(d=Tt==null?void 0:Tt.setEnabled)==null||d.call(Tt,a),(m=dt==null?void 0:dt.setEnabled)==null||m.call(dt,a),(g=je==null?void 0:je.setEnabled)==null||g.call(je,a),(A=Qt==null?void 0:Qt.setEnabled)==null||A.call(Qt,a),(S=Zt==null?void 0:Zt.setEnabled)==null||S.call(Zt,a),go()}function nl(){return _.game.mode==="FREE_SPINS"||_.fs.remaining>0||_.overlay.fsOutroPending}function sl(){var S,T,E,C,k,R,F,O,B,N,D,z,$,rt,Q,X,q;const a=(Ee==null?void 0:Ee.visible)||_.overlay.splash||_.overlay.startup||_.overlay.fsIntro||_.overlay.fsOutro||_.overlay.bigWin,h=_.ui.settingsOpen||_.ui.buyMenuOpen||(((S=se==null?void 0:se.isOpen)==null?void 0:S.call(se))??!1),d=nl(),m=!a&&!nl(),g=!a;if((T=Ne==null?void 0:Ne.setEnabled)==null||T.call(Ne,m),(E=je==null?void 0:je.setEnabled)==null||E.call(je,g),a){(C=ht==null?void 0:ht.setEnabled)==null||C.call(ht,!1),(k=Tt==null?void 0:Tt.setEnabled)==null||k.call(Tt,!1),(R=dt==null?void 0:dt.setEnabled)==null||R.call(dt,!1),(F=Zt==null?void 0:Zt.setEnabled)==null||F.call(Zt,!1),(O=Qt==null?void 0:Qt.setEnabled)==null||O.call(Qt,!1);return}if(d){(B=ht==null?void 0:ht.setEnabled)==null||B.call(ht,!1),(N=Tt==null?void 0:Tt.setEnabled)==null||N.call(Tt,!1),(D=dt==null?void 0:dt.setEnabled)==null||D.call(dt,!1),(z=Zt==null?void 0:Zt.setEnabled)==null||z.call(Zt,!1),($=Qt==null?void 0:Qt.setEnabled)==null||$.call(Qt,!1),gr("free spins lock"),li==null||li();return}go();const A=!h&&!_.ui.spinning;(rt=Tt==null?void 0:Tt.setEnabled)==null||rt.call(Tt,A),(Q=dt==null?void 0:dt.setEnabled)==null||Q.call(dt,A),(X=Zt==null?void 0:Zt.setEnabled)==null||X.call(Zt,!h&&!_.ui.spinning),(q=Qt==null?void 0:Qt.setEnabled)==null||q.call(Qt,!h&&!_.ui.spinning)}function b0(){var a,h;xn.eventMode="auto",xn.alpha=1,(a=ht==null?void 0:ht.resetVisual)==null||a.call(ht),(h=Tt==null?void 0:Tt.resetVisual)==null||h.call(Tt),li(),sl()}function kc(){qi.text=cs(_.bank.betLevels[_.bank.betIndex]);const a=16,h=!He(G),d=h?14:28,m=Math.max(90,qi.width+d);let g=Math.max(40,qi.height+a);g=Math.round(g*(h?.75:1.1)),ea.clear(),ea.rect(-m/2,-g/2,m,g).fill(0),ea.alpha=.35,qi.anchor.set(.5),qi.x=0,qi.y=-6}kc();function t1(a,h,d,m){var ee,jt,Kt;const g=new st;let A=!1;const S=new Se(jn(a));S.anchor.set(.5);const T=36,E=((ee=S.texture)==null?void 0:ee.height)||((Kt=(jt=S.texture)==null?void 0:jt.orig)==null?void 0:Kt.height)||1,C=T/Math.max(1,E);S.scale.set(C),S.roundPixels=!0;const k=64,R=64,F=new xt;F.rect(-k/2,-R/2,k,R).fill({color:16777215,alpha:.001}),F.eventMode="static",F.cursor="pointer",g.addChild(F),g.addChild(S),g.setMuted=Lt=>{A=Lt,S.texture=jn(A?h:a)},S.anchor.set(.5);const O=new xt,B=new xt,N=new xt,D=new xt,z=new xt,$=new xt;g.addChild(S,B,O,N,D,z,$);let rt=Math.max(0,Math.min(1,d)),Q=!1,X=!1;const q=new Set;q.add(S),q.add(F),q.add(B),q.add(O),q.add($),g.isFromSlider=Lt=>q.has(Lt),g.isDragging=()=>Q,g.bindIconTap=Lt=>{g._iconTapFn=Lt;const ce=et=>{var _t;et.eventMode="static",et.cursor="pointer",(_t=et.removeAllListeners)==null||_t.call(et,"pointertap"),et.on("pointertap",lt=>{var ct;(ct=lt.stopPropagation)==null||ct.call(lt),Lt()})};ce(S),ce(F)};const ut=60;function vt(Lt){const ce=Math.round(Lt*rt);B.clear(),B.moveTo(0,0).lineTo(Lt,0).stroke({width:6,color:16777215,alpha:.25}),O.clear(),ce>0&&(O.moveTo(0,0).lineTo(ce,0).stroke({width:6,color:16777215,alpha:.95}),N.clear(),N.moveTo(0,0).lineTo(Lt,0).stroke({width:32,color:16777215,alpha:.001})),D.visible=!1,z.visible=!1,D.clear(),D.circle(0,0,4).fill({color:16777215,alpha:.95}),z.clear(),z.circle(Lt,0,4).fill({color:16777215,alpha:.95}),$.clear(),$.circle(0,0,14).fill({color:16777215,alpha:1}),$.x=ut+ce,$.y=0}return g.layout=(Lt,ce,et)=>{var Yt,me,Ze,ws,Ms,ts;g.x=Lt,g.y=ce,S.x=0,S.y=0,B.roundPixels=!0,O.roundPixels=!0,D.roundPixels=!0,z.roundPixels=!0,$.roundPixels=!0,B.x=ut,B.y=0,O.x=ut,O.y=0,N.x=ut,N.y=0,D.x=ut,D.y=0,z.x=ut,z.y=0,vt(et),$.eventMode="static",$.cursor="pointer",(Yt=$.removeAllListeners)==null||Yt.call($),(me=B.removeAllListeners)==null||me.call(B),(Ze=O.removeAllListeners)==null||Ze.call(O),(ws=N.removeAllListeners)==null||ws.call(N),(Ms=S.removeAllListeners)==null||Ms.call(S,"pointertap"),(ts=F.removeAllListeners)==null||ts.call(F,"pointertap");const _t=g._iconTapFn;_t&&g.bindIconTap(_t),$.on("pointerdown",Bt=>{var ne;Q=!0,(ne=Bt.stopPropagation)==null||ne.call(Bt)}),$.on("pointertap",Bt=>{var ne;return(ne=Bt.stopPropagation)==null?void 0:ne.call(Bt)});const lt=Bt=>{Bt.eventMode="static",Bt.cursor="pointer",Bt.on("pointerdown",ne=>{var Ts;return(Ts=ne.stopPropagation)==null?void 0:Ts.call(ne)}),Bt.on("pointertap",ne=>{var Ts;return(Ts=ne.stopPropagation)==null?void 0:Ts.call(ne)}),Bt.on("pointertap",ne=>{var es;(es=ne.stopPropagation)==null||es.call(ne);const Ts=Bt.toLocal(ne.global);rt=Math.max(0,Math.min(1,Ts.x/et)),vt(et),m==null||m(rt)})};lt(B),lt(O);const ct=Bt=>{const ne=B.toLocal({x:Bt,y:0});return rt=Math.max(0,Math.min(et,ne.x))/et,vt(et),rt};if($.on("pointerdown",Bt=>{var ne;Q=!0,(ne=Bt.stopPropagation)==null||ne.call(Bt)}),!X){X=!0,P.stage.on("pointermove",ne=>{Q&&(ct(ne.global.x),m==null||m(rt))});const Bt=()=>{Q=!1};P.stage.on("pointerup",Bt),P.stage.on("pointerupoutside",Bt)}const nt=Bt=>{var ne;return(ne=Bt.stopPropagation)==null||ne.call(Bt),Q=!0,ct(Bt.global.x),m==null||m(rt),rt};B.eventMode="static",B.cursor="pointer",B.on("pointerdown",nt),B.on("pointertap",Bt=>{var ne;return(ne=Bt.stopPropagation)==null?void 0:ne.call(Bt)}),O.eventMode="static",O.cursor="pointer",O.on("pointerdown",nt),O.on("pointertap",Bt=>{var ne;return(ne=Bt.stopPropagation)==null?void 0:ne.call(Bt)}),N.eventMode="static",N.cursor="pointer",N.on("pointerdown",nt),N.on("pointertap",Bt=>{var ne;return(ne=Bt.stopPropagation)==null?void 0:ne.call(Bt)})},g.getValue=()=>rt,g.setValue=Lt=>{rt=Math.max(0,Math.min(1,Lt))},g}function na(a,h,d,m,g){const A=new st,S=new Se(jn(a)),T=new Se(jn(h)),E=new Se(jn(d));S.anchor.set(.5),T.anchor.set(.5),E.anchor.set(.5),T.visible=!1,E.visible=!1,A.addChild(S,T,E),A.eventMode="static",no(G)||Hd(G,A,"pointer"),A.on("pointerover",()=>{S.visible=!1,T.visible=!0,E.visible=!1}),A.on("pointerout",()=>{S.visible=!0,T.visible=!1,E.visible=!1}),A.on("pointerdown",()=>{S.visible=!1,T.visible=!1,E.visible=!0}),A.on("pointerup",()=>{S.visible=!1,T.visible=!0,E.visible=!1}),A.on("pointertap",()=>{var O,B;(O=u==null?void 0:u.initFromUserGesture)==null||O.call(u);const F=g&&"clickSfx"in g?g.clickSfx??null:"ui_click";F&&((B=u==null?void 0:u.playSfx)==null||B.call(u,F,(g==null?void 0:g.clickVol)??.9)),m()}),A.setEnabled=F=>{A.eventMode=F?"static":"none",A.alpha=F?1:.5,A.cursor=F?"pointer":"default",F||(S.visible=!0,T.visible=!1,E.visible=!1)},A.resetVisual=()=>{S.visible=!0,T.visible=!1,E.visible=!1};const C=n?40:4,k=n?34:4,R=A.getLocalBounds();return A.hitArea=new oe(R.x-C,R.y-k,R.width+C*2,R.height+k*2),A.btnWidth=()=>S.width,A.btnHeight=()=>S.height,A}function Rc(a,h,d,m,g,A,S,T){const E=new st,C=new Se(jn(a)),k=new Se(jn(h)),R=new Se(jn(d)),F=new Se(jn(m)),O=new Se(jn(g)),B=new Se(jn(A)),N=[C,k,R,F,O,B];N.forEach(Q=>{Q.anchor.set(.5),E.addChild(Q)});const D=C.width,z=C.height;N.forEach(Q=>{Q.width=D,Q.height=z});let $=S;function rt(Q){N.forEach(vt=>vt.visible=!1);const X=$?F:C,q=$?O:k,ut=$?B:R;Q==="up"&&(X.visible=!0),Q==="hover"&&(q.visible=!0),Q==="down"&&(ut.visible=!0)}return rt("up"),E.eventMode="static",no(G)||Hd(G,E,"pointer"),E.on("pointerover",()=>rt("hover")),E.on("pointerout",()=>rt("up")),E.on("pointerdown",()=>rt("down")),E.on("pointerup",()=>rt("hover")),E.on("pointertap",()=>{var Q;$=!$,(Q=u==null?void 0:u.playSfx)==null||Q.call(u,"ui_toggle",.9),rt("hover"),T($)}),E.setOn=Q=>{$=Q,rt("up")},E.getOn=()=>$,E.setEnabled=Q=>{E.eventMode=Q?"static":"none",E.alpha=Q?1:.5,E.cursor=Q?"pointer":"default"},E.btnWidth=()=>C.width,E.btnHeight=()=>C.height,E.setTapHandler=Q=>{var X;(X=E.removeAllListeners)==null||X.call(E,"pointertap"),E.on("pointertap",q=>{var ut,vt;(ut=q==null?void 0:q.stopPropagation)==null||ut.call(q),(vt=u==null?void 0:u.playSfx)==null||vt.call(u,"ui_toggle",.9),Q(q)})},E}function A0(a,h,d,m){const g=a.children,A=g[0],S=g[1],T=g[2];A.texture=jn(h),S.texture=jn(d),T.texture=jn(m),A.visible=!0,S.visible=!1,T.visible=!1,a.btnWidth=()=>A.width,a.btnHeight=()=>A.height}function e1(a,h,d,m){const g=new st,A=new xt().roundRect(0,0,h,d,12).fill(1710618).stroke({width:10,color:6710886}),S=new yt({text:a,style:{fill:16777215,fontSize:18}});return S.anchor.set(.5),S.x=h/2,S.y=d/2,g.addChild(A,S),g.eventMode="static",no(G)||Hd(G,g,"pointer"),g.on("pointertap",m),g.on("pointerover",()=>{A.alpha=.9}),g.on("pointerout",()=>{A.alpha=1}),g.setEnabled=T=>{g.eventMode=T?"static":"none",g.alpha=T?1:.5,g.cursor=T?"pointer":"default"},g.setLabel=T=>{S.text=T},g}const n1="icon_info.png",Fc="btn_spin_up.png",Bc="btn_spin_hover.png",Nc="btn_spin_down.png",S0="btn_spin_spinning.png",s1="icon_sfx_on.png",i1="icon_sfx_off.png",r1="icon_music_on.png",o1="icon_music_off.png",a1="btn_settings_off_up.png",l1="btn_settings_off_up.png",c1="btn_settings_off_down.png",h1="btn_settings_on_up.png",u1="btn_settings_on_up.png",d1="btn_settings_on_down.png",f1="btn_auto_off_up.png",p1="btn_auto_hover.png",m1="btn_auto_down.png",_1="btn_auto_on_up.png",g1="btn_auto_on_up.png",y1="btn_auto_on_up.png",x1="btn_turbo_off_up.png",b1="btn_turbo_hover.png",A1="btn_turbo_down.png",S1="btn_turbo_on_up.png",w1="btn_turbo_on_up.png",M1="btn_turbo_on_up.png",w0="btn_bet_down_up.png",M0="btn_bet_down_hover.png",T0="btn_bet_down_down.png",v0="btn_bet_up_up.png",E0="btn_bet_up_hover.png",C0="btn_bet_up_down.png",I0="btn_settings_on_up.png",P0="btn_settings_on_up.png",O0="btn_settings_on_down.png",T1="btn_buy_up.png",v1="btn_buy_hover.png",E1="btn_buy_down.png",L0="/assets/atlases/bigwin_items.json",k0="/assets/atlases/ui.json",R0="/assets/atlases/ui_extra.json",F0="/assets/atlases/vehicles.json",B0="/assets/atlases/reelhouse.json",N0="/assets/atlases/symbols.json",U0="/assets/atlases/auto_menu_ui.json",il="/assets/particles/coins.json";let Kr=null;function W0(){if(Kr)return Kr;const a=_s.get(il),h=a==null?void 0:a.textures;if(!h)return console.warn("[COINS] Sheet not ready or missing textures:",il,a),Kr=[],Kr;const d=Object.keys(h).sort((m,g)=>{const A=parseInt(m,10),S=parseInt(g,10);return!Number.isNaN(A)&&!Number.isNaN(S)?A-S:m.localeCompare(g)});return Kr=d.map(m=>h[m]).filter(Boolean),Kr.length?console.log("[COINS] Frames:",Kr.length,"from",il):console.warn("[COINS] No frames found in sheet:",il,d),Kr}await _s.load([U0,Lr,As]),hn=_s.get(As)||null,await ir(),await _s.load([Ns,yi,Lr,As,k0,L0,il,R0,F0,B0,N0,Hi,xi],a=>Xs(.5+a*.5)),Pa=_s.get(k0),ii=_s.get(R0);const D0=_s.get(U0);for(const a of Object.values(D0.textures||{}))a.source.scaleMode="nearest";function Uc(a){var d;const h=(d=D0.textures)==null?void 0:d[a];if(!h)throw new Error(`[AUTO_MENU_UI] Missing frame: ${a}`);return h}Yi=_s.get(N0),console.log("[SYMBOLS] frames:",Object.keys(Yi.textures||{}));for(const a of Object.values(Yi.textures))a.source.scaleMode="nearest";function G0(a){var d;const h=(d=Yi.textures)==null?void 0:d[a];if(!h)throw new Error(`[SYMBOLS_ATLAS] Missing frame: ${a}`);return h}const $r=Object.fromEntries(Object.keys(Mh).map(a=>[a,G0(Mh[a])]));kr(),Gi(),Xi=_s.get(B0),console.log("[REELHOUSE] frames:",Object.keys(Xi.textures||{}));for(const a of Object.values(Xi.textures))a.source.scaleMode="nearest";function Du(a){var d;const h=(d=Xi.textures)==null?void 0:d[a];if(!h)throw new Error(`[REELHOUSE_ATLAS] Missing frame: ${a}`);return h}Vi=_s.get(F0),console.log("[VEHICLES] frames:",Object.keys(Vi.textures||{}));for(const a of Object.values(Vi.textures))a.source.scaleMode="nearest";function Wc(a){var d;const h=(d=Vi.textures)==null?void 0:d[a];if(!h)throw new Error(`[VEHICLES_ATLAS] Missing frame: ${a}`);return h}console.log("[UI_EXTRA] frames:",Object.keys(ii.textures||{}));for(const a of Object.values(ii.textures))a.source.scaleMode="nearest";function rl(a){var d;if(!(ii!=null&&ii.textures))return te.WHITE;const h=(d=ii.textures)==null?void 0:d[a];if(!h)throw new Error(`[UI_EXTRA_ATLAS] Missing frame: ${a}`);return h}We.texture=rl("game_title.png");for(const a of Object.values(Pa.textures))a.source.scaleMode="nearest";function jn(a){var d;const h=(d=Pa.textures)==null?void 0:d[a];if(!h)throw new Error(`[UI_ATLAS] Missing frame: ${a}`);return h}Ii=_s.get(L0);for(const a of Object.values(Ii.textures))a.source.scaleMode="nearest";function H0(a){var d;const h=(d=Ii.textures)==null?void 0:d[a];if(!h)throw new Error(`[BIGWIN_ITEMS] Missing frame: ${a}`);return h}W0();const ol=new xt;ol.zIndex=-999,ol.eventMode="none",ps.addChildAt(ol,0);const _r=new xt;_r.visible=!1,_r.alpha=.65,_r.eventMode="static",_r.cursor="default",ps.addChild(_r);const ht=na(Fc,Bc,Nc,()=>{var d,m,g;if(_.ui.auto){gr("spin button (stop auto)"),li();return}if(_.ui.autoArmed){const A=_.ui.autoPendingRounds??-1;_.ui.auto=!0,_.ui.autoRounds=A,_.ui.autoLeft=A===-1?0:A,_.ui.autoArmed=!1,_.ui.autoPendingRounds=-1,(d=dt==null?void 0:dt.setOn)==null||d.call(dt,!0),(m=se==null?void 0:se.close)==null||m.call(se),x0(!0),li(),Jr();return}const a=_.bank.betLevels[_.bank.betIndex];if(!(_.fs.remaining>0)&&_.bank.balance<a){(g=Te==null?void 0:Te.showInsufficientToast)==null||g.call(Te),y0();return}Jr()},{clickSfx:null}),Y0=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||((Pm=(Im=window.matchMedia)==null?void 0:Im.call(window,"(pointer: coarse)"))==null?void 0:Pm.matches),X0=Y0?40:6,V0=Y0?34:6,Dc=ht.getLocalBounds();ht.hitArea=new oe(Dc.x-X0,Dc.y-V0,Dc.width+X0*2,Dc.height+V0*2),ps.addChild(ht);const ks=new yt({text:"",style:{fontFamily:"pixeldown",fill:16777215,fontSize:60,align:"center",stroke:{color:0,width:8},dropShadow:!0,dropShadowAlpha:.85,dropShadowBlur:0,dropShadowDistance:6,dropShadowAngle:-Math.PI/4}});ks.anchor.set(.5),ks.roundPixels=!0,ks.eventMode="none",ks.visible=!1,ht.addChild(ks);const wi=new Se(te.from(xi));wi.anchor.set(.5),wi.roundPixels=!0,wi.eventMode="none",wi.visible=!1,ht.addChild(wi);function Gc(){let a=0,h=0;if(Hu==="STOP"){const A=Uc("btn_spinstop_auto.png"),S=I1(A);a=S.x,h=S.y+C1}ks.x=Math.round(a),ks.y=Math.round(h),wi.x=ks.x,wi.y=ks.y;const d=20,m=wi.texture.height||1,g=d/m;wi.scale.set(g)}const C1=-8;function I1(a){const h=a.orig,d=a.trim,m=a.frame;if(!h||!d||!m)return{x:0,y:0};const g=d.x+m.width*.5,A=d.y+m.height*.5;return{x:g-h.width*.5,y:A-h.height*.5}}const z0=jn(Fc),P1=z0.width||1,O1=z0.height||1;function Gu(a,h,d){const m=ht.children,g=m[0],A=m[1],S=m[2];g.texture=a,A.texture=h,S.texture=d;for(const k of[g,A,S])k.width=P1,k.height=O1;g.visible=!0,A.visible=!1,S.visible=!1,ht.btnWidth=()=>g.width,ht.btnHeight=()=>g.height;const T=ht.getLocalBounds(),E=n?40:6,C=n?34:6;ht.hitArea=new oe(T.x-E,T.y-C,T.width+E*2,T.height+C*2),Gc()}let Hu="NORMAL";function Yu(a){if(Hu!==a){if(Hu=a,a==="NORMAL"){Gu(jn(Fc),jn(Bc),jn(Nc)),ks.visible=!1;return}if(a==="PLAY"){const h=Uc("btn_spinplay_auto.png");Gu(h,h,h),ks.visible=!1;return}{const h=Uc("btn_spinstop_auto.png");Gu(h,h,h),ks.visible=!0,Gc()}}}function li(){const a=!!_.ui.auto,h=!!_.ui.autoArmed;if(a){Yu("STOP");const d=_.ui.autoRounds??-1,m=_.ui.autoLeft??0,g=d===-1;ks.visible=!g,wi.visible=g,g||(ks.text=String(Math.max(0,m))),Gc();return}if(h){Yu("PLAY"),ks.visible=!1,wi.visible=!1;return}Yu("NORMAL"),ks.visible=!1,wi.visible=!1}window.addEventListener("resize",()=>{Gc(),li()}),fn(()=>{ht.visible&&li()}),p();let K0=!1;function L1(a){K0!==a&&(K0=a,a?A0(ht,S0,Bc,Nc):A0(ht,Fc,Bc,Nc))}const as=new Se(jn(S0));as.anchor.set(.5),as.visible=!1,as.eventMode="none",ps.addChild(as),go();const Ne=Rc(a1,l1,c1,h1,u1,d1,!1,a=>{var d,m;_.ui.settingsOpen=a;const h=-2;Ne.x+=a?h:-h,_r.visible=_.ui.settingsOpen,_.ui.settingsOpen?(d=qn==null?void 0:qn.open)==null||d.call(qn):(m=qn==null?void 0:qn.close)==null||m.call(qn),ht.setEnabled(!_.ui.settingsOpen&&!_.ui.spinning),ht.visible=!_.ui.spinning,as.visible=_.ui.spinning,Tt.setEnabled(!_.ui.settingsOpen),dt.setEnabled(!_.ui.settingsOpen),je.setEnabled(!_.ui.settingsOpen),Qt.setEnabled(!_.ui.settingsOpen),Zt.setEnabled(!_.ui.settingsOpen),Ne.setEnabled(!0),_.ui.settingsOpen&&(_.ui.auto=!1,dt.setOn(!1))});ps.addChild(Ne),qn=fC({app:P,root:Y,state:_,t:Jt,uiDimmer:_r,settingsBtnPixi:Ne,onClosed:()=>{ht.setEnabled(!_.ui.spinning),Tt.setEnabled(!0),dt.setEnabled(!0),je.setEnabled(!0),Qt.setEnabled(!0),Zt.setEnabled(!0)},texUI:jn,setScaleToHeight:bn,makePngButton:na,ICON_INFO:n1,ICON_SFX_ON:s1,ICON_SFX_OFF:i1,ICON_MUSIC_ON:r1,ICON_MUSIC_OFF:o1,CLOSE_UP:I0,CLOSE_HOVER:P0,CLOSE_DOWN:O0,getSfxMuted:()=>{var a;return((a=u==null?void 0:u.getSfxMuted)==null?void 0:a.call(u))??!1},setSfxMuted:a=>{var h;return(h=u==null?void 0:u.setSfxMuted)==null?void 0:h.call(u,a)},getMusicMuted:()=>{var a;return((a=u==null?void 0:u.getMusicMuted)==null?void 0:a.call(u))??!1},setMusicMuted:a=>{var h;return(h=u==null?void 0:u.setMusicMuted)==null?void 0:h.call(u,a)},applyAudioUI:()=>{var a;(a=u==null?void 0:u.apply)==null||a.call(u)},makeSlider:t1,getSfxValue01:()=>{var a;return((a=u==null?void 0:u.getSfxVolume01)==null?void 0:a.call(u))??.8},getMusicValue01:()=>{var a;return((a=u==null?void 0:u.getMusicVolume01)==null?void 0:a.call(u))??.6},setSfxValue01:a=>{var h;return(h=u==null?void 0:u.setSfxVolume01)==null?void 0:h.call(u,a)},setMusicValue01:a=>{var h;return(h=u==null?void 0:u.setMusicVolume01)==null?void 0:h.call(u,a)}});const Tt=na(T1,v1,E1,()=>{var a;_.ui.spinning||(gr("buy button"),console.log("[BUY BTN] clicked"),_.ui.settingsOpen&&gr("settings opened"),(a=Te==null?void 0:Te.openBuy)==null||a.call(Te))}),$0=n?36:6,j0=n?30:6,Hc=Tt.getLocalBounds();Tt.hitArea=new oe(Hc.x-$0,Hc.y-j0,Hc.width+$0*2,Hc.height+j0*2),ps.addChild(Tt);const dt=Rc(f1,p1,m1,_1,g1,y1,_.ui.auto,a=>{var h;if(a){const d=_.bank.betLevels[_.bank.betIndex];if(!(_.fs.remaining>0)&&_.bank.balance<d){_.ui.auto=!1,dt.setOn(!1),(h=Te==null?void 0:Te.showInsufficientToast)==null||h.call(Te);return}}_.ui.auto=a,_.ui.auto&&!_.ui.spinning&&!_.overlay.fsIntro&&!_.overlay.fsOutro&&Jr()});ps.addChild(dt);function gr(a=""){var h,d,m;!_.ui.auto&&(_.ui.autoRounds??-1)===-1&&(_.ui.autoPendingRounds??-1)===-1||(console.log("[AUTO] stop",a),_.ui.auto=!1,_.ui.autoArmed=!1,_.ui.autoPendingRounds=-1,_.ui.autoRounds=-1,_.ui.autoLeft=0,(h=dt==null?void 0:dt.setOn)==null||h.call(dt,!1),(d=se==null?void 0:se.isOpen)!=null&&d.call(se)&&((m=se==null?void 0:se.close)==null||m.call(se)),li())}se=mC({app:P,root:Y,texAutoMenu:Uc,audio:u,initialSelectedRounds:-1,t:Jt,onPick:a=>{_.ui.autoPendingRounds=a,_.ui.autoArmed=!0,li()},onClosed:()=>{_.ui.auto||(_.ui.autoArmed=!1,_.ui.autoPendingRounds=-1),x0(!0),li()}}),(Om=dt.setTapHandler)==null||Om.call(dt,()=>{var a;if(!_.ui.spinning&&!(_.ui.settingsOpen||_.ui.buyMenuOpen)){if(_.ui.auto){gr("auto button");return}(a=se==null?void 0:se.open)==null||a.call(se)}});const je=Rc(x1,b1,A1,S1,w1,M1,_.ui.turbo,a=>{_.ui.turbo=a});ps.addChild(je),Qt=na(w0,M0,T0,()=>{var a;nl()||(gr("bet down"),_.bank.betIndex>0&&(_.bank.betIndex--,kc(),go(),_.ui.buyMenuOpen&&((a=Te==null?void 0:Te.layoutBuy)==null||a.call(Te))))}),Zt=na(v0,E0,C0,()=>{var a;nl()||(gr("bet up"),_.bank.betIndex<_.bank.betLevels.length-1&&(_.bank.betIndex++,kc(),go(),_.ui.buyMenuOpen&&((a=Te==null?void 0:Te.layoutBuy)==null||a.call(Te))))}),Sn.addChild(Zt,Qt),Te=pC({app:P,root:Y,uiLayer:xn,state:_,audio:u,texUI:jn,texExtra:rl,t:Jt,setScaleToHeight:bn,makePngButton:na,makePngToggleButton:Rc,fmtMoney:cs,updateBetUI:kc,refreshSpinAffordability:go,onBalanceUpdated:()=>{Os.text=cs(_.bank.balance)},spinBtnPixi:ht,spinningBtnPixi:as,settingsBtnPixi:Ne,buyBtnPixi:Tt,autoBtnPixi:dt,turboBtnPixi:je,betDownBtnPixi:Qt,betUpBtnPixi:Zt,enterFreeSpins:w,CLOSE_UP:I0,CLOSE_HOVER:P0,CLOSE_DOWN:O0,BET_DOWN_UP:w0,BET_DOWN_HOVER:M0,BET_DOWN_DOWN:T0,BET_UP_UP:v0,BET_UP_HOVER:E0,BET_UP_DOWN:C0,waitMs:ns,animateMs:ke,tween:ye,easeOutCubic:Hs,easeOutBack:ms,easeInCubic:pa});const q0=e1(`BET: ${_.bank.betLevels[_.bank.betIndex]}`,160,56,()=>{_.bank.betIndex=(_.bank.betIndex+1)%_.bank.betLevels.length,q0.setLabel(`BET: ${_.bank.betLevels[_.bank.betIndex]}`)});let Z0=0;function Q0(){return Js(G)?.72:1}function k1(){if(!Zt||!Qt||!$n||!Ls)return;He(G)?(Ls.parent!==Zs&&Zs.addChild(Ls),$n.parent!==Zs&&Zs.addChild($n),Zt.parent!==Zs&&Zs.addChild(Zt),Qt.parent!==Zs&&Zs.addChild(Qt),Zs.visible=!0,Bn.visible=!1,Sn.visible=!1):(Ls.parent!==Bn&&Bn.addChild(Ls),$n.parent!==Bn&&Bn.addChild($n),Zt.parent!==Sn&&Sn.addChild(Zt),Qt.parent!==Sn&&Sn.addChild(Qt),Zs.visible=!1,Bn.visible=!0,Sn.visible=!0)}function J0(){const a=P.screen.width,h=Math.round(P.screen.height*sg);Z0=h,ps.x=0;const d=Sl();ps.y=Math.round(P.screen.height-h-d),ol.clear(),ol.rect(0,0,a,h).fill({color:0,alpha:.38}).stroke({width:2,color:13092807,alpha:.35}),_r.clear(),_r.rect(0,0,a,h).fill(0),k1(),He(G)?F1(a,h):ln(G)?B1(a,h):R1(a,h),as.x=ht.x,as.y=ht.y,as.scale.set(ht.scale.x,ht.scale.y),as.pivot.set(ht.pivot.x,ht.pivot.y)}function al(a,h){const d=a.getLocalBounds();a.y=Math.round(h-d.y)}function R1(a,h){const m=ln(G)?.85:1,g=Math.round(h*0);An.visible=!0;const A=310,S=Cn.getBounds();An.x=Math.round(S.x+S.width+A),al(An,g),al(An,g),An.scale.set(1,1),Os.anchor.set(.5),ai.anchor.set(.5),Os.position.set(0,0),ai.position.set(0,-35),Os.roundPixels=!0,ai.roundPixels=!0,An.scale.set(1,1);const T=Math.max(1,An.getLocalBounds().height),C=h*.73/T;An.scale.set(C),Cn.visible=!0,Cn.scale.set(1,1);const k=Math.max(1,Cn.getLocalBounds().height),F=h*.73/k;Cn.scale.set(F);const O=a*.5;Cn.x=Math.round(O),al(Cn,g);const B=Math.round(h*.35);qs.position.set(0,-B),Gs.position.set(0,3),ta(ht,.86,.1,a,h),bn(ht,h*1.7*m),ta(dt,.78,.5,a,h),bn(dt,h*.78*m),ta(je,.935,.5,a,h),bn(je,h*.9*m),ta(Tt,.14,.23,a,h),bn(Tt,h*1.4*m),ta(Ne,.07,.54,a,h),bn(Ne,h*.4*m);const N=ln(G)?.24:.3;bn(Zt,h*N),bn(Qt,h*N),$n.scale.set(.85),Ls.position.set(0,Math.round(-$n.getLocalBounds().height*.85));const z=$n.getBounds().width,$=320;Bn.x=Math.round(S.x-$-Bn.getBounds().width/2),Bn.pivot.set(0,0),Sn.pivot.set(0,0),$n.position.set(0,0),Ls.anchor.set(.5),Ls.position.set(0,Math.round(-$n.getLocalBounds().height*.85));const rt=Math.round(h*.18);Zt.position.set(0,-rt),Qt.position.set(0,+rt);const Q=50,X=Bn.x-z*.5,q=Sn.getLocalBounds(),ut=q.x+q.width;Sn.x=Math.round(X-Q-ut),Sn.x+=30,al(Bn,g),al(Sn,g);const vt=10;Sn.y+=vt}function F1(a,h){var lt,ct;Cn.visible=!1,qs.visible=!1,Gs.visible=!1;const d=a,m=h,g=m*1.6,A=m*1.2,S=m*.72;ta(Cn,.5,.4,d,m),bn(Cn,m*.55);const T=Math.round(m*.3);qs.x=0,qs.y=-T,Gs.x=0,Gs.y=4;const E=-.7,C=-m*.12;ht.x=Math.round(d*.5),ht.y=Math.round(m*E+C),bn(ht,g);const k=.34,R=E;Tt.x=Math.round(d*.5-d*k),Tt.y=Math.round(m*R),bn(Tt,A);const F=.32,O=.33,B=Math.round(d*.5),N=Math.round(m*E);dt.x=Math.round(B+d*F),dt.y=Math.round(N-m*O),bn(dt,S),je.x=Math.round(B+d*F),je.y=Math.round(N+m*O),bn(je,S),Cn.visible=!1,qs.visible=!1,Gs.visible=!1,bn(Ne,S*.75),Ds(Ne);const D=Math.round(d*.04),z=Math.round(m*.1);{const nt=Ne.getLocalBounds();Ne.hitArea=new oe(nt.x-D,nt.y-z,nt.width+D*2,nt.height+z*2)}bn($n,m*.36),Ds($n);const $=-$n.height*.75,rt=-$n.width*.95,Q=$n.height*.3,X=-$n.height*.24;$n.position.set(0,0),Ls.anchor.set(.5),Ls.position.set(0,Math.round($)),bn(Zt,m*.32),bn(Qt,m*.32);const q=Math.round(d*.03),ut=Math.round(m*.12);function vt(nt){const Yt=nt.getLocalBounds();nt.hitArea=new oe(Yt.x-q,Yt.y-ut,Yt.width+q*2,Yt.height+ut*2)}vt(Zt),vt(Qt),Zt.position.set(Math.round(rt),Math.round(-Q+X)),Qt.position.set(Math.round(rt),Math.round(+Q+X)),Ds(Zs),Os.anchor.set(.5),ai.anchor.set(.5);const ee=-m*.09;Os.position.set(0,0),ai.position.set(0,-33),Ds(An);const jt=Math.round(m*.55),Kt=Math.round(d*.06),Lt=[Ne,Zs,An],et=Lt.map(nt=>nt.getLocalBounds().width).reduce((nt,Yt)=>nt+Yt,0)+Kt*(Lt.length-1);let _t=Math.round(d*.5-et/2);for(let nt=0;nt<Lt.length;nt++){const Yt=Lt[nt],me=Yt.getLocalBounds().width;Yt.x=Math.round(_t+me/2),Yt.y=jt,_t+=me+Kt}An.y=Math.round(An.y+ee),(lt=ht.resetVisual)==null||lt.call(ht),(ct=Tt.resetVisual)==null||ct.call(Tt)}function B1(a,h){const d=a,m=h;Ds(Tt),Ds(ht),Ds(Ne),Ds(dt),Ds(je),Ds(Bn),Ds(Sn),Ds(Cn),Ds(An);const g=m*2.4,A=m*2.4,S=m*1.5,T=m*.6;if(bn(Tt,g),bn(ht,A),bn(Ne,S*.6),bn(dt,S),bn(je,S),bn(Zt,T),bn(Qt,T),ln(G)){const Rs=n?14:4,Qi=n?14:4;_0(Zt,Rs,Qi),_0(Qt,Rs,Qi)}Cn.visible=!0,qs.visible=!0,Gs.visible=!0,An.visible=!0,Bn.visible=!0,Sn.visible=!0;const E=Math.round(m*.72),C=Math.round(m*-.2),F=m*.58*1.9,O=Math.round(m*-.3),B=18;Ne.x=Math.round(B+Ne.getLocalBounds().width*.5),Ne.y=E+O;const N=Math.round(Ne.x+Ne.width*.75+Tt.width*.5+12);Tt.x=N,Tt.y=E;const D=Math.round(Tt.x+Tt.width*.62+Sn.getLocalBounds().width*.5+16);Sn.x=D,Sn.y=E+C;const z=Math.round(m*.36),$=-10;Sn.y=E+C+$,Zt.x=0,Qt.x=0,Zt.y=-z,Qt.y=+z,$n.x=0,$n.y=0,Ls.anchor.set(.5);const rt=Math.round(F*.18);Ls.position.set(0,Math.round(-($n.getLocalBounds().height*.5+rt))),Bn.y=E+C,Bn.scale.set(1,1);const Q=Math.max(1,Bn.getLocalBounds().height);Bn.scale.set(F/Q);const X=Math.round(m*.01);Ls.y-=Math.round(X/Math.max(1e-4,Bn.scale.y)),qs.anchor.set(.5),Gs.anchor.set(.5);const q=qs.getLocalBounds(),ut=Gs.getLocalBounds(),vt=q.height+ut.height;qs.position.set(0,Math.round(-vt*.5+q.height*.5)),Gs.position.set(0,Math.round(+vt*.5-ut.height*.5)),Ds(Cn),Cn.scale.set(1,1);const ee=Math.max(1,Cn.getLocalBounds().height);Cn.scale.set(F/ee);const jt=Math.round(m*-.1);Gs.y+=Math.round(jt/Math.max(1e-4,Cn.scale.y)),Cn.x=Math.round(d*.5),Cn.y=E+C,ai.anchor.set(.5),Os.anchor.set(.5);const Kt=ai.getLocalBounds(),Lt=Os.getLocalBounds(),ce=Kt.height+Lt.height;ai.position.set(0,Math.round(-ce*.5+Kt.height*.5)),Os.position.set(0,Math.round(+ce*.5-Lt.height*.5)),Ds(An),An.scale.set(1,1);const et=Math.max(1,An.getLocalBounds().height);An.scale.set(F/et);const _t=Math.round(m*-.1);Os.y+=Math.round(_t/Math.max(1e-4,An.scale.y));const lt=Math.round(d*.5);Cn.x=lt;const ct=Math.round(m*2.8),nt=Rs=>Rs.getLocalBounds().width*(Rs.scale.x||1),Yt=nt(Bn),me=nt(Cn),Ze=nt(An);Bn.x=Math.round(lt-me*.5-ct-Yt*.5),An.x=Math.round(lt+me*.5+ct+Ze*.5),An.y=E+C;const ws=Math.round(m*.25);Sn.scale.set(1,1);const Ms=Sn.getLocalBounds().width*(Sn.scale.x||1);Sn.x=Math.round(Bn.x-Yt*.5-ws-Ms*.5);const ts=-5,Bt=-50,ne=Math.round(m*.6),Ts=ht.getLocalBounds().width,es=dt.getLocalBounds().width,Qs=je.getLocalBounds().width,Zi=Math.round(m*-1);ht.x=Math.round(d-ts-Ts*.5),ht.y=E+Zi,Tt.y=ht.y,as.x=ht.x,as.y=ht.y,as.scale.set(ht.scale.x,ht.scale.y);const ci=Math.round(ht.x-Ts*.5-Bt-Math.max(es,Qs)*.5),hi=E+Zi;dt.x=ci,dt.y=hi-ne,je.x=ci,je.y=hi+ne}const Yc={left:110,top:310,right:110,bottom:310};let jr=0,qr=0,yr=0,xr=0;const an=new Se(Du("reel_house.png"));an.anchor.set(.5),js.addChild(an);const De=new st;De.zIndex=4e3,De.visible=!1,De.alpha=0,De.eventMode="none",Y.addChild(De),Y.sortChildren();const Xc=new xt;De.addChild(Xc);const ll=new st;De.addChild(ll);const sa=new yt({text:Jt("ui.tumbleWin"),style:we({fontFamily:"Pixeldown",fill:16777215,fontSize:64,letterSpacing:1,stroke:{color:0,width:8},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.75,dropShadowBlur:0,dropShadowDistance:8,dropShadowAngle:-Math.PI/4})}),ia=new yt({text:"",style:we({fontFamily:"Pixeldown",fill:16765802,fontSize:64,letterSpacing:1,stroke:{color:0,width:8},dropShadow:!0,dropShadowColor:0,dropShadowAlpha:.75,dropShadowBlur:0,dropShadowDistance:8,dropShadowAngle:-Math.PI/4})});ll.addChild(sa,ia);const N1=28,U1=5,W1=.8,D1=.35,G1=.47;let br=0;function cl(){let a=W1;return He(G)&&(a=G1),ln(G)&&(a*=oC),a}function hl(){P.screen.width,P.screen.height;const a=(wl==null?void 0:wl())??0;Sl==null||Sl();const h=an.getBounds();De.x=Math.round(h.x+h.width*.5);const d=-60;let m=Math.round(h.y-d);m=Math.max(m,a+8),De.y=m,De.scale.set(cl()),sa.anchor.set(1,.5),ia.anchor.set(0,.5);const g=85;sa.x=-6/2+g,ia.x=6/2+g;const A=sa.getLocalBounds(),S=ia.getLocalBounds();sa.y=-(A.y+A.height*.5),ia.y=-(S.y+S.height*.5);const T=ll.getLocalBounds();ll.pivot.set(T.x+T.width*.5,T.y+T.height*.5),ll.position.set(0,0);const E=T.width,C=T.height,k=Math.round(E+N1*2),R=Math.round(C+U1*2);Xc.clear(),Xc.rect(-k/2,-R/2,k,R).fill({color:0,alpha:D1}).stroke({width:2,color:11579568,alpha:.35});const F=Xc.getBounds().height,O=h.y-d-F*.5;De.y=Math.min(De.y,Math.round(O))}window.addEventListener("resize",hl);function H1(a){sa.text=Jt("ui.tumbleWin"),ia.text=cs(a),hl()}let Vc=!1;async function Y1(a){br++;const h=br;if(H1(a),hl(),Vc&&De.visible){const m=cl();De.visible=!0,De.alpha=1,De.scale.set(m*1.05);return}Vc=!0;const d=cl();De.visible=!0,De.alpha=0,De.scale.set(d*.92),await ke(160,m=>{if(h!==br)return;const g=ms(m,1.12);De.alpha=m;const A=d*.92+(d*1.05-d*.92)*g;De.scale.set(A)}),h===br&&(De.alpha=1,De.scale.set(d*1.05))}async function X1(a=180){if(!Vc||!De.visible)return;br++;const h=br,d=De.alpha,m=De.scale.x;await ke(a,g=>{if(h!==br)return;const A=pa(g);De.alpha=d*(1-A);const S=cl()*.92,T=m+(S-m)*A;De.scale.set(T)}),h===br&&(De.visible=!1,De.alpha=0,De.scale.set(cl()),Vc=!1)}function tm(){br++,De.visible=!1,De.alpha=0}function Xu(a){an.texture=Du(a==="FREE_SPINS"?"reel_house_free.png":"reel_house.png")}const zc=0,Kc=0,em=0,nm=0,ls=new xt;ls.clear(),ls.rect(jr+zc,qr+Kc,yr-zc-em,xr-Kc-nm).fill(16777215),Y.addChild(ls),ls.zIndex=2055,Y.sortChildren(),Cu(),Jn.mask=ls,Ss.mask=ls;const Nn=new xt;Nn.zIndex=2050,Nn.visible=!1,Nn.alpha=0,Nn.eventMode="none";const Mi=new xt;Mi.zIndex=2065,Mi.visible=!0,Mi.alpha=0,Mi.eventMode="none",Mi.filters=[new Co({strength:6})],Y.addChild(Mi);function V1(){Mi.clear();const a=an.getBounds();if(!Number.isFinite(a.x)||!Number.isFinite(a.y)||a.width<=0||a.height<=0)return;const h=He(G),d=h?-17:-27,m=h?-90:-132,g=0,A=4,S=h?34:24,T=h?28:20,E=a.width+d,C=a.height+m,k=a.x+(a.width-E)/2+g,R=a.y+(a.height-C)/2+A;E<=0||C<=0||Mi.roundRect(k,R,E,C,S).stroke({width:T,color:16777215,alpha:1})}function z1(){return V1(),Mi.alpha=0,new Promise(a=>{ye(140,h=>{Mi.alpha=Math.min(1,h)*.9},()=>{ye(220,h=>{Mi.alpha=.9*(1-Math.min(1,h))},()=>{Mi.alpha=0,a()})})})}Y.addChild(Nn),Ss.zIndex=2060,Ss.sortableChildren=!0,Y.addChild(Ss),Y.sortChildren();const ra=new st;ra.zIndex=2070,ra.eventMode="none",ra.mask=null,Y.addChild(ra),Y.sortChildren();const Ar=new st;Ar.zIndex=2060,Ar.sortableChildren=!0,Ar.mask=ls,Y.addChild(Ar);const Vu=[];function K1(a){var h;sm();for(const d of a){const m=qe[d],g=m==null?void 0:m.sprite;if(!g||!g.parent||g.parent===Ar)continue;const A=g.parent,S=A.getChildIndex(g),T=g.zIndex??0,E=g.getGlobalPosition();A.removeChild(g),Ar.addChild(g),g.position.copyFrom(Ar.toLocal(E)),g.zIndex=500;const C=(h=m==null?void 0:m.eyes)==null?void 0:h.root;let k=null,R=null,F=-1,O=0;if(C&&C.parent){k=C,R=C.parent,F=R.getChildIndex(C),O=C.zIndex??0;const B=C.getGlobalPosition();R.removeChild(C),Ar.addChild(C),C.position.copyFrom(Ar.toLocal(B)),C.zIndex=g.zIndex+1}Vu.push({s:g,fromParent:A,fromIndex:S,fromZ:T,eyesRoot:k,eyesFromParent:R,eyesFromIndex:F,eyesFromZ:O})}}function sm(){for(const a of Vu){const{s:h,fromParent:d,fromIndex:m,fromZ:g,eyesRoot:A,eyesFromParent:S,eyesFromIndex:T,eyesFromZ:E}=a;if(h){const C=h.getGlobalPosition();h.parent&&h.parent.removeChild(h);const k=Math.min(m,d.children.length);d.addChildAt(h,k),h.position.copyFrom(d.toLocal(C)),h.zIndex=g}if(A&&S){const C=A.getGlobalPosition();A.parent&&A.parent.removeChild(A);const k=Math.min(T,S.children.length);S.addChildAt(A,k),A.position.copyFrom(S.toLocal(C)),A.zIndex=E}}Vu.length=0}const zu=[],$1=.65,im=160,j1=90,rm=He(G),om=rm?-22:Js(G)?-14:-37,am=rm?-78:Js(G)?-60:-102;wn=new yt({text:Re(Jt("ui.popup.boosted")),style:{fontFamily:Zn(Pe()),fill:16765802,fontSize:88,letterSpacing:2,align:"center",stroke:{color:0,width:12},dropShadow:!0,dropShadowAlpha:.85,dropShadowBlur:0,dropShadowDistance:10,dropShadowAngle:-Math.PI/4}}),wn.anchor.set(.5),wn.zIndex=22e3,wn.visible=!1,wn.alpha=0,Y.addChild(wn),Y.sortChildren();let oa=0;async function lm(a=160,h=420,d=220){var T;oa++;const m=oa,g=P.screen.width,A=P.screen.height;if(!wn||(wn.x=Math.round(g*.5),wn.y=Math.round(A*.45),(T=u==null?void 0:u.playSfxThrottled)==null||T.call(u,"boosted",120,1,1),wn.visible=!0,wn.alpha=0,wn.scale.set(.85),await ke(a,E=>{if(m!==oa)return;const C=ms(E,1.1);if(!wn)return;wn.alpha=E;const k=.85+(1.12-.85)*C;wn.scale.set(k)}),m!==oa))return;await ns(h);const S=wn.y;await ke(d,E=>{if(m!==oa)return;const C=Hs(E);wn&&(wn.alpha=1-C,wn.y=S-26*C)}),m===oa&&(wn.visible=!1,wn.alpha=0)}Mn=new yt({text:Re(Jt("ui.popup.infused")),style:{fontFamily:Zn(Pe()),fill:16765802,fontSize:88,letterSpacing:2,align:"center",stroke:{color:0,width:12},dropShadow:!0,dropShadowAlpha:.85,dropShadowBlur:0,dropShadowDistance:10,dropShadowAngle:-Math.PI/4}}),Mn.anchor.set(.5),Mn.zIndex=22e3,Mn.visible=!1,Mn.alpha=0,Y.addChild(Mn),Y.sortChildren();let aa=0;async function Ku(a=160,h=420,d=220){var T;aa++;const m=aa,g=P.screen.width,A=P.screen.height;if(!Mn||(Mn.x=Math.round(g*.5),Mn.y=Math.round(A*.45),(T=u==null?void 0:u.playSfxThrottled)==null||T.call(u,"infused",120,.85,1),Mn.visible=!0,Mn.alpha=0,Mn.scale.set(.85),await ke(a,E=>{if(m!==aa)return;const C=ms(E,1.1);if(!Mn)return;Mn.alpha=E;const k=.85+(1.12-.85)*C;Mn.scale.set(k)}),m!==aa))return;await ns(h);const S=Mn.y;await ke(d,E=>{if(m!==aa)return;const C=Hs(E);Mn&&(Mn.alpha=1-C,Mn.y=S-26*C)}),m===aa&&(Mn.visible=!1,Mn.alpha=0)}const $c=new st;$c.zIndex=2080,$c.eventMode="none",Y.addChild($c),Y.sortChildren();function cm(){if(Js(G)){Nn.clear(),Nn.visible=!1,Nn.alpha=0;return}Nn.clear();const a=an.getBounds();Nn.rect(a.x-om,a.y-am,a.width+om*2,a.height+am*2).fill(0)}function q1(a,h=5){const d=[];for(let g=0;g<U;g++)g!==a&&d.push(g);for(let g=d.length-1;g>0;g--){const A=Math.random()*(g+1)|0,S=d[g];d[g]=d[A],d[A]=S}const m=d.slice(0,Math.max(2,Math.min(h,d.length)));return m.push(a),m}async function Z1(a,h,d){var F;const{cx:m,cy:g}=Jc(h),A=a.x,S=a.y,T=m,E=g,C=d.ms,k=d.arc,R=d.baseS;(F=u==null?void 0:u.playSfxThrottled)==null||F.call(u,"bounce",70,1,.98+Math.random()*.06),await ke(C,O=>{const B=Hs(O);a.x=A+(T-A)*B,a.y=S+(E-S)*B;const N=Math.sin(Math.PI*B);a.y-=N*k;const D=R*(1+.16*N),z=R*(1-.12*N);a.scale.set(D,z)}),a.x=Math.round(T),a.y=Math.round(E),a.scale.set(R,R)}async function Q1(a){ha(a.grid);const h=a.aftershockWildIndex??-1;if(h<0)return;await Zr(!0);const d=new Se($r.W1);d.anchor.set(.5),d.eventMode="none",d.roundPixels=!0,bt(d,"W1");const m=d.scale.x*1.18;d.scale.set(m);const g=fS();d.x=Math.round(g.cx),d.y=Math.round(g.cy),$c.addChild(d);const A=q1(h,4+(Math.random()*3|0));await ns(120);for(let S=0;S<A.length;S++){const T=S===A.length-1;await Z1(d,A[S],{ms:T?300:200,arc:T?86:42,baseS:m}),T||await ns(40)}ha(a.nextGrid),d.removeFromParent(),d.destroy(),await ns(120),await Zr(!1)}async function Zr(a){if(Js(G)){Nn.clear(),Nn.visible=!1,Nn.alpha=0;return}if(a){cm(),Nn.visible=!0;const h=Nn.alpha;await ke(sn(im),d=>{const m=Hs(d);Nn.alpha=h+($1-h)*m})}else{if(!Nn.visible)return;const h=Nn.alpha;await ke(sn(im),d=>{const m=Hs(d);Nn.alpha=h*(1-m)}),Nn.alpha=0,Nn.visible=!1}}p();const J1=6,la=[],tS=()=>rl("win_frame.png");function eS(){if(!la.length)for(let a=0;a<U;a++){const h=new Se(tS());h.anchor.set(.5),h.visible=!1;const d=L-J1*2,m=d/h.texture.width,g=d/h.texture.height,A=Math.min(m,g);h.scale.set(A),h.zIndex=9999,Ss.addChild(h),la.push({s:h})}}function hm(){for(const a of la)a.s.visible=!1,a.s.alpha=1}async function nS(a=80){const h=la.filter(m=>m.s.visible&&m.s.alpha>0);if(!h.length){hm();return}const d=h.map(m=>m.s.alpha);await ke(a,m=>{const g=Hs(m);for(let A=0;A<h.length;A++)h[A].s.alpha=d[A]*(1-g)});for(const m of h)m.s.alpha=0,m.s.visible=!1}const Qr=new st;Qr.zIndex=2e4,Qr.sortableChildren=!0,Qr.eventMode="none",Qr.eventMode="none",Qr.mask=null,Y.addChild(Qr),Y.sortChildren();let $u=[];function um(){for(const a of $u)a.destroy({children:!0});$u=[]}function sS(a,h){var E;let d=1/0,m=1/0,g=-1/0,A=-1/0;for(const C of a.positions){const k=(E=qe[C])==null?void 0:E.sprite;if(!k)continue;const R=k.getBounds();d=Math.min(d,R.x),m=Math.min(m,R.y),g=Math.max(g,R.x+R.width),A=Math.max(A,R.y+R.height)}if(!isFinite(d))return null;const S=h.toLocal({x:d,y:m}),T=h.toLocal({x:g,y:A});return{x:S.x,y:S.y,w:T.x-S.x,h:T.y-S.y}}function iS(a,h){const d=new st,m=new yt({text:"0.00",style:{fontFamily:"pixeldown",fill:16777215,fontSize:55,fontWeight:"1",stroke:{color:0,width:6},dropShadow:!0,dropShadowAlpha:.35,dropShadowBlur:6,dropShadowDistance:2}}),g=new yt({text:"x",style:{fontFamily:"pixeldown",fill:16777215,fontSize:44,fontWeight:"1",stroke:{color:0,width:5}}}),A=new yt({text:String(h),style:{fontFamily:"pixeldown",fill:16777215,fontSize:55,fontWeight:"1",stroke:{color:0,width:6},dropShadow:!0,dropShadowAlpha:.35,dropShadowBlur:6,dropShadowDistance:2}});m.anchor.set(1,.5),g.anchor.set(.5),A.anchor.set(0,.5);const S=Math.abs(h-1)>1e-6;g.visible=S,A.visible=S;const T=6,E=6;S?(m.anchor.set(1,.5),g.anchor.set(.5,.5),A.anchor.set(0,.5),g.x=0,m.x=-g.width/2-T,A.x=g.width/2+E):(m.anchor.set(.5,.5),m.x=0),m.y=0,g.y=2,A.y=0,m.y=0,g.y=2,A.y=0,m.skew.set(0,.39),g.skew.set(0,.39),A.skew.set(0,.39),m.scale.x=.98,A.scale.x=.98,d.addChild(m,g,A);const C=performance.now(),R=Math.min(1100,500+a*18);let F=!1;function O(B){var Q,X,q;const N=Math.min(1,(B-C)/R),D=N*N*(3-2*N),z=a*D;m.text=z.toFixed(2),F||(F=!0,(Q=u==null?void 0:u.startTickHighLoop)==null||Q.call(u,40,.4,1));const $=1+.55*Math.pow(N,1.25),rt=.3+.35*Math.pow(N,1.1);(X=u==null?void 0:u.setTickHighParams)==null||X.call(u,rt,$),N<1?requestAnimationFrame(O):(q=u==null?void 0:u.stopTickHighLoop)==null||q.call(u,60)}return requestAnimationFrame(O),d}async function rS(a,h,d,m=520){if(um(),!a||a.length===0)return;const g=a.map((A,S)=>{const T=sS(A,Qr);if(!T)return Promise.resolve();const E=A.payoutX*d,C=iS(E,h),k=T.x+T.w*.5,R=T.y+120;C.position.set(k,R);const F=1.5,O=Q0();C.scale.set(F*O),C.alpha=0,Qr.addChild(C),$u.push(C);const B=S*60;return new Promise(N=>{setTimeout(()=>{ye(140,D=>{const z=Math.max(0,Math.min(1,D));C.alpha=z;const $=Q0(),rt=(1.1+(1.5-1.1)*z)*$;C.scale.set(rt)},async()=>{await ns(m);const D=C.y;ye(220,z=>{const $=Math.max(0,Math.min(1,z));C.alpha=1-$,C.y=D-18*$},()=>{C.destroy({children:!0}),N()})},D=>ms(D,1.18))},B)})});await Promise.all(g)}const oS=50,dm=1.14,aS=90,fm=oS,lS=80,ju=Array(U).fill(null);function pm(a){const h=new Set;for(const m of a)for(const g of m.positions)h.add(g);const d=Array.from(h);return d.sort((m,g)=>{const A=m%v,S=Math.floor(m/v),T=g%v,E=Math.floor(g/v);return A!==T?A-T:S-E}),d}function mm(a,h){const d=qe[a];if(!d)return;if(!h){const g=ju[a];g&&(g.visible=!1,g.alpha=0);return}let m=ju[a];m||(m=new Se(d.sprite.texture),m.anchor.set(.5),m.zIndex=50,m.filters=[new Co({strength:15})],m.alpha=0,m.visible=!1,Jn.addChild(m),ju[a]=m),m.texture=d.sprite.texture,m.x=d.sprite.x,m.y=d.sprite.y,m.scale.set(d.sprite.scale.x*1.18,d.sprite.scale.y*1.18),m.visible=!0,m.alpha=.55}async function cS(a){const h=qe[a];if(!h)return;const d=h.sprite;mm(a,!0);const m=d.scale.x,g=d.scale.y;await TS(d,sn(aS),m,g,m*dm,g*dm)}async function hS(a){const d=pm(a).map((m,g)=>th(fm*g).then(()=>cS(m)));await Promise.all(d)}const uS=new Set(["W1","S1"]);async function dS(a,h){if(eS(),hm(),!a||a.length===0)return;const m=pm(a).filter(T=>!uS.has(h[T].id)),{x:g,y:A}=gm(),S=m.map((T,E)=>th(fm*E).then(()=>{const{x:C,y:k}=tg(T,v),R=g+C*(L+W),F=A+k*(L+W),O=la[T];O.s.x=R+L/2,O.s.y=F+L/2,O.s.visible=!0,O.s.alpha=0,ke(sn(lS),B=>{O.s.alpha=Math.min(1,B)})}));await Promise.all(S)}function fS(){return{ox:jr,oy:qr,totalW:yr,totalH:xr,cx:jr+yr/2,cy:qr+xr/2}}const pS=P.screen.height-Z0;an.y=Math.min(an.y,pS/2),Xt=new Se(te.from(Ns)),Xt.anchor.set(.5),Xt.alpha=.9,Vt=new Se(te.from(yi)),Vt.anchor.set(.5),Vt.alpha=.9,M.addChild(Xt),M.addChild(Vt);let yo=0,xo=0,jc=0,ca=0;const mS=10,_S=18,gS=.12;P.stage.eventMode="static",P.stage.hitArea=P.screen,P.stage.on("pointermove",a=>{if(Js(G))return;jc=(a.global.y/P.screen.height-.5)*2,jc=Math.max(-1,Math.min(1,jc))}),fn(()=>{if(!_.overlay.startup&&!_.overlay.splash){if(Js(G)){if(ca=0,!Xt||!Vt)return;Xt.y=yo,Vt.y=xo;return}ca+=(jc-ca)*gS,!(!Xt||!Vt)&&(Xt.y=yo+ca*mS,Vt.y=xo+ca*_S)}}),fn(a=>{if(!We.visible||Cc)return;Fu+=a;const h=Fu,d=Math.sin(h*Math.PI*2*Bu)*$A,m=Math.cos(h*Math.PI*2*(Bu*.9))*jA;We.x=ku+m*_o,We.y=Ru+d*_o,We.rotation=Math.sin(h*Math.PI*2*(Bu*.7))*qA*_o});function qu(){var D,z,$,rt,Q;const a=P.screen.width,h=P.screen.height,d=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)||((z=(D=window.matchMedia)==null?void 0:D.call(window,"(pointer: coarse)"))==null?void 0:z.matches),m=P.screen.width>P.screen.height,g=document.getElementById("rotate-blocker-dom");if(d&&m){Ft.visible=!0,ve();const X=document.getElementById("rotate-blocker-text");X&&(X.textContent=Jt("ui.rotateBackPortrait")),g&&(g.style.display="flex"),M.visible=!1,Mt.visible=!1,xn.visible=!1,Y.sortChildren();return}Ft.visible=!1,g&&(g.style.display="none"),M.visible=!0,Mt.visible=!0,xn.visible=!0,requestAnimationFrame(()=>{var X,q,ut;J0(),(X=se==null?void 0:se.layout)==null||X.call(se),(q=qn==null?void 0:qn.layout)==null||q.call(qn),(ut=Te==null?void 0:Te.layoutBuy)==null||ut.call(Te)}),Mt.visible=!0,xn.visible=!0,Mt.alpha=1,Mt.eventMode="auto",xn.alpha=1,xn.eventMode="auto",qc(),bc(),$p(),t0(),dc(),Kp();const A=a/2,S=h/2,T=He(G),E=Math.round(h*.055);an.x=A,an.y=T?Math.round(S-E):S;const C=Js(G);if(!C){L=Z();const X=v*L+(v-1)*K,q=I*L+(I-1)*K,ut=60,vt=60,ee=X+ut,jt=q+vt,Kt=an.texture.width||1,Lt=an.texture.height||1,ce=Math.max(ee/Kt,jt/Lt);an.scale.set(ce)}if(C){const q=Math.max(1,a-28),ut=an.texture.width||1,vt=q/ut,ee=He(G)?1.08:1,jt=ln(G)?rC:1;an.scale.set(vt*ee*jt)}const k=an.scale.x,R=an.scale.y,F=an.x-an.width/2+Yc.left*k,O=an.y-an.height/2+Yc.top*R,B=an.x+an.width/2-Yc.right*k,N=an.y+an.height/2-Yc.bottom*R;if(jr=Math.round(F),qr=Math.round(O),yr=Math.round(B-F),xr=Math.round(N-O),C&&C){const X=(yr-(v-1)*W)/v,q=(xr-(I-1)*W)/I;L=Math.floor(Math.min(X,q))}ls.clear(),ls.rect(jr+zc,qr+Kc,yr-zc-em,xr-Kc-nm).fill(16777215),cm(),hl(),Ja(),J0(),($=se==null?void 0:se.layout)==null||$.call(se),(rt=qn==null?void 0:qn.layout)==null||rt.call(qn),(Q=Te==null?void 0:Te.layoutBuy)==null||Q.call(Te),mn(),hl(),Ja(),Cu(),Kh==null||Kh(),Cu()}qu(),Y.sortChildren(),p(),requestAnimationFrame(()=>{(async()=>{try{Xs(1);const a=0;await new Promise(h=>setTimeout(h,a)),Zu(),Zc(1,0),await On()}catch(a){console.error("[BOOT] failed after loading:",a),Pt.text="BOOT ERROR"}})()});function qc(){if(!Xt||!Vt||_.overlay.splash)return;const a=P.screen.width/2,h=P.screen.height/2,d=[Xt,Vt];for(const m of d){m.x=a,m.y=h,yo=Xt.y,xo=Vt.y;const g=m.texture.width,A=m.texture.height,S=Math.max(P.screen.width/g,P.screen.height/A);m.scale.set(S)}}function yS(){Ic++,ca=0,Zc(1,0),!(!Xt||!Vt)&&(Xt.visible=!0,Vt.visible=!1,Xt.alpha=.9,Vt.alpha=0,dl="BASE",yo=Xt.y,xo=Vt.y)}function Zc(a,h=0){const d=P.screen.height;function m(g){const A=g.height*.5,S=d-g.height*.5;return Math.round(A+(S-A)*a+h)}!Xt||!Vt||(Xt.y=m(Xt),Vt.y=m(Vt),yo=Xt.y,xo=Vt.y)}qc();function Zu(){!Xt||!Vt||(Xt.y=Math.round(Xt.height*.5),Vt.y=Math.round(Vt.height*.5),yo=Xt.y,xo=Vt.y)}lo(),hr=!1,Fn=0;const _m=2e3,Qu=10;function xS(){_.overlay.startup=!0,hr=!1,lo(),Fn=0,Mt.alpha=0,Mt.scale.set(1),Mt.eventMode="none",tl(0,0),qc();const a=P.screen.height;if(!Xt||!Vt)return;const h=Math.round(a-Xt.height*.5),d=Math.round(a-Vt.height*.5),m=0;if(!Xt||!Vt)return;Xt.y=h+m,Vt.y=d+m,setTimeout(()=>{ye(_m,A=>{const S=A*A*(3-2*A);!Xt||!Vt||(Xt.y=h+(yo-h)*S,Vt.y=d+(xo-d)*S)},()=>{var A;_.overlay.startup=!1,m0(Qu,420,.92),tl(1,320),(A=u==null?void 0:u.playMusic)==null||A.call(u,"music_base",600),xh(G)||(ur=999,Zh(!0)),setTimeout(()=>{hr=!0},150),setTimeout(()=>{},Qu+0)})},40)}window.addEventListener("resize",qc);function Qc(a){const h=qe[a];if(!h)return;const d=h.sprite,m=h.eyes;if(!m)return;m.root.position.set(d.x,d.y),m.root.rotation=d.rotation,m.root.alpha=d.alpha,m.root.visible=m.active;let g=d.scale.x,A=d.scale.y;const S=d.__sid??m.lastId??null,T=td[S];T?(g*=T.scaleX??1,A*=T.scaleY??1):m.root.skew.set(0,0),m.root.scale.set(g,A)}function gm(){const a=v*L+(v-1)*W,h=I*L+(I-1)*W,d=Math.round(jr+(yr-a)/2),m=Math.round(qr+(xr-h)/2);return{x:d,y:m}}function Jc(a){const{x:h,y:d}=tg(a,v),{x:m,y:g}=gm();return{cx:m+h*(L+W)+L/2,cy:g+d*(L+W)+L/2}}function Ju(a,h){return h+(a==="S1"?it:0)}const ym={H1:{min:.1,max:.6},H2:{min:.3,max:1.1},H3:{min:.3,max:1.1},H4:{min:.3,max:1.1},H5:{min:.3,max:1.1}},bS={min:.9,max:2.8};function xm(a,h){const d=h&&ym[h]?ym[h]:bS;a.nextBlink=d.min+Math.random()*(d.max-d.min)}let qe=[];fn(a=>{a=Math.min(.05,a);for(let h=0;h<qe.length;h++){const d=qe[h].eyes;if(!(!d||!d.active||!d.root.visible)&&d.eyeG.length){if(d.nextBlink-=a,!d.blinking&&d.nextBlink<=0){d.blinking=!0,d.blinkT=0;const m=qe[h].sprite.__sid??d.lastId??null;xm(d,m)}if(d.blinking){d.blinkT+=a;const g=Math.min(1,d.blinkT/.12),A=g<.5?1-g/.5:(g-.5)/.5,S=Math.max(0,Math.min(1,A));for(const T of d.eyeG)T.scale.y=S;if(g>=1){d.blinking=!1;for(const T of d.eyeG)T.scale.y=1}}}}});const td={H1:{eyes:[{xN:.2,yN:.1}],wN:.1,hN:.13,skewX:0,skewY:-.35,scaleX:.48,scaleY:.5},H2:{eyes:[{xN:.03,yN:.39},{xN:.2,yN:.39}],wN:.1,hN:.14,skewY:.37,scaleX:.5,scaleY:.4},H3:{eyes:[{xN:.01,yN:.7},{xN:.18,yN:.7}],wN:.1,hN:.14,skewY:.42,scaleX:.5,scaleY:.4},H4:{eyes:[{xN:0,yN:.24},{xN:.2,yN:.25}],wN:.1,hN:.14,skewY:.47,scaleX:.35,scaleY:.35},H5:{eyes:[{xN:0,yN:.38},{xN:.2,yN:.38}],wN:.1,hN:.14,skewY:.47,scaleX:.35,scaleY:.35}};function AS(){if(!qe.length)for(let a=0;a<U;a++){const h=new Se($r.L1);h.zIndex=100,h.anchor.set(.5),Jn.addChild(h);const d=new st;d.eventMode="none",d.visible=!1,d.zIndex=101,Jn.addChild(d);const m={root:d,eyeG:[],nextBlink:.6+Math.random()*2.2,blinkT:0,blinking:!1,active:!1,lastId:null};qe.push({sprite:h,eyes:m})}}fn(()=>{if(qe.length)for(let a=0;a<qe.length;a++){const h=qe[a],d=h.eyes;if(!d)continue;const m=h.sprite,g=m.__sid??d.lastId,A=g?td[g]:void 0;d.active=!!A,d.root.visible=!!A&&m.visible,d.root.position.set(m.x,m.y),d.root.rotation=m.rotation,d.root.alpha=m.alpha;let S=m.scale.x,T=m.scale.y;A?(S*=A.scaleX??1,T*=A.scaleY??1,d.root.skew.set(A.skewX??0,A.skewY??0)):d.root.skew.set(0,0),d.root.scale.set(S,T)}});function SS(a,h,d,m){a.clear(),a.rect(-h/2,-d/2,h,d).fill({color:m,alpha:1}),a.roundPixels=!0}function wS(a){for(let h=0;h<U;h++)ul(h,a[h].id)}function ul(a,h){const d=qe[a];if(!d)return;const m=td[h],g=d.eyes;if(!m){g.root.visible=!1,g.active=!1;return}if(g.lastId!==h||!g.eyeG.length||g.root.children.length===0){g.root.removeChildren(),g.eyeG.length=0;const S=m.color??0,T=d.sprite.texture.width||1,E=d.sprite.texture.height||1,C=Math.max(1,Math.round(T*m.wN)),k=Math.max(1,Math.round(E*m.hN));for(const R of m.eyes){const F=new xt;SS(F,C,k,S),F.x=Math.round((R.xN-.5)*T),F.y=Math.round((R.yN-.5)*E),g.root.addChild(F),g.eyeG.push(F)}g.blinking=!1,g.blinkT=0,xm(g,h),g.lastId=h}g.root.visible=!0,g.active=!0;for(const S of g.eyeG)S.scale.y=1;g.root.visible=!0,g.active=!0;for(const S of g.eyeG)S.scale.y=1}function ed(a){AS();for(let h=0;h<U;h++){const d=qe[h].sprite,m=a[h].id;d.__sid=m,d.texture=$r[m],bt(d,m);const{cx:g,cy:A}=Jc(h);d.x=g,d.y=Ju(m,A),d.alpha=1;const S=qe[h].eyes;S.root.position.set(d.x,d.y),S.root.rotation=d.rotation,ul(h,m),Qc(h)}}function MS(a,h){qe[a]}const{waitT:th,durT:sn}=_C(()=>!!_.ui.turbo);function TS(a,h,d,m,g,A){return ke(h,S=>{const T=Hs(S),E=d+(g-d)*T,C=m+(A-m)*T;a.scale.set(E,C)})}async function bm(a,h,d=450,m=.9){a.visible=!0,h.visible=!0,a.alpha=m,h.alpha=0,await ke(d,g=>{const A=Hs(g);a.alpha=m*(1-A),h.alpha=m*A}),a.visible=!1,a.alpha=0,h.visible=!0,h.alpha=m}let nd=0;function Am(a=250){nd++;const h=nd;setTimeout(()=>{h===nd&&_.game.mode==="FREE_SPINS"&&(_.fs.remaining<=0||_.overlay.splash||_.overlay.startup||_.overlay.fsIntro||_.overlay.fsOutro||_.overlay.fsOutroPending||_.overlay.bigWin||_.ui.settingsOpen||_.ui.buyMenuOpen||_.ui.spinning||Jr())},a)}async function Jr(){var S,T,E,C,k,R,F,O,B,N;if(_.overlay.splash||_.overlay.startup||_.overlay.fsIntro||_.overlay.fsOutro||typeof _.ui.settingsOpen<"u"&&_.ui.settingsOpen||typeof _.ui.buyMenuOpen<"u"&&_.ui.buyMenuOpen||_.overlay.fsIntro||_.overlay.fsOutro||_.ui.settingsOpen||_.ui.spinning)return;_.ui.spinning=!0,sl(),(S=u==null?void 0:u.playSfx)==null||S.call(u,"spin_start",1),sl(),_.ui.auto?(as.visible=!1,ht.visible=!0,ht.eventMode="static",ht.cursor="pointer",ht.alpha=1):(ht.visible=!1,as.visible=!0,ht.setEnabled(!1)),Qt.setEnabled(!1),Zt.setEnabled(!1),(T=Tt==null?void 0:Tt.setEnabled)==null||T.call(Tt,!1),(E=dt==null?void 0:dt.setEnabled)==null||E.call(dt,!1);const a=_.bank.betLevels[_.bank.betIndex],h=_.game.mode==="FREE_SPINS"||_.fs.remaining>0?"FREE_SPINS":"BASE",d=h==="BASE"?a:0;if(d>0&&_.bank.balance<d){Te.showInsufficientToast(),_.ui.spinning=!1,as.visible=!1,ht.visible=!0,ht.setEnabled(!_.ui.settingsOpen&&!_.ui.buyMenuOpen),li(),ht.setEnabled(!0),Qt.setEnabled(!0),Zt.setEnabled(!0);const D=!_.ui.settingsOpen&&!_.ui.buyMenuOpen&&!(((C=se==null?void 0:se.isOpen)==null?void 0:C.call(se))??!1);(k=Tt==null?void 0:Tt.setEnabled)==null||k.call(Tt,D),(R=dt==null?void 0:dt.setEnabled)==null||R.call(dt,D);return}if(d>0&&_.bank.balance<d){_.ui.auto=!1,(F=dt==null?void 0:dt.setOn)==null||F.call(dt,!1),_.ui.spinning=!1,as.visible=!1,ht.visible=!0,ht.setEnabled(!0),Qt.setEnabled(!0),Zt.setEnabled(!0);return}d>0&&(_.bank.balance=Math.max(0,_.bank.balance-d),Os.text=cs(_.bank.balance),go());let m=null;h==="BASE"&&dn>0&&(m=(async()=>{await HA(),await u0()})()),await ES(),m&&await m;let g=!1,A=null;try{await bo(h,!0);const D=dC({COLS:v,ROWS:I,fsTotalCap:_.fs.totalCap});A=iC(D,h,_.fs.remaining,_.fs.ladderIndex,void 0),_.fs.ladderIndex=A.ladderIndexAfter,_.fs.remaining=A.fsRemainingAfter,xe(),h==="FREE_SPINS"&&A.fsAwarded>0&&(_.fs.total=Math.min(_.fs.totalCap,_.fs.total+A.fsAwarded)),await kS(A),(O=u==null?void 0:u.setBaseMusicIntensity)==null||O.call(u,.15,300);const z=A.totalWinX*a;h==="FREE_SPINS"&&(_.fs.sessionTotalWin+=z),z>0?g0(_.bank.lastWin+z):g0(0);const $=A.totalWinX;$>=fp&&await zp(z,$),_.bank.balance+=z,Os.text=cs(_.bank.balance),h==="BASE"&&A.fsAwarded>0&&(w(A.fsAwarded),g=!0)}finally{if(_.ui.spinning=!1,as.visible=!1,ht.visible=!0,as.visible=!1,ht.visible=!0,sl(),(B=Tt==null?void 0:Tt.resetVisual)==null||B.call(Tt),q0.setEnabled(!0),g)return;if(_.game.mode==="FREE_SPINS"&&_.fs.remaining===0){if(_.overlay.fsOutroPending=!0,vb(350),Xu("FREE_SPINS"),Ua=!0,bo("FREE_SPINS",!1),!Xt||!Vt)return;Xt.visible=!1,Xt.alpha=0,Vt.visible=!0,Vt.alpha=.9,dl="FREE_SPINS",Ae&&(Ae.s.removeFromParent(),Ae=null),Ie&&(Ie.s.removeFromParent(),Ie=null),Uo();const D=_.fs.sessionTotalWin;_.fs.sessionTotalWin=0,(async()=>(await Zr(!0),await ns(mA),_.overlay.fsOutroPending=!1,_.game.mode="BASE",ru(!0,D,520),Vh()))();return}if(_.fs.remaining>0)Am(250);else if(_.ui.auto){if(_.ui.settingsOpen||_.ui.buyMenuOpen||(N=se==null?void 0:se.isOpen)!=null&&N.call(se)){gr("ui opened during auto");return}if((_.ui.autoRounds??-1)!==-1&&(_.ui.autoLeft=Math.max(0,(_.ui.autoLeft??0)-1),li(),_.ui.autoLeft<=0)){gr("auto rounds finished");return}setTimeout(()=>{Jr()},250)}}}const eh=new yt({text:"MODE: BASE",style:{fill:16777215,fontSize:16}}),sd=new yt({text:"MULT: x1",style:{fill:16777215,fontSize:16}}),nh=new yt({text:"WIN: 0",style:{fill:16777215,fontSize:16}}),id=new yt({text:"FS: 0",style:{fill:16777215,fontSize:16}});[eh,sd,nh,id].forEach(a=>{a.visible=ft,a.alpha=0}),eh.visible=!1,sd.visible=!1,nh.visible=!1,id.visible=!1;function rd(a){let h=0;for(let d=0;d<a.length;d++)a[d].id==="S1"&&h++;return h}async function vS(a,h,d,m){var ee,jt,Kt,Lt,ce,et;for(const _t of h)mm(_t,!1);let g=0,A=0,S=0;for(const _t of h){const lt=(ee=qe[_t])==null?void 0:ee.sprite;if(!lt)continue;const ct=lt.getGlobalPosition();g+=ct.x,A+=ct.y,S++}S>0&&(g/=S,A/=S);{const nt=Math.min(1.45,1+m*.07);(jt=u==null?void 0:u.playSfxThrottled)==null||jt.call(u,"explode",80,1.2,nt)}await Promise.all(h.map(_t=>{var es;const lt=qe[_t];if(!lt)return Promise.resolve();const ct=(es=a[_t])==null?void 0:es.id,nt=BA[ct]??16777215;let Yt,me=.7;ct==="L1"&&(Yt=6274906,me=.9),ct==="L2"&&(Yt=6274906,me=.9),ct==="L3"&&(Yt=NA,me=.5),ct==="L4"&&(Yt=6274906,me=.8);const Ze=lt.sprite.getGlobalPosition(),ws=Y.toLocal(Ze),Ms=Pi.toLocal(ws),ts={x:Ze.x-g,y:Ze.y-A};if(Zp(Ms.x,Ms.y,nt,ts,Yt,me),!lt)return Promise.resolve();const Bt=lt.sprite.alpha,ne=lt.sprite.scale.x,Ts=lt.sprite.scale.y;return ke(sn(160),Qs=>{const Zi=Hs(Qs);lt.sprite.alpha=Bt*(1-Zi),lt.sprite.scale.set(ne*(1-.7*Zi),Ts*(1-.7*Zi))})}));const T=new Set(h),E=qe.map(_t=>({x:_t.sprite.x,y:_t.sprite.y})),C=L+W;for(let _t=0;_t<v;_t++){const lt=[];for(let nt=I-1;nt>=0;nt--){const Yt=Xd(_t,nt,v);T.has(Yt)||lt.push(Yt)}const ct=I-lt.length;for(let nt=0;nt<I;nt++){const Yt=I-1-nt,me=Xd(_t,Yt,v),Ze=qe[me].sprite,ws=d[me].id;if(Ze.__sid=ws,Ze.texture=$r[ws],bt(Ze,ws),Ze.visible=!0,Ze.alpha=1,Ze.x=E[me].x,nt<lt.length){const Ms=lt[nt];Ze.y=E[Ms].y,ul(me,ws),Qc(me)}else{const Ms=nt-lt.length,ts=Xd(_t,0,v);Ze.y=E[ts].y-C*(ct-Ms),ul(me,ws),Qc(me)}}}wS(d);const k=sn(90),R=sn(14),F=sn(190),O=sn(300),B=sn(520),N=rd(a),D=rd(d),z=N<2&&D>=2,$=N<3&&D>=3,rt=At||z||$;rt&&(e0(520,1.04),(Kt=u==null?void 0:u.setBaseMusicIntensity)==null||Kt.call(u,.85,250),(Lt=u==null?void 0:u.startTicktockLoop)==null||Lt.call(u,120,.4,1));let Q=null;if(rt){let _t=-1;for(let lt=0;lt<U;lt++)if(d[lt].id==="S1"){const ct=lt%v;ct>_t&&(_t=ct)}Q=Math.min(v,_t+1)}const X=Q!==null?Q-1:-1;let q=!1;const ut=sn(220),vt=Array.from({length:v},(_t,lt)=>new Promise(ct=>{let nt=lt*k;Q!==null&&lt>=Q&&(nt=Q*k+B+(lt-Q)*F),setTimeout(async()=>{const Yt=[];for(let Ze=I-1;Ze>=0;Ze--)Yt.push(Ze*v+lt);const me=Q!==null&&lt>=Q?O:R;await Promise.all(Yt.map((Ze,ws)=>new Promise(Ms=>{setTimeout(()=>{const ts=qe[Ze].sprite,Bt=ts.y,ne=E[Ze].y;ke(ut,Ts=>{const es=ms(Ts,.7);ts.y=Bt+(ne-Bt)*es}).then(Ms)},ws*me)}))),rt&&!q&&lt===X&&(q=!0,s0(d,B+260)),ct()},nt)}));await Promise.all(vt),rt&&n0(260,1),rt&&((ce=u==null?void 0:u.stopTicktockLoop)==null||ce.call(u,140)),(et=u==null?void 0:u.setBaseMusicIntensity)==null||et.call(u,.25,400),rt&&i0(),ha(d)}function ha(a){for(let h=0;h<U;h++){const d=a[h].id,m=qe[h].sprite;m.texture=$r[d],ul(h,d),Qc(h),m.visible=!0,m.alpha=1,bt(m,d);const{cx:g,cy:A}=Jc(h);m.x=g,m.y=Ju(d,A),m.__sid=d}}async function ES(){if(!qe.length)return;const a=L*(I+1),h=sn(45),d=sn(320),m=Array.from({length:v},(g,A)=>{const S=Array.from({length:U},(T,E)=>E).filter(T=>T%v===A);return new Promise(T=>{setTimeout(()=>{Promise.all(S.map(E=>{const C=qe[E].sprite,k=C.y,R=k+a;return ke(d,F=>{const O=pa(F);C.y=k+(R-k)*O,C.alpha=1-O})})).then(()=>T())},A*h)})});await Promise.all(m),Jn.removeChildren(),qe=[]}async function CS(a){ed(a);const h=L*(I+1),d=Array.from({length:U},(X,q)=>{const ut=a[q].id,{cx:vt,cy:ee}=Jc(q);return{x:vt,y:Ju(ut,ee)}});for(let X=0;X<U;X++){const q=qe[X].sprite;q.x=d[X].x,q.y=d[X].y-h,q.alpha=0,bt(q,a[X].id)}const m=sn(60),g=sn(0),A=sn(420),S=sn(200),T=sn(60);for(let X=0;X<v;X++){const q=X*T+A-S;setTimeout(()=>{var ut;(ut=u==null?void 0:u.playSfx)==null||ut.call(u,"reel_land",.8)},Math.max(0,q))}const E=sn(420),C=sn(520),k=sn(300),R=sn(300),F=sn(400),O=sn(500),B=Array.from({length:v},(X,q)=>{let ut=0;for(let vt=0;vt<I;vt++)a[vt*v+q].id==="S1"&&ut++;return ut});let N=null,D=null,z=0;for(let X=0;X<v;X++)z+=B[X],N===null&&z>=2&&(N=X),D===null&&z>=3&&(D=X);function $(X){let q=X*m;if(N!==null&&X>=N+1&&(q=(N+1)*m+E+(X-(N+1))*k),D!==null&&X>=D+1){const ut=N!==null?N+1:0,vt=Math.max(0,D+1-ut);q=ut*m+(N!==null?E:0)+vt*(N!==null?k:m)+C+(X-(D+1))*R}return q}if(At||N!==null||D!==null){let X=function(Kt){let Lt=g;return D!==null&&Kt>=D+1?Lt=O:N!==null&&Kt>=N+1&&(Lt=F),Lt};const ut=$(N??0)+A,vt=320,ee=Math.max(...Array.from({length:v},(Kt,Lt)=>{const ce=X(Lt),et=(I-1)*ce;return $(Lt)+et+A})),jt=Math.max(900,(ee-ut-vt)*1.6);setTimeout(()=>{var Kt;e0(jt,1.05,1.03),(Kt=u==null?void 0:u.startTicktockLoop)==null||Kt.call(u,120,.55,1),s0(a,700)},Math.max(0,ut)),setTimeout(()=>{var Kt;n0(320,1),i0(),(Kt=u==null?void 0:u.stopTicktockLoop)==null||Kt.call(u,140)},Math.max(0,ee))}const Q=Array.from({length:v},(X,q)=>new Promise(ut=>{setTimeout(async()=>{const vt=[];for(let jt=0;jt<I;jt++)vt.push(jt*v+q);let ee=g;D!==null&&q>=D+1?ee=O:N!==null&&q>=N+1&&(ee=F),await Promise.all(vt.map((jt,Kt)=>new Promise(Lt=>{setTimeout(()=>{const ce=qe[jt].sprite,et=d[jt].y,_t=et-h;ke(A,lt=>{const ct=ms(lt,.6);ce.y=_t+(et-_t)*ct,ce.alpha=Math.min(1,lt*1.2)}).then(Lt)},Kt*ee)}))),ut()},$(q))}));await Promise.all(Q),ha(a)}async function IS(){const a={rhX:js.x,rhY:js.y,rhSX:js.scale.x,rhSY:js.scale.y,gX:Jn.x,gY:Jn.y,gSX:Jn.scale.x,gSY:Jn.scale.y,pfX:Ss.x,pfY:Ss.y,pfSX:Ss.scale.x,pfSY:Ss.scale.y,mX:ls.x,mY:ls.y,mSX:ls.scale.x,mSY:ls.scale.y},h=10,d=sn(90),m=sn(160);await ke(d,g=>{const A=Hs(g),S=h*A;js.scale.set(a.rhSX,a.rhSY),Jn.scale.set(a.gSX,a.gSY),Ss.scale.set(a.pfSX,a.pfSY),ls.scale.set(a.mSX,a.mSY),js.position.set(a.rhX,a.rhY+S),Jn.position.set(a.gX,a.gY+S),Ss.position.set(a.pfX,a.pfY+S),ls.position.set(a.mX,a.mY+S)}),await ke(m,g=>{const A=ms(g,1.25),S=h+(0-h)*A;js.scale.set(a.rhSX,a.rhSY),Jn.scale.set(a.gSX,a.gSY),Ss.scale.set(a.pfSX,a.pfSY),ls.scale.set(a.mSX,a.mSY),js.position.set(a.rhX,a.rhY+S),Jn.position.set(a.gX,a.gY+S),Ss.position.set(a.pfX,a.pfY+S),ls.position.set(a.mX,a.mY+S)}),js.scale.set(a.rhSX,a.rhSY),js.position.set(a.rhX,a.rhY),Jn.scale.set(a.gSX,a.gSY),Jn.position.set(a.gX,a.gY),Ss.scale.set(a.pfSX,a.pfSY),Ss.position.set(a.pfX,a.pfY),ls.scale.set(a.mSX,a.mSY),ls.position.set(a.mX,a.mY)}function PS(a){var A;const g=Math.min(1,.15+a*.18);(A=u==null?void 0:u.setBaseMusicIntensity)==null||A.call(u,g,180)}function OS(a,h){const d=(h==null?void 0:h.baseDelayMs)??0,m=h==null?void 0:h.staggerMs,g=h==null?void 0:h.vol,A=.98,S=.015;for(let T=0;T<a.length;T++){const E=A+T*S;setTimeout(()=>{var C;(C=u==null?void 0:u.playSfx)==null||C.call(u,"reel_land",g,E)},d+T*m)}}function LS(a,h){const d=new Set;for(const m of a)d.add(m%h);return Array.from(d).sort((m,g)=>m-g)}async function kS(a){var d;tm(),bo(a.mode,!1),eh.text=`MODE: ${a.mode}`,nh.text="WIN: 0",tm();let h=0;await CS(a.initialGrid),a.mode==="FREE_SPINS"&&a.fsAwarded>0&&(await jp(a.fsAwarded),xe()),a.mode==="FREE_SPINS"&&a.fsAwarded>0&&_.fs.remaining>0&&Am(250),await Zr(!1);for(let m=0;m<a.steps.length;m++){const g=a.steps[m];if(a.mode==="BASE"&&PS(m),g.aftershockWildSpawned){ha(g.grid),await Q1(g);continue}ed(g.grid);const A=new Set;g.clusters.forEach(rt=>rt.positions.forEach(Q=>A.add(Q)));const S=Array.from(A);if(S.length>0&&(await ns(j1),g.clusters.length>0)){const ut=Math.min(3,1+m*.15);(d=u==null?void 0:u.playSfxThrottled)==null||d.call(u,"cluster_pop",80,.9,ut)}const T=Js(G)?Promise.resolve():Zr(!0),E=z1();K1(S);const C=IS();await Promise.all([T,C,E]),(g.enchantedClusters??0)>0&&lm(),A.forEach(rt=>MS(rt));const k=500,R=g.stepWinX*_.bank.betLevels[_.bank.betIndex];h+=R,R>1e-6&&Y1(h),console.log("[STEP FLAGS]",{i:m,infusedScatters:g.infusedScatters,enchantedClusters:g.enchantedClusters,scattersInGrid:rd(g.grid)}),(g.enchantedClusters??0)>0&&(lm(),await ns(120)),(g.infusedScatters??0)>0&&(Ku(),await ns(120)),await Promise.all([dS(g.clusters,g.grid),hS(g.clusters),rS(g.clusters,g.multiplier,_.bank.betLevels[_.bank.betIndex],520)]),Sm(!0),await th(k),Sm(!1);const F=nS(sn(80)),O=Js(G)?Promise.resolve():Zr(!1),B=g.explodePositions&&g.explodePositions.length>0?g.explodePositions:Array.from(new Set(g.clusters.flatMap(rt=>rt.positions))),N=LS(B,v);N.length>0&&OS(N,{baseDelayMs:sn(220)+90,staggerMs:70,vol:.5});const D=a.steps[m+1],z=D&&D.aftershockWildSpawned?D.grid:g.nextGrid,$=vS(g.grid,B,z,m);if(await Promise.all([F,O,$]),sm(),g.clusters.length>0){let rt=In.findIndex(q=>Math.abs(q-g.multiplier)<1e-6);rt<0&&(rt=0);const Q=Math.min(rt+1,In.length-1),X=In[Q];h0(X),Lc(X)}um()}await X1(200)}function Sm(a){for(const h of la)h.s.visible&&(h.s.alpha=a?.85:1)}let dl="INIT";bo("BASE",!1);async function bo(a,h=!0,d=!1){if(!(!d&&a===dl)){if(!h){if(M.visible=!0,M.alpha=1,!Xt||!Vt)return;Xt.visible=a==="BASE",Vt.visible=a==="FREE_SPINS",Xt.alpha=.9,Vt.alpha=.9,dl=a;return}if(a==="FREE_SPINS"){if(!Xt||!Vt)return;await bm(Xt,Vt,450,.9)}else{if(!Xt||!Vt)return;await bm(Vt,Xt,450,.9)}M.visible=!0,M.alpha=1,Xt.visible=a==="BASE",Vt.visible=a==="FREE_SPINS",dl=a}}function wm(){const a=yC(v,I,vf);eh.text="MODE: BASE",sd.text="MULT: x1",nh.text="WIN: 0",id.text=`FS: ${_.fs.remaining}`,ed(a),ha(a)}qu()}wC().catch(s=>{console.error("Fatal error in main():",s)});export{ba as $,Jg as A,ti as B,st as C,pn as D,Rt as E,Vg as F,Ta as G,Fi as H,Sa as I,Qm as J,Se as K,iM as L,Oe as M,mM as N,Hl as O,Fs as P,Xn as Q,Rl as R,fM as S,to as T,vh as U,oe as V,kM as W,t_ as X,gd as Y,e_ as Z,Nw as _,Bi as a,ss as a0,Fw as a1,xg as a2,ty as a3,ae as a4,ze as a5,UM as a6,uT as a7,iT as a8,PT as a9,LT as aa,NT as ab,WT as ac,DT as ad,my as ae,m_ as af,f_ as ag,G_ as ah,nr as ai,Gv as aj,Tn as ak,xt as al,iw as am,_e as an,Z_ as ao,yy as ap,eT as b,Ul as c,Sh as d,Es as e,p_ as f,QM as g,_f as h,qg as i,Ig as j,Ni as k,Hg as l,Dl as m,IT as n,OT as o,FT as p,UT as q,yw as r,Fh as s,te as t,sw as u,Rh as v,vn as w,GT as x,Ei as y,_g as z};
